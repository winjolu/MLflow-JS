{"version":3,"file":"static/js/675.166d5fc1.chunk.js","mappings":"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","sources":["common/static/chart-bar.svg","common/static/chart-contour.svg","common/static/chart-difference.svg","common/static/chart-image.svg","common/static/chart-line.svg","common/static/chart-parallel.svg","common/static/chart-scatter.svg","common/static/registered-model-grey-ok.svg","common/components/JsonFormatting.tsx","common/components/KeyValueTagFullViewModal.tsx","common/components/KeyValueTag.tsx","common/components/ToggleIconButton.tsx","common/hooks/useDragAndDropElement.tsx","common/components/TagSelectDropdown.tsx","common/hooks/useEditKeyValueTagsModal.tsx","common/hooks/useIsTabActive.tsx","common/utils/CssGrid.utils.ts","common/utils/LocalStorageUtils.ts","experiment-tracking/components/ExperimentSourceTypeIcon.tsx","experiment-tracking/components/RunStatusIcon.tsx","experiment-tracking/components/experiment-page/components/RunColorPill.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetSchemaTable.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetSchema.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetLink.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetSourceType.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetSourceURL.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetDigest.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetDrawer.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetWithContext.tsx","experiment-tracking/components/experiment-page/components/runs/cells/SourceCellRenderer.tsx","experiment-tracking/components/experiment-page/contexts/ExperimentPageUIStateContext.tsx","experiment-tracking/components/experiment-page/hooks/useExperimentIds.ts","experiment-tracking/components/experiment-page/hooks/usePopulateImagesByRunUuid.tsx","experiment-tracking/components/experiment-page/utils/customMetricBehaviorUtils.ts","experiment-tracking/components/modals/ConfirmModal.tsx","experiment-tracking/components/modals/DeleteRunModal.tsx","experiment-tracking/components/modals/GenericInputModal.tsx","experiment-tracking/components/modals/RenameForm.tsx","experiment-tracking/components/modals/RenameRunModal.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigure.common.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureBarChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureParallelChart.tsx","experiment-tracking/components/runs-charts/components/RunsChartsYAxisMetricAndExpressionSelector.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureLineChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureLineChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureParallelChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureContourChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureScatterChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureDifferenceChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureDifferenceChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureImageChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureImageChart.preview.tsx","experiment-tracking/components/runs-charts/components/RunsChartsConfigureModal.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureBarChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureContourChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureScatterChart.preview.tsx","experiment-tracking/components/runs-charts/components/RunsChartsFullScreenModal.tsx","experiment-tracking/components/runs-charts/components/RunsChartsNoDataFoundIndicator.tsx","experiment-tracking/components/runs-charts/components/RunsChartsTooltipBody.tsx","experiment-tracking/components/runs-charts/components/RunsContourPlot.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsBarPlot.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsLegend.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsLegendWrapper.tsx","experiment-tracking/components/runs-charts/hooks/useRunsChartsMultipleTracesTooltip.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsLinePlot.tsx","experiment-tracking/components/runs-charts/components/RunsMultipleTracesTooltipBody.tsx","experiment-tracking/components/runs-charts/components/RunsScatterPlot.tsx","experiment-tracking/components/runs-charts/components/cards/ChartCard.common.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsBarChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsLineChartCard.tsx","experiment-tracking/components/runs-charts/hooks/useCompareRunChartSelectedRange.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsScatterChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsContourChartCard.tsx","common/static/parallel-chart-placeholder.svg","experiment-tracking/components/runs-charts/components/cards/RunsChartsParallelChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsDifferenceChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsImageChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsCard.tsx","experiment-tracking/components/runs-charts/utils/differenceView.ts","experiment-tracking/components/runs-charts/components/charts/DifferenceViewPlot.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridPlot.common.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridSingleKeyPlot.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridMultipleKeyPlot.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridPlot.tsx","experiment-tracking/components/runs-charts/components/charts/LazyParallelCoordinatesPlot.tsx","experiment-tracking/components/MetricChartsAccordion.tsx","experiment-tracking/components/runs-charts/components/RunsChartsAddChartMenu.tsx","experiment-tracking/components/runs-charts/components/sections/RunsChartsSectionHeader.tsx","experiment-tracking/components/runs-charts/components/RunsCharts.tsx","experiment-tracking/components/runs-charts/components/sections/RunsChartsSection.tsx","experiment-tracking/components/runs-charts/components/sections/RunsChartsSectionAccordion.tsx","experiment-tracking/components/runs-charts/hooks/useChartImageDownloadHandler.tsx","experiment-tracking/components/runs-charts/hooks/useImageSliderStepMarks.tsx","experiment-tracking/components/runs-charts/hooks/useIsInViewport.tsx","experiment-tracking/components/runs-charts/hooks/useMutableHoverCallback.tsx","experiment-tracking/components/runs-charts/hooks/useRunsChartTraceHighlight.ts","experiment-tracking/components/runs-charts/hooks/useRunsChartsTooltip.tsx","experiment-tracking/components/runs-charts/hooks/useRunsChartsUIConfiguration.tsx","experiment-tracking/components/runs-charts/hooks/useSampledMetricHistory.tsx","experiment-tracking/components/runs-charts/runs-charts.types.ts","experiment-tracking/components/runs-charts/utils/findChartStepsByTimestamp.ts","experiment-tracking/components/runs-compare/hooks/useGroupedChartRunData.tsx","experiment-tracking/components/traces/hooks/useExperimentTraces.tsx","experiment-tracking/components/traces/TracesViewTableTagCell.tsx","experiment-tracking/components/traces/TracesViewTableStatusCell.tsx","experiment-tracking/components/traces/TracesViewTablePreviewCell.tsx","experiment-tracking/components/traces/TracesViewTableSourceCell.tsx","experiment-tracking/components/traces/TracesViewTable.utils.ts","experiment-tracking/components/traces/TracesViewTableRow.tsx","experiment-tracking/components/traces/TracesViewTableTimestampCell.tsx","experiment-tracking/components/traces/TracesViewTableHeaderCheckbox.tsx","experiment-tracking/components/traces/TracesViewTableCellCheckbox.tsx","experiment-tracking/components/traces/TracesViewTable.tsx","experiment-tracking/components/traces/hooks/useExperimentTraceData.tsx","shared/web-shared/model-trace-explorer/ModelTraceExplorerFrameRenderer.tsx","shared/web-shared/model-trace-explorer/index.ts","experiment-tracking/components/traces/hooks/useExperimentTraceInfo.tsx","experiment-tracking/components/traces/TraceDataDrawer.tsx","experiment-tracking/components/traces/TracesViewDeleteTraceModal.tsx","experiment-tracking/components/traces/TracesViewControlsActions.tsx","experiment-tracking/components/traces/TracesViewControls.tsx","experiment-tracking/components/traces/hooks/useExperimentViewTracesUIState.tsx","experiment-tracking/components/traces/hooks/useActiveExperimentTrace.tsx","experiment-tracking/components/traces/TracesView.tsx","experiment-tracking/components/traces/hooks/useEditExperimentTraceTags.tsx","experiment-tracking/components/traces/TracesView.utils.ts","experiment-tracking/utils/DatasetUtils.ts","shared/building_blocks/CopyButton.tsx","shared/building_blocks/Image.tsx","shared/web-shared/hooks/useMediaQuery.ts","shared/web-shared/snippet/theme/databricks-duotone-dark.ts","shared/web-shared/snippet/theme/databricks-light.ts","shared/web-shared/snippet/index.tsx"],"sourcesContent":["var _path, _rect, _rect2, _rect3, _rect4;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartBar(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 16,\n    viewBox: \"0 0 18 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 0.813599V15.1865H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 3.16943,\n    y: 10.5763,\n    width: 2.16949,\n    height: 3.25424,\n    fill: \"#338ECC\"\n  })), _rect2 || (_rect2 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 6.42371,\n    y: 5.15259,\n    width: 2.16949,\n    height: 8.67797,\n    fill: \"#338ECC\"\n  })), _rect3 || (_rect3 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 9.67798,\n    y: 8.40686,\n    width: 2.16949,\n    height: 5.42373,\n    fill: \"#338ECC\"\n  })), _rect4 || (_rect4 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 12.9323,\n    y: 1.89832,\n    width: 2.16949,\n    height: 11.9322,\n    fill: \"#338ECC\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartBar);\nexport default __webpack_public_path__ + \"static/media/chart-bar.0fd4a63680fba840a7b69fbf07969f79.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _path2, _path3;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartContour(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 18,\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 1V17H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.9749 4.94148C12.9188 4.71702 12.221 4.73284 12.0618 4.71515C11.1779 4.61693 10.2817 4.66052 9.39271 4.66052C8.11919 4.66052 7.15648 4.97961 6.24753 5.90922C5.86197 6.30355 5.5235 6.77684 5.23295 7.24378C4.99434 7.62726 4.65544 7.93479 4.40569 8.31299C3.93777 9.02154 3.56281 9.80723 3.56281 10.6699C3.56281 11.1806 3.37479 11.598 3.76962 12.0669C4.19449 12.5714 4.6863 12.9507 5.27978 13.2649C5.88594 13.5858 6.42202 13.8619 7.13723 13.8619C7.74338 13.8619 8.34952 13.8619 8.95567 13.8619C9.45735 13.8619 9.96042 13.8731 10.4619 13.8619C11.1412 13.8468 11.9484 13.1895 12.413 12.7381C13.581 11.6035 14.2393 9.88016 14.2393 8.24665C14.2393 7.69923 14.3797 7.17063 14.3797 6.62723C14.3797 6.40084 14.4779 5.87696 14.2744 5.71411C13.9268 5.43606 13.5785 5.13789 13.1857 4.94148\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.9213 6.83789C11.2761 6.83789 10.6309 6.83789 9.98577 6.83789C9.19776 6.83789 8.80182 7.44144 8.2844 7.97734C7.58163 8.70521 7.28544 9.67306 7.28544 10.666C7.28544 10.9641 7.22004 11.177 7.46104 11.3645C7.6831 11.5372 8.10719 11.6142 8.37806 11.6142C9.07316 11.6142 9.91042 11.5583 10.4462 11.0523C10.9277 10.5975 11.473 10.3701 11.8159 9.75284C12.045 9.34042 12.2022 8.86324 12.2022 8.38317C12.2022 8.14903 12.2022 7.9149 12.2022 7.68077C12.2022 7.4241 12.0208 7.38817 11.9213 7.18909\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartContour);\nexport default __webpack_public_path__ + \"static/media/chart-contour.0d4b306f2669f3ad25375568935e3ce3.svg\";\nexport { ForwardRef as ReactComponent };","var _rect, _rect2, _rect3, _rect4, _rect5, _rect6, _rect7, _rect8, _rect9, _rect10, _rect11, _rect12, _rect13, _rect14, _rect15, _rect16, _rect17, _rect18;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartDifference(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 2,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect2 || (_rect2 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 2,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect3 || (_rect3 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 2,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect4 || (_rect4 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 4,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect5 || (_rect5 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 4,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect6 || (_rect6 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 4,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect7 || (_rect7 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 6,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect8 || (_rect8 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 6,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect9 || (_rect9 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 6,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect10 || (_rect10 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 8,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect11 || (_rect11 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 8,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect12 || (_rect12 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 8,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect13 || (_rect13 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 10,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect14 || (_rect14 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 10,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect15 || (_rect15 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 10,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect16 || (_rect16 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 12,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect17 || (_rect17 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 12,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect18 || (_rect18 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 12,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartDifference);\nexport default __webpack_public_path__ + \"static/media/chart-difference.16174216d6f3b7c24f40e3541fe0ca2c.svg\";\nexport { ForwardRef as ReactComponent };","var _rect, _line, _line2, _line3;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartImage(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 0.5,\n    y: 0.5,\n    width: 15,\n    height: 15,\n    stroke: \"#C4C4C4\"\n  })), _line || (_line = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 8.5,\n    y1: 0.800049,\n    x2: 8.5,\n    y2: 16,\n    stroke: \"#C4C4C4\"\n  })), _line2 || (_line2 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 16,\n    y1: 5.69995,\n    x2: -2.63656e-8,\n    y2: 5.69995,\n    stroke: \"#C4C4C4\"\n  })), _line3 || (_line3 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 16,\n    y1: 10.9,\n    x2: -2.63656e-8,\n    y2: 10.9,\n    stroke: \"#C4C4C4\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartImage);\nexport default __webpack_public_path__ + \"static/media/chart-image.cc434c4dc50780966344e2385a15f8fe.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _path2;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartLine(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 22,\n    height: 22,\n    viewBox: \"0 0 22 22\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.38977 15.717L8.79655 10.8113L12.5254 14.9622L19.644 7.03772\",\n    stroke: \"#338ECC\",\n    strokeWidth: 2,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 1V21H21\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartLine);\nexport default __webpack_public_path__ + \"static/media/chart-line.0adaa2036bb4eb5956db6d0c7e925a3d.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _path2, _path3, _path4, _path5;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartParallel(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 18,\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 1V17H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.21875 3.58289C4.55663 3.58289 4.88067 3.68935 5.21469 3.73008C5.6474 3.78285 6.02137 3.96513 6.37191 4.21552C6.76902 4.49917 7.0271 4.74589 7.24101 5.18954C7.44337 5.60925 7.59378 6.06989 7.72958 6.51432C7.86002 6.94121 8.09708 7.33726 8.19153 7.77803C8.25347 8.0671 8.34514 8.32427 8.44678 8.60015C8.58028 8.96252 8.80086 9.27915 8.96667 9.62583C9.15145 10.0122 9.216 10.4461 9.34876 10.8551C9.57831 11.5623 9.91132 12.4763 10.7205 12.6731C11.4284 12.8453 12.1459 12.8845 12.8705 12.8845C13.0981 12.8845 13.3979 12.898 13.5831 12.7499C13.6402 12.7042 13.7451 12.6907 13.8164 12.6591C13.8752 12.6329 14.0919 12.5871 14.1123 12.5463\",\n    stroke: \"#CCE3F2\",\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.16162 12.9805C4.32512 12.9805 4.4895 12.9859 4.65284 12.9805C4.84076 12.9742 5.0468 12.7952 5.2099 12.707C5.62236 12.4841 5.99426 12.0648 6.24299 11.6739C6.49491 11.2781 6.8776 10.9871 7.0887 10.5649C7.27767 10.187 7.50992 9.80749 7.73691 9.45078C7.93911 9.13304 8.10211 8.77722 8.28637 8.44554C8.43088 8.18544 8.45 7.88672 8.60542 7.62768C8.94898 7.05509 9.16215 6.418 9.45873 5.82484C9.72614 5.29001 9.96898 4.82426 10.4159 4.42207C10.5753 4.27853 10.8984 4.21824 11.0995 4.14861C11.3303 4.06873 11.579 4.02714 11.8136 3.93592C12.0394 3.84807 12.2521 3.84383 12.4795 3.77386C12.6993 3.70623 12.9319 3.63713 13.1632 3.63713C13.5192 3.63713 13.9089 3.59155 14.2798 3.59155\",\n    stroke: \"#CCE3F2\",\n    strokeLinecap: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.79248 2.74207V13.8225\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.873 3.04419V13.7217\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartParallel);\nexport default __webpack_public_path__ + \"static/media/chart-parallel.da7dedf539b2af4b654d377c679173e4.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _circle, _ellipse, _circle2, _circle3, _ellipse2, _ellipse3;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgChartScatter(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 16,\n    viewBox: \"0 0 18 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 0.813599V15.1865H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _circle || (_circle = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 3.98301,\n    cy: 12.4746,\n    r: 1.35593,\n    fill: \"#338ECC\"\n  })), _ellipse || (_ellipse = /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 9.40684,\n    cy: 10.8475,\n    rx: 1.35593,\n    ry: 1.35593,\n    fill: \"#338ECC\"\n  })), _circle2 || (_circle2 = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 5.6102,\n    cy: 8.1356,\n    r: 1.35593,\n    fill: \"#338ECC\",\n    fillOpacity: 0.25\n  })), _circle3 || (_circle3 = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 9.40684,\n    cy: 6.50852,\n    r: 1.35593,\n    fill: \"#338ECC\"\n  })), _ellipse2 || (_ellipse2 = /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 13.7457,\n    cy: 5.96616,\n    rx: 1.35593,\n    ry: 1.35593,\n    fill: \"#338ECC\",\n    fillOpacity: 0.25\n  })), _ellipse3 || (_ellipse3 = /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 16.4576,\n    cy: 2.46128,\n    rx: 1.35593,\n    ry: 1.35593,\n    fill: \"#338ECC\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartScatter);\nexport default __webpack_public_path__ + \"static/media/chart-scatter.69118d0023a6ff3973f7fa913834ac47.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _g, _path2, _path3, _defs;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgRegisteredModelGreyOk(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 19,\n    height: 16,\n    viewBox: \"0 0 19 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"g\", {\n    clipPath: \"url(#clip0_0_3)\"\n  }, /*#__PURE__*/React.createElement(\"mask\", {\n    id: \"mask0_0_3\",\n    style: {\n      maskType: \"luminance\"\n    },\n    maskUnits: \"userSpaceOnUse\",\n    x: 0,\n    y: 0,\n    width: 16,\n    height: 16\n  }, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16 0H0V16H16V0Z\",\n    fill: \"white\"\n  }))), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    mask: \"url(#mask0_0_3)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M2.75 3.49999C2.05964 3.49999 1.5 4.05963 1.5 4.74999C1.5 5.44034 2.05964 5.99999 2.75 5.99999C3.44036 5.99999 4 5.44034 4 4.74999C4 4.05963 3.44036 3.49999 2.75 3.49999ZM0 4.74999C0 3.2312 1.23122 1.99999 2.75 1.99999C3.77682 1.99999 4.6722 2.56276 5.14452 3.39669L9.51655 2.44626C9.66772 1.0704 10.8338 0 12.25 0C13.7688 0 15 1.23122 15 2.75C15 3.87686 14.3222 4.84541 13.3521 5.27025L13.6341 7.52661C14.9711 7.71349 16 8.86158 16 10.25C16 11.7688 14.7687 13 13.25 13C12.3895 13 11.6214 12.6048 11.1172 11.9861L8.49749 13.1322C8.49913 13.1713 8.49997 13.2105 8.49997 13.25C8.49996 14.7688 7.26875 16 5.74997 16C4.23118 16 2.99997 14.7688 2.99996 13.25C2.99997 12.3569 3.42568 11.5633 4.08524 11.0609L3.01322 7.48755C2.92659 7.49578 2.83878 7.49999 2.75 7.49999C1.23122 7.49999 0 6.26877 0 4.74999ZM5.46534 5.18782C5.48277 5.07884 5.4938 4.96773 5.49804 4.85488L9.76409 3.92748C10.1528 4.74671 10.9346 5.34321 11.8658 5.47338L12.1478 7.72974C11.7709 7.89483 11.438 8.14204 11.1719 8.44873L5.46534 5.18782ZM4.82802 6.55126C4.70399 6.69422 4.56546 6.82424 4.41471 6.93906L5.48674 10.5124C5.57337 10.5042 5.66118 10.5 5.74997 10.5C6.69483 10.5 7.52839 10.9765 8.02345 11.7023L10.5231 10.6087C10.5079 10.4913 10.5 10.3716 10.5 10.25C10.5 10.101 10.5118 9.95475 10.5346 9.81218L4.82802 6.55126ZM12 10.25C12 9.55963 12.5596 8.99999 13.25 8.99999C13.9403 8.99999 14.5 9.55963 14.5 10.25C14.5 10.9403 13.9403 11.5 13.25 11.5C12.5596 11.5 12 10.9403 12 10.25ZM5.74997 12C5.05961 12 4.49997 12.5596 4.49997 13.25C4.49997 13.9403 5.05961 14.5 5.74997 14.5C6.44032 14.5 6.99997 13.9403 6.99997 13.25C6.99997 12.5596 6.44032 12 5.74997 12ZM11 2.75C11 2.05964 11.5596 1.5 12.25 1.5C12.9403 1.5 13.5 2.05964 13.5 2.75C13.5 3.44036 12.9403 4 12.25 4C11.5596 4 11 3.44036 11 2.75Z\",\n    fill: \"currentColor\"\n  }))), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.5 14C15.433 14 17 12.433 17 10.5C17 8.567 15.433 7 13.5 7C11.567 7 10 8.567 10 10.5C10 12.433 11.567 14 13.5 14Z\",\n    fill: \"white\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M11.125 11C11.125 9.41218 12.4122 8.125 14 8.125C15.5878 8.125 16.875 9.41218 16.875 11C16.875 12.5878 15.5878 13.875 14 13.875C12.4122 13.875 11.125 12.5878 11.125 11ZM14 6.625C11.5838 6.625 9.625 8.58375 9.625 11C9.625 13.4162 11.5838 15.375 14 15.375C16.4162 15.375 18.375 13.4162 18.375 11C18.375 8.58375 16.4162 6.625 14 6.625ZM14.0303 12.5303L16.0303 10.5303L14.9697 9.46967L13.5 10.9393L13.0303 10.4697L11.9697 11.5303L12.9697 12.5303L13.5 13.0607L14.0303 12.5303Z\",\n    fill: \"#3CAA60\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n    id: \"clip0_0_3\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    width: 19,\n    height: 16,\n    fill: \"white\"\n  })))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgRegisteredModelGreyOk);\nexport default __webpack_public_path__ + \"static/media/registered-model-grey-ok.8274b58d39504c8d1b8c358aa1c9aa35.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react';\nimport { CodeSnippet } from '@databricks/web-shared/snippet';\nimport { isObject } from 'lodash';\n\ninterface JsonPreviewProps {\n  json: string;\n  wrapperStyle?: React.CSSProperties;\n  overlayStyle?: React.CSSProperties;\n  codeSnippetStyle?: React.CSSProperties;\n}\n\nexport const JsonPreview: React.FC<JsonPreviewProps> = ({ json, wrapperStyle, overlayStyle, codeSnippetStyle }) => {\n  const { formattedJson, isJsonContent } = useFormattedJson(json);\n\n  const defaultWrapperStyle: React.CSSProperties = {\n    position: 'relative',\n    maxHeight: 'calc(1.5em * 9)',\n    overflow: 'hidden',\n  };\n\n  const defaultOverlayStyle: React.CSSProperties = {\n    position: 'absolute',\n    bottom: 0,\n    right: 0,\n    left: 6,\n    height: '2em',\n    background: 'linear-gradient(transparent, white)',\n  };\n\n  const defaultCodeSnippetStyle: React.CSSProperties = {\n    padding: '5px',\n    overflowX: 'hidden',\n  };\n\n  return (\n    <div style={{ ...defaultWrapperStyle, ...wrapperStyle }}>\n      {isJsonContent ? (\n        <>\n          <CodeSnippet language=\"json\" style={{ ...defaultCodeSnippetStyle, ...codeSnippetStyle }}>\n            {formattedJson}\n          </CodeSnippet>\n          <div css={{ ...defaultOverlayStyle, ...overlayStyle }}></div>\n        </>\n      ) : (\n        <>{json}</>\n      )}\n    </div>\n  );\n};\n\nexport function useFormattedJson(json: string) {\n  return React.useMemo(() => {\n    try {\n      const parsed = JSON.parse(json);\n      const isJson = isObject(parsed) && typeof parsed !== 'function' && !(parsed instanceof Date);\n      return {\n        formattedJson: isJson ? JSON.stringify(parsed, null, 2) : json,\n        isJsonContent: isJson,\n      };\n    } catch (e) {\n      return {\n        formattedJson: json,\n        isJsonContent: false,\n      };\n    }\n  }, [json]);\n}\n\nexport const FormattedJsonDisplay: React.FC<{ json: string }> = ({ json }) => {\n  const { formattedJson, isJsonContent } = useFormattedJson(json);\n\n  return (\n    <div css={{ whiteSpace: 'pre-wrap' }}>\n      {isJsonContent ? (\n        <CodeSnippet language=\"json\" wrapLongLines>\n          {formattedJson}\n        </CodeSnippet>\n      ) : (\n        <span>{json}</span>\n      )}\n    </div>\n  );\n};\n","import React from 'react';\nimport { Modal, Typography, CopyIcon, useDesignSystemTheme } from '@databricks/design-system';\nconst { Paragraph } = Typography;\nimport { CopyButton } from '@mlflow/mlflow/src/shared/building_blocks/CopyButton';\n\nexport interface KeyValueTagFullViewModalProps {\n  tagKey: string;\n  tagValue: string;\n  setIsKeyValueTagFullViewModalVisible: React.Dispatch<React.SetStateAction<boolean>>;\n  isKeyValueTagFullViewModalVisible: boolean;\n}\n\nexport const KeyValueTagFullViewModal = React.memo((props: KeyValueTagFullViewModalProps) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <Modal\n      title={'Tag: ' + props.tagKey}\n      visible={props.isKeyValueTagFullViewModalVisible}\n      onCancel={() => props.setIsKeyValueTagFullViewModalVisible(false)}\n    >\n      <div css={{ display: 'flex' }}>\n        <Paragraph css={{ flexGrow: 1 }}>\n          <pre\n            css={{\n              backgroundColor: theme.colors.backgroundPrimary,\n              marginTop: theme.spacing.sm,\n              whiteSpace: 'pre-wrap',\n              wordBreak: 'break-all',\n            }}\n          >\n            {props.tagValue}\n          </pre>\n        </Paragraph>\n        <div\n          css={{\n            marginTop: theme.spacing.sm,\n          }}\n        >\n          <CopyButton copyText={props.tagValue} showLabel={false} icon={<CopyIcon />} aria-label=\"Copy\" />\n        </div>\n      </div>\n    </Modal>\n  );\n});\n","import { Tag, LegacyTooltip, Typography } from '@databricks/design-system';\nimport { KeyValueEntity } from '../../experiment-tracking/types';\nimport React, { useState } from 'react';\nimport { useIntl } from 'react-intl';\nimport { KeyValueTagFullViewModal } from './KeyValueTagFullViewModal';\nimport { Interpolation, Theme } from '@emotion/react';\n\n/**\n * An arbitrary number that is used to determine if a tag is too\n * long and should be truncated. We want to avoid short keys or values\n * in a long tag to be truncated\n * */\nexport const TRUNCATE_ON_CHARS_LENGTH = 30;\n\nfunction getTruncatedStyles(shouldTruncate = true): Interpolation<Theme> {\n  return shouldTruncate\n    ? {\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        textWrap: 'nowrap',\n        whiteSpace: 'nowrap' as const,\n      }\n    : { whiteSpace: 'nowrap' as const };\n}\n\n/**\n * A <Tag /> wrapper used for displaying key-value entity\n */\nexport const KeyValueTag = ({\n  isClosable = false,\n  onClose,\n  tag,\n  enableFullViewModal = false,\n  charLimit = TRUNCATE_ON_CHARS_LENGTH,\n  maxWidth = 300,\n  className,\n}: {\n  isClosable?: boolean;\n  onClose?: () => void;\n  tag: KeyValueEntity;\n  enableFullViewModal?: boolean;\n  charLimit?: number;\n  maxWidth?: number;\n  className?: string;\n}) => {\n  const intl = useIntl();\n\n  const [isKeyValueTagFullViewModalVisible, setIsKeyValueTagFullViewModalVisible] = useState(false);\n\n  const { shouldTruncateKey, shouldTruncateValue } = getKeyAndValueComplexTruncation(tag, charLimit);\n  const allowFullViewModal = enableFullViewModal && (shouldTruncateKey || shouldTruncateValue);\n\n  const fullViewModalLabel = intl.formatMessage({\n    defaultMessage: 'Click to see more',\n    description: 'Run page > Overview > Tags cell > Tag',\n  });\n\n  return (\n    <div>\n      <Tag closable={isClosable} onClose={onClose} title={tag.key} className={className}>\n        <LegacyTooltip title={allowFullViewModal ? fullViewModalLabel : ''}>\n          <span\n            css={{ maxWidth, display: 'inline-flex' }}\n            onClick={() => (allowFullViewModal ? setIsKeyValueTagFullViewModalVisible(true) : undefined)}\n          >\n            <Typography.Text bold title={tag.key} css={getTruncatedStyles(shouldTruncateKey)}>\n              {tag.key}\n            </Typography.Text>\n            {tag.value && (\n              <Typography.Text title={tag.value} css={getTruncatedStyles(shouldTruncateValue)}>\n                : {tag.value}\n              </Typography.Text>\n            )}\n          </span>\n        </LegacyTooltip>\n      </Tag>\n      <div>\n        {isKeyValueTagFullViewModalVisible && (\n          <KeyValueTagFullViewModal\n            tagKey={tag.key}\n            tagValue={tag.value}\n            isKeyValueTagFullViewModalVisible={isKeyValueTagFullViewModalVisible}\n            setIsKeyValueTagFullViewModalVisible={setIsKeyValueTagFullViewModalVisible}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport function getKeyAndValueComplexTruncation(\n  tag: KeyValueEntity,\n  charLimit = TRUNCATE_ON_CHARS_LENGTH,\n): { shouldTruncateKey: boolean; shouldTruncateValue: boolean } {\n  const { key, value } = tag;\n  const fullLength = key.length + value.length;\n  const isKeyLonger = key.length > value.length;\n  const shorterLength = isKeyLonger ? value.length : key.length;\n\n  // No need to truncate if tag is short enough\n  if (fullLength <= charLimit) return { shouldTruncateKey: false, shouldTruncateValue: false };\n  // If the shorter string is too long, truncate both key and value.\n  if (shorterLength > charLimit / 2) return { shouldTruncateKey: true, shouldTruncateValue: true };\n\n  // Otherwise truncate the longer string\n  return {\n    shouldTruncateKey: isKeyLonger,\n    shouldTruncateValue: !isKeyLonger,\n  };\n}\n","import React from 'react';\n\nimport type { ButtonProps } from '@databricks/design-system';\nimport {\n  DesignSystemEventProviderAnalyticsEventTypes,\n  DesignSystemEventProviderComponentTypes,\n  useDesignSystemEventComponentCallbacks,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\n\nexport interface ToggleIconButtonProps extends ButtonProps {\n  pressed?: boolean;\n}\n\n/**\n * WARNING: Temporary component!\n *\n * This component recreates \"Toggle button with icon\" pattern which is not\n * available in the design system yet.\n *\n * TODO: replace this component with the one from DuBois design system when available.\n */\nconst ToggleIconButton = React.forwardRef<HTMLButtonElement, ToggleIconButtonProps>(\n  (props: ToggleIconButtonProps, ref) => {\n    const {\n      pressed,\n      onClick,\n      icon,\n      onBlur,\n      onFocus,\n      onMouseEnter,\n      onMouseLeave,\n      componentId,\n      analyticsEvents,\n      type,\n      ...remainingProps\n    } = props;\n    const { theme } = useDesignSystemTheme();\n\n    const eventContext = useDesignSystemEventComponentCallbacks({\n      componentType: DesignSystemEventProviderComponentTypes.Button,\n      componentId,\n      analyticsEvents: analyticsEvents ?? [DesignSystemEventProviderAnalyticsEventTypes.OnClick],\n    });\n\n    return (\n      <button\n        onClick={(event) => {\n          eventContext.onClick();\n          onClick?.(event);\n        }}\n        css={{\n          cursor: 'pointer',\n          width: theme.general.heightSm,\n          height: theme.general.heightSm,\n          borderRadius: theme.borders.borderRadiusMd,\n          lineHeight: theme.typography.lineHeightBase,\n          padding: 0,\n          border: 0,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          background: pressed ? theme.colors.actionDefaultBackgroundPress : 'transparent',\n          color: pressed ? theme.colors.actionDefaultTextPress : theme.colors.textSecondary,\n          '&:hover': {\n            background: theme.colors.actionDefaultBackgroundHover,\n            color: theme.colors.actionDefaultTextHover,\n          },\n        }}\n        ref={ref}\n        onBlur={onBlur}\n        onFocus={onFocus}\n        onMouseEnter={onMouseEnter}\n        onMouseLeave={onMouseLeave}\n        {...remainingProps}\n      >\n        {icon}\n      </button>\n    );\n  },\n);\n\nexport { ToggleIconButton };\n","// eslint-disable-next-line import/no-extraneous-dependencies\nimport { type DragDropManager, createDragDropManager } from 'dnd-core';\nimport { useLayoutEffect, useRef, useState } from 'react';\nimport { useDrag, useDrop, DndProvider } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\n\nexport interface useDragAndDropElementProps {\n  /**\n   * Unique drag element identifier, used in drop events\n   */\n  dragKey: string;\n  /**\n   * Group key - items are droppable only within a single group\n   */\n  dragGroupKey: string;\n  /**\n   * Callback function, conveys both dragged and target element key\n   */\n  onDrop: (draggedKey: string, targetDropKey: string) => void;\n\n  /**\n   * If true, drag and drop will be disabled\n   */\n  disabled?: boolean;\n}\n\ninterface DraggedItem {\n  key: string;\n  groupKey: string;\n}\n\n/**\n * A hook enabling drag-and-drop capabilities for any component.\n * Used component will serve as both DnD source and target.\n */\nexport const useDragAndDropElement = ({\n  dragGroupKey,\n  dragKey,\n  onDrop,\n  disabled = false,\n}: useDragAndDropElementProps) => {\n  const dropListener = useRef(onDrop);\n\n  dropListener.current = onDrop;\n\n  const [{ isOver, draggedItem }, dropTargetRef] = useDrop<\n    DraggedItem,\n    never,\n    { isOver: boolean; draggedItem: DraggedItem }\n  >(\n    {\n      canDrop: () => !disabled,\n      accept: `dnd-${dragGroupKey}`,\n      drop: ({ key: sourceKey }: { key: string }, monitor) => {\n        if (sourceKey === dragKey || monitor.didDrop()) {\n          return;\n        }\n        dropListener.current(sourceKey, dragKey);\n      },\n      collect: (monitor) => ({ isOver: monitor.isOver({ shallow: true }), draggedItem: monitor.getItem() }),\n    },\n    [disabled, dragGroupKey, dragKey],\n  );\n\n  const [{ isDragging }, dragHandleRef, dragPreviewRef] = useDrag(\n    {\n      canDrag: () => !disabled,\n      type: `dnd-${dragGroupKey}`,\n      item: { key: dragKey, groupKey: dragGroupKey },\n      collect: (monitor) => ({\n        isDragging: monitor.isDragging(),\n      }),\n    },\n    [disabled, dragGroupKey, dragKey],\n  );\n\n  const isDraggingOtherGroup = Boolean(draggedItem && draggedItem.groupKey !== dragGroupKey);\n\n  return { dropTargetRef, dragHandleRef, dragPreviewRef, isDragging, isOver, isDraggingOtherGroup };\n};\n\n/**\n * Create a scoped DndProvider that will limit its functionality to a single root element.\n * It should prevent HTML5Backend collisions, see:\n * https://github.com/react-dnd/react-dnd/blob/7c88c37489a53b5ac98699c46a506a8e085f1c03/packages/backend-html5/src/HTML5BackendImpl.ts#L107-L109\n */\nexport const DragAndDropProvider: React.FC = ({ children }) => {\n  const rootElementRef = useRef<HTMLDivElement>(null);\n  const [manager, setManager] = useState<DragDropManager | null>(null);\n\n  useLayoutEffect(() => {\n    const rootElement = rootElementRef.current;\n    const dragDropManager = createDragDropManager(HTML5Backend, undefined, { rootElement });\n    setManager(dragDropManager);\n    return () => {\n      dragDropManager.getBackend().teardown();\n    };\n  }, []);\n\n  return (\n    <div css={{ display: 'contents' }} ref={rootElementRef}>\n      {manager && <DndProvider manager={manager}>{children}</DndProvider>}\n    </div>\n  );\n};\n","import { sortedIndexOf } from 'lodash';\nimport React, { useMemo, useRef, useState } from 'react';\nimport { Control, useController } from 'react-hook-form';\nimport { useIntl } from 'react-intl';\n\nimport { PlusIcon, LegacySelect, LegacyTooltip, useDesignSystemTheme } from '@databricks/design-system';\nimport { KeyValueEntity } from '../../experiment-tracking/types';\n\n/**\n * Will show an extra row at the bottom of the dropdown menu to create a new tag when\n * The user has typed something in the search input\n * and either\n * 1. The search input is not an exact match for an existing tag name\n * 2. There are no tags available based on search input\n */\n\nfunction DropdownMenu(menu: React.ReactElement, allAvailableTags: string[]) {\n  const intl = useIntl();\n  const { theme } = useDesignSystemTheme();\n  const searchValue = menu.props.searchValue.toLowerCase();\n\n  const resolvedMenu = useMemo(() => {\n    if (!searchValue) return menu;\n\n    const doesTagExists = sortedIndexOf(allAvailableTags, searchValue) >= 0;\n    if (doesTagExists) return menu;\n\n    const isValidTagKey = /^[^,.:/=\\-\\s]+$/.test(searchValue);\n\n    // Overriding the menu to add a new option at the top\n    return React.cloneElement(menu, {\n      flattenOptions: [\n        {\n          data: {\n            value: searchValue,\n            disabled: !isValidTagKey,\n            style: {\n              color: isValidTagKey ? theme.colors.actionTertiaryTextDefault : theme.colors.actionDisabledText,\n            },\n            children: (\n              <LegacyTooltip\n                title={\n                  isValidTagKey\n                    ? undefined\n                    : intl.formatMessage({\n                        defaultMessage: ', . : / - = and blank spaces are not allowed',\n                        description:\n                          'Key-value tag editor modal > Tag dropdown Manage Modal > Invalid characters error',\n                      })\n                }\n                placement=\"right\"\n              >\n                <span css={{ display: 'block' }}>\n                  <PlusIcon css={{ marginRight: theme.spacing.sm }} />\n                  {intl.formatMessage(\n                    {\n                      defaultMessage: 'Add tag \"{tagKey}\"',\n                      description: 'Key-value tag editor modal > Tag dropdown Manage Modal > Add new tag button',\n                    },\n                    {\n                      tagKey: searchValue,\n                    },\n                  )}\n                </span>\n              </LegacyTooltip>\n            ),\n          },\n          key: searchValue,\n          groupOption: false,\n        },\n        ...menu.props.flattenOptions,\n      ],\n    });\n  }, [allAvailableTags, menu, searchValue, intl, theme]);\n\n  return resolvedMenu;\n}\n\nfunction getDropdownMenu(allAvailableTags: string[]) {\n  return (menu: React.ReactElement) => DropdownMenu(menu, allAvailableTags);\n}\n\n/**\n * Used in tag edit feature, allows selecting existing / adding new tag value\n */\nexport function TagKeySelectDropdown({\n  allAvailableTags,\n  control,\n  onKeyChangeCallback,\n}: {\n  allAvailableTags: string[];\n  control: Control<KeyValueEntity>;\n  onKeyChangeCallback?: (key?: string) => void;\n}) {\n  const intl = useIntl();\n  const [isOpen, setIsOpen] = useState(false);\n  const selectRef = useRef<{ blur: () => void; focus: () => void }>(null);\n\n  const { field, fieldState } = useController({\n    control: control,\n    name: 'key',\n    rules: {\n      required: {\n        message: intl.formatMessage({\n          defaultMessage: 'A tag key is required',\n          description: 'Key-value tag editor modal > Tag dropdown > Tag key required error message',\n        }),\n        value: true,\n      },\n    },\n  });\n\n  const handleDropdownVisibleChange = (visible: boolean) => {\n    setIsOpen(visible);\n  };\n\n  const handleClear = () => {\n    field.onChange(undefined);\n    onKeyChangeCallback?.(undefined);\n  };\n\n  const handleSelect = (key: string) => {\n    field.onChange(key);\n    onKeyChangeCallback?.(key);\n  };\n\n  return (\n    <LegacySelect\n      allowClear\n      ref={selectRef}\n      dangerouslySetAntdProps={{\n        showSearch: true,\n        dropdownRender: getDropdownMenu(allAvailableTags),\n      }}\n      css={{ width: '100%' }}\n      placeholder={intl.formatMessage({\n        defaultMessage: 'Type a key',\n        description: 'Key-value tag editor modal > Tag dropdown > Tag input placeholder',\n      })}\n      value={field.value}\n      defaultValue={field.value}\n      open={isOpen}\n      onDropdownVisibleChange={handleDropdownVisibleChange}\n      filterOption={(input, option) => option?.value.toLowerCase().includes(input.toLowerCase())}\n      onSelect={handleSelect}\n      onClear={handleClear}\n      validationState={fieldState.error ? 'error' : undefined}\n    >\n      {allAvailableTags.map((tag) => (\n        <LegacySelect.Option value={tag} key={tag}>\n          {tag}\n        </LegacySelect.Option>\n      ))}\n    </LegacySelect>\n  );\n}\n","import { isEqual, sortBy } from 'lodash';\nimport { useCallback, useMemo, useRef, useState } from 'react';\nimport { truncate } from 'lodash';\n\nimport {\n  Button,\n  FormUI,\n  Modal,\n  PlusIcon,\n  Popover,\n  RHFControlledComponents,\n  RestoreAntDDefaultClsPrefix,\n  LegacyTooltip,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { Typography } from '@databricks/design-system';\nimport { KeyValueEntity } from '../../experiment-tracking/types';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { useForm } from 'react-hook-form';\nimport { TagKeySelectDropdown } from '../components/TagSelectDropdown';\nimport { KeyValueTag } from '../components/KeyValueTag';\nimport { ErrorWrapper } from '../utils/ErrorWrapper';\n\nfunction getTagsMap(tags: KeyValueEntity[]) {\n  return new Map(tags.map((tag) => [tag.key, tag]));\n}\n\n/**\n * Provides methods to initialize and display modal used to add and remove tags from any compatible entity\n */\nexport const useEditKeyValueTagsModal = <T extends { tags?: KeyValueEntity[] }>({\n  onSuccess,\n  saveTagsHandler,\n  allAvailableTags,\n  valueRequired = false,\n}: {\n  onSuccess?: () => void;\n  saveTagsHandler: (editedEntity: T, existingTags: KeyValueEntity[], newTags: KeyValueEntity[]) => Promise<any>;\n  allAvailableTags?: string[];\n  valueRequired?: boolean;\n}) => {\n  const editedEntityRef = useRef<T>();\n  const [errorMessage, setErrorMessage] = useState<string>('');\n  const { theme } = useDesignSystemTheme();\n\n  const [initialTags, setInitialTags] = useState<Map<string, KeyValueEntity>>(new Map());\n  const [finalTags, setFinalTags] = useState<Map<string, KeyValueEntity>>(new Map());\n\n  const [showModal, setShowModal] = useState(false);\n\n  const form = useForm<KeyValueEntity>({\n    defaultValues: {\n      key: undefined,\n      value: '',\n    },\n  });\n\n  const hideModal = () => setShowModal(false);\n\n  /**\n   * Function used to invoke the modal and start editing tags of the particular model version\n   */\n  const showEditTagsModal = useCallback(\n    (editedEntity: T) => {\n      editedEntityRef.current = editedEntity;\n      setInitialTags(getTagsMap(editedEntity.tags || []));\n      setFinalTags(getTagsMap(editedEntity.tags || []));\n      form.reset();\n\n      setShowModal(true);\n    },\n    [form],\n  );\n\n  const saveTags = async () => {\n    if (!editedEntityRef.current) {\n      return;\n    }\n    setErrorMessage('');\n    setIsLoading(true);\n    saveTagsHandler(editedEntityRef.current, Array.from(initialTags.values()), Array.from(finalTags.values()))\n      .then(() => {\n        hideModal();\n        onSuccess?.();\n        setIsLoading(false);\n      })\n      .catch((e: ErrorWrapper | Error) => {\n        setIsLoading(false);\n        setErrorMessage(e instanceof ErrorWrapper ? e.getUserVisibleError()?.message : e.message);\n      });\n  };\n\n  const intl = useIntl();\n  const formValues = form.watch();\n\n  const [isLoading, setIsLoading] = useState(false);\n\n  const hasNewValues = useMemo(\n    () => !isEqual(sortBy(Array.from(initialTags.values()), 'key'), sortBy(Array.from(finalTags.values()), 'key')),\n    [initialTags, finalTags],\n  );\n  const isDirty = formValues.key || formValues.value;\n  const showPopoverMessage = hasNewValues && isDirty;\n\n  const onKeyChangeCallback = (key: string | undefined) => {\n    const tag = key ? finalTags.get(key) : undefined;\n    /**\n     * If a tag value exists for provided key, set the value to the existing tag value\n     */\n    form.setValue('value', tag?.value ?? '');\n  };\n\n  const handleTagDelete = ({ key }: KeyValueEntity) => {\n    setFinalTags((currentFinalTags) => {\n      currentFinalTags.delete(key);\n      return new Map(currentFinalTags);\n    });\n  };\n\n  const onSubmit = () => {\n    // Do not accept form if no value provided while it's required\n    if (valueRequired && !formValues.value.trim()) {\n      return;\n    }\n\n    // Add new tag to existing tags leaving only one tag per key value\n    const newEntries = new Map(finalTags);\n    newEntries.set(formValues.key, formValues);\n\n    setFinalTags(newEntries);\n    form.reset();\n  };\n\n  const EditTagsModal = (\n    <Modal\n      destroyOnClose\n      visible={showModal}\n      title={\n        <FormattedMessage\n          defaultMessage=\"Add/Edit tags\"\n          description=\"Key-value tag editor modal > Title of the update tags modal\"\n        />\n      }\n      onCancel={hideModal}\n      footer={\n        <RestoreAntDDefaultClsPrefix>\n          <Button\n            componentId=\"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_147\"\n            dangerouslyUseFocusPseudoClass\n            onClick={hideModal}\n            /**\n             * Hack: The footer will remove the margin to the save tags button\n             * if the button if wrapped on another component.\n             */\n            css={{ marginRight: !hasNewValues ? theme.spacing.sm : 0 }}\n          >\n            {intl.formatMessage({\n              defaultMessage: 'Cancel',\n              description: 'Key-value tag editor modal > Manage Tag cancel button',\n            })}\n          </Button>\n          {showPopoverMessage ? (\n            <UnsavedTagPopoverTrigger formValues={formValues} isLoading={isLoading} onSaveTask={saveTags} />\n          ) : (\n            <LegacyTooltip\n              title={\n                !hasNewValues\n                  ? intl.formatMessage({\n                      defaultMessage: 'Please add or remove one or more tags before saving',\n                      description: 'Key-value tag editor modal > Tag disabled message',\n                    })\n                  : undefined\n              }\n            >\n              <Button\n                componentId=\"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_174\"\n                dangerouslyUseFocusPseudoClass\n                disabled={!hasNewValues}\n                loading={isLoading}\n                type=\"primary\"\n                onClick={saveTags}\n              >\n                {intl.formatMessage({\n                  defaultMessage: 'Save tags',\n                  description: 'Key-value tag editor modal > Manage Tag save button',\n                })}\n              </Button>\n            </LegacyTooltip>\n          )}\n        </RestoreAntDDefaultClsPrefix>\n      }\n    >\n      <form\n        onSubmit={form.handleSubmit(onSubmit)}\n        css={{ display: 'flex', alignItems: 'flex-end', gap: theme.spacing.md }}\n      >\n        <div css={{ minWidth: 0, display: 'flex', gap: theme.spacing.md, flex: 1 }}>\n          <div css={{ flex: 1 }}>\n            <FormUI.Label htmlFor=\"key\">\n              {intl.formatMessage({\n                defaultMessage: 'Key',\n                description: 'Key-value tag editor modal > Key input label',\n              })}\n            </FormUI.Label>\n            <TagKeySelectDropdown\n              allAvailableTags={allAvailableTags || []}\n              control={form.control}\n              onKeyChangeCallback={onKeyChangeCallback}\n            />\n          </div>\n          <div css={{ flex: 1 }}>\n            <FormUI.Label htmlFor=\"value\">\n              {valueRequired\n                ? intl.formatMessage({\n                    defaultMessage: 'Value',\n                    description: 'Key-value tag editor modal > Value input label (required)',\n                  })\n                : intl.formatMessage({\n                    defaultMessage: 'Value (optional)',\n                    description: 'Key-value tag editor modal > Value input label',\n                  })}\n            </FormUI.Label>\n            <RHFControlledComponents.Input\n              name=\"value\"\n              control={form.control}\n              aria-label={\n                valueRequired\n                  ? intl.formatMessage({\n                      defaultMessage: 'Value',\n                      description: 'Key-value tag editor modal > Value input label (required)',\n                    })\n                  : intl.formatMessage({\n                      defaultMessage: 'Value (optional)',\n                      description: 'Key-value tag editor modal > Value input label',\n                    })\n              }\n              placeholder={intl.formatMessage({\n                defaultMessage: 'Type a value',\n                description: 'Key-value tag editor modal > Value input placeholder',\n              })}\n            />\n          </div>\n        </div>\n        <LegacyTooltip\n          title={intl.formatMessage({\n            defaultMessage: 'Add tag',\n            description: 'Key-value tag editor modal > Add tag button',\n          })}\n        >\n          <Button\n            componentId=\"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_248\"\n            htmlType=\"submit\"\n            aria-label={intl.formatMessage({\n              defaultMessage: 'Add tag',\n              description: 'Key-value tag editor modal > Add tag button',\n            })}\n          >\n            <PlusIcon />\n          </Button>\n        </LegacyTooltip>\n      </form>\n      {errorMessage && <FormUI.Message type=\"error\" message={errorMessage} />}\n      <div\n        css={{\n          display: 'flex',\n          rowGap: theme.spacing.xs,\n          flexWrap: 'wrap',\n          marginTop: theme.spacing.sm,\n        }}\n      >\n        {Array.from(finalTags.values()).map((tag) => (\n          <KeyValueTag isClosable tag={tag} onClose={() => handleTagDelete(tag)} key={tag.key} />\n        ))}\n      </div>\n    </Modal>\n  );\n\n  return { EditTagsModal, showEditTagsModal, isLoading };\n};\n\nfunction UnsavedTagPopoverTrigger({\n  isLoading,\n  formValues,\n  onSaveTask,\n}: {\n  isLoading: boolean;\n  formValues: any;\n  onSaveTask: () => void;\n}) {\n  const intl = useIntl();\n  const { theme } = useDesignSystemTheme();\n\n  const tagKeyDisplay = `${truncate(formValues.key, { length: 20 }) || '_'}`;\n  const tagValueDisplay = formValues.value ? `:${truncate(formValues.value, { length: 20 })}` : '';\n  const fullTagDisplay = `${tagKeyDisplay}${tagValueDisplay}`;\n\n  const shownText = intl.formatMessage(\n    {\n      defaultMessage: 'Are you sure you want to save and close without adding \"{tag}\"',\n      description: 'Key-value tag editor modal > Unsaved tag message',\n    },\n    {\n      tag: fullTagDisplay,\n    },\n  );\n  return (\n    <Popover.Root>\n      <Popover.Trigger asChild>\n        <Button\n          componentId=\"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_306\"\n          dangerouslyUseFocusPseudoClass\n          loading={isLoading}\n          type=\"primary\"\n        >\n          {intl.formatMessage({\n            defaultMessage: 'Save tags',\n            description: 'Key-value tag editor modal > Manage Tag save button',\n          })}\n        </Button>\n      </Popover.Trigger>\n      <Popover.Content align=\"end\" aria-label={shownText}>\n        <Typography.Paragraph css={{ maxWidth: 400 }}>{shownText}</Typography.Paragraph>\n        <Popover.Close asChild>\n          <Button\n            componentId=\"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_316\"\n            onClick={onSaveTask}\n          >\n            {intl.formatMessage({\n              defaultMessage: 'Yes, save and close',\n              description: 'Key-value tag editor modal > Unsaved tag message > Yes, save and close button',\n            })}\n          </Button>\n        </Popover.Close>\n        <Popover.Close asChild>\n          <Button\n            componentId=\"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_324\"\n            type=\"primary\"\n            css={{ marginLeft: theme.spacing.sm }}\n          >\n            {intl.formatMessage({\n              defaultMessage: 'Cancel',\n              description: 'Key-value tag editor modal > Unsaved tag message > cancel button',\n            })}\n          </Button>\n        </Popover.Close>\n        <Popover.Arrow />\n      </Popover.Content>\n    </Popover.Root>\n  );\n}\n","import { useEffect, useState } from 'react';\n\n/**\n * Hook that returns whether the browser tab is active or not.\n * @returns true if the tab is active, false otherwise\n */\nexport const useIsTabActive = () => {\n  const [isTabActive, setIsTabActive] = useState(document.visibilityState === 'visible');\n  useEffect(() => {\n    document.addEventListener('visibilitychange', (x) => {\n      setIsTabActive(document.visibilityState === 'visible');\n    });\n  }, []);\n  return isTabActive;\n};\n","const DEFAULT_MIN_COLUMNS = 1;\nconst DEFAULT_MAX_COLUMNS = 3;\nconst DEFAULT_MIN_COLUMN_WIDTH = 330;\nconst DEFAULT_GAP = 16;\n\n/**\n * Creates a CSS grid column setup with min/max number of columns.\n * See: https://stackoverflow.com/a/69154193\n */\nexport const getGridColumnSetup = ({\n  minColumns = DEFAULT_MIN_COLUMNS,\n  maxColumns = DEFAULT_MAX_COLUMNS,\n  minColumnWidth = DEFAULT_MIN_COLUMN_WIDTH,\n  gap = DEFAULT_GAP,\n  additionalBreakpoints = [],\n}: {\n  /**\n   * Minimum number of columns to display\n   */\n  minColumns?: number;\n  /**\n   * Maximum number of columns to display\n   */\n  maxColumns?: number;\n  /**\n   * Minimum column width\n   */\n  minColumnWidth?: number;\n  /**\n   * Gap between columns, in pixels\n   */\n  gap?: number;\n  /**\n   * Additional breakpoints to add to the grid. Defines the min breakpoint width and the minimum column width for that breakpoint.\n   * Does not use minimum and maximum use of columns.\n   */\n  additionalBreakpoints?: { breakpointWidth: number; minColumnWidthForBreakpoint?: number }[];\n}) => ({\n  display: 'grid',\n  gridTemplateColumns: `repeat(\n      auto-fit,\n      minmax(\n        min(\n          calc(\n            100%/${minColumns} - ${gap}px\n          ),\n          max(\n            ${minColumnWidth}px,\n            calc(100%/${maxColumns} - ${gap}px)\n          )\n        ),\n        1fr\n      )\n    )`,\n  gap,\n  ...additionalBreakpoints.reduce(\n    (acc, { breakpointWidth, minColumnWidthForBreakpoint }) => ({\n      ...acc,\n      [`@media (min-width: ${breakpointWidth}px)`]: {\n        gridTemplateColumns: `repeat(\n        auto-fit,\n        minmax(\n          ${minColumnWidthForBreakpoint}px,\n          1fr\n        )\n      )`,\n      },\n    }),\n    {},\n  ),\n});\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\n/**\n * Utils for working with local storage.\n */\nexport default class LocalStorageUtils {\n  /**\n   * Protocol version of MLflow's local storage. Should be incremented on any breaking change in how\n   * data persisted in local storage is used, to prevent old (invalid) cached data from being loaded\n   * and breaking the application.\n   */\n  static version = '1.1';\n\n  /**\n   * Return a LocalStorageStore corresponding to the specified component and ID, where the ID\n   * can be used to disambiguate between multiple instances of cached data for the same component\n   * (e.g. cached data for multiple experiments).\n   */\n  static getStoreForComponent(componentName: any, id: any) {\n    return new LocalStorageStore([componentName, id].join('-'), 'localStorage');\n  }\n\n  static getSessionScopedStoreForComponent(componentName: any, id: any) {\n    return new LocalStorageStore([componentName, id].join('-'), 'sessionStorage');\n  }\n}\n\n/**\n * Interface to browser local storage that allows for setting key-value pairs under the specified\n * \"scope\".\n */\nclass LocalStorageStore {\n  constructor(scope: any, type: any) {\n    this.scope = scope;\n    if (type === 'localStorage') {\n      this.storageObj = window.localStorage;\n    } else {\n      this.storageObj = window.sessionStorage;\n    }\n  }\n  static reactComponentStateKey = 'ReactComponentState';\n\n  scope: any;\n  storageObj: any;\n\n  /**\n   * Loads React component state cached in local storage into a vanilla JS object.\n   */\n  loadComponentState() {\n    const storedVal = this.getItem(LocalStorageStore.reactComponentStateKey);\n    if (storedVal) {\n      return JSON.parse(storedVal);\n    }\n    return {};\n  }\n\n  /**\n   * Save React component state in local storage.\n   * @param stateRecord: Immutable.Record instance or plain object containing component state.\n   */\n  saveComponentState(stateRecord: any) {\n    const targetValue = typeof stateRecord.toJSON === 'function' ? stateRecord.toJSON() : stateRecord;\n    this.setItem(LocalStorageStore.reactComponentStateKey, JSON.stringify(targetValue));\n  }\n\n  /**\n   * Helper method for constructing a scoped key to use for setting/getting values in\n   * local storage.\n   */\n  withScopePrefix(key: any) {\n    return ['MLflowLocalStorage', LocalStorageUtils.version, this.scope, key].join('-');\n  }\n\n  /** Save the specified key-value pair in local storage. */\n  setItem(key: any, value: any) {\n    this.storageObj.setItem(this.withScopePrefix(key), value);\n  }\n\n  /** Fetch the value corresponding to the passed-in key from local storage. */\n  getItem(key: any) {\n    return this.storageObj.getItem(this.withScopePrefix(key));\n  }\n}\n","import { FolderBranchIcon, HomeIcon, NotebookIcon, WorkflowsIcon } from '@databricks/design-system';\nimport { SourceType } from '../sdk/MlflowEnums';\n\n/**\n * Displays an icon corresponding to the source type of an experiment run.\n */\nexport const ExperimentSourceTypeIcon = ({\n  sourceType,\n  className,\n}: {\n  sourceType: SourceType | string;\n  className?: string;\n}) => {\n  if (sourceType === SourceType.NOTEBOOK) {\n    return <NotebookIcon className={className} />;\n  } else if (sourceType === SourceType.LOCAL) {\n    return <HomeIcon className={className} />;\n  } else if (sourceType === SourceType.PROJECT) {\n    return <FolderBranchIcon className={className} />;\n  } else if (sourceType === SourceType.JOB) {\n    return <WorkflowsIcon className={className} />;\n  }\n  return null;\n};\n","import { CheckCircleIcon, ClockIcon, XCircleIcon, useDesignSystemTheme } from '@databricks/design-system';\n\nconst ErrorIcon = () => {\n  const { theme } = useDesignSystemTheme();\n  return <XCircleIcon css={{ color: theme.colors.textValidationDanger }} />;\n};\n\nconst FinishedIcon = () => {\n  const { theme } = useDesignSystemTheme();\n  return <CheckCircleIcon css={{ color: theme.colors.textValidationSuccess }} />;\n};\n\nexport const RunStatusIcon = ({ status }: { status: string }) => {\n  switch (status) {\n    case 'FAILED':\n    case 'KILLED':\n      return <ErrorIcon />;\n    case 'FINISHED':\n      return <FinishedIcon />;\n    case 'SCHEDULED':\n    case 'RUNNING':\n      return <ClockIcon />; // This one is the same color as the link\n    default:\n      return null;\n  }\n};\n","// This media query applies to screens with a pixel density of 2 or higher\n\nimport { debounce } from 'lodash';\nimport { useMemo, useState } from 'react';\nimport { COLORS_PALETTE_DATALIST_ID } from '../../../../common/components/ColorsPaletteDatalist';\nimport { visuallyHidden } from '@databricks/design-system';\n\n// and higher resolution values (e.g. Retina displays). 192 dpi is double the \"default\" historical 96 dpi.\nconst HIGH_RESOLUTION_MEDIA_QUERY = '@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)';\n\nconst stripedHiddenBackgroundStyle = `repeating-linear-gradient(\n  135deg,\n  #959595 0,\n  #e7e7e7 1px,\n  #e7e7e7 2px,\n  #959595 3px,\n  #e7e7e7 4px,\n  #e7e7e7 5px,\n  #959595 6px,\n  #e7e7e7 7px,\n  #e7e7e7 8px,\n  #959595 9px,\n  #e7e7e7 10px,\n  #e7e7e7 11px,\n  #959595 12px,\n  #e7e7e7 13px,\n  #e7e7e7 14px\n)`;\n\n/**\n * Renders a colored rounded pill for a run.\n */\nexport const RunColorPill = ({\n  color,\n  hidden,\n  onChangeColor,\n  ...props\n}: {\n  color?: string;\n  hidden?: boolean;\n  onChangeColor?: (colorValue: string) => void;\n}) => {\n  const [colorValue, setColorValue] = useState<string | undefined>(undefined);\n\n  const onChangeColorDebounced = useMemo(() => {\n    // Implementations of <input type=\"color\"> vary from browser to browser, some browser\n    // fire an event on every color change so we debounce the event to avoid multiple\n    // calls to the onChangeColor handler.\n    if (onChangeColor) {\n      return debounce(onChangeColor, 300);\n    }\n    return () => {};\n  }, [onChangeColor]);\n\n  return (\n    <label\n      css={{\n        width: 12,\n        height: 12,\n        borderRadius: 6,\n        flexShrink: 0,\n        // Add a border to make the pill visible when using very light color\n        border: `1px solid ${hidden ? 'transparent' : 'rgba(0,0,0,0.1)'}`,\n        // Straighten it up on high-res screens\n        [HIGH_RESOLUTION_MEDIA_QUERY]: {\n          marginBottom: 1,\n        },\n        background: hidden ? stripedHiddenBackgroundStyle : undefined,\n        cursor: onChangeColor ? 'pointer' : 'default',\n        position: 'relative',\n        '&:hover': {\n          opacity: onChangeColor ? 0.8 : 1,\n        },\n      }}\n      style={{ backgroundColor: colorValue ?? color ?? 'transparent' }}\n      {...props}\n    >\n      <span\n        css={[\n          visuallyHidden,\n          {\n            userSelect: 'none',\n          },\n        ]}\n      >\n        {color}\n      </span>\n      {onChangeColor && (\n        <input\n          disabled={hidden}\n          type=\"color\"\n          value={colorValue ?? color}\n          onChange={({ target }) => {\n            setColorValue(target.value);\n            onChangeColorDebounced(target.value);\n          }}\n          list={COLORS_PALETTE_DATALIST_ID}\n          css={{\n            appearance: 'none',\n            width: 0,\n            height: 0,\n            border: 0,\n            padding: 0,\n            position: 'absolute',\n            bottom: 0,\n            visibility: 'hidden',\n          }}\n        />\n      )}\n    </label>\n  );\n};\n","import { Table, TableCell, TableHeader, TableRow } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\n\nexport interface ExperimentViewDatasetSchemaTableProps {\n  schema: any[];\n  filter: string;\n}\n\nexport const ExperimentViewDatasetSchemaTable = ({\n  schema,\n  filter,\n}: ExperimentViewDatasetSchemaTableProps): JSX.Element => {\n  const hasFilter = (name?: string, type?: string) => {\n    return (\n      filter === '' ||\n      name?.toLowerCase().includes(filter.toLowerCase()) ||\n      type?.toLowerCase().includes(filter.toLowerCase())\n    );\n  };\n\n  const filteredSchema = schema.filter((row: { name: string; type: string }, _: number) =>\n    hasFilter(row.name, row.type),\n  );\n\n  const getNameHeader = () => {\n    return (\n      <FormattedMessage\n        defaultMessage=\"Name\"\n        description={'Header for \"name\" column in the experiment run dataset schema'}\n      />\n    );\n  };\n\n  const getTypeHeader = () => {\n    return <FormattedMessage defaultMessage=\"Type\" description={'Header for \"type\" column in the UC table schema'} />;\n  };\n\n  return (\n    <Table scrollable css={{ width: '100%' }}>\n      <TableRow isHeader>\n        <TableHeader>{getNameHeader()}</TableHeader>\n        <TableHeader>{getTypeHeader()}</TableHeader>\n      </TableRow>\n      <div onWheel={(e) => e.stopPropagation()}>\n        {filteredSchema.length === 0 ? (\n          <TableRow>\n            <TableCell>\n              <FormattedMessage\n                defaultMessage=\"No results match this search.\"\n                description=\"No results message in datasets drawer table\"\n              />\n            </TableCell>\n          </TableRow>\n        ) : (\n          filteredSchema.map((row: { name: string; type: string }, idx: number) => (\n            <TableRow key={`table-body-row-${idx}`}>\n              <TableCell>{row.name}</TableCell>\n              <TableCell>{row.type}</TableCell>\n            </TableRow>\n          ))\n        )}\n      </div>\n    </Table>\n  );\n};\n","import {\n  Header,\n  TableIcon,\n  useDesignSystemTheme,\n  Table,\n  TableCell,\n  TableHeader,\n  TableRow,\n  TableFilterInput,\n  Spacer,\n  Typography,\n} from '@databricks/design-system';\nimport { ExperimentViewDatasetSchemaTable } from './ExperimentViewDatasetSchemaTable';\nimport { DatasetSourceTypes, RunDatasetWithTags } from '../../../../types';\nimport { useEffect, useMemo, useState } from 'react';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport interface DatasetsCellRendererProps {\n  datasetWithTags: RunDatasetWithTags;\n}\n\nexport const ExperimentViewDatasetSchema = ({ datasetWithTags }: DatasetsCellRendererProps): JSX.Element => {\n  const { theme } = useDesignSystemTheme();\n  const { dataset } = datasetWithTags;\n  const [filter, setFilter] = useState('');\n\n  if (dataset.schema === null || dataset.schema === '') {\n    return (\n      <div\n        css={{\n          display: 'flex',\n          flexDirection: 'column',\n          height: '100vh',\n        }}\n      >\n        <div\n          css={{\n            height: '100%',\n            display: 'flex',\n            flexDirection: 'column',\n            justifyContent: 'flex-start',\n            alignContent: 'center',\n          }}\n        >\n          <Header title={<div css={{ color: theme.colors.grey600 }}>No schema available</div>} />\n        </div>\n      </div>\n    );\n  }\n  try {\n    const schema = JSON.parse(dataset.schema);\n    if ('mlflow_colspec' in schema) {\n      // if the dataset schema is colspec\n      return (\n        <div\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n            overflow: 'hidden',\n            height: '100vh',\n          }}\n        >\n          <div\n            css={{\n              marginTop: theme.spacing.sm,\n              form: { width: '100%' },\n            }}\n          >\n            <TableFilterInput\n              value={filter}\n              placeholder=\"Search fields\"\n              onChange={(e) => setFilter(e.target.value)}\n              onClear={() => {\n                setFilter('');\n              }}\n              css={{ width: '100%' }}\n              containerProps={{ style: { width: 'auto' } }}\n            />\n          </div>\n          <div\n            css={{\n              marginTop: theme.spacing.sm,\n              overflow: 'hidden',\n            }}\n          >\n            <ExperimentViewDatasetSchemaTable schema={schema.mlflow_colspec} filter={filter} />\n          </div>\n        </div>\n      );\n    } else if ('mlflow_tensorspec' in schema) {\n      // if the dataset schema is tensorspec\n      return (\n        <div css={{ height: '100vh' }}>\n          <div\n            css={{\n              display: 'flex',\n              flexDirection: 'column',\n              alignItems: 'center',\n              justifyContent: 'center',\n              height: '100%',\n            }}\n          >\n            <TableIcon css={{ fontSize: '56px', color: theme.colors.grey600 }} />\n            <Header title={<div css={{ color: theme.colors.grey600 }}>Array Datasource</div>} />\n            <Typography.Text color={theme.colors.grey600} css={{ textAlign: 'center' }}>\n              <FormattedMessage\n                defaultMessage=\"The dataset is an array. To see a preview of the dataset, view the dataset in the training notebook.\"\n                description=\"Notification when the dataset is an array data source in the experiment run dataset schema\"\n              />\n            </Typography.Text>\n          </div>\n        </div>\n      );\n    } else {\n      // if the dataset schema is not colspec or tensorspec\n      return (\n        <div css={{ marginLeft: theme.spacing.lg, marginTop: theme.spacing.md, width: '100%' }}>\n          <div css={{ display: 'flex', flexDirection: 'column', justifyContent: 'flex-start' }}>\n            <Header title={<div css={{ color: theme.colors.grey600 }}>Unrecognized Schema Format</div>} />\n            <Typography.Text color={theme.colors.grey600}>\n              <FormattedMessage\n                defaultMessage=\"Raw Schema JSON: \"\n                description=\"Label for the raw schema JSON in the experiment run dataset schema\"\n              />\n              {JSON.stringify(schema)}\n            </Typography.Text>\n          </div>\n        </div>\n      );\n    }\n  } catch {\n    return (\n      <div css={{ marginLeft: theme.spacing.lg, marginTop: theme.spacing.md, width: '100%' }}>\n        <div css={{ display: 'flex', flexDirection: 'column', justifyContent: 'flex-start' }}>\n          <Header title={<div css={{ color: theme.colors.grey600 }}>No schema available</div>} />\n        </div>\n      </div>\n    );\n  }\n};\n","import { Button, CopyIcon, NewWindowIcon, Typography } from '@databricks/design-system';\nimport { DatasetSourceTypes, RunDatasetWithTags } from '../../../../types';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { getDatasetSourceUrl } from '../../../../utils/DatasetUtils';\nimport { CopyButton } from '../../../../../shared/building_blocks/CopyButton';\n\nexport interface DatasetLinkProps {\n  datasetWithTags: RunDatasetWithTags;\n  runTags: Record<string, { key: string; value: string }>;\n}\n\nexport const ExperimentViewDatasetLink = ({ datasetWithTags, runTags }: DatasetLinkProps) => {\n  const { dataset } = datasetWithTags;\n  if (dataset.sourceType === DatasetSourceTypes.HTTP || dataset.sourceType === DatasetSourceTypes.HUGGING_FACE) {\n    const url = getDatasetSourceUrl(datasetWithTags);\n    if (url) {\n      return (\n        <Button\n          type=\"primary\"\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetlink.tsx_19_1\"\n          icon={<NewWindowIcon />}\n          href={url}\n          target=\"_blank\"\n        >\n          <FormattedMessage\n            defaultMessage=\"Open dataset\"\n            description=\"Text for the HTTP/HF location link in the experiment run dataset drawer\"\n          />\n        </Button>\n      );\n    }\n  }\n  if (dataset.sourceType === DatasetSourceTypes.S3) {\n    const url = getDatasetSourceUrl(datasetWithTags);\n    if (url) {\n      return (\n        <CopyButton\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetlink.tsx_19_2\"\n          icon={<CopyIcon />}\n          copyText={url}\n        >\n          <FormattedMessage\n            defaultMessage=\"Copy S3 URI to clipboard\"\n            description=\"Text for the HTTP/HF location link in the experiment run dataset drawer\"\n          />\n        </CopyButton>\n      );\n    }\n  }\n  if (dataset.sourceType === DatasetSourceTypes.EXTERNAL) {\n    return (\n      <Button\n        componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetlink.tsx_19_3\"\n        icon={<NewWindowIcon />}\n      >\n        <FormattedMessage\n          defaultMessage=\"Go to external location\"\n          description=\"Text for the external location link in the experiment run dataset drawer\"\n        />\n      </Button>\n    );\n  }\n  return null;\n};\n","import { Typography } from '@databricks/design-system';\nimport { DatasetSourceTypes, RunDatasetWithTags } from '../../../../types';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport interface ExperimentViewDatasetSourceTypeProps {\n  datasetWithTags: RunDatasetWithTags;\n}\n\nexport const ExperimentViewDatasetSourceType = ({ datasetWithTags }: ExperimentViewDatasetSourceTypeProps) => {\n  const { dataset } = datasetWithTags;\n\n  const sourceType = dataset.sourceType;\n\n  const getSourceTypeLabel = () => {\n    if (sourceType === DatasetSourceTypes.HTTP || sourceType === DatasetSourceTypes.EXTERNAL) {\n      return (\n        <FormattedMessage\n          defaultMessage=\"HTTP\"\n          description=\"Experiment dataset drawer > source type > HTTP source type label\"\n        />\n      );\n    }\n    if (sourceType === DatasetSourceTypes.S3) {\n      return (\n        <FormattedMessage\n          defaultMessage=\"S3\"\n          description=\"Experiment dataset drawer > source type > S3 source type label\"\n        />\n      );\n    }\n    if (sourceType === DatasetSourceTypes.HUGGING_FACE) {\n      return (\n        <FormattedMessage\n          defaultMessage=\"Hugging Face\"\n          description=\"Experiment dataset drawer > source type > Hugging Face source type label\"\n        />\n      );\n    }\n    return null;\n  };\n\n  const typeLabel = getSourceTypeLabel();\n\n  if (typeLabel) {\n    return (\n      <Typography.Hint>\n        <FormattedMessage\n          defaultMessage=\"Source type: {typeLabel}\"\n          description=\"Experiment dataset drawer > source type > label\"\n          values={{ typeLabel }}\n        />\n      </Typography.Hint>\n    );\n  }\n\n  return null;\n};\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { DatasetSourceTypes, RunDatasetWithTags } from '../../../../types';\nimport { getDatasetSourceUrl } from '../../../../utils/DatasetUtils';\n\nexport interface ExperimentViewDatasetSourceProps {\n  datasetWithTags: RunDatasetWithTags;\n}\n\nexport const ExperimentViewDatasetSourceURL = ({ datasetWithTags }: ExperimentViewDatasetSourceProps) => {\n  const { dataset } = datasetWithTags;\n  const { theme } = useDesignSystemTheme();\n\n  const sourceType = dataset.sourceType;\n\n  if (\n    sourceType === DatasetSourceTypes.HTTP ||\n    sourceType === DatasetSourceTypes.EXTERNAL ||\n    sourceType === DatasetSourceTypes.HUGGING_FACE\n  ) {\n    const url = getDatasetSourceUrl(datasetWithTags);\n    if (url) {\n      return (\n        <div\n          css={{\n            whiteSpace: 'nowrap',\n            display: 'flex',\n            fontSize: theme.typography.fontSizeSm,\n            color: theme.colors.textSecondary,\n            columnGap: theme.spacing.xs,\n          }}\n          title={url}\n        >\n          URL:{' '}\n          <Typography.Link openInNewTab href={url} css={{ display: 'flex', overflow: 'hidden' }}>\n            <span css={{ overflow: 'hidden', textOverflow: 'ellipsis' }}>{url}</span>\n          </Typography.Link>\n        </div>\n      );\n    }\n  }\n  if (sourceType === DatasetSourceTypes.S3) {\n    try {\n      const { uri } = JSON.parse(dataset.source);\n      if (uri) {\n        return (\n          <Typography.Hint\n            title={uri}\n            css={{\n              whiteSpace: 'nowrap',\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n            }}\n          >\n            S3 URI: {uri}\n          </Typography.Hint>\n        );\n      }\n    } catch {\n      return null;\n    }\n  }\n  return null;\n};\n","import { Typography } from '@databricks/design-system';\nimport { RunDatasetWithTags } from '../../../../types';\nimport { FormattedMessage } from 'react-intl';\n\nexport const ExperimentViewDatasetDigest = ({ datasetWithTags }: { datasetWithTags: RunDatasetWithTags }) => {\n  const { dataset } = datasetWithTags;\n  return (\n    <Typography.Hint>\n      <FormattedMessage\n        defaultMessage=\"Digest: {digest}\"\n        description=\"Experiment dataset drawer > digest > label and value\"\n        values={{ digest: <code>{dataset.digest}</code> }}\n      />\n    </Typography.Hint>\n  );\n};\n","import React from 'react';\nimport { useState } from 'react';\nimport {\n  Button,\n  Drawer,\n  Header,\n  Spacer,\n  TableIcon,\n  Tag,\n  LegacyTooltip,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport type { RunDatasetWithTags } from '../../../../types';\nimport { MLFLOW_RUN_DATASET_CONTEXT_TAG } from '../../../../constants';\nimport { Divider } from 'antd';\nimport { ExperimentViewDatasetSchema } from './ExperimentViewDatasetSchema';\nimport { ExperimentViewDatasetLink } from './ExperimentViewDatasetLink';\nimport { Link } from '../../../../../common/utils/RoutingUtils';\nimport Routes from '../../../../routes';\nimport { FormattedMessage } from 'react-intl';\nimport { ExperimentViewDatasetWithContext } from './ExperimentViewDatasetWithContext';\nimport { RunColorPill } from '../RunColorPill';\nimport { ExperimentViewDatasetSourceType } from './ExperimentViewDatasetSourceType';\nimport { ExperimentViewDatasetSourceURL } from './ExperimentViewDatasetSourceURL';\nimport { ExperimentViewDatasetDigest } from './ExperimentViewDatasetDigest';\nimport { useSelector } from 'react-redux';\nimport { ReduxState } from '../../../../../redux-types';\nimport { useGetExperimentRunColor } from '../../hooks/useExperimentRunColor';\n\nexport type DatasetWithRunType = {\n  datasetWithTags: RunDatasetWithTags;\n  runData: {\n    experimentId?: string;\n    tags?: Record<string, { key: string; value: string }>;\n    runUuid: string;\n    runName?: string;\n    datasets: RunDatasetWithTags[];\n  };\n};\n\nexport interface DatasetsCellRendererProps {\n  isOpen: boolean;\n  setIsOpen: (open: boolean) => void;\n  selectedDatasetWithRun: DatasetWithRunType;\n  setSelectedDatasetWithRun: (datasetWithRun: DatasetWithRunType) => void;\n}\n\nconst DRAWER_WITDH = '800px';\nconst MAX_PROFILE_LENGTH = 80;\n\nexport const ExperimentViewDatasetDrawerImpl = ({\n  isOpen,\n  setIsOpen,\n  selectedDatasetWithRun,\n  setSelectedDatasetWithRun,\n}: DatasetsCellRendererProps): JSX.Element => {\n  const { theme } = useDesignSystemTheme();\n  const { datasetWithTags, runData } = selectedDatasetWithRun;\n  const contextTag = selectedDatasetWithRun\n    ? datasetWithTags?.tags?.find((tag) => tag.key === MLFLOW_RUN_DATASET_CONTEXT_TAG)\n    : undefined;\n  const fullProfile =\n    datasetWithTags.dataset.profile && datasetWithTags.dataset.profile !== 'null'\n      ? datasetWithTags.dataset.profile\n      : undefined;\n\n  const getRunColor = useGetExperimentRunColor();\n  const { experimentId = '', tags = {} } = runData;\n\n  return (\n    <Drawer.Root\n      open={isOpen}\n      onOpenChange={(open) => {\n        if (!open) {\n          setIsOpen(false);\n        }\n      }}\n    >\n      <Drawer.Content\n        title={\n          <div css={{ display: 'flex', alignItems: 'center', height: '100%' }}>\n            <Typography.Title level={4} css={{ marginRight: theme.spacing.sm, marginBottom: 0 }}>\n              <FormattedMessage\n                defaultMessage=\"Data details for \"\n                description=\"Text for data details for the experiment run in the dataset drawer\"\n              />\n            </Typography.Title>\n            <Link to={Routes.getRunPageRoute(experimentId, runData.runUuid)} css={styles.runLink}>\n              <RunColorPill color={getRunColor(runData.runUuid)} />\n              <span css={styles.runName}>{runData.runName}</span>\n            </Link>\n          </div>\n        }\n        width={DRAWER_WITDH}\n        footer={<Spacer size=\"xs\" />}\n      >\n        <div\n          css={{\n            display: 'flex',\n            borderTop: `1px solid ${theme.colors.border}`,\n            height: '100%',\n            marginLeft: -theme.spacing.sm,\n          }}\n        >\n          {/* column for dataset selection */}\n          <div\n            css={{\n              display: 'flex',\n              flexDirection: 'column',\n              width: '300px',\n              borderRight: `1px solid ${theme.colors.border}`,\n              height: '100%',\n            }}\n          >\n            <Typography.Text\n              color=\"secondary\"\n              css={{\n                marginBottom: theme.spacing.sm,\n                marginTop: theme.spacing.sm,\n                paddingLeft: theme.spacing.sm,\n              }}\n            >\n              {runData.datasets.length}{' '}\n              <FormattedMessage\n                defaultMessage=\"datasets used\"\n                description=\"Text for dataset count in the experiment run dataset drawer\"\n              />\n            </Typography.Text>\n            <div\n              css={{\n                display: 'flex',\n                flexDirection: 'column',\n                height: '100%',\n                overflow: 'auto',\n              }}\n              onWheel={(e) => e.stopPropagation()}\n            >\n              {runData.datasets.map((dataset) => (\n                <div\n                  key={`${dataset.dataset.name}-${dataset.dataset.digest}`}\n                  css={{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    justifyContent: 'center',\n                    backgroundColor:\n                      dataset.dataset.name === datasetWithTags.dataset.name &&\n                      dataset.dataset.digest === datasetWithTags.dataset.digest\n                        ? theme.colors.backgroundSecondary\n                        : 'transparent',\n                    borderTop: `1px solid ${theme.colors.border}`,\n                    paddingBottom: theme.spacing.sm,\n                    paddingTop: theme.spacing.sm,\n                    paddingLeft: theme.spacing.sm,\n                  }}\n                >\n                  <Button\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetdrawer.tsx_151\"\n                    type=\"link\"\n                    css={{\n                      textAlign: 'left',\n                      overflowX: 'auto',\n                      overflowY: 'hidden',\n                    }}\n                    onClick={() => {\n                      setSelectedDatasetWithRun({ datasetWithTags: dataset, runData: runData });\n                      setIsOpen(true);\n                    }}\n                  >\n                    <ExperimentViewDatasetWithContext datasetWithTags={dataset} displayTextAsLink={false} />\n                  </Button>\n                </div>\n              ))}\n            </div>\n          </div>\n          {/* column for dataset details */}\n          <div\n            css={{\n              overflow: 'hidden',\n              paddingLeft: theme.spacing.md,\n              paddingTop: theme.spacing.md,\n              display: 'flex',\n              flexDirection: 'column',\n              width: '100%',\n            }}\n          >\n            {/* dataset metadata */}\n            <div\n              css={{\n                display: 'flex',\n                gap: theme.spacing.sm,\n              }}\n            >\n              <div css={{ flex: '1' }}>\n                <Header\n                  title={\n                    <div css={{ display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                      <TableIcon css={{ marginRight: theme.spacing.xs }} />\n                      <LegacyTooltip title={datasetWithTags.dataset.name}>\n                        <Typography.Title ellipsis level={3} css={{ marginBottom: 0, maxWidth: 200 }}>\n                          {datasetWithTags.dataset.name}\n                        </Typography.Title>\n                      </LegacyTooltip>\n                      {contextTag && (\n                        <Tag\n                          css={{\n                            textTransform: 'capitalize',\n                            marginLeft: theme.spacing.xs,\n                            marginRight: theme.spacing.xs,\n                          }}\n                        >\n                          {contextTag.value}\n                        </Tag>\n                      )}\n                    </div>\n                  }\n                />\n                <Typography.Title\n                  level={4}\n                  color=\"secondary\"\n                  css={{ marginBottom: theme.spacing.xs, marginTop: theme.spacing.xs }}\n                  title={fullProfile}\n                >\n                  {datasetWithTags.dataset.profile && datasetWithTags.dataset.profile !== 'null' ? (\n                    datasetWithTags.dataset.profile.length > MAX_PROFILE_LENGTH ? (\n                      `${datasetWithTags.dataset.profile.substring(0, MAX_PROFILE_LENGTH)} ...`\n                    ) : (\n                      datasetWithTags.dataset.profile\n                    )\n                  ) : (\n                    <FormattedMessage\n                      defaultMessage=\"No profile available\"\n                      description=\"Text for no profile available in the experiment run dataset drawer\"\n                    />\n                  )}\n                </Typography.Title>\n              </div>\n              <ExperimentViewDatasetLink datasetWithTags={datasetWithTags} runTags={tags} />\n            </div>\n            <div css={{ flexShrink: 0, display: 'flex', flexDirection: 'column', gap: theme.spacing.xs }}>\n              <ExperimentViewDatasetDigest datasetWithTags={datasetWithTags} />\n              <ExperimentViewDatasetSourceType datasetWithTags={datasetWithTags} />\n              <ExperimentViewDatasetSourceURL datasetWithTags={datasetWithTags} />\n            </div>\n            {/* dataset schema */}\n            <Divider css={{ marginTop: theme.spacing.sm, marginBottom: theme.spacing.xs }} />\n            <ExperimentViewDatasetSchema datasetWithTags={datasetWithTags} />\n          </div>\n        </div>\n      </Drawer.Content>\n    </Drawer.Root>\n  );\n};\n\n// Memoize the component so it rerenders only when props change directly, preventing\n// rerenders caused e.g. by the overarching context provider.\nexport const ExperimentViewDatasetDrawer = React.memo(ExperimentViewDatasetDrawerImpl);\n\nconst styles = {\n  runLink: {\n    overflow: 'hidden',\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n  },\n  runName: {\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    fontSize: '13px',\n  },\n};\n","import { TableIcon, Tag, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport type { RunDatasetWithTags } from '../../../../types';\nimport React from 'react';\nimport { MLFLOW_RUN_DATASET_CONTEXT_TAG } from '../../../../constants';\n\nexport interface DatasetWithContextProps {\n  datasetWithTags: RunDatasetWithTags;\n  displayTextAsLink: boolean;\n  className?: string;\n}\n\nexport const ExperimentViewDatasetWithContext = ({\n  datasetWithTags,\n  displayTextAsLink,\n  className,\n}: DatasetWithContextProps) => {\n  const { dataset, tags } = datasetWithTags;\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        marginTop: theme.spacing.xs,\n        marginBottom: theme.spacing.xs,\n      }}\n      className={className}\n    >\n      <TableIcon css={{ marginRight: theme.spacing.xs, color: theme.colors.textSecondary }} />\n      {displayTextAsLink ? (\n        <div>\n          {dataset.name} ({dataset.digest})\n        </div>\n      ) : (\n        <Typography.Text size=\"md\" css={{ marginBottom: 0 }}>\n          {dataset.name} ({dataset.digest})\n        </Typography.Text>\n      )}\n      <Tag\n        css={{\n          textTransform: 'capitalize',\n          marginLeft: theme.spacing.xs,\n          marginRight: theme.spacing.xs,\n        }}\n      >\n        {tags && tags.find(({ key }) => key === MLFLOW_RUN_DATASET_CONTEXT_TAG)?.value}\n      </Tag>\n    </div>\n  );\n};\n","import React from 'react';\nimport Utils from '../../../../../../common/utils/Utils';\nimport { RunRowType } from '../../../utils/experimentPage.row-types';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { ExperimentSourceTypeIcon } from '../../../../ExperimentSourceTypeIcon';\n\nexport const SourceCellRenderer = React.memo(({ value: tags }: { value: RunRowType['tags'] }) => {\n  const { theme } = useDesignSystemTheme();\n  if (!tags) {\n    return <>-</>;\n  }\n  const sourceType = tags[Utils.sourceTypeTag]?.value || '';\n\n  const sourceLink = Utils.renderSource(tags || {}, undefined, undefined);\n  return sourceLink ? (\n    <div css={{ display: 'flex', gap: theme.spacing.xs, alignItems: 'center' }}>\n      <ExperimentSourceTypeIcon sourceType={sourceType} css={{ color: theme.colors.textSecondary }} />\n      <span css={{ overflow: 'hidden', textOverflow: 'ellipsis' }}>{sourceLink}</span>\n    </div>\n  ) : (\n    <>-</>\n  );\n});\n","import React, { ReactNode, useMemo } from 'react';\nimport { ExperimentPageUIState, createExperimentPageUIState } from '../models/ExperimentPageUIState';\n\nconst ExperimentPageUISetStateContext = React.createContext<\n  React.Dispatch<React.SetStateAction<ExperimentPageUIState>>\n>((state) => state);\n\n// Creates contexts for setting current UI state\nexport const ExperimentPageUIStateContextProvider = ({\n  children,\n  setUIState,\n}: {\n  children: ReactNode;\n  setUIState: React.Dispatch<React.SetStateAction<ExperimentPageUIState>>;\n}) => (\n  <ExperimentPageUISetStateContext.Provider value={setUIState}>{children}</ExperimentPageUISetStateContext.Provider>\n);\n\nexport const useUpdateExperimentViewUIState = () => React.useContext(ExperimentPageUISetStateContext);\n","import qs from 'qs';\nimport { useMemo } from 'react';\nimport { useParams, useLocation } from '../../../../common/utils/RoutingUtils';\nimport Utils from '../../../../common/utils/Utils';\n\nexport type UseExperimentIdsResult = string[];\n\n/**\n * Hook that returns requested experiment IDs basing on the URL.\n * It extracts ids basing on either route match (in case of a single experiment)\n * or query params (in case of comparing experiments.).\n *\n * @returns array of strings with experiment IDs\n */\n\nexport const useExperimentIds = (): UseExperimentIdsResult => {\n  const params = useParams<{ experimentId?: string }>();\n  const location = useLocation();\n\n  const normalizedLocationSearch = useMemo(() => decodeURIComponent(location.search), [location.search]);\n\n  /**\n   * Memoized string containing experiment IDs for comparison (\"?experiments=...\")\n   */\n  const compareExperimentIdsQueryParam = useMemo(() => {\n    const queryParams = qs.parse(normalizedLocationSearch.substring(1));\n    if (queryParams['experiments']) {\n      const experimentIdsRaw = queryParams['experiments'];\n      return experimentIdsRaw?.toString() || '';\n    }\n\n    return '';\n  }, [normalizedLocationSearch]);\n\n  return useMemo(() => {\n    // Case #1: single experiment\n    if (params?.experimentId) {\n      return [params?.experimentId];\n    }\n\n    // Case #2: multiple (compare) experiments\n    if (compareExperimentIdsQueryParam) {\n      try {\n        return JSON.parse(compareExperimentIdsQueryParam);\n      } catch {\n        // Apparently URL is malformed\n        Utils.logErrorAndNotifyUser(`Could not parse experiment query parameter ${compareExperimentIdsQueryParam}`);\n        return '';\n      }\n    }\n\n    return [];\n  }, [compareExperimentIdsQueryParam, params?.experimentId]);\n};\n","import Utils from '@mlflow/mlflow/src/common/utils/Utils';\nimport { listImagesApi } from '@mlflow/mlflow/src/experiment-tracking/actions';\nimport { EXPERIMENT_RUNS_IMAGE_AUTO_REFRESH_INTERVAL } from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { useEffect, useRef } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { ThunkDispatch } from '@mlflow/mlflow/src/redux-types';\nimport { NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE } from '@mlflow/mlflow/src/experiment-tracking/constants';\n\nexport const usePopulateImagesByRunUuid = ({\n  runUuids,\n  runUuidsIsActive,\n  autoRefreshEnabled,\n  enabled,\n}: {\n  runUuids: string[];\n  runUuidsIsActive: boolean[];\n  autoRefreshEnabled?: boolean;\n  enabled?: boolean;\n}) => {\n  // Retrieve image keys for each run. This should only re-render when the runUuids change.\n  // This populates the imagesByRunUuid with imageKeys, which will be used elsewhere to fetch metadata.\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  /**\n   * The criteria to populate images for a run is\n   * 1. The run is not hidden\n   * 2. The run includes the mlflow.loggedImage tag\n   * 3. The run's image is not already populated\n   */\n  // We need to use a serialized version of runUuids to avoid re-triggering the effect when using an array.\n  const runUuidsSerialized = runUuids.slice(0, NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE).join(',');\n  useEffect(() => {\n    // Regular single fetch event with no auto-refresh capabilities. Used if auto-refresh is disabled.\n    if (!enabled || autoRefreshEnabled) {\n      return;\n    }\n    runUuidsSerialized.split(',').forEach((runUuid) => {\n      if (runUuid) {\n        dispatch(listImagesApi(runUuid));\n      }\n    });\n  }, [runUuidsSerialized, dispatch, autoRefreshEnabled, enabled]);\n\n  const refreshTimeoutRef = useRef<number | undefined>(undefined);\n  const autoRefreshEnabledRef = useRef(autoRefreshEnabled && enabled);\n  autoRefreshEnabledRef.current = autoRefreshEnabled;\n\n  const runUuidsIsActiveSerialized = runUuidsIsActive.slice(0, NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE).join(',');\n  // A fetch effect with auto-refresh capabilities. Used only if auto-refresh is enabled.\n  useEffect(() => {\n    let hookUnmounted = false;\n\n    if (!enabled || !autoRefreshEnabled) {\n      return;\n    }\n\n    const fetchImagesFn = async (autoRefresh: boolean) => {\n      const runUuids = runUuidsSerialized.split(',');\n\n      const activeRunUuids = runUuidsIsActiveSerialized.split(',');\n      // If auto-refresh is enabled, only fetch images for runs that are currently active\n      const filteredRunUuids = autoRefresh ? runUuids.filter((_, index) => activeRunUuids[index] === 'true') : runUuids;\n\n      filteredRunUuids.forEach((runUuid) => {\n        if (runUuid) {\n          dispatch(listImagesApi(runUuid, autoRefresh));\n        }\n      });\n    };\n\n    const scheduleRefresh = async () => {\n      // Initial check to confirm that auto-refresh is still enabled and the hook is still mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n      try {\n        await fetchImagesFn(true);\n      } catch (e) {\n        // In case of error during auto-refresh, log the error but do break the auto-refresh loop\n        Utils.logErrorAndNotifyUser(e);\n      }\n      clearTimeout(refreshTimeoutRef.current);\n\n      // After loading the data, schedule the next refresh if the hook is still enabled and mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n\n      refreshTimeoutRef.current = window.setTimeout(scheduleRefresh, EXPERIMENT_RUNS_IMAGE_AUTO_REFRESH_INTERVAL);\n    };\n\n    fetchImagesFn(false).then(scheduleRefresh);\n\n    return () => {\n      fetchImagesFn(true);\n      // Mark the hook as unmounted to prevent scheduling new auto-refreshes with current data\n      hookUnmounted = true;\n      // Clear the timeout\n      clearTimeout(refreshTimeoutRef.current);\n    };\n  }, [dispatch, runUuidsSerialized, runUuidsIsActiveSerialized, autoRefreshEnabled, enabled]);\n};\n","/**\n * Defines the behavior of a custom metric in the experiment page.\n */\ninterface CustomMetricBehaviorDef {\n  /**\n   * Display name of the metric. Used in column header, chart title, sort by and column selector.\n   */\n  displayName: string;\n  /**\n   * Formatter for the metric value. Used in table and chart tooltips.\n   */\n  valueFormatter: ({ value }: { value: number | string }) => string;\n  /**\n   * Initial width of the column in the table in pixels.\n   */\n  initialColumnWidth?: number;\n  /**\n   * Format of the axis tick labels in the chart.\n   */\n  chartAxisTickFormat?: string;\n}\n\n/**\n * Custom metric behavior definitions.\n */\nexport const customMetricBehaviorDefs: Record<string, CustomMetricBehaviorDef> = {\n  // empty\n};\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { Modal } from '@databricks/design-system';\n\ntype Props = {\n  isOpen: boolean;\n  handleSubmit: (...args: any[]) => any;\n  onClose: (...args: any[]) => any;\n  title: React.ReactNode;\n  helpText: React.ReactNode;\n  confirmButtonText: React.ReactNode;\n};\n\ntype State = any;\n\nexport class ConfirmModal extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.onRequestCloseHandler = this.onRequestCloseHandler.bind(this);\n    this.handleSubmitWrapper = this.handleSubmitWrapper.bind(this);\n  }\n\n  state = {\n    isSubmitting: false,\n  };\n\n  onRequestCloseHandler() {\n    if (!this.state.isSubmitting) {\n      this.props.onClose();\n    }\n  }\n\n  handleSubmitWrapper() {\n    this.setState({ isSubmitting: true });\n    return this.props.handleSubmit().finally(() => {\n      this.props.onClose();\n      this.setState({ isSubmitting: false });\n    });\n  }\n\n  render() {\n    return (\n      <Modal\n        data-testid=\"confirm-modal\"\n        title={this.props.title}\n        visible={this.props.isOpen}\n        onOk={this.handleSubmitWrapper}\n        okText={this.props.confirmButtonText}\n        confirmLoading={this.state.isSubmitting}\n        onCancel={this.onRequestCloseHandler}\n        // @ts-expect-error TS(2322): Type '{ children: Element; \"data-testid\": string; ... Remove this comment to see the full error message\n        centered\n      >\n        <div className=\"modal-explanatory-text\">{this.props.helpText}</div>\n      </Modal>\n    );\n  }\n}\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { ConfirmModal } from './ConfirmModal';\nimport { deleteRunApi, openErrorModal } from '../../actions';\nimport { connect } from 'react-redux';\nimport Utils from '../../../common/utils/Utils';\nimport { IntlShape, injectIntl } from 'react-intl';\n\ntype Props = {\n  isOpen: boolean;\n  onClose: (...args: any[]) => any;\n  selectedRunIds: string[];\n  openErrorModal: (...args: any[]) => any;\n  deleteRunApi: (...args: any[]) => any;\n  onSuccess?: () => void;\n  intl: IntlShape;\n};\n\nexport class DeleteRunModalImpl extends Component<Props> {\n  constructor(props: Props) {\n    super(props);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  handleSubmit() {\n    const deletePromises: any = [];\n    this.props.selectedRunIds.forEach((runId) => {\n      deletePromises.push(this.props.deleteRunApi(runId));\n    });\n    return Promise.all(deletePromises)\n      .catch(() => {\n        const errorModalContent = `${this.props.intl.formatMessage({\n          defaultMessage: 'While deleting an experiment run, an error occurred.',\n          description: 'Experiment tracking > delete run modal > error message',\n        })}`;\n        this.props.openErrorModal(errorModalContent);\n      })\n      .then(() => {\n        this.props.onSuccess?.();\n      });\n  }\n\n  render() {\n    const number = this.props.selectedRunIds.length;\n    return (\n      <ConfirmModal\n        isOpen={this.props.isOpen}\n        onClose={this.props.onClose}\n        handleSubmit={this.handleSubmit}\n        title={`Delete Experiment ${Utils.pluralize('Run', number)}`}\n        helpText={\n          <div>\n            <p>\n              <b>\n                {number} experiment {Utils.pluralize('run', number)} will be deleted.\n              </b>\n            </p>\n            {/* @ts-expect-error TS(4111): Property 'MLFLOW_SHOW_GDPR_PURGING_MESSAGES' comes from a... Remove this comment to see the full error message */}\n            {process.env.MLFLOW_SHOW_GDPR_PURGING_MESSAGES === 'true' ? (\n              <p>\n                Deleted runs are restorable for 30 days, after which they are purged along with associated metrics,\n                params, tags, and artifacts.\n              </p>\n            ) : (\n              ''\n            )}\n          </div>\n        }\n        confirmButtonText=\"Delete\"\n      />\n    );\n  }\n}\n\nconst mapDispatchToProps = {\n  deleteRunApi,\n  openErrorModal,\n};\n\nexport default connect(null, mapDispatchToProps)(injectIntl(DeleteRunModalImpl));\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { Modal } from '@databricks/design-system';\n\nimport Utils from '../../../common/utils/Utils';\n\ntype Props = {\n  okText?: string;\n  cancelText?: string;\n  isOpen?: boolean;\n  onClose: (...args: any[]) => any;\n  onCancel?: (...args: any[]) => any;\n  className?: string;\n  footer?: React.ReactNode;\n  handleSubmit: (...args: any[]) => any;\n  title: React.ReactNode;\n};\n\ntype State = any;\n\n/**\n * Generic modal that has a title and an input field with a save/submit button.\n * As of now, it is used to display the 'Rename Run' and 'Rename Experiment' modals.\n */\nexport class GenericInputModal extends Component<Props, State> {\n  state = {\n    isSubmitting: false,\n  };\n\n  formRef = React.createRef();\n\n  onSubmit = async () => {\n    this.setState({ isSubmitting: true });\n    try {\n      const values = await (this as any).formRef.current.validateFields();\n\n      // call handleSubmit from parent component, pass form values\n      // handleSubmit is expected to return a promise\n      return await this.props\n        .handleSubmit(values)\n        .then(this.resetAndClearModalForm)\n        .catch(this.handleSubmitFailure)\n        .finally(this.onRequestCloseHandler);\n    } catch (e) {\n      this.setState({ isSubmitting: false });\n      return Promise.reject(e);\n    }\n  };\n\n  resetAndClearModalForm = () => {\n    this.setState({ isSubmitting: false });\n    (this as any).formRef.current.resetFields();\n  };\n\n  handleSubmitFailure = (e: any) => {\n    this.setState({ isSubmitting: false });\n    Utils.logErrorAndNotifyUser(e);\n  };\n\n  onRequestCloseHandler = () => {\n    if (!this.state.isSubmitting) {\n      this.resetAndClearModalForm();\n      this.props.onClose();\n    }\n  };\n\n  handleCancel = () => {\n    this.onRequestCloseHandler();\n    // Check for optional `onCancel` method prop.\n    if (this.props.onCancel !== undefined) {\n      this.props.onCancel();\n    }\n  };\n\n  render() {\n    const { isSubmitting } = this.state;\n    const { okText, cancelText, isOpen, footer, children } = this.props;\n\n    // add props (ref) to passed component\n    const displayForm = React.Children.map(children, (child) => {\n      // Checking isValidElement is the safe way and avoids a typescript\n      // error too.\n      if (React.isValidElement(child)) {\n        // @ts-expect-error TODO: fix this\n        return React.cloneElement(child, { innerRef: this.formRef });\n      }\n      return child;\n    });\n\n    return (\n      <Modal\n        data-testid=\"mlflow-input-modal\"\n        className={this.props.className}\n        title={this.props.title}\n        // @ts-expect-error TS(2322): Type '{ children: {}[] | null | undefined; \"data-t... Remove this comment to see the full error message\n        width={540}\n        visible={isOpen}\n        onOk={this.onSubmit}\n        okText={okText}\n        cancelText={cancelText}\n        confirmLoading={isSubmitting}\n        onCancel={this.handleCancel}\n        footer={footer}\n        centered\n      >\n        {displayForm}\n      </Modal>\n    );\n  }\n}\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\n\nimport { Form, Input } from '@databricks/design-system';\n\nexport const NEW_NAME_FIELD = 'newName';\n\ntype Props = {\n  type: string;\n  name: string;\n  visible: boolean;\n  validator?: (...args: any[]) => any;\n  innerRef: any;\n};\n\n/**\n * Component that renders a form for updating a run's or experiment's name.\n */\nclass RenameFormComponent extends Component<Props> {\n  inputToAutoFocus: any;\n\n  componentDidUpdate(prevProps: Props) {\n    this.autoFocus(prevProps);\n    this.resetFields(prevProps);\n  }\n\n  autoFocusInputRef = (inputToAutoFocus: any) => {\n    this.inputToAutoFocus = inputToAutoFocus;\n    inputToAutoFocus && inputToAutoFocus.focus();\n    inputToAutoFocus && inputToAutoFocus.select();\n  };\n\n  autoFocus = (prevProps: any) => {\n    if (prevProps.visible === false && this.props.visible === true) {\n      // focus on input field\n      this.inputToAutoFocus && this.inputToAutoFocus.focus();\n      // select text\n      this.inputToAutoFocus && this.inputToAutoFocus.select();\n    }\n  };\n\n  resetFields = (prevProps: any) => {\n    const formRef = this.props.innerRef;\n    if (prevProps.name !== this.props.name) {\n      // reset input field to reset displayed initialValue\n      formRef.current.resetFields([NEW_NAME_FIELD]);\n    }\n  };\n\n  render() {\n    return (\n      // @ts-expect-error TS(2322): Type '{ children: Element; ref: any; layout: \"vert... Remove this comment to see the full error message\n      <Form ref={this.props.innerRef} layout=\"vertical\">\n        <Form.Item\n          name={NEW_NAME_FIELD}\n          initialValue={this.props.name}\n          rules={[\n            { required: true, message: `Please input a new name for the ${this.props.type}.` },\n            { validator: this.props.validator },\n          ]}\n          label={`New ${this.props.type} name`}\n        >\n          <Input\n            placeholder={`Input a ${this.props.type} name`}\n            ref={this.autoFocusInputRef}\n            data-testid=\"rename-modal-input\"\n          />\n        </Form.Item>\n      </Form>\n    );\n  }\n}\n\nexport const RenameForm = RenameFormComponent;\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { IntlShape, injectIntl } from 'react-intl';\n\nimport { GenericInputModal } from './GenericInputModal';\nimport { RenameForm, NEW_NAME_FIELD } from './RenameForm';\n\nimport { updateRunApi } from '../../actions';\nimport { getUUID } from '../../../common/utils/ActionUtils';\n\ntype Props = {\n  isOpen?: boolean;\n  runUuid: string;\n  runName: string;\n  onClose: (...args: any[]) => any;\n  updateRunApi: (...args: any[]) => any;\n  intl: IntlShape;\n  onSuccess?: (...args: any[]) => any;\n};\n\nexport class RenameRunModalImpl extends Component<Props> {\n  handleRenameRun = (values: any) => {\n    // get value of input field\n    const newRunName = values[NEW_NAME_FIELD];\n\n    const updateRunRequestId = getUUID();\n\n    return this.props\n      .updateRunApi(this.props.runUuid, newRunName, updateRunRequestId)\n      .then(() => this.props.onSuccess?.());\n  };\n\n  render() {\n    const { isOpen, runName } = this.props;\n    return (\n      <GenericInputModal\n        title={this.props.intl.formatMessage({\n          defaultMessage: 'Rename Run',\n          description: 'Modal title to rename the experiment run name',\n        })}\n        okText={this.props.intl.formatMessage({\n          defaultMessage: 'Save',\n          description: 'Modal button text to save the changes to rename the experiment run name',\n        })}\n        isOpen={isOpen}\n        handleSubmit={this.handleRenameRun}\n        onClose={this.props.onClose}\n      >\n        <RenameForm\n          type=\"run\"\n          name={runName}\n          // @ts-expect-error TS(2769): No overload matches this call.\n          visible={isOpen}\n          validator={async (_, value) => {\n            if (typeof value === 'string' && value.length && !value.trim()) {\n              throw new Error(\n                this.props.intl.formatMessage({\n                  defaultMessage: 'Run name cannot consist only of whitespace!',\n                  description: \"An error shown when user sets the run's name to whitespace characters only\",\n                }),\n              );\n            }\n            return true;\n          }}\n        />\n      </GenericInputModal>\n    );\n  }\n}\n\nconst mapDispatchToProps = {\n  updateRunApi,\n};\n\nexport const RenameRunModalWithIntl = injectIntl(RenameRunModalImpl);\nexport const RenameRunModal = connect(undefined, mapDispatchToProps)(RenameRunModalWithIntl);\n","import { LegacySelect, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport React, { ComponentProps, PropsWithChildren } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { makeCanonicalSortKey } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\n\n/**\n * Represents a field in the compare run charts configuration modal.\n * Displays a title and content with proper margins.\n */\nexport const RunsChartsConfigureField = ({\n  title,\n  compact = false,\n  children,\n}: PropsWithChildren<{\n  title: string;\n  compact?: boolean;\n}>) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div\n      css={{ marginBottom: compact ? theme.spacing.sm : theme.spacing.md * 2 }}\n      data-testid=\"experiment-view-compare-runs-config-field\"\n    >\n      <Typography.Title level={4}>{title}</Typography.Title>\n      {children}\n    </div>\n  );\n};\n\n/**\n * A searchable select for selecting metric or param from a categorized list.\n */\nexport const RunsChartsMetricParamSelect = ({\n  value,\n  onChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  value: string;\n  onChange: ComponentProps<typeof LegacySelect>['onChange'];\n  metricKeyList?: string[];\n  paramKeyList?: string[];\n}) => {\n  const { formatMessage } = useIntl();\n\n  const isEmpty = !paramKeyList?.length && !metricKeyList?.length;\n\n  return (\n    <LegacySelect\n      css={styles.selectFull}\n      value={\n        isEmpty\n          ? formatMessage({\n              description:\n                'Message displayed when no metrics or params are available in the compare runs chart configure modal',\n              defaultMessage: 'No metrics or parameters available',\n            })\n          : value\n      }\n      disabled={isEmpty}\n      onChange={onChange}\n      dangerouslySetAntdProps={{ showSearch: true }}\n    >\n      {metricKeyList?.length ? (\n        <LegacySelect.OptGroup\n          label={formatMessage({\n            defaultMessage: 'Metrics',\n            description: \"Label for 'metrics' option group in the compare runs chart configure modal\",\n          })}\n        >\n          {metricKeyList.map((metric) => (\n            <LegacySelect.Option\n              key={makeCanonicalSortKey('METRIC', metric)}\n              value={makeCanonicalSortKey('METRIC', metric)}\n            >\n              {metric}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect.OptGroup>\n      ) : null}\n      {paramKeyList?.length ? (\n        <LegacySelect.OptGroup\n          label={formatMessage({\n            defaultMessage: 'Params',\n            description: \"Label for 'params' option group in the compare runs chart configure modal\",\n          })}\n        >\n          {paramKeyList.map((param) => (\n            <LegacySelect.Option\n              key={makeCanonicalSortKey('PARAM', param)}\n              value={makeCanonicalSortKey('PARAM', param)}\n            >\n              {param}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect.OptGroup>\n      ) : null}\n    </LegacySelect>\n  );\n};\n\nexport const RunsChartsRunNumberSelect = ({\n  onChange,\n  value,\n  options,\n}: {\n  value?: number;\n  onChange: ComponentProps<typeof LegacySelect<number>>['onChange'];\n  options: (number | { value: number; label: React.ReactNode })[];\n}) => {\n  const { formatMessage } = useIntl();\n\n  // After moving to the new run rows visibility model, we don't configure run count per chart\n  if (shouldUseNewRunRowsVisibilityModel()) {\n    return null;\n  }\n  return (\n    <RunsChartsConfigureField\n      title={formatMessage({\n        defaultMessage: 'Max. no of runs shown',\n        description: 'Label for the control allowing selection of number of runs displayed in a compare runs chart',\n      })}\n    >\n      <LegacySelect<number> css={styles.selectFull} value={value} onChange={onChange}>\n        {options.map((countOption) => {\n          const optionValue = typeof countOption === 'number' ? countOption : countOption.value;\n          const label = typeof countOption === 'number' ? countOption : countOption.label;\n          return (\n            <LegacySelect.Option key={optionValue} value={optionValue}>\n              {label}\n            </LegacySelect.Option>\n          );\n        })}\n      </LegacySelect>\n    </RunsChartsConfigureField>\n  );\n};\n\nexport const runsChartsRunCountDefaultOptions: { value: number; label: React.ReactNode }[] = [\n  // We're not using any procedural generation so react-intl extractor can parse it\n  {\n    value: 5,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"5\"\n        description=\"Label for 5 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 10,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"10\"\n        description=\"Label for 10 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 20,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"20\"\n        description=\"Label for 20 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n];\n\nconst styles = { selectFull: { width: '100%' } };\n","import { LegacySelect } from '@databricks/design-system';\nimport { useCallback, useEffect } from 'react';\nimport type { RunsChartsCardConfig, RunsChartsBarCardConfig } from '../../runs-charts.types';\nimport {\n  RunsChartsConfigureField,\n  runsChartsRunCountDefaultOptions,\n  RunsChartsRunNumberSelect,\n} from './RunsChartsConfigure.common';\n\n/**\n * Form containing configuration controls for runs compare charts.\n */\nexport const RunsChartsConfigureBarChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n}: {\n  metricKeyList: string[];\n  state: Partial<RunsChartsBarCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsBarCardConfig) => void;\n}) => {\n  /**\n   * Callback for updating metric key\n   */\n  const updateMetric = useCallback(\n    (metricKey: string) => {\n      onStateChange((current) => ({ ...(current as RunsChartsBarCardConfig), metricKey }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsBarCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow metric key is not predetermined, automatically\n   * select the first one so it's not empty\n   */\n  useEffect(() => {\n    if (!state.metricKey && metricKeyList?.[0]) {\n      updateMetric(metricKeyList[0]);\n    }\n  }, [state.metricKey, updateMetric, metricKeyList]);\n\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <>\n      <RunsChartsConfigureField title=\"Metric\">\n        <LegacySelect\n          css={styles.selectFull}\n          value={emptyMetricsList ? 'No metrics available' : state.metricKey}\n          onChange={updateMetric}\n          disabled={emptyMetricsList}\n          dangerouslySetAntdProps={{ showSearch: true }}\n        >\n          {metricKeyList.map((metric) => (\n            <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n              {metric}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect>\n      </RunsChartsConfigureField>\n      <RunsChartsRunNumberSelect\n        value={state.runsCountToCompare}\n        onChange={updateVisibleRunCount}\n        options={runsChartsRunCountDefaultOptions}\n      />\n    </>\n  );\n};\n\nconst styles = { selectFull: { width: '100%' } };\n","import { LegacySelect } from '@databricks/design-system';\nimport { useCallback } from 'react';\nimport type { RunsChartsCardConfig, RunsChartsParallelCardConfig } from '../../runs-charts.types';\nimport { RunsChartsConfigureField } from './RunsChartsConfigure.common';\n\n/**\n * Form containing configuration controls for runs compare charts.\n */\nexport const RunsChartsConfigureParallelChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: Partial<RunsChartsParallelCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsParallelCardConfig) => void;\n}) => {\n  /**\n   * Callback for updating selected metrics and params\n   */\n\n  const updateSelectedParams = useCallback(\n    (selectedParams: string[]) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsParallelCardConfig),\n        selectedParams,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateSelectedMetrics = useCallback(\n    (selectedMetrics: string[]) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsParallelCardConfig),\n        selectedMetrics,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const emptyMetricsList = metricKeyList.length === 0;\n  const emptyParamsList = paramKeyList.length === 0;\n\n  return (\n    <>\n      <RunsChartsConfigureField title=\"Params\">\n        <LegacySelect\n          mode={emptyParamsList ? undefined : 'multiple'}\n          onChange={updateSelectedParams}\n          style={{\n            width: 275,\n          }}\n          value={emptyParamsList ? ('No parameters available' as any) : state.selectedParams}\n          disabled={emptyParamsList}\n        >\n          {paramKeyList.map((param) => (\n            <LegacySelect.Option value={param} key={param}>\n              {param}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect>\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField title=\"Metrics\">\n        <LegacySelect\n          mode={emptyMetricsList ? undefined : 'multiple'}\n          onChange={updateSelectedMetrics}\n          style={{\n            width: 275,\n          }}\n          value={emptyMetricsList ? ('No metrics available' as any) : state.selectedMetrics}\n          disabled={emptyMetricsList}\n        >\n          {metricKeyList.map((metric) => (\n            <LegacySelect.Option value={metric} key={metric}>\n              {metric}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect>\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import {\n  Button,\n  CloseIcon,\n  Input,\n  LegacySelect,\n  PlusIcon,\n  Radio,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { RunsChartsCardConfig, RunsChartsLineCardConfig, RunsChartsLineChartYAxisType } from '../runs-charts.types';\nimport { RunsChartsConfigureField } from './config/RunsChartsConfigure.common';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { shouldEnableChartExpressions } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { useCallback } from 'react';\n\nconst renderMetricSelectorV1 = ({\n  metricKeyList,\n  metricKey,\n  updateMetric,\n}: {\n  metricKeyList: string[];\n  metricKey?: string;\n  updateMetric: (metricKey: string) => void;\n}) => {\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <LegacySelect\n      css={{ width: '100%' }}\n      value={emptyMetricsList ? 'No metrics available' : metricKey}\n      onChange={updateMetric}\n      disabled={emptyMetricsList}\n      dangerouslySetAntdProps={{ showSearch: true }}\n    >\n      {metricKeyList.map((metric) => (\n        <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n          {metric}\n        </LegacySelect.Option>\n      ))}\n    </LegacySelect>\n  );\n};\n\nconst renderMetricSelectorV2 = ({\n  metricKeyList,\n  selectedMetricKeys,\n  updateSelectedMetrics,\n}: {\n  metricKeyList: string[];\n  selectedMetricKeys?: string[];\n  updateSelectedMetrics: (metricKeys: string[]) => void;\n}) => {\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <LegacySelect\n      mode=\"multiple\"\n      placeholder={\n        emptyMetricsList ? (\n          <FormattedMessage\n            defaultMessage=\"No metrics available\"\n            description=\"Text shown in a disabled multi-selector when there are no selectable metrics.\"\n          />\n        ) : (\n          <FormattedMessage\n            defaultMessage=\"Select metrics\"\n            description=\"Placeholder text for a metric multi-selector when configuring a line chart\"\n          />\n        )\n      }\n      css={{ width: '100%' }}\n      value={emptyMetricsList ? [] : selectedMetricKeys}\n      onChange={updateSelectedMetrics}\n      disabled={emptyMetricsList}\n      dangerouslySetAntdProps={{ showSearch: true }}\n    >\n      {metricKeyList.map((metric) => (\n        <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n          {metric}\n        </LegacySelect.Option>\n      ))}\n    </LegacySelect>\n  );\n};\n\nexport const RunsChartsYAxisMetricAndExpressionSelector = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  updateSelectedMetrics,\n}: {\n  state: Partial<RunsChartsLineCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsLineCardConfig) => void;\n  metricKeyList: string[];\n  updateSelectedMetrics: (metricKeys: string[]) => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const usingChartExpressions = shouldEnableChartExpressions();\n\n  const updateYAxisExpression = (expression: string, index: number) => {\n    onStateChange((current) => {\n      const config = current as RunsChartsLineCardConfig;\n      const yAxisExpressions = config.yAxisExpressions || [];\n      yAxisExpressions[index] = expression;\n      return {\n        ...config,\n        yAxisExpressions,\n      };\n    });\n  };\n\n  const addNewYAxisExpression = () => {\n    onStateChange((current) => {\n      const config = current as RunsChartsLineCardConfig;\n      const yAxisExpressions = config.yAxisExpressions || [];\n      return {\n        ...config,\n        yAxisExpressions: [...yAxisExpressions, ''],\n      };\n    });\n  };\n\n  const removeYAxisExpression = (index: number) => {\n    onStateChange((current) => {\n      const config = current as RunsChartsLineCardConfig;\n      const yAxisExpressions = config.yAxisExpressions || [];\n      yAxisExpressions.splice(index, 1);\n      return {\n        ...config,\n        yAxisExpressions,\n      };\n    });\n  };\n\n  const updateYAxisKey = useCallback(\n    (yAxisKey: RunsChartsLineCardConfig['yAxisKey']) => {\n      onStateChange((current) => {\n        const config = current as RunsChartsLineCardConfig;\n        return {\n          ...config,\n          yAxisKey,\n          range: {\n            ...config.range,\n            yMin: undefined,\n            yMax: undefined,\n          },\n        };\n      });\n    },\n    [onStateChange],\n  );\n\n  return (\n    <>\n      {usingChartExpressions && (\n        <RunsChartsConfigureField title=\"Metric type\" compact>\n          <Radio.Group\n            name=\"runs-charts-field-group-metric-type-y-axis\"\n            value={state.yAxisKey || RunsChartsLineChartYAxisType.METRIC}\n            onChange={({ target: { value } }) => updateYAxisKey(value)}\n          >\n            <Radio value={RunsChartsLineChartYAxisType.METRIC} key={RunsChartsLineChartYAxisType.METRIC}>\n              <FormattedMessage\n                defaultMessage=\"Logged metrics\"\n                description=\"Experiment tracking > runs charts > line chart configuration > logged metrics label\"\n              />\n            </Radio>\n            <Radio value={RunsChartsLineChartYAxisType.EXPRESSION} key={RunsChartsLineChartYAxisType.EXPRESSION}>\n              <FormattedMessage\n                defaultMessage=\"Custom expression\"\n                description=\"Experiment tracking > runs charts > line chart configuration > custom expression label\"\n              />\n            </Radio>\n          </Radio.Group>\n        </RunsChartsConfigureField>\n      )}\n      {usingChartExpressions && state.yAxisKey === RunsChartsLineChartYAxisType.EXPRESSION ? (\n        <RunsChartsConfigureField title=\"Expression\" compact>\n          <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-start', gap: theme.spacing.sm }}>\n            {state.yAxisExpressions?.map((expression, index) => {\n              return (\n                <span css={{ display: 'flex', width: '100%', gap: theme.spacing.sm }}>\n                  <Input\n                    style={{ fontFamily: 'monospace' }}\n                    value={expression}\n                    onChange={(e) => updateYAxisExpression(e.target.value, index)}\n                  />\n                  <Button\n                    componentId=\"mlflow.charts.line_chart_configure.expressions_remove\"\n                    icon={<CloseIcon />}\n                    onClick={() => removeYAxisExpression(index)}\n                  />\n                </span>\n              );\n            })}\n            <Button\n              componentId=\"mlflow.charts.line_chart_configure.expressions_add_new\"\n              icon={<PlusIcon />}\n              onClick={addNewYAxisExpression}\n            >\n              <FormattedMessage\n                defaultMessage=\"Add new\"\n                description=\"Experiment tracking > runs charts > line chart configuration > add new expression button\"\n              />\n            </Button>\n          </div>\n        </RunsChartsConfigureField>\n      ) : (\n        <RunsChartsConfigureField title=\"Metric\" compact>\n          {renderMetricSelectorV2({\n            metricKeyList,\n            selectedMetricKeys: state.selectedMetricKeys,\n            updateSelectedMetrics,\n          })}\n        </RunsChartsConfigureField>\n      )}\n    </>\n  );\n};\n","import {\n  Radio,\n  LegacySelect,\n  Switch,\n  LegacyTooltip,\n  QuestionMarkIcon,\n  Form,\n  useDesignSystemTheme,\n  ThemeType,\n  SegmentedControlGroup,\n  SegmentedControlButton,\n  InfoIcon,\n  Input,\n  FormUI,\n  Typography,\n  SimpleSelect,\n  SimpleSelectOption,\n  SimpleSelectOptionGroup,\n  Tooltip,\n  PlusIcon,\n  Button,\n  Spacer,\n  CloseIcon,\n} from '@databricks/design-system';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { useCallback, useEffect, useState } from 'react';\nimport {\n  RunsChartsLineChartYAxisType,\n  type ChartRange,\n  type RunsChartsCardConfig,\n  type RunsChartsLineCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsConfigureField, RunsChartsRunNumberSelect } from './RunsChartsConfigure.common';\nimport {\n  shouldEnableChartExpressions,\n  shouldEnableDeepLearningUIPhase3,\n  shouldEnableManualRangeControls,\n} from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { RunsChartsLineChartXAxisType } from '@mlflow/mlflow/src/experiment-tracking/components/runs-charts/components/RunsCharts.common';\nimport { LineSmoothSlider } from '@mlflow/mlflow/src/experiment-tracking/components/LineSmoothSlider';\nimport { isUndefined } from 'lodash';\nimport { RunsChartsYAxisMetricAndExpressionSelector } from '../RunsChartsYAxisMetricAndExpressionSelector';\n\nconst renderXAxisMetricSelector = ({\n  theme,\n  metricKeyList,\n  selectedXAxisMetricKey,\n  updateSelectedXAxisMetricKey,\n}: {\n  theme: ThemeType;\n  metricKeyList: string[];\n  selectedXAxisMetricKey?: string;\n  updateSelectedXAxisMetricKey: (metricKey: string) => void;\n}) => {\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <Radio value={RunsChartsLineChartXAxisType.METRIC}>\n      <FormattedMessage\n        defaultMessage=\"Metric\"\n        description=\"Label for a radio button that configures the x-axis on a line chart. This option makes the X-axis a custom metric that the user selects.\"\n      />\n      <LegacySelect\n        css={{\n          marginTop: theme.spacing.xs,\n          width: '100%',\n        }}\n        value={selectedXAxisMetricKey || undefined}\n        placeholder={\n          emptyMetricsList ? (\n            <FormattedMessage\n              defaultMessage=\"No metrics available\"\n              description=\"Text shown in a disabled metric selector when there are no selectable metrics.\"\n            />\n          ) : (\n            <FormattedMessage\n              defaultMessage=\"Select metric\"\n              description=\"Placeholder text for a metric selector when configuring a line chart\"\n            />\n          )\n        }\n        onClick={(e: React.MouseEvent<HTMLElement>) => {\n          // this is to prevent the radio button\n          // from automatically closing the selector\n          e.preventDefault();\n          e.stopPropagation();\n        }}\n        onChange={updateSelectedXAxisMetricKey}\n        disabled={emptyMetricsList}\n        dangerouslySetAntdProps={{ showSearch: true }}\n      >\n        {metricKeyList.map((metric) => (\n          <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n            {metric}\n          </LegacySelect.Option>\n        ))}\n      </LegacySelect>\n    </Radio>\n  );\n};\n\nconst safeLog = (x: number | undefined) => {\n  if (isUndefined(x)) {\n    return x;\n  }\n  if (x <= 0) {\n    return undefined;\n  }\n  return Math.log10(x);\n};\n\nconst safePow = (x: number | undefined) => {\n  if (isUndefined(x)) {\n    return x;\n  }\n  return Math.pow(10, x);\n};\n\n/**\n * Form containing configuration controls for runs compare charts.\n */\nexport const RunsChartsConfigureLineChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n}: {\n  metricKeyList: string[];\n  state: Partial<RunsChartsLineCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsLineCardConfig) => void;\n}) => {\n  const usingChartExpressions = shouldEnableChartExpressions();\n  const shouldEnableMetricsOnXAxis = shouldEnableDeepLearningUIPhase3();\n  const usingManualRangeControls = shouldEnableManualRangeControls();\n  const { theme } = useDesignSystemTheme();\n  const intl = useIntl();\n  const runSelectOptions = [5, 10, 20, 50, 100];\n\n  const [localAxisRange, setLocalAxisRange] = useState<ChartRange>({\n    xMin: state.xAxisScaleType === 'log' ? safePow(state.range?.xMin) : state.range?.xMin,\n    xMax: state.xAxisScaleType === 'log' ? safePow(state.range?.xMax) : state.range?.xMax,\n    yMin: state.scaleType === 'log' ? safePow(state.range?.yMin) : state.range?.yMin,\n    yMax: state.scaleType === 'log' ? safePow(state.range?.yMax) : state.range?.yMax,\n  });\n\n  /**\n   * Callback for updating metric key\n   */\n  const updateMetric = useCallback(\n    (metricKey: string) => {\n      onStateChange((current) => ({ ...(current as RunsChartsLineCardConfig), metricKey }));\n    },\n    [onStateChange],\n  );\n\n  const updateSelectedMetrics = useCallback(\n    (metricKeys: string[]) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        metricKey: metricKeys[0],\n        selectedMetricKeys: metricKeys,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateXAxisKey = useCallback(\n    (xAxisKey: RunsChartsLineCardConfig['xAxisKey']) => {\n      onStateChange((current) => {\n        const config = current as RunsChartsLineCardConfig;\n        return {\n          ...config,\n          xAxisKey,\n          selectedXAxisMetricKey: '',\n          range: {\n            ...config.range,\n            xMin: undefined,\n            xMax: undefined,\n          },\n        };\n      });\n    },\n    [onStateChange],\n  );\n\n  const isInvalidLogValue = (value: number | undefined) => !isUndefined(value) && value <= 0;\n\n  const updateXAxisScaleType = useCallback(\n    (isLogType: boolean) => {\n      if (usingManualRangeControls) {\n        onStateChange((current) => {\n          const config = current as RunsChartsLineCardConfig;\n\n          let newXMin = isLogType ? safeLog(localAxisRange.xMin) : localAxisRange.xMin;\n          let newXMax = isLogType ? safeLog(localAxisRange.xMax) : localAxisRange.xMax;\n          if (isLogType && isInvalidLogValue(localAxisRange.xMin) && localAxisRange.xMax && localAxisRange.xMax > 1) {\n            // when switching to log type, if only xMin is invalid, set xMin to 1.\n            setLocalAxisRange((prev) => ({\n              ...prev,\n              xMin: 1,\n            }));\n            newXMin = 0;\n          } else if (isLogType && (isInvalidLogValue(localAxisRange.xMin) || isInvalidLogValue(localAxisRange.xMax))) {\n            setLocalAxisRange((prev) => ({\n              ...prev,\n              xMin: undefined,\n              xMax: undefined,\n            }));\n            newXMin = undefined;\n            newXMax = undefined;\n          }\n          return {\n            ...config,\n            xAxisScaleType: isLogType ? 'log' : 'linear',\n            range: {\n              ...config.range,\n              xMin: newXMin,\n              xMax: newXMax,\n            },\n          };\n        });\n      } else {\n        onStateChange((current) => ({\n          ...(current as RunsChartsLineCardConfig),\n          xAxisScaleType: isLogType ? 'log' : 'linear',\n        }));\n      }\n    },\n    [onStateChange, localAxisRange.xMin, localAxisRange.xMax, usingManualRangeControls],\n  );\n\n  const updateSelectedXAxisMetricKey = useCallback(\n    (selectedXAxisMetricKey: string) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        selectedXAxisMetricKey,\n        xAxisKey: RunsChartsLineChartXAxisType.METRIC,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateYAxisType = useCallback(\n    (isLogType: boolean) => {\n      if (usingManualRangeControls) {\n        onStateChange((current) => {\n          const config = current as RunsChartsLineCardConfig;\n\n          let newYMin = isLogType ? safeLog(localAxisRange.yMin) : localAxisRange.yMin;\n          let newYMax = isLogType ? safeLog(localAxisRange.yMax) : localAxisRange.yMax;\n          if (isLogType && isInvalidLogValue(localAxisRange.yMin) && localAxisRange.yMax && localAxisRange.yMax > 1) {\n            // when switching to log type, if only yMin is invalid, set yMin to 1.\n            setLocalAxisRange((prev) => ({\n              ...prev,\n              yMin: 1,\n            }));\n            newYMin = 0; // This is the logged value of 1.\n          } else if (isLogType && (isInvalidLogValue(localAxisRange.yMin) || isInvalidLogValue(localAxisRange.yMax))) {\n            setLocalAxisRange((prev) => ({\n              ...prev,\n              yMin: undefined,\n              yMax: undefined,\n            }));\n            newYMin = undefined;\n            newYMax = undefined;\n          }\n          return {\n            ...config,\n            scaleType: isLogType ? 'log' : 'linear',\n            range: {\n              ...config.range,\n              yMin: newYMin,\n              yMax: newYMax,\n            },\n          };\n        });\n      } else {\n        onStateChange((current) => ({\n          ...(current as RunsChartsLineCardConfig),\n          scaleType: isLogType ? 'log' : 'linear',\n        }));\n      }\n    },\n    [onStateChange, localAxisRange.yMin, localAxisRange.yMax, usingManualRangeControls],\n  );\n\n  const updateIgnoreOutliers = useCallback(\n    (ignoreOutliers: boolean) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        ignoreOutliers,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateSmoothing = useCallback(\n    (lineSmoothness: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        lineSmoothness: lineSmoothness,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow metric key is not predetermined, automatically\n   * select the first one so it's not empty\n   */\n  useEffect(() => {\n    if (!state.metricKey && metricKeyList?.[0]) {\n      updateMetric(metricKeyList[0]);\n    }\n  }, [state.metricKey, updateMetric, metricKeyList]);\n\n  // for backwards compatibility, if selectedMetricKeys\n  // is not present, set it using metricKey.\n  useEffect(() => {\n    if (isUndefined(state.selectedMetricKeys) && !isUndefined(state.metricKey) && state.metricKey !== '') {\n      updateSelectedMetrics([state.metricKey]);\n    }\n  }, [state.selectedMetricKeys, state.metricKey, updateSelectedMetrics]);\n\n  const updateXAxisWhenConfirmed = (xMin: number | undefined, xMax: number | undefined) => {\n    if (inTransitionState(xMin, xMax)) {\n      return;\n    }\n    onStateChange((current) => {\n      const config = current as RunsChartsLineCardConfig;\n      return {\n        ...config,\n        range: {\n          ...config.range,\n          xMin: config.xAxisScaleType === 'log' ? safeLog(xMin) : xMin,\n          xMax: config.xAxisScaleType === 'log' ? safeLog(xMax) : xMax,\n        },\n      };\n    });\n  };\n\n  const updateYAxisWhenConfirmed = (yMin: number | undefined, yMax: number | undefined) => {\n    if (inTransitionState(yMin, yMax)) {\n      return;\n    }\n    onStateChange((current) => {\n      const config = current as RunsChartsLineCardConfig;\n      return {\n        ...config,\n        range: {\n          ...config.range,\n          yMin: config.scaleType === 'log' ? safeLog(yMin) : yMin,\n          yMax: config.scaleType === 'log' ? safeLog(yMax) : yMax,\n        },\n      };\n    });\n  };\n\n  const updateXAxisScaleMin = (xMin: string) => {\n    const newXMin = xMin ? Number(xMin) : undefined;\n    setLocalAxisRange((prev) => ({ ...prev, xMin: newXMin }));\n    updateXAxisWhenConfirmed(newXMin, localAxisRange.xMax);\n  };\n  const updateXAxisScaleMax = (xMax: string) => {\n    const newXMax = xMax ? Number(xMax) : undefined;\n    setLocalAxisRange((prev) => ({ ...prev, xMax: newXMax }));\n    updateXAxisWhenConfirmed(localAxisRange.xMin, newXMax);\n  };\n  const updateYAxisScaleMin = (yMin: string) => {\n    const newYMin = yMin ? Number(yMin) : undefined;\n    setLocalAxisRange((prev) => ({ ...prev, yMin: newYMin }));\n    updateYAxisWhenConfirmed(newYMin, localAxisRange.yMax);\n  };\n  const updateYAxisScaleMax = (yMax: string) => {\n    const newYMax = yMax ? Number(yMax) : undefined;\n    setLocalAxisRange((prev) => ({ ...prev, yMax: newYMax }));\n    updateYAxisWhenConfirmed(localAxisRange.yMin, newYMax);\n  };\n\n  const inTransitionState = (a: number | undefined, b: number | undefined) => {\n    if (isUndefined(a) && isUndefined(b)) {\n      return false;\n    } else if (!isUndefined(a) && !isUndefined(b)) {\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  const invalidMessage = (scaleType: 'log' | 'linear' | undefined, value: number | undefined) => {\n    if (scaleType === 'log' && isInvalidLogValue(value)) {\n      return (\n        <FormUI.Message\n          message={\n            <FormattedMessage\n              defaultMessage=\"Invalid log value\"\n              description=\"Experiment tracking > runs charts > line chart configuration > invalid log value message\"\n            />\n          }\n          type=\"warning\"\n        />\n      );\n    }\n    return null;\n  };\n\n  const METRIC_AXIS_PREFIX = 'metric-';\n  return (\n    <>\n      <Typography.Title level={4} color=\"secondary\">\n        X-axis\n      </Typography.Title>\n      <RunsChartsConfigureField title=\"Type\" compact>\n        {usingChartExpressions ? (\n          <SimpleSelect\n            id=\"x-axis-type\"\n            width=\"100%\"\n            value={state.xAxisKey}\n            contentProps={{ matchTriggerWidth: true, textOverflowMode: 'ellipsis' }}\n            onChange={({ target: { value } }) => {\n              if (value.startsWith(METRIC_AXIS_PREFIX)) {\n                updateSelectedXAxisMetricKey(value.slice(METRIC_AXIS_PREFIX.length));\n              } else if (value === RunsChartsLineChartXAxisType.STEP) {\n                updateXAxisKey(RunsChartsLineChartXAxisType.STEP);\n              } else if (value === RunsChartsLineChartXAxisType.TIME) {\n                updateXAxisKey(RunsChartsLineChartXAxisType.TIME);\n              } else if (value === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n                updateXAxisKey(RunsChartsLineChartXAxisType.TIME_RELATIVE);\n              }\n            }}\n          >\n            <SimpleSelectOption value={RunsChartsLineChartXAxisType.STEP}>\n              <FormattedMessage\n                defaultMessage=\"Step\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the step number that the metrics were logged.\"\n              />\n            </SimpleSelectOption>\n            <SimpleSelectOption value={RunsChartsLineChartXAxisType.TIME}>\n              <FormattedMessage\n                defaultMessage=\"Time (wall)\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the absolute time that the metrics were logged.\"\n              />\n              <Tooltip\n                content={\n                  <FormattedMessage\n                    defaultMessage=\"Absolute date and time\"\n                    description=\"A tooltip line chart configuration for the step function of wall time\"\n                  />\n                }\n                side=\"right\"\n              >\n                <span>\n                  {' '}\n                  <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n                </span>\n              </Tooltip>\n            </SimpleSelectOption>\n            <SimpleSelectOption value={RunsChartsLineChartXAxisType.TIME_RELATIVE}>\n              <FormattedMessage\n                defaultMessage=\"Time (relative)\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for relative time since the first metric was logged.\"\n              />\n              <Tooltip\n                content={\n                  <FormattedMessage\n                    defaultMessage=\"Amount of time that has passed since the first metric value was logged\"\n                    description=\"A tooltip line chart configuration for the step function of relative time\"\n                  />\n                }\n                side=\"right\"\n              >\n                <span>\n                  {' '}\n                  <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n                </span>\n              </Tooltip>\n            </SimpleSelectOption>\n            {shouldEnableMetricsOnXAxis && metricKeyList.length > 0 && (\n              <SimpleSelectOptionGroup label=\"Metrics\">\n                {metricKeyList.map((metric) => (\n                  <SimpleSelectOption\n                    key={metric}\n                    value={`${METRIC_AXIS_PREFIX}${metric}`}\n                    data-testid={`${METRIC_AXIS_PREFIX}${metric}`}\n                  >\n                    {metric}\n                  </SimpleSelectOption>\n                ))}\n              </SimpleSelectOptionGroup>\n            )}\n          </SimpleSelect>\n        ) : (\n          <Radio.Group\n            name=\"runs-charts-field-group-x-axis\"\n            value={state.xAxisKey}\n            onChange={({ target: { value } }) => updateXAxisKey(value)}\n          >\n            <Radio value={RunsChartsLineChartXAxisType.STEP}>\n              <FormattedMessage\n                defaultMessage=\"Step\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the step number that the metrics were logged.\"\n              />\n            </Radio>\n            <Radio value={RunsChartsLineChartXAxisType.TIME}>\n              <FormattedMessage\n                defaultMessage=\"Time (wall)\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the absolute time that the metrics were logged.\"\n              />\n              <LegacyTooltip\n                title={\n                  <FormattedMessage\n                    defaultMessage=\"Absolute date and time\"\n                    description=\"A tooltip line chart configuration for the step function of wall time\"\n                  />\n                }\n                placement=\"right\"\n              >\n                {' '}\n                <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n              </LegacyTooltip>\n            </Radio>\n            <Radio value={RunsChartsLineChartXAxisType.TIME_RELATIVE}>\n              <FormattedMessage\n                defaultMessage=\"Time (relative)\"\n                description=\"Label for a radio button that configures the x-axis on a line chart. This option is for relative time since the first metric was logged.\"\n              />\n              <LegacyTooltip\n                title={\n                  <FormattedMessage\n                    defaultMessage=\"Amount of time that has passed since the first metric value was logged\"\n                    description=\"A tooltip line chart configuration for the step function of relative time\"\n                  />\n                }\n                placement=\"right\"\n              >\n                {' '}\n                <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n              </LegacyTooltip>\n            </Radio>\n            {shouldEnableMetricsOnXAxis &&\n              renderXAxisMetricSelector({\n                theme,\n                metricKeyList,\n                selectedXAxisMetricKey: state.selectedXAxisMetricKey,\n                updateSelectedXAxisMetricKey,\n              })}\n          </Radio.Group>\n        )}\n      </RunsChartsConfigureField>\n      {state.xAxisKey === RunsChartsLineChartXAxisType.STEP && (\n        <>\n          {usingManualRangeControls && (\n            <RunsChartsConfigureField title=\"X-axis scale\" compact>\n              <div css={{ display: 'flex', gap: theme.spacing.sm }}>\n                <div>\n                  <Input\n                    componentId=\"mlflow.charts.line_chart_configure.x_axis_min\"\n                    aria-label=\"x-axis-min\"\n                    name=\"min\"\n                    type=\"number\"\n                    value={localAxisRange.xMin}\n                    onChange={(e) => updateXAxisScaleMin(e.target.value)}\n                    max={localAxisRange.xMax}\n                    placeholder=\"Min\"\n                  />\n                  {invalidMessage(state.xAxisScaleType, localAxisRange.xMin)}\n                </div>\n                <div>\n                  <Input\n                    componentId=\"mlflow.charts.line_chart_configure.x_axis_max\"\n                    aria-label=\"x-axis-max\"\n                    name=\"max\"\n                    type=\"number\"\n                    value={localAxisRange.xMax}\n                    onChange={(e) => updateXAxisScaleMax(e.target.value)}\n                    min={localAxisRange.xMin}\n                    placeholder=\"Max\"\n                  />\n                  {invalidMessage(state.xAxisScaleType, localAxisRange.xMax)}\n                </div>\n              </div>\n              <div style={{ padding: theme.spacing.xs }} />\n              <Switch\n                aria-label=\"x-axis-log\"\n                checked={state.xAxisScaleType === 'log'}\n                onChange={updateXAxisScaleType}\n                label=\"Log scale\"\n                activeLabel=\"On\"\n                inactiveLabel=\"Off\"\n                disabledLabel=\"Disabled\"\n              />\n            </RunsChartsConfigureField>\n          )}\n        </>\n      )}\n      <Typography.Title level={4} color=\"secondary\" css={{ paddingTop: theme.spacing.lg }}>\n        Y-axis\n      </Typography.Title>\n      <RunsChartsYAxisMetricAndExpressionSelector\n        state={state}\n        onStateChange={onStateChange}\n        metricKeyList={metricKeyList}\n        updateSelectedMetrics={updateSelectedMetrics}\n      />\n      <RunsChartsConfigureField title=\"Y-axis scale\" compact>\n        {usingManualRangeControls && (\n          <div css={{ display: 'flex', gap: theme.spacing.sm }}>\n            <div>\n              <Input\n                componentId=\"mlflow.charts.line_chart_configure.y_axis_min\"\n                aria-label=\"y-axis-min\"\n                name=\"min\"\n                type=\"number\"\n                value={localAxisRange.yMin}\n                onChange={(e) => updateYAxisScaleMin(e.target.value)}\n                max={localAxisRange.yMax}\n                placeholder=\"Min\"\n              />\n              {invalidMessage(state.scaleType, localAxisRange.yMin)}\n            </div>\n            <div>\n              <Input\n                componentId=\"mlflow.charts.line_chart_configure.y_axis_max\"\n                aria-label=\"y-axis-max\"\n                name=\"max\"\n                type=\"number\"\n                value={localAxisRange.yMax}\n                onChange={(e) => updateYAxisScaleMax(e.target.value)}\n                min={localAxisRange.yMin}\n                placeholder=\"Max\"\n              />\n              {invalidMessage(state.scaleType, localAxisRange.yMax)}\n            </div>\n          </div>\n        )}\n        <Spacer size=\"xs\" />\n        <Switch\n          aria-label=\"y-axis-log\"\n          checked={state.scaleType === 'log'}\n          onChange={updateYAxisType}\n          label=\"Log scale\"\n          activeLabel=\"On\"\n          inactiveLabel=\"Off\"\n          disabledLabel=\"Disabled\"\n        />\n        <Spacer size=\"xs\" />\n        <div css={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-between' }}>\n          <div>\n            <Typography.Text bold>\n              <FormattedMessage\n                defaultMessage=\"Ignore outliers\"\n                description=\"Runs charts > line chart > ignore outliers > label\"\n              />\n            </Typography.Text>\n            <Tooltip\n              delayDuration={0}\n              content={\n                <FormattedMessage\n                  defaultMessage=\"Only display data points between the p5 and p95 of the data. This can help with chart readability in cases where outliers significantly affect the Y-axis range\"\n                  description=\"A tooltip describing the 'Ignore Outliers' configuration option for line charts\"\n                />\n              }\n              side=\"right\"\n            >\n              <span>\n                {' '}\n                <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n              </span>\n            </Tooltip>\n          </div>\n          <Switch\n            aria-label=\"y-axis-ignore-outliers\"\n            checked={state.ignoreOutliers}\n            onChange={updateIgnoreOutliers}\n            // Empty label so that the active/inactive labels are actually displayed\n            label=\" \"\n            activeLabel={intl.formatMessage({\n              defaultMessage: 'On',\n              description: 'Runs charts > line chart > ignore outliers > on setting label',\n            })}\n            inactiveLabel={intl.formatMessage({\n              defaultMessage: 'Off',\n              description: 'Runs charts > line chart > ignore outliers > off setting label',\n            })}\n            disabledLabel={intl.formatMessage({\n              defaultMessage: 'Disabled',\n              description: 'Runs charts > line chart > ignore outliers > disabled label',\n            })}\n          />\n        </div>\n      </RunsChartsConfigureField>\n      <Typography.Title level={4} color=\"secondary\" css={{ paddingTop: theme.spacing.lg }}>\n        Advanced\n      </Typography.Title>\n      <RunsChartsConfigureField\n        title={intl.formatMessage({\n          defaultMessage: 'Display points',\n          description: 'Runs charts > line chart > display points > label',\n        })}\n        compact\n      >\n        <SegmentedControlGroup\n          name={intl.formatMessage({\n            defaultMessage: 'Display points',\n            description: 'Runs charts > line chart > display points > label',\n          })}\n          value={state.displayPoints}\n          onChange={({ target }) => {\n            onStateChange((current) => ({\n              ...(current as RunsChartsLineCardConfig),\n              displayPoints: target.value,\n            }));\n          }}\n        >\n          <SegmentedControlButton\n            value={undefined}\n            aria-label={[\n              intl.formatMessage({\n                defaultMessage: 'Display points',\n                description: 'Runs charts > line chart > display points > label',\n              }),\n              intl.formatMessage({\n                defaultMessage: 'Auto',\n                description: 'Runs charts > line chart > display points > auto setting label',\n              }),\n            ].join(': ')}\n          >\n            <FormattedMessage\n              defaultMessage=\"Auto\"\n              description=\"Runs charts > line chart > display points > auto setting label\"\n            />{' '}\n            <LegacyTooltip\n              title={\n                <FormattedMessage\n                  defaultMessage=\"Show points on line charts if there are fewer than 60 data points per trace\"\n                  description=\"Runs charts > line chart > display points > auto tooltip\"\n                />\n              }\n            >\n              <InfoIcon />\n            </LegacyTooltip>\n          </SegmentedControlButton>\n          <SegmentedControlButton\n            value\n            aria-label={[\n              intl.formatMessage({\n                defaultMessage: 'Display points',\n                description: 'Runs charts > line chart > display points > label',\n              }),\n              intl.formatMessage({\n                defaultMessage: 'On',\n                description: 'Runs charts > line chart > display points > on setting label',\n              }),\n            ].join(': ')}\n          >\n            <FormattedMessage\n              defaultMessage=\"On\"\n              description=\"Runs charts > line chart > display points > on setting label\"\n            />\n          </SegmentedControlButton>\n          <SegmentedControlButton\n            value={false}\n            aria-label={[\n              intl.formatMessage({\n                defaultMessage: 'Display points',\n                description: 'Runs charts > line chart > display points > label',\n              }),\n              intl.formatMessage({\n                defaultMessage: 'Off',\n                description: 'Runs charts > line chart > display points > off setting label',\n              }),\n            ].join(': ')}\n          >\n            <FormattedMessage\n              defaultMessage=\"Off\"\n              description=\"Runs charts > line chart > display points > off setting label\"\n            />\n          </SegmentedControlButton>\n        </SegmentedControlGroup>\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField title=\"Line smoothness\" compact>\n        <LineSmoothSlider\n          data-testid=\"smoothness-toggle\"\n          min={0}\n          max={100}\n          onChange={updateSmoothing}\n          defaultValue={state.lineSmoothness ? state.lineSmoothness : 0}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsRunNumberSelect\n        value={state.runsCountToCompare}\n        onChange={updateVisibleRunCount}\n        options={runSelectOptions}\n      />\n    </>\n  );\n};\n\nconst styles = {\n  selectFull: { width: '100%' },\n  timeStepQuestionMarkIcon: () => ({\n    svg: { width: 12, height: 12 },\n  }),\n};\n","import { LegacySkeleton } from '@databricks/design-system';\nimport { useCallback, useMemo, useRef } from 'react';\nimport { connect } from 'react-redux';\nimport { ReduxState } from '../../../../../redux-types';\nimport { MetricHistoryByName } from '../../../../types';\nimport {\n  RunsChartsLineChartXAxisType,\n  removeOutliersFromMetricHistory,\n  type RunsChartsRunData,\n} from '../RunsCharts.common';\nimport { RunsMetricsLinePlot } from '../RunsMetricsLinePlot';\nimport { RunsChartsTooltipMode, useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsLineCardConfig } from '../../runs-charts.types';\nimport {\n  shouldEnableDeepLearningUIPhase3,\n  shouldEnableManualRangeControls,\n} from '../../../../../common/utils/FeatureUtils';\nimport { useSampledMetricHistory } from '../../hooks/useSampledMetricHistory';\nimport { compact, isUndefined, uniq } from 'lodash';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { useGroupedChartRunData } from '../../../runs-compare/hooks/useGroupedChartRunData';\n\nexport const RunsChartsConfigureLineChartPreviewImpl = ({\n  previewData,\n  cardConfig,\n  metricsByRunUuid,\n  groupBy,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsLineCardConfig;\n  groupBy: RunsGroupByConfig | null;\n\n  metricsByRunUuid: Record<string, MetricHistoryByName>;\n}) => {\n  const usingMultipleRunsHoverTooltip = shouldEnableDeepLearningUIPhase3();\n  const usingManualRangeControls = shouldEnableManualRangeControls();\n\n  const isGrouped = useMemo(() => previewData.some((r) => r.groupParentInfo), [previewData]);\n\n  const { aggregateFunction } = groupBy || {};\n\n  const runUuidsToFetch = useMemo(() => {\n    if (isGrouped) {\n      const runsInGroups = compact(previewData.map((r) => r.groupParentInfo)).flatMap((g) => g.runUuids);\n      const ungroupedRuns = compact(\n        previewData.filter((r) => !r.groupParentInfo && !r.belongsToGroup).map((r) => r.runInfo?.runUuid ?? undefined),\n      );\n      return [...runsInGroups, ...ungroupedRuns];\n    }\n    return compact(previewData.map((r) => r.runInfo)).map((g) => g.runUuid ?? '');\n  }, [previewData, isGrouped]);\n\n  const metricKeysToFetch = useMemo(() => {\n    const fallback = [cardConfig.metricKey];\n\n    const yAxisKeys = cardConfig.selectedMetricKeys ?? fallback;\n    const xAxisKeys = !cardConfig.selectedXAxisMetricKey ? [] : [cardConfig.selectedXAxisMetricKey];\n    return yAxisKeys.concat(xAxisKeys);\n  }, [cardConfig.metricKey, cardConfig.selectedMetricKeys, cardConfig.selectedXAxisMetricKey]);\n\n  const { resultsByRunUuid, isLoading } = useSampledMetricHistory({\n    runUuids: runUuidsToFetch,\n    metricKeys: metricKeysToFetch,\n    enabled: true,\n    maxResults: 320,\n    autoRefreshEnabled: false,\n  });\n\n  const sampledData = useMemo(\n    () =>\n      previewData.map((run) => {\n        const metricsHistory = metricKeysToFetch.reduce((acc: MetricHistoryByName, key) => {\n          const history = resultsByRunUuid[run.uuid]?.[key]?.metricsHistory;\n          if (history) {\n            acc[key] = cardConfig.ignoreOutliers ? removeOutliersFromMetricHistory(history) : history;\n          }\n          return acc;\n        }, {});\n\n        return {\n          ...run,\n          metricsHistory,\n        };\n      }),\n    [metricKeysToFetch, resultsByRunUuid, previewData, cardConfig.ignoreOutliers],\n  );\n\n  const sampledGroupData = useGroupedChartRunData({\n    enabled: isGrouped,\n    ungroupedRunsData: sampledData,\n    metricKeys: metricKeysToFetch,\n    sampledDataResultsByRunUuid: resultsByRunUuid,\n    aggregateFunction,\n    selectedXAxisMetricKey:\n      cardConfig.xAxisKey === RunsChartsLineChartXAxisType.METRIC ? cardConfig.selectedXAxisMetricKey : undefined,\n    ignoreOutliers: cardConfig.ignoreOutliers ?? false,\n  });\n\n  // Use grouped data traces only if enabled and if there are any groups\n  const chartData = isGrouped ? sampledGroupData : sampledData;\n\n  const { setTooltip, resetTooltip } = useRunsChartsTooltip(\n    cardConfig,\n    usingMultipleRunsHoverTooltip ? RunsChartsTooltipMode.MultipleTracesWithScanline : RunsChartsTooltipMode.Simple,\n  );\n\n  if (isLoading) {\n    return <LegacySkeleton />;\n  }\n\n  const checkValidRange = (\n    rangeMin: number | undefined,\n    rangeMax: number | undefined,\n  ): [number, number] | undefined => {\n    if (isUndefined(rangeMin) || isUndefined(rangeMax)) {\n      return undefined;\n    }\n    return [rangeMin, rangeMax];\n  };\n\n  const xRange = checkValidRange(cardConfig.range?.xMin, cardConfig.range?.xMax);\n  const yRange = checkValidRange(cardConfig.range?.yMin, cardConfig.range?.yMax);\n\n  return (\n    <RunsMetricsLinePlot\n      runsData={chartData}\n      metricKey={cardConfig.metricKey}\n      selectedMetricKeys={cardConfig.selectedMetricKeys}\n      scaleType={cardConfig.scaleType}\n      xAxisScaleType={cardConfig.xAxisScaleType}\n      lineSmoothness={cardConfig.lineSmoothness}\n      xAxisKey={cardConfig.xAxisKey}\n      selectedXAxisMetricKey={cardConfig.selectedXAxisMetricKey}\n      displayPoints={cardConfig.displayPoints}\n      useDefaultHoverBox={false}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n      xRange={usingManualRangeControls ? xRange : undefined}\n      yRange={usingManualRangeControls ? yRange : undefined}\n    />\n  );\n};\n\nconst mapStateToProps = ({ entities: { metricsByRunUuid } }: ReduxState) => ({\n  metricsByRunUuid,\n});\n\n/**\n * Preview of line chart used in compare runs configuration modal\n */\nexport const RunsChartsConfigureLineChartPreview = connect(mapStateToProps, undefined, undefined, {\n  areStatesEqual: (nextState, prevState) => nextState.entities.metricsByRunUuid === prevState.entities.metricsByRunUuid,\n})(RunsChartsConfigureLineChartPreviewImpl);\n","import { RunsChartsRunData } from '../RunsCharts.common';\nimport LazyParallelCoordinatesPlot, { processParallelCoordinateData } from '../charts/LazyParallelCoordinatesPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsParallelCardConfig } from '../../runs-charts.types';\nimport { useMemo } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\nexport const RunsChartsConfigureParallelChartPreview = ({\n  previewData,\n  cardConfig,\n  groupBy,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsParallelCardConfig;\n  groupBy: RunsGroupByConfig | null;\n}) => {\n  const selectedParamsCount = cardConfig.selectedParams?.length || 0;\n  const selectedMetricsCount = cardConfig.selectedMetrics?.length || 0;\n\n  const isConfigured = selectedParamsCount + selectedMetricsCount >= 2;\n\n  const { setTooltip, resetTooltip } = useRunsChartsTooltip(cardConfig);\n\n  const containsStringValues = useMemo(\n    () =>\n      cardConfig.selectedParams?.some(\n        (paramKey) => previewData?.some((dataTrace) => isNaN(Number(dataTrace.params[paramKey]?.value))),\n        [cardConfig.selectedParams, previewData],\n      ),\n    [cardConfig.selectedParams, previewData],\n  );\n\n  if (containsStringValues && groupBy) {\n    return (\n      <div css={{ display: 'flex', justifyContent: 'center', alignItems: 'center', textAlign: 'center' }}>\n        <FormattedMessage\n          defaultMessage=\"Parallel coordinates chart does not support aggregated string values. Use other parameters or disable run grouping to continue.\"\n          description=\"Experiment page > compare runs > parallel coordinates chart configuration modal > unsupported string values warning\"\n        />\n      </div>\n    );\n  }\n\n  const filteredData = isConfigured\n    ? processParallelCoordinateData(previewData, cardConfig.selectedParams, cardConfig.selectedMetrics)\n    : [];\n\n  if (!isConfigured) {\n    return (\n      <div css={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\n        Select at least two metrics and params first\n      </div>\n    );\n  }\n\n  return filteredData.length ? (\n    /* Avoid displaying empty set, otherwise parcoord-es crashes */\n    <LazyParallelCoordinatesPlot\n      selectedMetrics={cardConfig.selectedMetrics}\n      selectedParams={cardConfig.selectedParams}\n      data={filteredData}\n      axesRotateThreshold={6}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n    />\n  ) : null;\n};\n","import { useCallback, useEffect } from 'react';\nimport { useIntl } from 'react-intl';\nimport {\n  extractCanonicalSortKey,\n  isCanonicalSortKeyOfType,\n  makeCanonicalSortKey,\n} from '../../../experiment-page/utils/experimentPage.common-utils';\nimport type { RunsChartsCardConfig, RunsChartsContourCardConfig } from '../../runs-charts.types';\nimport {\n  RunsChartsMetricParamSelect,\n  RunsChartsConfigureField,\n  RunsChartsRunNumberSelect,\n} from './RunsChartsConfigure.common';\n\ntype ValidAxis = keyof Pick<RunsChartsContourCardConfig, 'xaxis' | 'yaxis' | 'zaxis'>;\n\n/**\n * Form containing configuration controls for Contour runs compare chart.\n */\nexport const RunsChartsConfigureContourChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: RunsChartsContourCardConfig;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsContourCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n  const runSelectOptions = [5, 10, 20, 50, 100];\n\n  /**\n   * Callback for updating X or Y axis\n   */\n  const updateAxis = useCallback(\n    (canonicalKey: string, axis: ValidAxis) => {\n      const type = isCanonicalSortKeyOfType(canonicalKey, 'METRIC') ? 'METRIC' : 'PARAM';\n      const key = extractCanonicalSortKey(canonicalKey, type);\n      onStateChange((current) => ({\n        ...(current as RunsChartsContourCardConfig),\n        [axis]: { key, type },\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsContourCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow axes are not predetermined, automatically\n   * select the first metric/param so it's not empty\n   */\n  useEffect(() => {\n    const firstMetric = metricKeyList?.[0];\n    const firstParam = paramKeyList?.[0];\n    if (!state.xaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'xaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'xaxis');\n      }\n    }\n    if (!state.yaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'yaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'yaxis');\n      }\n    }\n    if (!state.zaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'zaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'zaxis');\n      }\n    }\n  }, [state.xaxis, state.yaxis, state.zaxis, updateAxis, metricKeyList, paramKeyList]);\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'X axis',\n          description: 'Label for X axis in Contour chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.xaxis.key ? makeCanonicalSortKey(state.xaxis.type, state.xaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'xaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Y axis',\n          description: 'Label for Y axis in Contour chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.yaxis.key ? makeCanonicalSortKey(state.yaxis.type, state.yaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'yaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Z axis',\n          description: 'Label for Z axis in Contour chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.zaxis.key ? makeCanonicalSortKey(state.zaxis.type, state.zaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'zaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsRunNumberSelect\n        value={state.runsCountToCompare}\n        onChange={updateVisibleRunCount}\n        options={runSelectOptions}\n      />\n    </>\n  );\n};\n","import { useCallback, useEffect } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport {\n  extractCanonicalSortKey,\n  isCanonicalSortKeyOfType,\n  makeCanonicalSortKey,\n} from '../../../experiment-page/utils/experimentPage.common-utils';\nimport type { RunsChartsCardConfig, RunsChartsScatterCardConfig } from '../../runs-charts.types';\nimport {\n  RunsChartsMetricParamSelect,\n  RunsChartsConfigureField,\n  RunsChartsRunNumberSelect,\n  runsChartsRunCountDefaultOptions,\n} from './RunsChartsConfigure.common';\n\ntype ValidAxis = keyof Pick<RunsChartsScatterCardConfig, 'xaxis' | 'yaxis'>;\n\nconst scatterPlotDefaultOptions = runsChartsRunCountDefaultOptions;\nscatterPlotDefaultOptions.push(\n  {\n    value: 100,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"100\"\n        description=\"Label for 100 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 250,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"250\"\n        description=\"Label for 250 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 500,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"500\"\n        description=\"Label for 500 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n);\n\n/**\n * Form containing configuration controls for scatter runs compare chart.\n */\nexport const RunsChartsConfigureScatterChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: RunsChartsScatterCardConfig;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsScatterCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n\n  /**\n   * Callback for updating X or Y axis\n   */\n  const updateAxis = useCallback(\n    (canonicalKey: string, axis: ValidAxis) => {\n      const type = isCanonicalSortKeyOfType(canonicalKey, 'METRIC') ? 'METRIC' : 'PARAM';\n      const key = extractCanonicalSortKey(canonicalKey, type);\n      onStateChange((current) => ({\n        ...(current as RunsChartsScatterCardConfig),\n        [axis]: { key, type },\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsScatterCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow axes are not predetermined, automatically\n   * select the first metric/param so it's not empty\n   */\n  useEffect(() => {\n    const firstMetric = metricKeyList?.[0];\n    const firstParam = paramKeyList?.[0];\n    if (!state.xaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'xaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'xaxis');\n      }\n    }\n    if (!state.yaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'yaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'yaxis');\n      }\n    }\n  }, [state.xaxis, state.yaxis, updateAxis, metricKeyList, paramKeyList]);\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'X axis',\n          description: 'Label for X axis in scatter chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.xaxis.key ? makeCanonicalSortKey(state.xaxis.type, state.xaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'xaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Y axis',\n          description: 'Label for Y axis in scatter chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.yaxis.key ? makeCanonicalSortKey(state.yaxis.type, state.yaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'yaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsRunNumberSelect\n        value={state.runsCountToCompare}\n        onChange={updateVisibleRunCount}\n        options={scatterPlotDefaultOptions}\n      />\n    </>\n  );\n};\n","import { FormattedMessage } from 'react-intl';\nimport {\n  DifferenceCardConfigCompareGroup,\n  RunsChartsCardConfig,\n  RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { DifferenceViewPlot } from '../charts/DifferenceViewPlot';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\nexport const RunsChartsConfigureDifferenceChartPreview = ({\n  previewData,\n  groupBy,\n  cardConfig,\n  setCardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  groupBy: RunsGroupByConfig | null;\n  cardConfig: RunsChartsDifferenceCardConfig;\n  setCardConfig: (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => void;\n}) => {\n  return (\n    <div css={{ width: '100%', overflow: 'auto hidden', height: '100%' }}>\n      <DifferenceViewPlot\n        previewData={previewData}\n        groupBy={groupBy}\n        cardConfig={cardConfig}\n        setCardConfig={setCardConfig}\n      />\n    </div>\n  );\n};\n","import {\n  Checkbox,\n  Input,\n  Switch,\n  useDesignSystemTheme,\n  LegacyTooltip,\n  InfoIcon,\n  LegacyInfoTooltip,\n} from '@databricks/design-system';\nimport {\n  DISABLED_GROUP_WHEN_GROUPBY,\n  DifferenceCardConfigCompareGroup,\n  RunsChartsCardConfig,\n  RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsConfigureField } from './RunsChartsConfigure.common';\nimport { useCallback } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\n/**\n * Form containing configuration controls for runs compare difference view chart.\n */\nexport const RunsChartsConfigureDifferenceChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n  groupBy,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: Partial<RunsChartsDifferenceCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => void;\n  groupBy: RunsGroupByConfig | null;\n}) => {\n  /**\n   * Callback for updating compare groups\n   */\n  const updateCompareGroups = useCallback(\n    (compareGroup: DifferenceCardConfigCompareGroup) => {\n      onStateChange((current) => {\n        const currentConfig = current as RunsChartsDifferenceCardConfig;\n        const compareGroups = currentConfig.compareGroups;\n        if (compareGroups.includes(compareGroup)) {\n          return {\n            ...(current as RunsChartsDifferenceCardConfig),\n            compareGroups: compareGroups.filter((group) => group !== compareGroup),\n          };\n        } else {\n          return { ...(current as RunsChartsDifferenceCardConfig), compareGroups: [...compareGroups, compareGroup] };\n        }\n      });\n    },\n    [onStateChange],\n  );\n\n  const updateChartName = useCallback(\n    (e) => onStateChange((current) => ({ ...(current as RunsChartsDifferenceCardConfig), chartName: e.target.value })),\n    [onStateChange],\n  );\n\n  const updateShowChangeFromBaseline = useCallback(\n    (showChangeFromBaseline: boolean) =>\n      onStateChange((current) => ({\n        ...(current as RunsChartsDifferenceCardConfig),\n        showChangeFromBaseline,\n      })),\n    [onStateChange],\n  );\n\n  const updateShowDifferencesOnly = useCallback(\n    (showDifferencesOnly: boolean) =>\n      onStateChange((current) => ({\n        ...(current as RunsChartsDifferenceCardConfig),\n        showDifferencesOnly,\n      })),\n    [onStateChange],\n  );\n\n  const { theme } = useDesignSystemTheme();\n  const { formatMessage } = useIntl();\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Compare',\n          description:\n            'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Compare config section',\n        })}\n      >\n        <Checkbox.Group id=\"checkbox-group\" defaultValue={state.compareGroups}>\n          {Object.values(DifferenceCardConfigCompareGroup).map((group) => {\n            const groupedCondition = groupBy ? DISABLED_GROUP_WHEN_GROUPBY.includes(group) : false;\n            return (\n              <div css={{ display: 'inline-flex', alignItems: 'center' }}>\n                <Checkbox\n                  key={group}\n                  value={group}\n                  isChecked={state.compareGroups?.includes(group)}\n                  onChange={() => updateCompareGroups(group)}\n                  disabled={groupedCondition}\n                >\n                  {group}\n                </Checkbox>\n                {groupedCondition && (\n                  <LegacyInfoTooltip\n                    title={\n                      <FormattedMessage\n                        defaultMessage=\"Disable grouped runs to compare\"\n                        description=\"Experiment tracking > components > runs-charts > RunsChartsConfigureDifferenceCharts > disable grouped runs info message\"\n                      />\n                    }\n                  />\n                )}\n              </div>\n            );\n          })}\n        </Checkbox.Group>\n        <div\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n            padding: `${theme.spacing.md}px 0px`,\n            gap: theme.spacing.sm,\n          }}\n        >\n          <Switch\n            checked={state.showChangeFromBaseline}\n            onChange={updateShowChangeFromBaseline}\n            label={formatMessage({\n              defaultMessage: 'Show change from baseline',\n              description:\n                'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Show change from baseline toggle',\n            })}\n          />\n          <Switch\n            checked={state.showDifferencesOnly}\n            onChange={updateShowDifferencesOnly}\n            label={formatMessage({\n              defaultMessage: 'Show differences only',\n              description:\n                'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Show differences only toggle',\n            })}\n          />\n        </div>\n      </RunsChartsConfigureField>\n\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Chart name',\n          description:\n            'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Chart name config section',\n        })}\n      >\n        <Input value={state.chartName} onChange={updateChartName} />\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import { useCallback } from 'react';\nimport { RunsChartsCardConfig, RunsChartsImageCardConfig } from '../../runs-charts.types';\nimport { Input } from '@databricks/design-system';\nimport { useIntl } from 'react-intl';\nimport { RunsChartsConfigureField } from './RunsChartsConfigure.common';\nimport { DialogCombobox } from '@databricks/design-system';\nimport { DialogComboboxContent } from '@databricks/design-system';\nimport { DialogComboboxTrigger } from '@databricks/design-system';\nimport { DialogComboboxOptionListCheckboxItem } from '@databricks/design-system';\nimport { DialogComboboxOptionList } from '@databricks/design-system';\nimport { useImageSliderStepMarks } from '../../hooks/useImageSliderStepMarks';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { Slider } from 'antd';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { LineSmoothSlider } from '@mlflow/mlflow/src/experiment-tracking/components/LineSmoothSlider';\n\nexport const RunsChartsConfigureImageChart = ({\n  previewData,\n  state,\n  onStateChange,\n  imageKeyList,\n}: {\n  previewData: RunsChartsRunData[];\n  imageKeyList: string[];\n  state: Partial<RunsChartsImageCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n}) => {\n  const IMAGE_CONFIG_WIDTH = 275;\n\n  const { stepMarks, maxMark, minMark } = useImageSliderStepMarks({\n    data: previewData,\n    selectedImageKeys: state.imageKeys || [],\n  });\n\n  const updateImageKeys = useCallback(\n    (imageKeys: string[]) => {\n      onStateChange((current) => {\n        return { ...(current as RunsChartsImageCardConfig), imageKeys };\n      });\n    },\n    [onStateChange],\n  );\n\n  const updateStep = useCallback(\n    (step: number) => {\n      onStateChange((current) => {\n        return { ...(current as RunsChartsImageCardConfig), step };\n      });\n    },\n    [onStateChange],\n  );\n\n  const { formatMessage } = useIntl();\n\n  const handleUpdate = (imageKey: string) => {\n    onStateChange((current) => {\n      const currentConfig = current as RunsChartsImageCardConfig;\n      if (currentConfig.imageKeys?.includes(imageKey)) {\n        return {\n          ...currentConfig,\n          imageKeys: currentConfig.imageKeys?.filter((key) => key !== imageKey),\n        };\n      } else {\n        return { ...currentConfig, imageKeys: [...(currentConfig.imageKeys || []), imageKey] };\n      }\n    });\n  };\n\n  const handleClear = () => {\n    onStateChange((current) => {\n      return { ...(current as RunsChartsImageCardConfig), imageKeys: [] };\n    });\n  };\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Images',\n          description: 'Runs charts > components > config > RunsChartsConfigureImageGrid > Images section',\n        })}\n      >\n        <DialogCombobox value={state.imageKeys} label=\"Images\" multiSelect>\n          <DialogComboboxTrigger onClear={handleClear} minWidth={IMAGE_CONFIG_WIDTH} />\n          <DialogComboboxContent matchTriggerWidth>\n            <DialogComboboxOptionList>\n              {imageKeyList.map((imageKey) => {\n                return (\n                  <DialogComboboxOptionListCheckboxItem\n                    key={imageKey}\n                    value={imageKey}\n                    onChange={handleUpdate}\n                    checked={state.imageKeys?.includes(imageKey)}\n                  />\n                );\n              })}\n            </DialogComboboxOptionList>\n          </DialogComboboxContent>\n        </DialogCombobox>\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField title=\"Step\">\n        <LineSmoothSlider\n          max={maxMark}\n          min={minMark}\n          marks={stepMarks}\n          defaultValue={state.step}\n          disabled={Object.keys(stepMarks).length <= 1}\n          onChange={updateStep}\n          step={null}\n        />\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import { RunsGroupByConfig } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsCardConfig, RunsChartsImageCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { ImageGridPlot } from '../charts/ImageGridPlot';\n\nexport const RunsChartsConfigureImageChartPreview = ({\n  previewData,\n  cardConfig,\n  setCardConfig,\n  groupBy,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  setCardConfig: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n  groupBy: RunsGroupByConfig | null;\n}) => {\n  return (\n    <div css={{ width: '100%', overflow: 'auto hidden' }}>\n      <ImageGridPlot\n        previewData={previewData}\n        cardConfig={cardConfig}\n        setCardConfig={setCardConfig}\n        containerWidth={500}\n        groupBy={groupBy}\n      />\n    </div>\n  );\n};\n","/**\n * TODO: implement actual UI for this modal, it's a crude placeholder with minimal logic for now\n */\nimport { Modal, useDesignSystemTheme, SimpleSelect, SimpleSelectOption } from '@databricks/design-system';\nimport { Interpolation, Theme } from '@emotion/react';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { useIntl, FormattedMessage } from 'react-intl';\nimport {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartType,\n  RunsChartsLineCardConfig,\n  RunsChartsContourCardConfig,\n  RunsChartsScatterCardConfig,\n  RunsChartsParallelCardConfig,\n  RunsChartsDifferenceCardConfig,\n  RunsChartsImageCardConfig,\n} from '../runs-charts.types';\n\nimport { ReactComponent as ChartBarIcon } from '../../../../common/static/chart-bar.svg';\nimport { ReactComponent as ChartContourIcon } from '../../../../common/static/chart-contour.svg';\nimport { ReactComponent as ChartLineIcon } from '../../../../common/static/chart-line.svg';\nimport { ReactComponent as ChartParallelIcon } from '../../../../common/static/chart-parallel.svg';\nimport { ReactComponent as ChartScatterIcon } from '../../../../common/static/chart-scatter.svg';\nimport { ReactComponent as ChartDifferenceIcon } from '../../../../common/static/chart-difference.svg';\nimport { ReactComponent as ChartImageIcon } from '../../../../common/static/chart-image.svg';\nimport { RunsChartsConfigureBarChart } from './config/RunsChartsConfigureBarChart';\nimport { RunsChartsConfigureParallelChart } from './config/RunsChartsConfigureParallelChart';\nimport type { RunsChartsRunData } from './RunsCharts.common';\nimport { RunsChartsConfigureField } from './config/RunsChartsConfigure.common';\nimport { RunsChartsConfigureLineChart } from './config/RunsChartsConfigureLineChart';\nimport { RunsChartsConfigureLineChartPreview } from './config/RunsChartsConfigureLineChart.preview';\nimport { RunsChartsConfigureBarChartPreview } from './config/RunsChartsConfigureBarChart.preview';\nimport { RunsChartsConfigureContourChartPreview } from './config/RunsChartsConfigureContourChart.preview';\nimport { RunsChartsConfigureScatterChartPreview } from './config/RunsChartsConfigureScatterChart.preview';\nimport { RunsChartsConfigureParallelChartPreview } from './config/RunsChartsConfigureParallelChart.preview';\nimport { RunsChartsConfigureContourChart } from './config/RunsChartsConfigureContourChart';\nimport { RunsChartsConfigureScatterChart } from './config/RunsChartsConfigureScatterChart';\nimport { RunsChartsTooltipBody } from './RunsChartsTooltipBody';\nimport { RunsChartsTooltipWrapper } from '../hooks/useRunsChartsTooltip';\nimport {\n  shouldEnableDifferenceViewCharts,\n  shouldEnableImageGridCharts,\n  shouldUseNewRunRowsVisibilityModel,\n} from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { RunsChartsConfigureDifferenceChartPreview } from './config/RunsChartsConfigureDifferenceChart.preview';\nimport { RunsChartsConfigureDifferenceChart } from './config/RunsChartsConfigureDifferenceChart';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsConfigureImageChart } from './config/RunsChartsConfigureImageChart';\nimport { RunsChartsConfigureImageChartPreview } from './config/RunsChartsConfigureImageChart.preview';\n\nconst previewComponentsMap: Record<\n  RunsChartType,\n  React.FC<{\n    previewData: RunsChartsRunData[];\n    cardConfig: any;\n    groupBy: RunsGroupByConfig | null;\n    setCardConfig: (\n      setter: (\n        current: RunsChartsCardConfig,\n      ) => RunsChartsDifferenceCardConfig | RunsChartsImageCardConfig | RunsChartsLineCardConfig,\n    ) => void;\n  }>\n> = {\n  [RunsChartType.BAR]: RunsChartsConfigureBarChartPreview,\n  [RunsChartType.CONTOUR]: RunsChartsConfigureContourChartPreview,\n  [RunsChartType.LINE]: RunsChartsConfigureLineChartPreview,\n  [RunsChartType.PARALLEL]: RunsChartsConfigureParallelChartPreview,\n  [RunsChartType.SCATTER]: RunsChartsConfigureScatterChartPreview,\n  [RunsChartType.DIFFERENCE]: RunsChartsConfigureDifferenceChartPreview,\n  [RunsChartType.IMAGE]: RunsChartsConfigureImageChartPreview,\n};\n\nexport const RunsChartsConfigureModal = ({\n  onCancel,\n  onSubmit,\n  config,\n  chartRunData,\n  metricKeyList,\n  paramKeyList,\n  groupBy,\n  supportedChartTypes,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  config: RunsChartsCardConfig;\n  chartRunData: RunsChartsRunData[];\n  onCancel: () => void;\n  groupBy: RunsGroupByConfig | null;\n  onSubmit: (formData: Partial<RunsChartsCardConfig>) => void;\n  supportedChartTypes?: RunsChartType[] | undefined;\n}) => {\n  const isChartTypeSupported = (type: RunsChartType) => !supportedChartTypes || supportedChartTypes.includes(type);\n  const { theme } = useDesignSystemTheme();\n  const borderStyle = `1px solid ${theme.colors.actionDefaultBorderDefault}`;\n  const [currentFormState, setCurrentFormState] = useState<RunsChartsCardConfig>(config);\n\n  const isEditing = Boolean(currentFormState.uuid);\n\n  const updateChartType = useCallback((type?: RunsChartType) => {\n    if (!type) {\n      return;\n    }\n    const emptyChartCard = RunsChartsCardConfig.getEmptyChartCardByType(type, true);\n    if (emptyChartCard) {\n      setCurrentFormState(emptyChartCard);\n    }\n  }, []);\n\n  const previewData = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, currentFormState.runsCountToCompare).reverse();\n  }, [chartRunData, currentFormState.runsCountToCompare]);\n\n  const imageKeyList = useMemo(() => {\n    const imageKeys = new Set<string>();\n    previewData.forEach((run) => {\n      Object.keys(run.images).forEach((imageKey) => {\n        imageKeys.add(imageKey);\n      });\n    });\n    return Array.from(imageKeys).sort();\n  }, [previewData]);\n\n  const renderConfigOptionsforChartType = (type?: RunsChartType) => {\n    if (type === RunsChartType.BAR) {\n      return (\n        <RunsChartsConfigureBarChart\n          metricKeyList={metricKeyList}\n          state={currentFormState as RunsChartsBarCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.CONTOUR) {\n      return (\n        <RunsChartsConfigureContourChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsContourCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.LINE) {\n      return (\n        <RunsChartsConfigureLineChart\n          metricKeyList={metricKeyList}\n          state={currentFormState as RunsChartsLineCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.PARALLEL) {\n      return (\n        <RunsChartsConfigureParallelChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsParallelCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.SCATTER) {\n      return (\n        <RunsChartsConfigureScatterChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsScatterCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (shouldEnableDifferenceViewCharts() && type === RunsChartType.DIFFERENCE) {\n      return (\n        <RunsChartsConfigureDifferenceChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsDifferenceCardConfig}\n          onStateChange={setCurrentFormState}\n          groupBy={groupBy}\n        />\n      );\n    }\n    if (shouldEnableImageGridCharts() && type === RunsChartType.IMAGE) {\n      return (\n        <RunsChartsConfigureImageChart\n          previewData={previewData}\n          imageKeyList={imageKeyList}\n          state={currentFormState as RunsChartsImageCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    return null;\n  };\n\n  const renderPreviewChartType = (type?: RunsChartType) => {\n    if (!type) {\n      return null;\n    }\n    const PreviewComponent = previewComponentsMap[type];\n    if (!PreviewComponent) {\n      return null;\n    }\n    return (\n      <PreviewComponent\n        previewData={previewData}\n        cardConfig={currentFormState}\n        groupBy={groupBy}\n        setCardConfig={setCurrentFormState}\n      />\n    );\n  };\n\n  const { formatMessage } = useIntl();\n\n  let disableSaveButton = false;\n  if (currentFormState.type === RunsChartType.LINE) {\n    const lineCardConfig = currentFormState as RunsChartsLineCardConfig;\n    disableSaveButton = (lineCardConfig.selectedMetricKeys ?? []).length === 0;\n  }\n\n  return (\n    <Modal\n      visible\n      onCancel={onCancel}\n      onOk={() => onSubmit(currentFormState)}\n      title={\n        isEditing\n          ? formatMessage({\n              defaultMessage: 'Edit chart',\n              description: 'Title of the modal when editing a runs comparison chart',\n            })\n          : formatMessage({\n              defaultMessage: 'Add new chart',\n              description: 'Title of the modal when adding a new runs comparison chart',\n            })\n      }\n      okButtonProps={{\n        'data-testid': 'experiment-view-compare-runs-chart-modal-confirm',\n        disabled: disableSaveButton,\n      }}\n      cancelText={formatMessage({\n        defaultMessage: 'Cancel',\n        description: 'Cancel button label within a modal for adding/editing a new runs comparison chart',\n      })}\n      okText={\n        isEditing\n          ? formatMessage({\n              defaultMessage: 'Save changes',\n              description: 'Confirm button label within a modal when editing a runs comparison chart',\n            })\n          : formatMessage({\n              defaultMessage: 'Add chart',\n              description: 'Confirm button label within a modal when adding a new runs comparison chart',\n            })\n      }\n      size=\"wide\"\n      css={{ width: 1280 }}\n      dangerouslySetAntdProps={{\n        bodyStyle: {\n          overflowY: 'hidden',\n          display: 'flex',\n        },\n      }}\n    >\n      <div\n        css={{\n          // TODO: wait for modal dimensions decision\n          display: 'flex',\n          width: '100%',\n          gridTemplateColumns: '300px 1fr',\n          gap: theme.spacing.md,\n          borderTop: borderStyle,\n          borderBottom: borderStyle,\n        }}\n      >\n        <div\n          css={{\n            overflowY: 'auto',\n            borderRight: borderStyle,\n            padding: `${theme.spacing.md}px ${theme.spacing.md}px ${theme.spacing.md}px 0px`,\n            width: '300px',\n          }}\n        >\n          {!isEditing && (\n            <RunsChartsConfigureField title=\"Chart type\">\n              <SimpleSelect\n                id=\"chart-type-select\"\n                css={{ width: '100%' }}\n                value={currentFormState.type}\n                onChange={({ target }) => {\n                  const chartType = target.value as RunsChartType;\n                  Object.values(RunsChartType).includes(chartType) && updateChartType(chartType);\n                }}\n              >\n                {isChartTypeSupported(RunsChartType.BAR) && (\n                  <SimpleSelectOption value={RunsChartType.BAR}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartBarIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Bar chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > bar chart\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.SCATTER) && (\n                  <SimpleSelectOption value={RunsChartType.SCATTER}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartScatterIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Scatter chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > scatter plot\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.LINE) && (\n                  <SimpleSelectOption value={RunsChartType.LINE}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartLineIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Line chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > line chart\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.PARALLEL) && (\n                  <SimpleSelectOption value={RunsChartType.PARALLEL}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartParallelIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Parallel coordinates\"\n                        description=\"Experiment tracking > runs charts > add chart menu > parallel coordinates\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {isChartTypeSupported(RunsChartType.CONTOUR) && (\n                  <SimpleSelectOption value={RunsChartType.CONTOUR}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartContourIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Contour chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > contour chart\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {shouldEnableDifferenceViewCharts() && isChartTypeSupported(RunsChartType.DIFFERENCE) && (\n                  <SimpleSelectOption value={RunsChartType.DIFFERENCE}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartDifferenceIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Difference view\"\n                        description=\"Experiment tracking > runs charts > add chart menu > difference view\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n                {shouldEnableImageGridCharts() && isChartTypeSupported(RunsChartType.IMAGE) && (\n                  <SimpleSelectOption value={RunsChartType.IMAGE}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartImageIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Image grid\"\n                        description=\"Experiment tracking > runs charts > add chart menu > image grid\"\n                      />\n                    </div>\n                  </SimpleSelectOption>\n                )}\n              </SimpleSelect>\n            </RunsChartsConfigureField>\n          )}\n          {renderConfigOptionsforChartType(currentFormState.type)}\n        </div>\n        <div css={{ overflow: 'auto', flexGrow: 1 }}>\n          <RunsChartsTooltipWrapper contextData={{ runs: chartRunData }} component={RunsChartsTooltipBody} hoverOnly>\n            <div\n              css={{\n                minHeight: 500,\n                width: 500,\n                padding: '32px 0px',\n              }}\n            >\n              {renderPreviewChartType(currentFormState.type)}\n            </div>\n          </RunsChartsTooltipWrapper>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nconst styles = {\n  chartTypeOption: (theme: Theme) =>\n    ({\n      display: 'grid',\n      gridTemplateColumns: `${theme.general.iconSize + theme.spacing.xs}px 1fr`,\n      gap: theme.spacing.xs,\n      alignItems: 'center',\n    } as Interpolation<Theme>),\n  field: {\n    // TODO: wait for modal dimensions decision\n    display: 'grid',\n    gridTemplateColumns: '80px 1fr',\n    marginBottom: 16,\n  } as Interpolation<Theme>,\n};\n","import { barChartCardDefaultMargin } from '../cards/RunsChartsBarChartCard';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsMetricsBarPlot } from '../RunsMetricsBarPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsBarCardConfig } from '../../runs-charts.types';\n\nexport const RunsChartsConfigureBarChartPreview = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsBarCardConfig;\n}) => {\n  const { resetTooltip, setTooltip } = useRunsChartsTooltip(cardConfig);\n\n  return (\n    <RunsMetricsBarPlot\n      useDefaultHoverBox={false}\n      displayRunNames={false}\n      displayMetricKey={false}\n      metricKey={cardConfig.metricKey}\n      runsData={previewData}\n      margin={barChartCardDefaultMargin}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n    />\n  );\n};\n","import { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsContourPlot } from '../RunsContourPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsContourCardConfig } from '../../runs-charts.types';\n\nexport const RunsChartsConfigureContourChartPreview = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsContourCardConfig;\n}) => {\n  const { resetTooltip, setTooltip } = useRunsChartsTooltip(cardConfig);\n\n  return (\n    <RunsContourPlot\n      xAxis={cardConfig.xaxis}\n      yAxis={cardConfig.yaxis}\n      zAxis={cardConfig.zaxis}\n      runsData={previewData}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n      useDefaultHoverBox={false}\n    />\n  );\n};\n","import { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsScatterPlot } from '../RunsScatterPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsScatterCardConfig } from '../../runs-charts.types';\n\nexport const RunsChartsConfigureScatterChartPreview = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsScatterCardConfig;\n}) => {\n  const { resetTooltip, setTooltip } = useRunsChartsTooltip(cardConfig);\n\n  return (\n    <RunsScatterPlot\n      xAxis={cardConfig.xaxis}\n      yAxis={cardConfig.yaxis}\n      runsData={previewData}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n      useDefaultHoverBox={false}\n    />\n  );\n};\n","import { ReactNode } from 'react';\nimport { RunsChartsCardConfig } from '../runs-charts.types';\nimport { RunsChartsRunData } from './RunsCharts.common';\nimport { Modal, useDesignSystemTheme } from '@databricks/design-system';\nimport { RunsChartsTooltipBodyProps, RunsChartsTooltipWrapper } from '../hooks/useRunsChartsTooltip';\nimport { RunsChartsCard } from './cards/RunsChartsCard';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\n\nexport const RunsChartsFullScreenModal = <TContext,>({\n  chartData,\n  isMetricHistoryLoading = false,\n  groupBy,\n  fullScreenChart,\n  onCancel,\n  tooltipContextValue,\n  tooltipComponent,\n  autoRefreshEnabled,\n}: {\n  chartData: RunsChartsRunData[];\n  isMetricHistoryLoading?: boolean;\n  groupBy: RunsGroupByConfig | null;\n  autoRefreshEnabled?: boolean;\n  fullScreenChart: { config: RunsChartsCardConfig; title: string; subtitle: ReactNode } | undefined;\n  onCancel: () => void;\n  tooltipContextValue: TContext;\n  tooltipComponent: React.ComponentType<RunsChartsTooltipBodyProps<TContext>>;\n}) => {\n  const { theme, getPrefixedClassName } = useDesignSystemTheme();\n\n  const emptyReorderProps = {\n    canMoveDown: false,\n    canMoveUp: false,\n    onMoveDown: () => {},\n    onMoveUp: () => {},\n    onReorderWith: () => {},\n  };\n\n  const emptyConfigureProps = {\n    onRemoveChart: () => {},\n    onReorderCharts: () => {},\n    onStartEditChart: () => {},\n    setFullScreenChart: () => {},\n  };\n\n  if (!fullScreenChart) {\n    return null;\n  }\n\n  return (\n    <Modal\n      visible\n      onCancel={onCancel}\n      title={\n        <div css={{ display: 'flex', flexDirection: 'column' }}>\n          {fullScreenChart.title}\n          <span\n            css={{\n              color: theme.colors.textSecondary,\n              fontSize: theme.typography.fontSizeSm,\n              marginRight: theme.spacing.xs,\n            }}\n          >\n            {fullScreenChart.subtitle}\n          </span>\n        </div>\n      }\n      footer={null}\n      verticalSizing=\"maxed_out\"\n      dangerouslySetAntdProps={{ width: '95%' }}\n      css={{\n        [`.${getPrefixedClassName('modal-body')}`]: {\n          flex: 1,\n        },\n      }}\n    >\n      <RunsChartsTooltipWrapper contextData={tooltipContextValue} component={tooltipComponent}>\n        <RunsChartsCard\n          cardConfig={fullScreenChart.config}\n          chartRunData={chartData}\n          groupBy={groupBy}\n          index={0}\n          sectionIndex={0}\n          fullScreen\n          autoRefreshEnabled={autoRefreshEnabled}\n          {...emptyConfigureProps}\n          {...emptyReorderProps}\n        />\n      </RunsChartsTooltipWrapper>\n    </Modal>\n  );\n};\n","import { Empty, NoIcon, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { useUpdateExperimentViewUIState } from '../../experiment-page/contexts/ExperimentPageUIStateContext';\nimport { useCallback } from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport const RunsChartsNoDataFoundIndicator = () => {\n  const updateUIState = useUpdateExperimentViewUIState();\n  const { theme } = useDesignSystemTheme();\n\n  const hideEmptyCharts = useCallback(() => {\n    updateUIState((state) => ({ ...state, hideEmptyCharts: true }));\n  }, [updateUIState]);\n\n  return (\n    <div\n      css={{\n        flex: 1,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        paddingLeft: theme.spacing.lg,\n        paddingRight: theme.spacing.lg,\n      }}\n    >\n      <Empty\n        description={\n          <FormattedMessage\n            defaultMessage=\"No chart data available for the currently visible runs. Select other runs or <link>hide empty charts.</link>\"\n            description=\"Experiment tracking > runs charts > indication displayed when no corresponding data is found to be used in chart-based run comparison\"\n            values={{\n              link: (chunks) => <Typography.Link onClick={hideEmptyCharts}>{chunks}</Typography.Link>,\n            }}\n          />\n        }\n        image={<NoIcon />}\n      />\n    </div>\n  );\n};\n","import { isNil } from 'lodash';\nimport {\n  Button,\n  CloseIcon,\n  PinIcon,\n  PinFillIcon,\n  LegacyTooltip,\n  VisibleIcon,\n  Typography,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { FormattedMessage } from 'react-intl';\nimport { Link } from '../../../../common/utils/RoutingUtils';\nimport Routes from '../../../routes';\nimport { useExperimentIds } from '../../experiment-page/hooks/useExperimentIds';\nimport { RunsChartsRunData, RunsChartsLineChartXAxisType } from './RunsCharts.common';\nimport {\n  RunsChartsTooltipBodyProps,\n  RunsChartsTooltipMode,\n  containsMultipleRunsTooltipData,\n} from '../hooks/useRunsChartsTooltip';\nimport {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartType,\n  RunsChartsScatterCardConfig,\n  RunsChartsContourCardConfig,\n  RunsChartsLineCardConfig,\n  RunsChartsParallelCardConfig,\n} from '../runs-charts.types';\nimport {\n  type RunsCompareMultipleTracesTooltipData,\n  type RunsMetricsSingleTraceTooltipData,\n} from './RunsMetricsLinePlot';\nimport { RunsMultipleTracesTooltipBody } from './RunsMultipleTracesTooltipBody';\nimport { shouldEnableRelativeTimeDateAxis } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { customMetricBehaviorDefs } from '../../experiment-page/utils/customMetricBehaviorUtils';\n\ninterface RunsChartsContextMenuContentDataType {\n  runs: RunsChartsRunData[];\n  onTogglePin?: (runUuid: string) => void;\n  onHideRun?: (runUuid: string) => void;\n}\n\ntype RunsChartContextMenuHoverDataType = RunsChartsCardConfig;\n\nconst createBarChartValuesBox = (cardConfig: RunsChartsBarCardConfig, activeRun: RunsChartsRunData) => {\n  const { metricKey } = cardConfig;\n  const metric = activeRun?.metrics[metricKey];\n\n  if (!metric) {\n    return null;\n  }\n\n  const customMetricBehaviorDef = customMetricBehaviorDefs[metric.key];\n  const displayName = customMetricBehaviorDef?.displayName ?? metric.key;\n  const displayValue = customMetricBehaviorDef?.valueFormatter({ value: metric.value }) ?? metric.value;\n\n  return (\n    <div css={styles.value}>\n      <strong>{displayName}:</strong> {displayValue}\n    </div>\n  );\n};\n\nconst createScatterChartValuesBox = (cardConfig: RunsChartsScatterCardConfig, activeRun: RunsChartsRunData) => {\n  const { xaxis, yaxis } = cardConfig;\n  const xKey = xaxis.key;\n  const yKey = yaxis.key;\n\n  const xValue = xaxis.type === 'METRIC' ? activeRun.metrics[xKey]?.value : activeRun.params[xKey]?.value;\n\n  const yValue = yaxis.type === 'METRIC' ? activeRun.metrics[yKey]?.value : activeRun.params[yKey]?.value;\n\n  return (\n    <>\n      {xValue && (\n        <div css={styles.value}>\n          <strong>X ({xKey}):</strong> {xValue}\n        </div>\n      )}\n      {yValue && (\n        <div css={styles.value}>\n          <strong>Y ({yKey}):</strong> {yValue}\n        </div>\n      )}\n    </>\n  );\n};\n\nconst createContourChartValuesBox = (cardConfig: RunsChartsContourCardConfig, activeRun: RunsChartsRunData) => {\n  const { xaxis, yaxis, zaxis } = cardConfig;\n  const xKey = xaxis.key;\n  const yKey = yaxis.key;\n  const zKey = zaxis.key;\n\n  const xValue = xaxis.type === 'METRIC' ? activeRun.metrics[xKey]?.value : activeRun.params[xKey]?.value;\n\n  const yValue = yaxis.type === 'METRIC' ? activeRun.metrics[yKey]?.value : activeRun.params[yKey]?.value;\n\n  const zValue = zaxis.type === 'METRIC' ? activeRun.metrics[zKey]?.value : activeRun.params[zKey]?.value;\n\n  return (\n    <>\n      {xValue && (\n        <div css={styles.value}>\n          <strong>X ({xKey}):</strong> {xValue}\n        </div>\n      )}\n      {yValue && (\n        <div css={styles.value}>\n          <strong>Y ({yKey}):</strong> {yValue}\n        </div>\n      )}\n      {zValue && (\n        <div css={styles.value}>\n          <strong>Z ({zKey}):</strong> {zValue}\n        </div>\n      )}\n    </>\n  );\n};\n\nconst normalizeRelativeTimeChartTooltipValue = (value: string | number) => {\n  if (typeof value === 'number') {\n    return value;\n  }\n  return value.split(' ')[1] || '00:00:00';\n};\n\nconst getTooltipXValue = (\n  hoverData: RunsMetricsSingleTraceTooltipData | undefined,\n  xAxisKey: RunsChartsLineChartXAxisType,\n) => {\n  if (xAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n    return hoverData?.xValue ?? '';\n  }\n\n  if (shouldEnableRelativeTimeDateAxis() && xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n    return normalizeRelativeTimeChartTooltipValue(hoverData?.xValue ?? '');\n  }\n\n  // Default return for other cases\n  return hoverData?.xValue;\n};\n\nconst createLineChartValuesBox = (\n  cardConfig: RunsChartsLineCardConfig,\n  activeRun: RunsChartsRunData,\n  hoverData?: RunsMetricsSingleTraceTooltipData,\n) => {\n  const { metricKey: metricKeyFromConfig, xAxisKey } = cardConfig;\n  const metricKey = hoverData?.metricEntity?.key || metricKeyFromConfig;\n\n  // If there's available value from x axis (step or time), extract entry from\n  // metric history instead of latest metric.\n  const metricValue = hoverData?.yValue ?? activeRun?.metrics[metricKey].value;\n\n  if (isNil(metricValue)) {\n    return null;\n  }\n\n  const xValue = getTooltipXValue(hoverData, xAxisKey);\n\n  return (\n    <>\n      {hoverData && (\n        <div css={styles.value}>\n          <strong>{hoverData.label}:</strong> {xValue}\n        </div>\n      )}\n      <div css={styles.value}>\n        <strong>{metricKey}:</strong> {metricValue}\n      </div>\n    </>\n  );\n};\n\nconst createParallelChartValuesBox = (\n  cardConfig: RunsChartsParallelCardConfig,\n  activeRun: RunsChartsRunData,\n  isHovering?: boolean,\n) => {\n  const { selectedParams, selectedMetrics } = cardConfig as RunsChartsParallelCardConfig;\n  const paramsList = selectedParams.map((paramKey) => {\n    const param = activeRun?.params[paramKey];\n    if (param) {\n      return (\n        <div key={paramKey}>\n          <strong>{param.key}:</strong> {param.value}\n        </div>\n      );\n    }\n    return true;\n  });\n  const metricsList = selectedMetrics.map((metricKey) => {\n    const metric = activeRun?.metrics[metricKey];\n    if (metric) {\n      return (\n        <div key={metricKey}>\n          <strong>{metric.key}:</strong> {metric.value}\n        </div>\n      );\n    }\n    return true;\n  });\n\n  // show only first 3 params and primary metric if hovering, else show all\n  if (isHovering) {\n    return (\n      <>\n        {paramsList.slice(0, 3)}\n        {(paramsList.length > 3 || metricsList.length > 1) && <div>...</div>}\n        {metricsList[metricsList.length - 1]}\n      </>\n    );\n  } else {\n    return (\n      <>\n        {paramsList}\n        {metricsList}\n      </>\n    );\n  }\n};\n\n/**\n * Internal component that displays metrics/params - its final design\n * is a subject to change\n */\nconst ValuesBox = ({\n  activeRun,\n  cardConfig,\n  isHovering,\n  hoverData,\n}: {\n  activeRun: RunsChartsRunData;\n  cardConfig: RunsChartsCardConfig;\n  isHovering?: boolean;\n  hoverData?: RunsMetricsSingleTraceTooltipData;\n}) => {\n  if (cardConfig.type === RunsChartType.BAR) {\n    return createBarChartValuesBox(cardConfig as RunsChartsBarCardConfig, activeRun);\n  }\n\n  if (cardConfig.type === RunsChartType.SCATTER) {\n    return createScatterChartValuesBox(cardConfig as RunsChartsScatterCardConfig, activeRun);\n  }\n\n  if (cardConfig.type === RunsChartType.CONTOUR) {\n    return createContourChartValuesBox(cardConfig as RunsChartsContourCardConfig, activeRun);\n  }\n\n  if (cardConfig.type === RunsChartType.LINE) {\n    return createLineChartValuesBox(cardConfig as RunsChartsLineCardConfig, activeRun, hoverData);\n  }\n\n  if (cardConfig.type === RunsChartType.PARALLEL) {\n    return createParallelChartValuesBox(cardConfig as RunsChartsParallelCardConfig, activeRun, isHovering);\n  }\n\n  return null;\n};\n\nexport const RunsChartsTooltipBody = ({\n  closeContextMenu,\n  contextData,\n  hoverData,\n  chartData,\n  runUuid,\n  isHovering,\n  mode,\n}: RunsChartsTooltipBodyProps<\n  RunsChartsContextMenuContentDataType,\n  RunsChartContextMenuHoverDataType,\n  RunsMetricsSingleTraceTooltipData | RunsCompareMultipleTracesTooltipData\n>) => {\n  const { runs, onTogglePin, onHideRun } = contextData;\n  const [experimentId] = useExperimentIds();\n  const activeRun = runs?.find((run) => run.uuid === runUuid);\n\n  if (\n    containsMultipleRunsTooltipData(hoverData) &&\n    mode === RunsChartsTooltipMode.MultipleTracesWithScanline &&\n    isHovering\n  ) {\n    return <RunsMultipleTracesTooltipBody hoverData={hoverData} />;\n  }\n\n  const singleTraceHoverData = containsMultipleRunsTooltipData(hoverData) ? hoverData.hoveredDataPoint : hoverData;\n\n  if (!activeRun) {\n    return null;\n  }\n\n  const runName = activeRun.displayName || activeRun.uuid;\n  const metricSuffix = singleTraceHoverData?.metricEntity ? ` (${singleTraceHoverData.metricEntity.key})` : '';\n\n  return (\n    <div>\n      <div css={styles.contentWrapper}>\n        <div css={styles.header}>\n          <div css={styles.colorPill} style={{ backgroundColor: activeRun.color }} />\n          {activeRun.groupParentInfo ? (\n            <Typography.Text>{runName + metricSuffix}</Typography.Text>\n          ) : (\n            <Link\n              to={Routes.getRunPageRoute(experimentId, runUuid)}\n              target=\"_blank\"\n              css={styles.runLink}\n              onClick={closeContextMenu}\n            >\n              {runName + metricSuffix}\n            </Link>\n          )}\n        </div>\n        {!isHovering && (\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscomparetooltipbody.tsx_259\"\n            size=\"small\"\n            onClick={closeContextMenu}\n            icon={<CloseIcon />}\n          />\n        )}\n      </div>\n\n      <ValuesBox\n        isHovering={isHovering}\n        activeRun={activeRun}\n        cardConfig={chartData}\n        hoverData={singleTraceHoverData}\n      />\n\n      <div css={styles.actionsWrapper}>\n        {activeRun.pinnable && onTogglePin && (\n          <LegacyTooltip\n            title={\n              activeRun.pinned ? (\n                <FormattedMessage\n                  defaultMessage=\"Unpin run\"\n                  description=\"A tooltip for the pin icon button in the runs table next to the pinned run\"\n                />\n              ) : (\n                <FormattedMessage\n                  defaultMessage=\"Click to pin the run\"\n                  description=\"A tooltip for the pin icon button in the runs chart tooltip next to the not pinned run\"\n                />\n              )\n            }\n            placement=\"bottom\"\n          >\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscomparetooltipbody.tsx_282\"\n              size=\"small\"\n              onClick={() => {\n                onTogglePin(runUuid);\n                closeContextMenu();\n              }}\n              icon={activeRun.pinned ? <PinFillIcon /> : <PinIcon />}\n            />\n          </LegacyTooltip>\n        )}\n        {onHideRun && (\n          <LegacyTooltip\n            title={\n              <FormattedMessage\n                defaultMessage=\"Click to hide the run\"\n                description='A tooltip for the \"hide\" icon button in the runs chart tooltip'\n              />\n            }\n            placement=\"bottom\"\n          >\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscomparetooltipbody.tsx_302\"\n              data-testid=\"experiment-view-compare-runs-tooltip-visibility-button\"\n              size=\"small\"\n              onClick={() => {\n                onHideRun(runUuid);\n                closeContextMenu();\n              }}\n              icon={<VisibleIcon />}\n            />\n          </LegacyTooltip>\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst styles = {\n  runLink: (theme: Theme) => ({\n    color: theme.colors.primary,\n    '&:hover': {},\n  }),\n  actionsWrapper: {\n    marginTop: 8,\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n  },\n  header: {\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n  },\n  value: {\n    whiteSpace: 'nowrap' as const,\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n  },\n  contentWrapper: {\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n    marginBottom: 12,\n    justifyContent: 'space-between',\n    height: 24,\n  },\n  colorPill: { width: 12, height: 12, borderRadius: '100%' },\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { Data, Datum, Layout, PlotMouseEvent } from 'plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightScatterTraces, useRenderRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  RunsChartAxisDef,\n  runsChartDefaultContourMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  useDynamicPlotSize,\n  getLegendDataFromRuns,\n} from './RunsCharts.common';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\n\nexport interface RunsContourPlotProps extends RunsPlotsCommonProps {\n  /**\n   * Horizontal axis with a metric or a param\n   */\n  xAxis: RunsChartAxisDef;\n\n  /**\n   * Vertical axis with a metric or a param\n   */\n  yAxis: RunsChartAxisDef;\n\n  /**\n   * Depth dimension with a metric or a param\n   */\n  zAxis: RunsChartAxisDef;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: RunsChartsRunData[];\n\n  /**\n   * Sets the color scale in [[0.35, 'rgb(40,60,190)'],[0.5, 'rgb(70,100,245)'],...] format.\n   * Leave unset to use the defualt scale.\n   */\n  colorScale?: [number, string][];\n\n  /**\n   * Set to `true` in order to reverse the color scale.\n   */\n  reverseScale?: boolean;\n}\n\nconst PLOT_CONFIG = {\n  displaylogo: false,\n  scrollZoom: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nconst DEFAULT_COLOR_SCALE: [number, string][] = [\n  [0, 'rgb(5,10,172)'],\n  [0.35, 'rgb(40,60,190)'],\n  [0.5, 'rgb(70,100,245)'],\n  [0.6, 'rgb(90,120,245)'],\n  [0.7, 'rgb(106,137,247)'],\n  [1, 'rgb(220,220,220)'],\n];\n\nexport const createTooltipTemplate = (zAxisTitle: string) =>\n  '<b>%{customdata[1]}:</b><br>' +\n  '<b>%{xaxis.title.text}:</b> %{x:.2f}<br>' +\n  '<b>%{yaxis.title.text}:</b> %{y:.2f}<br>' +\n  `<b>${zAxisTitle}:</b> %{customdata[2]:.2f}` +\n  '<extra></extra>';\n\n/**\n * Implementation of plotly.js chart displaying\n * contour plot comparing values for a given\n * set of experiments runs\n */\nexport const RunsContourPlot = React.memo(\n  ({\n    runsData,\n    xAxis,\n    yAxis,\n    zAxis,\n    markerSize = 10,\n    className,\n    reverseScale,\n    margin = runsChartDefaultContourMargin,\n    colorScale = DEFAULT_COLOR_SCALE,\n    onUpdate,\n    onHover,\n    onUnhover,\n    width,\n    height,\n    useDefaultHoverBox = true,\n    selectedRunUuid,\n    onSetDownloadHandler,\n  }: RunsContourPlotProps) => {\n    const { theme } = useDesignSystemTheme();\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const plotData = useMemo(() => {\n      // Prepare empty values\n      const xValues: (number | string)[] = [];\n      const yValues: (number | string)[] = [];\n      const zValues: (number | string)[] = [];\n      const colors: (number | string)[] = [];\n      const tooltipData: Datum[] = [];\n\n      // Iterate through all the runs and aggregate selected metrics/params\n      for (const runData of runsData) {\n        const { metrics, params, color, uuid, displayName } = runData;\n        const xAxisData = xAxis.type === 'METRIC' ? metrics : params;\n        const yAxisData = yAxis.type === 'METRIC' ? metrics : params;\n        const zAxisData = zAxis.type === 'METRIC' ? metrics : params;\n\n        const x = xAxisData?.[xAxis.key]?.value || undefined;\n        const y = yAxisData?.[yAxis.key]?.value || undefined;\n        const z = zAxisData?.[zAxis.key]?.value || undefined;\n\n        if (x && y && z) {\n          xValues.push(x);\n          yValues.push(y);\n          zValues.push(z);\n          colors.push(color || theme.colors.primary);\n          tooltipData.push([uuid, displayName || uuid, z] as any);\n        }\n      }\n\n      // Let's compile chart layers\n      const layers = [\n        // The top layer with the scatter plot (dots)\n        {\n          x: xValues,\n          y: yValues,\n          customdata: tooltipData,\n          text: runsData.map(({ displayName }) => displayName),\n          hovertemplate: useDefaultHoverBox ? createTooltipTemplate(zAxis.key) : undefined,\n          hoverinfo: useDefaultHoverBox ? undefined : 'none',\n          hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n          type: 'scatter',\n          mode: 'markers',\n          textposition: 'bottom center',\n          marker: {\n            size: markerSize,\n            color: colors,\n            line: {\n              color: 'black',\n              width: 1,\n            },\n          },\n        },\n      ] as Data[];\n\n      // If there are at least two runs, add a contour chart layer\n      if (runsData.length > 1) {\n        layers.unshift({\n          x: xValues,\n          y: yValues,\n          z: zValues,\n          type: 'contour',\n          connectgaps: true,\n          hoverinfo: 'none',\n          contours: {\n            coloring: 'heatmap',\n          },\n          colorscale: colorScale,\n          reversescale: reverseScale,\n          colorbar: {\n            tickfont: { size: 11, color: theme.colors.textSecondary, family: '' },\n          },\n        } as Data);\n      }\n      return layers;\n    }, [\n      colorScale,\n      reverseScale,\n      markerSize,\n      runsData,\n      xAxis.type,\n      xAxis.key,\n      yAxis.type,\n      yAxis.key,\n      zAxis.type,\n      zAxis.key,\n      theme.colors.primary,\n      theme.colors.textSecondary,\n      useDefaultHoverBox,\n    ]);\n\n    const plotlyThemedLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: { title: xAxis.key, tickfont: { size: 11, color: theme.colors.textSecondary } },\n      yaxis: {\n        ticks: 'inside',\n        title: { standoff: 32, text: yAxis.key },\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n      },\n      template: { layout: plotlyThemedLayout },\n    });\n\n    useEffect(() => {\n      setLayout((current) => {\n        const newLayout = {\n          ...current,\n          width: width || layoutWidth,\n          height: height || layoutHeight,\n          margin,\n        };\n\n        if (newLayout.xaxis) {\n          newLayout.xaxis.title = xAxis.key;\n        }\n\n        if (newLayout.yaxis) {\n          newLayout.yaxis.title = { standoff: 32, text: yAxis.key };\n        }\n\n        return newLayout;\n      });\n    }, [layoutWidth, layoutHeight, margin, xAxis.key, yAxis.key, width, height]);\n\n    const { setHoveredPointIndex } = useRenderRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      runsData,\n      highlightScatterTraces,\n    );\n\n    const hoverCallback = useCallback(\n      ({ points }: PlotMouseEvent) => {\n        // Find hover event corresponding to the second curve (scatter plot) only\n        const scatterPoints = points.find(({ curveNumber }) => curveNumber === 1);\n\n        setHoveredPointIndex(scatterPoints?.pointIndex ?? -1);\n\n        if (!scatterPoints) {\n          return;\n        }\n\n        // Find the corresponding run UUID by basing on \"customdata\" field set in the trace data.\n        // Plotly TS typings don't support custom fields so we need to cast to \"any\" first\n        const pointCustomDataRunUuid = (scatterPoints as any)?.customdata?.[0];\n        if (pointCustomDataRunUuid) {\n          onHover?.(pointCustomDataRunUuid);\n        }\n      },\n      [onHover, setHoveredPointIndex],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(hoverCallback);\n\n    const legendLabelData = useMemo(() => getLegendDataFromRuns(runsData), [runsData]);\n\n    useEffect(() => {\n      const dataToExport: Data[] = plotData.map((trace: Data) => ({\n        ...trace,\n        mode: 'text+markers',\n      }));\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layout));\n    }, [layout, onSetDownloadHandler, plotData]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), commonRunsChartStyles.scatterChartHighlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotData}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          onUpdate={onUpdate}\n          layout={layout}\n          config={PLOT_CONFIG}\n          onHover={mutableHoverCallback}\n          onUnhover={unhoverCallback}\n        />\n      </div>\n    );\n\n    return <RunsMetricsLegendWrapper labelData={legendLabelData}>{chart}</RunsMetricsLegendWrapper>;\n  },\n);\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { Config, Data, Layout } from 'plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useIntl } from 'react-intl';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightBarTraces, useRenderRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  runsChartDefaultMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  normalizeChartValue,\n  useDynamicPlotSize,\n  getLegendDataFromRuns,\n} from './RunsCharts.common';\nimport type { MetricEntity } from '../../../types';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\nimport { customMetricBehaviorDefs } from '../../experiment-page/utils/customMetricBehaviorUtils';\n\n// We're not using params in bar plot\nexport type BarPlotRunData = Omit<RunsChartsRunData, 'params' | 'tags' | 'images'>;\n\nexport interface RunsMetricsBarPlotHoverData {\n  xValue: string;\n  yValue: number;\n  index: number;\n  metricEntity?: MetricEntity;\n}\n\nexport interface RunsMetricsBarPlotProps extends RunsPlotsCommonProps {\n  /**\n   * Determines which metric are we comparing by\n   */\n  metricKey: string;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: BarPlotRunData[];\n\n  /**\n   * Relative width of the plot bar\n   */\n  barWidth?: number;\n\n  /**\n   * Display run names on the Y axis\n   */\n  displayRunNames?: boolean;\n\n  /**\n   * Display metric key on the X axis\n   */\n  displayMetricKey?: boolean;\n}\n\nconst PLOT_CONFIG: Partial<Config> = {\n  displaylogo: false,\n  scrollZoom: false,\n  doubleClick: 'autosize',\n  showTips: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nexport const Y_AXIS_PARAMS = {\n  ticklabelposition: 'inside',\n  tickfont: { size: 11 },\n  fixedrange: true,\n};\n\nconst getFixedPointValue = (val: string | number, places = 2) => (typeof val === 'number' ? val.toFixed(places) : val);\n\n/**\n * Implementation of plotly.js chart displaying\n * bar plot comparing metrics for a given\n * set of experiments runs\n */\nexport const RunsMetricsBarPlot = React.memo(\n  ({\n    runsData,\n    metricKey,\n    className,\n    margin = runsChartDefaultMargin,\n    onUpdate,\n    onHover,\n    onUnhover,\n    barWidth = 3 / 4,\n    width,\n    height,\n    displayRunNames = true,\n    useDefaultHoverBox = true,\n    displayMetricKey = true,\n    selectedRunUuid,\n    onSetDownloadHandler,\n  }: RunsMetricsBarPlotProps) => {\n    const plotData = useMemo(() => {\n      // Run uuids\n      const ids = runsData.map((d) => d.uuid);\n\n      // Trace names\n      const names = runsData.map(({ displayName }) => displayName);\n\n      // Actual metric values\n      const values = runsData.map((d) => normalizeChartValue(d.metrics[metricKey]?.value));\n\n      // Displayed metric values\n      const textValues = runsData.map((d) => {\n        const customMetricBehaviorDef = customMetricBehaviorDefs[metricKey];\n        if (customMetricBehaviorDef) {\n          return customMetricBehaviorDef.valueFormatter({ value: d.metrics[metricKey]?.value });\n        }\n\n        return getFixedPointValue(d.metrics[metricKey]?.value);\n      });\n\n      // Colors corresponding to each run\n      const colors = runsData.map((d) => d.color);\n\n      return [\n        {\n          y: ids,\n          x: values,\n          names,\n          text: textValues,\n          textposition: values.map((value) => (value === 0 ? 'outside' : 'auto')),\n          textfont: {\n            size: 11,\n          },\n          metrics: runsData.map((d) => d.metrics[metricKey]),\n          // Display run name on hover. \"<extra></extra>\" removes plotly's \"extra\" tooltip that\n          // is unnecessary here.\n          type: 'bar' as any,\n          hovertemplate: useDefaultHoverBox ? '%{label}<extra></extra>' : undefined,\n          hoverinfo: useDefaultHoverBox ? 'y' : 'none',\n          hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n          width: barWidth,\n\n          orientation: 'h',\n          marker: {\n            color: colors,\n          },\n        } as Data & { names: string[] },\n      ];\n    }, [runsData, metricKey, barWidth, useDefaultHoverBox]);\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const { formatMessage } = useIntl();\n    const { theme } = useDesignSystemTheme();\n    const plotlyThemedLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      hovermode: 'y',\n      margin,\n      xaxis: {\n        title: displayMetricKey ? metricKey : undefined,\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n        tickformat: customMetricBehaviorDefs[metricKey]?.chartAxisTickFormat ?? undefined,\n      },\n      yaxis: {\n        showticklabels: displayRunNames,\n        title: displayRunNames\n          ? formatMessage({\n              defaultMessage: 'Run name',\n              description: 'Label for Y axis in bar chart when comparing metrics between runs',\n            })\n          : undefined,\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n        fixedrange: true,\n      },\n      template: { layout: plotlyThemedLayout },\n    });\n\n    useEffect(() => {\n      setLayout((current) => ({\n        ...current,\n        width: width || layoutWidth,\n        height: height || layoutHeight,\n        margin,\n        xaxis: {\n          ...current.xaxis,\n          title: displayMetricKey ? metricKey : undefined,\n        },\n      }));\n    }, [layoutWidth, layoutHeight, margin, metricKey, width, height, displayMetricKey]);\n\n    const { setHoveredPointIndex } = useRenderRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      runsData,\n      highlightBarTraces,\n    );\n\n    const hoverCallback = useCallback(\n      ({ points, event }) => {\n        const metricEntity = points[0].data?.metrics[points[0].pointIndex];\n        setHoveredPointIndex(points[0]?.pointIndex ?? -1);\n\n        const hoverData: RunsMetricsBarPlotHoverData = {\n          xValue: points[0].x,\n          yValue: points[0].value,\n          // The index of the X datum\n          index: points[0].pointIndex,\n          metricEntity,\n        };\n\n        const runUuid = points[0]?.label;\n        if (runUuid) {\n          onHover?.(runUuid, event, hoverData);\n        }\n      },\n      [onHover, setHoveredPointIndex],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(hoverCallback);\n\n    const legendLabelData = useMemo(() => getLegendDataFromRuns(runsData), [runsData]);\n\n    useEffect(() => {\n      // Prepare layout and data traces to export\n      const layoutToExport = {\n        ...layout,\n        yaxis: {\n          ...layout.yaxis,\n          showticklabels: true,\n          automargin: true,\n        },\n      };\n\n      const dataToExport = plotData.map((trace) => ({\n        ...trace,\n        // In exported image, use names for Y axes\n        y: trace.names,\n      }));\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layoutToExport));\n    }, [layout, onSetDownloadHandler, plotData]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), styles.highlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotData}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          onUpdate={onUpdate}\n          layout={layout}\n          config={PLOT_CONFIG}\n          onHover={mutableHoverCallback}\n          onUnhover={unhoverCallback}\n        />\n      </div>\n    );\n\n    return <RunsMetricsLegendWrapper labelData={legendLabelData}>{chart}</RunsMetricsLegendWrapper>;\n  },\n);\n\nconst styles = {\n  highlightStyles: {\n    '.trace.bars g.point path': {\n      transition: 'var(--trace-transition)',\n    },\n    '.trace.bars.is-highlight g.point path': {\n      opacity: 'var(--trace-opacity-dimmed-high) !important',\n    },\n    '.trace.bars g.point.is-hover-highlight path': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n    },\n    '.trace.bars g.point.is-selection-highlight path': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n      stroke: 'var(--trace-stroke-color)',\n      strokeWidth: 'var(--trace-stroke-width) !important',\n    },\n  },\n};\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\n\nimport React from 'react';\nimport { Dash } from 'plotly.js';\n\nconst STROKE_WIDTH = 3;\n\n/**\n * Replicating plotly.js's dasharrays for each dash type, with smaller spaces\n * https://github.com/plotly/plotly.js/blob/master/src/components/drawing/index.js#L162\n */\nconst getDashArray = (dashType: Dash) => {\n  switch (dashType) {\n    case 'dot':\n      return `${STROKE_WIDTH}`;\n    case 'dash':\n      return `${2 * STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    case 'longdash':\n      return `${3 * STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    case 'dashdot':\n      return `${2 * STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    case 'longdashdot':\n      return `${3 * STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    default:\n      return '';\n  }\n};\n\nexport type LegendLabelData = {\n  label: string;\n  color: string;\n  dashStyle?: Dash;\n  uuid?: string;\n  metricKey?: string;\n};\n\nconst TraceLabel: React.FC<LegendLabelData> = ({ label, color, dashStyle }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        alignItems: 'center',\n        textOverflow: 'ellipsis',\n        flexShrink: 0,\n        marginRight: theme.spacing.md,\n        maxWidth: '100%',\n      }}\n    >\n      <TraceLabelColorIndicator color={color} dashStyle={dashStyle} />\n      <Typography.Text\n        color=\"secondary\"\n        size=\"sm\"\n        css={{ whiteSpace: 'nowrap', textOverflow: 'ellipsis', overflow: 'hidden' }}\n      >\n        {label}\n      </Typography.Text>\n    </div>\n  );\n};\n\nexport const TraceLabelColorIndicator: React.FC<Pick<LegendLabelData, 'color' | 'dashStyle'>> = ({\n  color,\n  dashStyle,\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const strokeDasharray = dashStyle ? getDashArray(dashStyle) : undefined;\n  const pathYOffset = theme.typography.fontSizeSm / 2;\n\n  return (\n    <svg\n      css={{\n        height: theme.typography.fontSizeSm,\n        width: STROKE_WIDTH * 8,\n        marginRight: theme.spacing.xs,\n        flexShrink: 0,\n      }}\n    >\n      <path\n        d={`M0,${pathYOffset}h${STROKE_WIDTH * 8}`}\n        style={{\n          strokeWidth: STROKE_WIDTH,\n          stroke: color,\n          strokeDasharray,\n        }}\n      />\n    </svg>\n  );\n};\ntype RunsMetricsLegendProps = {\n  labelData: LegendLabelData[];\n  height: number;\n  fullScreen?: boolean;\n};\n\nconst RunsMetricsLegend: React.FC<RunsMetricsLegendProps> = ({ labelData, height, fullScreen }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexWrap: 'wrap',\n        height,\n        alignContent: fullScreen ? 'flex-start' : 'normal',\n        gap: fullScreen ? theme.spacing.sm : 0,\n        overflowY: 'auto',\n        overflowX: 'hidden',\n        marginTop: fullScreen ? theme.spacing.lg : theme.spacing.sm,\n      }}\n    >\n      {labelData.map((labelDatum) => (\n        <TraceLabel key={labelDatum.label} {...labelDatum} />\n      ))}\n    </div>\n  );\n};\n\nexport default RunsMetricsLegend;\n","import React from 'react';\n\nimport RunsMetricsLegend, { LegendLabelData } from './RunsMetricsLegend';\nimport { useDesignSystemTheme } from '@databricks/design-system';\n\nconst RunsMetricsLegendWrapper = ({\n  labelData,\n  fullScreen,\n  children,\n}: React.PropsWithChildren<{\n  labelData: LegendLabelData[];\n  fullScreen?: boolean;\n}>) => {\n  const { theme } = useDesignSystemTheme();\n\n  const FULL_SCREEN_LEGEND_HEIGHT = 100;\n  const LEGEND_HEIGHT = 32;\n\n  const height = fullScreen ? FULL_SCREEN_LEGEND_HEIGHT : LEGEND_HEIGHT;\n  const heightBuffer = fullScreen ? theme.spacing.lg : theme.spacing.md;\n\n  return (\n    <>\n      <div css={{ height: `calc(100% - ${height + heightBuffer}px)` }}>{children}</div>\n      <RunsMetricsLegend labelData={labelData} height={height} fullScreen={fullScreen} />\n    </>\n  );\n};\n\nexport default RunsMetricsLegendWrapper;\n","import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport type { Figure } from 'react-plotly.js';\nimport type {\n  LineChartTraceData,\n  RunsCompareMultipleTracesTooltipData,\n  RunsMetricsLinePlotProps,\n  RunsMetricsSingleTraceTooltipData,\n} from '../components/RunsMetricsLinePlot';\nimport { compact, isNumber, isString, isUndefined, orderBy, throttle, uniq } from 'lodash';\nimport type { LegendLabelData } from '../components/RunsMetricsLegend';\nimport { RunsChartsLineChartXAxisType } from '../components/RunsCharts.common';\n\n// Plotly-specific selectors for finding particular elements of interest in the plot DOM structure\nconst PLOTLY_SVG_SELECTOR = '.main-svg';\nconst PLOTLY_DRAGLAYER_SELECTOR = '.main-svg .draglayer .nsewdrag';\n\n// Interval for throttling the tooltip data update handler\nconst TOOLTIP_DATA_UPDATE_INTERVAL = 50;\n\n/**\n * Utility function, parses the microseconds from the plotly's axis boundary string\n * which are not supported by JavaScript's Date object and have to be added manually.\n *\n * E.g. transforms 2024-02-02 14:35:37.5747 into 0.7\n */\nconst parseMicroseconds = (plotlyAxisBoundary: string) => {\n  const microsecondsString =\n    isString(plotlyAxisBoundary) && plotlyAxisBoundary.match(/[0-9]{2}:[0-9]{2}:[0-9]{2}\\.([0-9]+)/)?.[1];\n  if (!microsecondsString) {\n    return 0;\n  }\n\n  // We turn the microseconds into a fraction of a millisecond, e.g. 0.5743 -> 574.3 -> 0.3\n  return (Number(`0.${microsecondsString}`) * 1000) % 1;\n};\n\nexport const useRunsMultipleTracesTooltipData = ({\n  onUnhover,\n  onHover,\n  runsData,\n  plotData,\n  legendLabelData,\n  containsMultipleMetricKeys,\n  xAxisKeyLabel,\n  xAxisKey,\n  disabled,\n  setHoveredPointIndex,\n  xAxisScaleType = 'linear',\n}: Pick<RunsMetricsLinePlotProps, 'runsData' | 'onHover' | 'onUnhover'> & {\n  plotData: LineChartTraceData[];\n  legendLabelData: LegendLabelData[];\n  containsMultipleMetricKeys?: boolean;\n  xAxisKeyLabel: string;\n  disabled: boolean;\n  xAxisKey: RunsChartsLineChartXAxisType;\n  setHoveredPointIndex: (value: number) => void;\n  xAxisScaleType?: 'linear' | 'log';\n}) => {\n  // Save current boundaries/dimensions of the plot in the mutable ref object\n  const chartBoundaries = useRef<{\n    containerLeftPixels: number;\n    plotWidthPixels: number;\n    plotOffsetPixels: number;\n    lowerBoundValue: number;\n    valueRange: number;\n    mainContainer: SVGElement | null;\n    dragLayer: SVGElement | null;\n    initialized: boolean;\n  }>({\n    containerLeftPixels: 0,\n    plotWidthPixels: 0,\n    plotOffsetPixels: 0,\n    lowerBoundValue: 0,\n    valueRange: 0,\n    mainContainer: null,\n    dragLayer: null,\n    initialized: false,\n  });\n\n  // Keep the reference to the scanline element\n  const scanlineElementRef = useRef<HTMLDivElement>(null);\n\n  // Keep the reference to the current hovered trace data\n  const currentHoveredDataPoint = useRef<RunsMetricsSingleTraceTooltipData | undefined>(undefined);\n\n  // Calculate all visible X values each time the plot data changes\n  const visibleXValues = useMemo(() => uniq(plotData.map(({ x }) => x).flat()) as number[], [plotData]);\n\n  // Store the reference to the initialized plotly's figure object, helps keep track when the plot is initialized\n  const [initializedFigure, setInitializedFigure] = useState<{\n    figure: Readonly<Figure>;\n    graphDiv: Readonly<HTMLElement>;\n  } | null>(null);\n\n  // We are calculating the tooltip data outside of React to avoid unnecessary re-renders,\n  // so we're copying all the input data to the mutable ref objects\n  const immediateHoverData = useRef<RunsCompareMultipleTracesTooltipData | undefined>(undefined);\n  const immediateLegendLabelData = useRef(legendLabelData);\n  const immediateRunsData = useRef(runsData);\n  const immediatePlotData = useRef(plotData);\n  const immediateXValuesData = useRef(visibleXValues);\n\n  // Update the mutable ref objects when the input data changes\n  immediateLegendLabelData.current = legendLabelData;\n  immediateRunsData.current = runsData;\n  immediatePlotData.current = plotData;\n  immediateXValuesData.current = visibleXValues;\n\n  // Setup the boundaries of the plot\n  const setupBoundaries = useCallback((figure: Readonly<Figure>) => {\n    const lowerAxisValue = figure.layout.xaxis?.range?.[0];\n    const upperAxisValue = figure.layout.xaxis?.range?.[1];\n\n    // If the axis values are numbers, use them as is, otherwise convert them to timestamps\n    let lowerBoundary = isNumber(lowerAxisValue) ? lowerAxisValue : new Date(lowerAxisValue ?? 0).getTime();\n    let upperBoundary = isNumber(upperAxisValue) ? upperAxisValue : new Date(upperAxisValue ?? 0).getTime();\n\n    lowerBoundary += parseMicroseconds(lowerAxisValue);\n    upperBoundary += parseMicroseconds(upperAxisValue);\n\n    // Save the boundaries to the mutable ref object\n    chartBoundaries.current.lowerBoundValue = lowerBoundary ?? 0;\n    chartBoundaries.current.valueRange = (upperBoundary ?? 0) - chartBoundaries.current.lowerBoundValue;\n  }, []);\n\n  const updateContainerPosition = useCallback(() => {\n    const { mainContainer, dragLayer } = chartBoundaries.current;\n\n    if (mainContainer && dragLayer) {\n      const containerRect = mainContainer.getBoundingClientRect();\n      const dragLayerRect = dragLayer.getBoundingClientRect();\n\n      // Save the boundaries to the mutable ref object\n      chartBoundaries.current.containerLeftPixels = containerRect.x;\n      chartBoundaries.current.plotWidthPixels = dragLayerRect.width;\n      chartBoundaries.current.plotOffsetPixels = dragLayerRect.x - containerRect.x;\n      chartBoundaries.current.initialized = dragLayerRect.width > 0;\n    }\n  }, []);\n\n  // This is a handler of plotly's onUpdate callback.\n  // It is called when the plot is initialized and when the plot is updated.\n  const onUpdatePlotHandler = useCallback(\n    (figure: Readonly<Figure>, graphDiv: Readonly<HTMLElement>) => {\n      setupBoundaries(figure);\n\n      const mainContainer: SVGElement | null = graphDiv.querySelector(PLOTLY_SVG_SELECTOR);\n      const dragLayer: SVGElement | null = graphDiv.querySelector(PLOTLY_DRAGLAYER_SELECTOR);\n\n      chartBoundaries.current.mainContainer = mainContainer;\n      chartBoundaries.current.dragLayer = dragLayer;\n      updateContainerPosition();\n    },\n    [setupBoundaries, updateContainerPosition],\n  );\n\n  // This is a handler of plotly's onInit callback.\n  const onInitPlotHandler = useCallback(\n    (figure: Readonly<Figure>, graphDiv: Readonly<HTMLElement>) => {\n      setInitializedFigure({ figure, graphDiv });\n      onUpdatePlotHandler(figure, graphDiv);\n    },\n    [onUpdatePlotHandler],\n  );\n\n  // Hides the scanline when the mouse leaves the plot\n  const pointerLeavePlotCallback = useCallback(\n    (e: PointerEvent) => {\n      // Noop if the mouse is moving to plotly's dragcover element\n      if (e.relatedTarget instanceof Element && e.relatedTarget.classList.contains('dragcover')) {\n        return;\n      }\n      onUnhover?.();\n      if (scanlineElementRef.current) {\n        scanlineElementRef.current.style.display = 'none';\n      }\n    },\n    [onUnhover],\n  );\n\n  // This is a handler of plotly's onHover callback.\n  const onPointHoverCallback = useCallback(\n    ({ points }) => {\n      const hoveredPoint = points[0];\n      const hoveredPointData = hoveredPoint?.data;\n\n      setHoveredPointIndex(hoveredPoint?.curveNumber ?? -1);\n\n      if (!hoveredPointData) {\n        return;\n      }\n\n      // Extract metric entity\n      const metricEntity = hoveredPointData.metricHistory?.[hoveredPoint.pointIndex];\n\n      const singleTraceData: RunsMetricsSingleTraceTooltipData = {\n        // Value of the \"x\" axis (time, step)\n        xValue: hoveredPoint.x,\n        // Value of the \"y\" axis\n        yValue: hoveredPoint.y,\n        // Metric entity value\n        metricEntity,\n        // The index of the X datum\n        index: hoveredPoint.pointIndex,\n        // Current label (\"Step\", \"Time\" etc.)\n        label: xAxisKeyLabel,\n        // Run/group UUID\n        traceUuid: hoveredPointData.uuid,\n      };\n\n      // Save the hovered point/trace data to the mutable ref object\n      currentHoveredDataPoint.current = singleTraceData;\n    },\n    [xAxisKeyLabel, setHoveredPointIndex],\n  );\n\n  // This is a handler of plotly's onUnhover callback.\n  const onPointUnhoverCallback = useCallback(() => {\n    currentHoveredDataPoint.current = undefined;\n    setHoveredPointIndex(-1);\n  }, [setHoveredPointIndex]);\n\n  const getClosestXValue = useCallback(\n    (pointerClientX: number) => {\n      const boundaries = chartBoundaries.current;\n      // Calculate the X value of the hovered point\n      const resultX =\n        (pointerClientX - boundaries.plotOffsetPixels - boundaries.containerLeftPixels) / boundaries.plotWidthPixels;\n\n      // Calculate the current step based on the X value and precalculated boundaries\n      let currentStep = boundaries.lowerBoundValue + boundaries.valueRange * resultX;\n      if (xAxisScaleType === 'log') {\n        currentStep = 10 ** currentStep;\n      }\n      // Find the closest existing X value to the currently hovered value\n      const closestXValue = immediateXValuesData.current.reduce((acc, x) => {\n        if (Math.abs(x - currentStep) < Math.abs(acc - currentStep)) {\n          return x;\n        }\n        return acc;\n      }, immediateXValuesData.current[0]);\n      return closestXValue;\n    },\n    [xAxisScaleType],\n  );\n\n  useEffect(() => {\n    // Return early if this tooltip is disabled\n    if (disabled) {\n      return;\n    }\n    // Return early if the figure is not initialized yet\n    if (!initializedFigure) {\n      return;\n    }\n\n    // Setup the boundaries of the plot at the beginning\n    setupBoundaries(initializedFigure.figure);\n\n    // Get the drag layer element - this is the event-sensitive layer of rendered plotly chart\n    const dragLayer: SVGElement | null = initializedFigure.graphDiv.querySelector(PLOTLY_DRAGLAYER_SELECTOR);\n\n    // This is a throttled handler of the pointermove event, it contains some heavier logic so it's throttled for 50ms\n    const tooltipDataUpdateHandler = throttle(\n      (e: PointerEvent) => {\n        // If for some reason the chart sizing is not initialized yet, do it now\n        if (!chartBoundaries.current.initialized) {\n          updateContainerPosition();\n        }\n        const closestXValue = getClosestXValue(e.clientX);\n\n        // Calculate the tooltip data - based on existing legend, plot and runs data\n        const data = immediateLegendLabelData.current.map((legendEntry) => {\n          // First, find the corresponding data entry (from chart components's input data) and trace (from data prepared for plotly)\n          const correspondingDataEntry = immediateRunsData.current.find(({ uuid }) => uuid === legendEntry.uuid);\n          const correspondingDataTrace = immediatePlotData.current.find(\n            ({ uuid, metricKey }) => uuid === legendEntry.uuid && legendEntry.metricKey === metricKey,\n          );\n\n          if (!correspondingDataTrace) {\n            return undefined;\n          }\n\n          // Determine the display name of the metric - if there are multiple metrics, use the legend label,\n          // otherwise use the display name of the corresponding data entry.\n          const displayName = containsMultipleMetricKeys ? legendEntry.label : correspondingDataEntry?.displayName;\n\n          // Find the value of the corresponding data trace at the closest X value\n          const xIndex = correspondingDataTrace.x?.indexOf(closestXValue);\n          if (isUndefined(xIndex) || xIndex === -1) {\n            return undefined;\n          }\n          const value = correspondingDataTrace.y?.[xIndex];\n\n          // Construct the tooltip legend entry\n          return {\n            displayName: displayName || '',\n            value: isNumber(value) ? value : undefined,\n            color: legendEntry?.color,\n            dashStyle: legendEntry?.dashStyle,\n            uuid: `${legendEntry.uuid}.${legendEntry.metricKey}`,\n          };\n        });\n\n        // Save the tooltip data to the mutable ref object\n        immediateHoverData.current = {\n          tooltipLegendItems: orderBy(compact(data), 'value', 'desc'),\n          hoveredDataPoint: currentHoveredDataPoint?.current,\n          xValue: closestXValue,\n          xAxisKey,\n          xAxisKeyLabel,\n        };\n      },\n      TOOLTIP_DATA_UPDATE_INTERVAL,\n      { leading: true },\n    );\n\n    const windowResizeHandler = throttle(updateContainerPosition, TOOLTIP_DATA_UPDATE_INTERVAL);\n\n    // This is a handler of the pointermove event.\n    // It's not throttled: it just updates the scanline and tooltip position and pass precalculated tooltip data\n    const hoverHandler = (e: PointerEvent) => {\n      if (!immediateHoverData.current) {\n        return;\n      }\n\n      const boundaries = chartBoundaries.current;\n      const closestXValue = getClosestXValue(e.clientX);\n      const closestXValueLeftX =\n        ((xAxisScaleType === 'log' ? Math.log10(closestXValue) : closestXValue) - boundaries.lowerBoundValue) /\n        boundaries.valueRange;\n      const closestXValueLeftInPixels = closestXValueLeftX * boundaries.plotWidthPixels;\n\n      // Enable and reposition the scanline\n      if (scanlineElementRef.current) {\n        scanlineElementRef.current.style.display = 'block';\n        scanlineElementRef.current.style.left = `${boundaries.plotOffsetPixels + closestXValueLeftInPixels}px`;\n      }\n\n      onHover?.(\n        immediateHoverData.current?.hoveredDataPoint?.traceUuid || '',\n        {\n          x: boundaries.containerLeftPixels + boundaries.plotOffsetPixels + closestXValueLeftInPixels,\n          y: e.clientY,\n          originalEvent: e,\n        },\n        immediateHoverData.current,\n      );\n    };\n\n    if (dragLayer) {\n      // Assign two separate handlers for move: one for updating the tooltip data, one for updating the scanline and tooltip position\n      dragLayer.addEventListener('pointermove', tooltipDataUpdateHandler);\n      dragLayer.addEventListener('pointermove', hoverHandler);\n      window.addEventListener('resize', windowResizeHandler);\n\n      // Assign a handler that hides the scanline and tooltip\n      dragLayer.addEventListener('pointerleave', pointerLeavePlotCallback);\n      return () => {\n        dragLayer.removeEventListener('pointermove', tooltipDataUpdateHandler);\n        dragLayer.removeEventListener('pointermove', hoverHandler);\n        dragLayer.removeEventListener('pointerleave', pointerLeavePlotCallback);\n        window.removeEventListener('resize', windowResizeHandler);\n      };\n    }\n\n    return () => {};\n  }, [\n    pointerLeavePlotCallback,\n    initializedFigure,\n    setupBoundaries,\n    onHover,\n    containsMultipleMetricKeys,\n    currentHoveredDataPoint,\n    disabled,\n    xAxisKey,\n    xAxisKeyLabel,\n    xAxisScaleType,\n    getClosestXValue,\n    updateContainerPosition,\n  ]);\n\n  const scanlineElement = disabled ? null : (\n    <div\n      css={{\n        top: 0,\n        width: 0,\n        borderLeft: `1px dashed rgba(0,0,0,0.5)`,\n        height: '100%',\n        position: 'absolute',\n        pointerEvents: 'none',\n      }}\n      ref={scanlineElementRef}\n      style={{ display: 'none' }}\n    />\n  );\n\n  return {\n    updateHandler: onUpdatePlotHandler,\n    initHandler: onInitPlotHandler,\n    scanlineElement,\n    onPointHover: onPointHoverCallback,\n    onPointUnhover: onPointUnhoverCallback,\n  };\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { compact, isEmpty, isEqual, maxBy, minBy } from 'lodash';\nimport { Config, Dash, Data as PlotlyData, Datum, Layout, LayoutAxis, TypedArray } from 'plotly.js';\nimport { Figure } from 'react-plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useIntl } from 'react-intl';\nimport { MetricEntity } from '../../../types';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightLineTraces, useRenderRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  runsChartDefaultMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  normalizeChartValue,\n  useDynamicPlotSize,\n  getLineChartLegendData,\n  lineDashStyles,\n  containsDuplicateXValues,\n  createFadedTraceColor,\n  getChartAxisLabelDescriptor,\n  RunsChartsLineChartXAxisType,\n} from './RunsCharts.common';\nimport { EMA } from '../../MetricsPlotView';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport {\n  shouldEnableDeepLearningUIPhase3,\n  shouldEnableManualRangeControls,\n  shouldEnableChartsOriginalLinesWhenSmoothing,\n  shouldEnableRelativeTimeDateAxis,\n} from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { useRunsMultipleTracesTooltipData } from '../hooks/useRunsChartsMultipleTracesTooltip';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\nimport {\n  EPOCH_RELATIVE_TIME,\n  HOUR_IN_MILLISECONDS,\n  LINE_CHART_RELATIVE_TIME_THRESHOLD,\n} from '@mlflow/mlflow/src/experiment-tracking/constants';\n\nexport type LineChartTraceData = PlotlyData & {\n  x?: number[] | undefined;\n  y?: number[];\n  uuid?: string;\n  metricKey?: string;\n};\n\n// Display markers only if there are less than 60 points in the single data trace\nconst MARKER_DISPLAY_THRESHOLD = 60;\n\nconst getDataTraceForRun = ({\n  runEntry,\n  metricKey,\n  xAxisKey,\n  selectedXAxisMetricKey,\n  useDefaultHoverBox,\n  lineSmoothness,\n  lineShape,\n  lineDash,\n  displayPoints,\n  displayOriginalLine: originalLine,\n}: {\n  runEntry: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>;\n  metricKey: RunsMetricsLinePlotProps['metricKey'];\n  xAxisKey: RunsMetricsLinePlotProps['xAxisKey'];\n  selectedXAxisMetricKey: RunsMetricsLinePlotProps['selectedXAxisMetricKey'];\n  useDefaultHoverBox: RunsMetricsLinePlotProps['useDefaultHoverBox'];\n  lineSmoothness: RunsMetricsLinePlotProps['lineSmoothness'];\n  lineShape: RunsMetricsLinePlotProps['lineShape'];\n  lineDash?: Dash;\n  displayPoints?: boolean;\n  displayOriginalLine?: boolean;\n}): LineChartTraceData => {\n  if (!runEntry.metricsHistory) {\n    return {};\n  }\n\n  const sortedMetricsHistory = runEntry.metricsHistory[metricKey]?.sort((a, b) =>\n    xAxisKey === RunsChartsLineChartXAxisType.STEP ? a.step - b.step : a.timestamp - b.timestamp,\n  );\n\n  let xValues;\n  let yValues;\n  if (xAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n    const ySteps = new Set((sortedMetricsHistory ?? []).map(({ step }) => step));\n    const xValuesWithSteps = prepareXAxisDataForMetricType(ySteps, runEntry.metricsHistory[selectedXAxisMetricKey]);\n    const stepOrder = xValuesWithSteps.map(({ step }) => step);\n    const xSteps = new Set(stepOrder);\n    const yValueHistory = orderBySteps(sortedMetricsHistory ?? [], stepOrder).filter(({ step }) => xSteps.has(step));\n\n    xValues = xValuesWithSteps.map(({ value }) => value);\n    yValues = yValueHistory.map(({ value }) => normalizeChartValue(value));\n  } else {\n    xValues = prepareMetricHistoryByAxisType(sortedMetricsHistory, xAxisKey);\n    yValues = sortedMetricsHistory?.map(({ value }) => normalizeChartValue(value));\n  }\n\n  // If there are any duplicate X values, use linear line shape\n  // to avoid bending splines in the wrong direction\n  const optimizedLineShape = containsDuplicateXValues(xValues) ? 'linear' : lineShape;\n\n  // Use chart card's configuration or if its unset, use the automatic behavior by checking the number of points\n  const shouldDisplayMarkers = !originalLine && (displayPoints ?? xValues.length < MARKER_DISPLAY_THRESHOLD);\n\n  const containsSingleValue = yValues?.length === 1;\n\n  const hoverinfo = (() => {\n    if (originalLine) {\n      return 'skip';\n    }\n    if (useDefaultHoverBox) {\n      return undefined;\n    }\n    return 'none';\n  })();\n\n  return {\n    // Let's add UUID to each run so it can be distinguished later (e.g. on hover)\n    uuid: runEntry.uuid,\n    name: runEntry.runInfo?.runName || '',\n    x: xValues,\n    // The actual value is on Y axis\n    y: EMA(yValues ?? [], originalLine ? 0 : lineSmoothness),\n    // Save the metric history\n    metricHistory: sortedMetricsHistory,\n    metricKey,\n    hovertext: runEntry.runInfo?.runName || '',\n    text: 'x',\n    textposition: 'outside',\n    textfont: {\n      size: 11,\n    },\n    mode: containsSingleValue || shouldDisplayMarkers ? 'lines+markers' : 'lines',\n    hovertemplate: useDefaultHoverBox ? createTooltipTemplate(runEntry.runInfo?.runName || '') : undefined,\n    hoverinfo,\n    hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n    type: 'scatter',\n    line: { dash: lineDash, shape: optimizedLineShape },\n    marker: {\n      color: originalLine ? createFadedTraceColor(runEntry.color, 0.15) : runEntry.color,\n    },\n  } as LineChartTraceData;\n};\n\nconst getBandTraceForRun = ({\n  runEntry,\n  metricKey,\n  lineShape,\n  xAxisKey,\n  selectedXAxisMetricKey,\n}: {\n  runEntry: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>;\n  metricKey: RunsMetricsLinePlotProps['metricKey'];\n  lineShape: RunsMetricsLinePlotProps['lineShape'];\n  xAxisKey: RunsChartsLineChartXAxisType;\n  selectedXAxisMetricKey: RunsMetricsLinePlotProps['selectedXAxisMetricKey'];\n}): LineChartTraceData => {\n  if (!runEntry.aggregatedMetricsHistory) {\n    return {};\n  }\n\n  // Get upper and lower boundaries to draw a band\n  const { max, min } = runEntry.aggregatedMetricsHistory[metricKey];\n\n  let xMins, xMaxes, yMins, yMaxes;\n  if (xAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n    if (!runEntry.metricsHistory) {\n      return {};\n    }\n    const ySteps = new Set(max.map(({ step }) => step));\n    const xValuesWithSteps = prepareXAxisDataForMetricType(ySteps, runEntry.metricsHistory[selectedXAxisMetricKey]);\n    const stepOrder = xValuesWithSteps.map((e) => e.step);\n    const xSteps = new Set(stepOrder);\n    const xValues = xValuesWithSteps.map((e) => e.value);\n\n    yMins = orderBySteps(min, stepOrder)\n      .filter(({ step }) => xSteps.has(step))\n      .map(({ value }) => normalizeChartValue(value))\n      .reverse();\n    yMaxes = orderBySteps(max, stepOrder)\n      .filter(({ step }) => xSteps.has(step))\n      .map(({ value }) => normalizeChartValue(value));\n    xMins = xValues.slice().reverse();\n    xMaxes = xValues;\n  } else {\n    // Reverse one of the arrays so that the band is drawn correctly\n    const minReversed = min.slice().reverse();\n    xMins = prepareMetricHistoryByAxisType(minReversed, xAxisKey);\n    xMaxes = prepareMetricHistoryByAxisType(max, xAxisKey);\n    yMins = minReversed.map(({ value }) => normalizeChartValue(value));\n    yMaxes = max.map(({ value }) => normalizeChartValue(value));\n  }\n\n  // Place a null value in the middle to create a gap, otherwise Plotly will\n  // connect the lines and the fill will be drawn incorrectly\n  const xValues = [...xMins, null, ...xMaxes];\n  const bandValues = [...yMins, null, ...yMaxes];\n\n  return {\n    name: runEntry.runInfo?.runName || '',\n    x: xValues,\n    y: bandValues,\n    fillcolor: createFadedTraceColor(runEntry.color, 0.2),\n    hovertemplate: undefined,\n    hoverlabel: undefined,\n    hoverinfo: 'skip',\n    line: { color: 'transparent', shape: lineShape },\n    fill: 'tozeroy',\n    type: 'scatter',\n  } as LineChartTraceData;\n};\n\n/**\n * This function takes a list of metric entities and returns a copy ordered by\n * the step order provided. This is used in metric-type X axes, where the Y values\n * need to be ordered by the X values.\n *\n * For example:\n * dataPoints = [{step: 0, value: 1}, {step: 1, value: 2}, {step: 2, value: 3}]\n * stepOrder = [2, 0, 1]\n * return = [{step: 2, value: 3}, {step: 0, value: 1}, {step: 1, value: 2}]\n */\nconst orderBySteps = (dataPoints: MetricEntity[], stepOrder: number[]) => {\n  const stepIndexes = stepOrder.reduce((acc, step, idx) => {\n    acc[step] = idx;\n    return acc;\n  }, {} as Record<number, number>);\n\n  // if there's a step mismatch, send all non-existing values to the end\n  return dataPoints.slice().sort((a, b) => (stepIndexes[a.step] ?? Infinity) - (stepIndexes[b.step] ?? Infinity));\n};\n\nexport interface RunsMetricsSingleTraceTooltipData {\n  xValue: string | number;\n  yValue: number;\n  index: number;\n  label: string;\n  traceUuid?: string;\n  metricEntity?: MetricEntity;\n}\n\nexport interface RunsCompareMultipleTracesTooltipData {\n  tooltipLegendItems: {\n    uuid: string;\n    color?: string;\n    dashStyle?: Dash;\n    displayName: string;\n    value?: string | number;\n  }[];\n  xValue: string | number;\n  xAxisKey: RunsChartsLineChartXAxisType;\n  xAxisKeyLabel: string;\n  hoveredDataPoint?: RunsMetricsSingleTraceTooltipData;\n}\n\nexport interface RunsMetricsLinePlotProps extends RunsPlotsCommonProps {\n  /**\n   * Determines which metric are we comparing by\n   * NOTE: used only as a fallback in V2 charts\n   */\n  metricKey: string;\n\n  /**\n   * Determines which metric keys to display in V2 charts\n   * NOTE: this prop may not be present in V1 chart configs\n   */\n  selectedMetricKeys?: string[];\n\n  /**\n   * Smoothing factor for EMA\n   */\n  lineSmoothness?: number;\n\n  /**\n   * X axis mode\n   */\n  xAxisScaleType?: 'linear' | 'log';\n\n  /**\n   * Y axis mode\n   */\n  scaleType?: 'linear' | 'log';\n\n  /**\n   * Use spline or polyline. Spline is default mode.\n   */\n  lineShape?: 'linear' | 'spline';\n\n  /**\n   * Choose X axis mode - numeric step or absolute time\n   */\n  xAxisKey?: RunsChartsLineChartXAxisType;\n\n  /**\n   * Name of the metric to use for the X axis. Used when xAxisKey is set to 'metric'\n   */\n  selectedXAxisMetricKey: string;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>[];\n\n  /**\n   * Currently visible range on x-axis.\n   */\n  xRange?: [number | string, number | string];\n\n  /**\n   * Currently visible range on y-axis\n   */\n  yRange?: [number | string, number | string];\n\n  /**\n   * If set to true, only x-axis can be zoomed by dragging\n   */\n  lockXAxisZoom?: boolean;\n\n  /**\n   * Display points on the line chart. Undefined means \"auto\" mode, i.e. display points only when\n   * there are fewer than 60 datapoints on the chart.\n   */\n  displayPoints?: boolean;\n}\n\nconst PLOT_CONFIG: Partial<Config> = {\n  displaylogo: false,\n  doubleClick: 'autosize',\n  scrollZoom: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nexport const createTooltipTemplate = (runName: string) =>\n  `<b>${runName}</b>:<br>` +\n  '<b>%{xaxis.title.text}:</b> %{x}<br>' +\n  '<b>%{yaxis.title.text}:</b> %{y:.2f}<br>' +\n  '<extra></extra>';\n\n/**\n * Prepares dataset's X axis according to selected visualization type: step, time-wall and time-relative\n *\n * NOTE: metric-type X axes are handled by `prepareXAxisDataForMetricType()`, since we need to retain\n *       step information in order to format the Y axis data correctly.\n */\nconst prepareMetricHistoryByAxisType = (\n  metricHistory?: MetricEntity[],\n  axisType?: RunsMetricsLinePlotProps['xAxisKey'],\n) => {\n  if (!metricHistory) {\n    return [];\n  }\n  if (axisType === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n    const { timestamp: minTimestamp } = minBy(metricHistory, 'timestamp') || {};\n    if (minTimestamp) {\n      if (shouldEnableRelativeTimeDateAxis()) {\n        return metricHistory.map(({ timestamp }) => timestamp - minTimestamp + EPOCH_RELATIVE_TIME);\n      }\n      return metricHistory.map(({ timestamp }) => (timestamp - minTimestamp) / 1000); // Milliseconds -> seconds\n    }\n    return metricHistory.map(({ step }) => step);\n  } else if (shouldEnableRelativeTimeDateAxis() && axisType === RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS) {\n    const { timestamp: minTimestamp } = minBy(metricHistory, 'timestamp') || {};\n    if (minTimestamp) {\n      return metricHistory.map(({ timestamp }) => (timestamp - minTimestamp) / HOUR_IN_MILLISECONDS);\n    }\n  } else if (axisType === RunsChartsLineChartXAxisType.TIME) {\n    return metricHistory.map(({ timestamp }) => timestamp);\n  }\n\n  return metricHistory.map(({ step }) => step);\n};\n\n/**\n * Prepares dataset's X axis when axisType is 'metric'. This is separate from\n * `prepareMetricHistoryByAxisType` because we need to keep track of the `step`\n * in addition to the `value`, so that the Y axis data can be associated to the\n * correct X datapoint.\n */\nconst prepareXAxisDataForMetricType = (\n  ySteps: Set<number>,\n  metricHistory?: MetricEntity[],\n): Array<{\n  value: number | undefined;\n  step: number;\n}> => {\n  if (!metricHistory) {\n    return [];\n  }\n\n  return metricHistory\n    .filter((datapoint) => ySteps.has(datapoint.step))\n    .map((datapoint) => ({\n      value: normalizeChartValue(datapoint.value),\n      step: datapoint.step,\n    }))\n    .sort((a, b) => {\n      // sort by value in ascending order\n      return Number(a.value) - Number(b.value);\n    });\n};\n\nconst getXAxisPlotlyType = (\n  xAxisKey: RunsChartsLineChartXAxisType,\n  xAxisScaleType: 'linear' | 'log',\n  dynamicXAxisKey: RunsChartsLineChartXAxisType,\n) => {\n  if (\n    xAxisKey === RunsChartsLineChartXAxisType.TIME ||\n    (shouldEnableRelativeTimeDateAxis() && dynamicXAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE)\n  ) {\n    return 'date';\n  }\n  if (xAxisKey === RunsChartsLineChartXAxisType.STEP && xAxisScaleType === 'log') {\n    return 'log';\n  }\n  return 'linear';\n};\n\n/**\n * Implementation of plotly.js chart displaying\n * line plot comparing metrics' history for a given\n * set of experiments runs\n */\nexport const RunsMetricsLinePlot = React.memo(\n  ({\n    runsData,\n    metricKey,\n    selectedMetricKeys,\n    scaleType = 'linear',\n    xAxisScaleType = 'linear',\n    xAxisKey = RunsChartsLineChartXAxisType.STEP,\n    selectedXAxisMetricKey = '',\n    lineSmoothness = 70,\n    className,\n    margin = runsChartDefaultMargin,\n    lineShape = 'linear',\n    onUpdate,\n    onHover,\n    onUnhover,\n    width,\n    height,\n    useDefaultHoverBox = true,\n    selectedRunUuid,\n    xRange,\n    yRange,\n    lockXAxisZoom,\n    fullScreen,\n    displayPoints,\n    onSetDownloadHandler,\n  }: RunsMetricsLinePlotProps) => {\n    const { theme } = useDesignSystemTheme();\n    const usingMultipleRunsHoverTooltip = shouldEnableDeepLearningUIPhase3();\n    const usingManualRangeControls = shouldEnableManualRangeControls();\n\n    const dynamicXAxisKey = useMemo(() => {\n      let dynamicXAxisKey = xAxisKey;\n      if (shouldEnableRelativeTimeDateAxis() && xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n        const metricKeys = selectedMetricKeys || [metricKey];\n        let maxDiff = 0;\n        runsData.forEach((runData) => {\n          const metricHistory = runData.metricsHistory;\n          if (metricHistory) {\n            metricKeys.forEach((metricKey) => {\n              if (metricHistory[metricKey]) {\n                const { timestamp: minTimestamp } = minBy(metricHistory[metricKey], 'timestamp') || {};\n                const { timestamp: maxTimestamp } = maxBy(metricHistory[metricKey], 'timestamp') || {};\n                if (maxTimestamp && minTimestamp) {\n                  const diff = maxTimestamp - minTimestamp;\n                  maxDiff = Math.max(maxDiff, diff);\n                }\n              }\n            });\n          }\n        });\n\n        if (maxDiff >= LINE_CHART_RELATIVE_TIME_THRESHOLD) {\n          dynamicXAxisKey = RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS;\n        }\n      }\n      return dynamicXAxisKey;\n    }, [runsData, selectedMetricKeys, metricKey, xAxisKey]);\n\n    const plotData = useMemo(() => {\n      // Generate a data trace for each metric in each run\n      const metricKeys = selectedMetricKeys ?? [metricKey];\n      return runsData\n        .map((runEntry) =>\n          metricKeys\n            // Discard creating traces for metrics that don't have any history for a given run\n            .filter((metricKey) => !isEmpty(runEntry.metricsHistory?.[metricKey]))\n            .flatMap((metricKey, idx) => {\n              const dataTrace = getDataTraceForRun({\n                runEntry,\n                metricKey,\n                xAxisKey: dynamicXAxisKey,\n                selectedXAxisMetricKey,\n                useDefaultHoverBox,\n                lineSmoothness,\n                lineShape,\n                lineDash: lineDashStyles[idx % lineDashStyles.length],\n                displayPoints,\n              });\n              if (shouldEnableChartsOriginalLinesWhenSmoothing()) {\n                const originalDataTrace = getDataTraceForRun({\n                  runEntry,\n                  metricKey,\n                  xAxisKey: dynamicXAxisKey,\n                  selectedXAxisMetricKey,\n                  useDefaultHoverBox: false,\n                  lineSmoothness: 0,\n                  lineShape,\n                  displayPoints: false,\n                  displayOriginalLine: true,\n                });\n                return [dataTrace, originalDataTrace];\n              }\n              return [dataTrace];\n            }),\n        )\n        .flat();\n    }, [\n      runsData,\n      lineShape,\n      dynamicXAxisKey,\n      lineSmoothness,\n      metricKey,\n      useDefaultHoverBox,\n      selectedMetricKeys,\n      selectedXAxisMetricKey,\n      displayPoints,\n    ]);\n\n    const bandsData = useMemo(() => {\n      const metricKeys = selectedMetricKeys ?? [metricKey];\n      return runsData\n        .filter(({ groupParentInfo }) => groupParentInfo)\n        .flatMap((runEntry) =>\n          metricKeys.map((metricKey) =>\n            getBandTraceForRun({\n              runEntry,\n              metricKey,\n              lineShape,\n              xAxisKey: dynamicXAxisKey,\n              selectedXAxisMetricKey,\n            }),\n          ),\n        );\n    }, [lineShape, metricKey, runsData, selectedMetricKeys, dynamicXAxisKey, selectedXAxisMetricKey]);\n\n    const plotDataWithBands = useMemo(() => [...bandsData, ...plotData], [plotData, bandsData]);\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const { formatMessage } = useIntl();\n\n    const { setHoveredPointIndex } = useRenderRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      plotDataWithBands,\n      highlightLineTraces,\n      bandsData.length,\n    );\n\n    const xAxisPlotlyType = getXAxisPlotlyType(xAxisKey, xAxisScaleType, dynamicXAxisKey);\n\n    const xAxisKeyLabel = useMemo(() => {\n      if (dynamicXAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n        return selectedXAxisMetricKey;\n      }\n\n      return formatMessage(getChartAxisLabelDescriptor(dynamicXAxisKey));\n    }, [formatMessage, dynamicXAxisKey, selectedXAxisMetricKey]);\n\n    const yAxisParams: Partial<LayoutAxis> = useMemo(() => {\n      if (usingManualRangeControls) {\n        return {\n          tickfont: { size: 11, color: theme.colors.textSecondary },\n          type: scaleType === 'log' ? 'log' : 'linear',\n          fixedrange: lockXAxisZoom,\n          range: yRange,\n          autorange: yRange === undefined,\n          tickformat: 'f',\n        };\n      } else {\n        return {\n          tickfont: { size: 11, color: theme.colors.textSecondary },\n          type: scaleType === 'log' ? 'log' : 'linear',\n          fixedrange: lockXAxisZoom,\n        };\n      }\n    }, [scaleType, lockXAxisZoom, theme, yRange, usingManualRangeControls]);\n\n    const xAxisParams: Partial<LayoutAxis> = useMemo(() => {\n      if (usingManualRangeControls) {\n        return {\n          title: xAxisKeyLabel,\n          tickfont: { size: 11, color: theme.colors.textSecondary },\n          range: xRange,\n          autorange: xRange === undefined,\n          type: xAxisPlotlyType,\n        };\n      } else {\n        return {\n          title: xAxisKeyLabel,\n          tickfont: { size: 11, color: theme.colors.textSecondary },\n        };\n      }\n    }, [theme, xAxisKeyLabel, xRange, xAxisPlotlyType, usingManualRangeControls]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: xAxisParams,\n      yaxis: yAxisParams,\n      showlegend: false,\n    });\n\n    useEffect(() => {\n      setLayout((current) => {\n        const updatedLayout = {\n          ...current,\n          width: width || layoutWidth,\n          height: height || layoutHeight,\n          margin,\n          yaxis: yAxisParams,\n          showlegend: false,\n        };\n        if (usingManualRangeControls) {\n          updatedLayout.xaxis = xAxisParams;\n        }\n        if (isEqual(updatedLayout, current)) {\n          return current;\n        }\n        return updatedLayout;\n      });\n    }, [\n      layoutWidth,\n      layoutHeight,\n      margin,\n      xAxisParams,\n      yAxisParams,\n      width,\n      height,\n      xAxisKeyLabel,\n      usingManualRangeControls,\n    ]);\n\n    const containsMultipleMetricKeys = useMemo(() => (selectedMetricKeys?.length || 0) > 1, [selectedMetricKeys]);\n\n    const hoverCallback = useCallback(\n      ({ points, event }) => {\n        const hoveredPoint = points[0];\n        const hoveredPointData = hoveredPoint?.data;\n        setHoveredPointIndex(hoveredPoint?.curveNumber ?? -1);\n\n        if (!hoveredPointData) {\n          return;\n        }\n        const runUuid = hoveredPointData.uuid;\n\n        // Extract metric entity\n        const metricEntity = hoveredPointData.metricHistory?.[hoveredPoint.pointIndex];\n\n        const data: RunsMetricsSingleTraceTooltipData = {\n          // Value of the \"x\" axis (time, step)\n          xValue: hoveredPoint.x,\n          // Value of the \"y\" axis\n          yValue: hoveredPoint.y,\n          // Metric entity value\n          metricEntity,\n          // The index of the X datum\n          index: hoveredPoint.pointIndex,\n          // Current label (\"Step\", \"Time\" etc.)\n          label: xAxisKeyLabel,\n        };\n        if (runUuid) {\n          onHover?.(runUuid, event, data);\n        }\n      },\n      [onHover, setHoveredPointIndex, xAxisKeyLabel],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    const themedPlotlyLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const getXAxisRange = (\n      xAxisKey: RunsChartsLineChartXAxisType,\n      xRange: [number | string, number | string],\n      xAxisScaleType: 'linear' | 'log',\n    ) => {\n      if (\n        xAxisKey === RunsChartsLineChartXAxisType.STEP &&\n        typeof xRange[0] === 'number' &&\n        typeof xRange[1] === 'number'\n      ) {\n        if (xAxisScaleType === 'log') {\n          if (xRange[0] < 0 && xRange[1] < 0) {\n            // If both are negative, autoscale\n            return undefined;\n          } else if (xRange[0] < 0) {\n            // If only the lower bound is negative, set it to 0\n            return [0, xRange[1]];\n          }\n        }\n      }\n      return [...xRange];\n    };\n\n    // When switching axis title, Plotly.js mutates its layout object\n    // internally which leads to desync problems and automatic axis range\n    // ends up with an invalid value. In order to fix it, we are mutating\n    // axis object and injecting metric key as title in\n    // the render phase.\n    // It could be fixed by wrapping plotly.js directly instead of using\n    // react-plotly.js - but the effort does not correspond to the plan of\n    // moving away from plotly soon.\n    const immediateLayout = layout;\n    if (immediateLayout.xaxis) {\n      immediateLayout.xaxis.title = xAxisKeyLabel;\n      immediateLayout.xaxis.type = xAxisPlotlyType;\n      if (xRange) {\n        immediateLayout.xaxis.range = usingManualRangeControls\n          ? xRange\n          : getXAxisRange(xAxisKey, xRange, xAxisScaleType);\n      }\n      immediateLayout.xaxis.automargin = true;\n      immediateLayout.xaxis.tickformat =\n        shouldEnableRelativeTimeDateAxis() && dynamicXAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE\n          ? '%H:%M:%S'\n          : undefined;\n    }\n    immediateLayout.template = { layout: themedPlotlyLayout };\n\n    if (immediateLayout.yaxis && yRange) {\n      immediateLayout.yaxis.range = yRange;\n      immediateLayout.yaxis.automargin = true;\n      immediateLayout.yaxis.tickformat = 'f';\n    }\n\n    const legendLabelData = useMemo(\n      () => getLineChartLegendData(runsData, selectedMetricKeys, metricKey),\n      [runsData, selectedMetricKeys, metricKey],\n    );\n\n    const {\n      scanlineElement,\n      initHandler,\n      updateHandler: updateHandlerMultipleRuns,\n      onPointHover: hoverCallbackMultipleRuns,\n      onPointUnhover: unhoverCallbackMultipleRuns,\n    } = useRunsMultipleTracesTooltipData({\n      legendLabelData,\n      plotData,\n      runsData,\n      containsMultipleMetricKeys,\n      onHover,\n      onUnhover: unhoverCallback,\n      xAxisKeyLabel,\n      xAxisKey: dynamicXAxisKey,\n      xAxisScaleType: xAxisKey === RunsChartsLineChartXAxisType.STEP ? xAxisScaleType : 'linear',\n      setHoveredPointIndex,\n      disabled: !usingMultipleRunsHoverTooltip,\n    });\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(\n      usingMultipleRunsHoverTooltip ? hoverCallbackMultipleRuns : hoverCallback,\n    );\n\n    // Prepare data for image download handler\n    useEffect(() => {\n      // Check if we are using multiple metric keys. If so, we also need to append\n      // the metric key to  the trace name in the exported image.\n      const usingMultipleMetricKeys = (selectedMetricKeys?.length || 0) > 1;\n      const dataToExport = usingMultipleMetricKeys\n        ? plotDataWithBands.map((dataTrace) =>\n            dataTrace.metricKey\n              ? {\n                  ...dataTrace,\n                  name: `${dataTrace.name} (${dataTrace.metricKey})`,\n                }\n              : dataTrace,\n          )\n        : plotDataWithBands;\n\n      const layoutToExport: Partial<Layout> = {\n        ...layout,\n        showlegend: true,\n        legend: {\n          orientation: 'h',\n        },\n      };\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layoutToExport));\n    }, [layout, onSetDownloadHandler, plotDataWithBands, selectedMetricKeys?.length]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), styles.highlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotDataWithBands}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          onUpdate={(figure: Readonly<Figure>, graphDiv: Readonly<HTMLElement>) => {\n            if (usingMultipleRunsHoverTooltip) {\n              updateHandlerMultipleRuns(figure, graphDiv);\n            }\n            onUpdate?.(figure, graphDiv);\n          }}\n          layout={immediateLayout}\n          config={PLOT_CONFIG}\n          onHover={mutableHoverCallback}\n          onUnhover={usingMultipleRunsHoverTooltip ? unhoverCallbackMultipleRuns : unhoverCallback}\n          onInitialized={initHandler}\n        />\n        {scanlineElement}\n      </div>\n    );\n\n    return (\n      <RunsMetricsLegendWrapper labelData={legendLabelData} fullScreen={fullScreen}>\n        {chart}\n      </RunsMetricsLegendWrapper>\n    );\n  },\n);\n\nconst styles = {\n  highlightStyles: {\n    '.scatterlayer g.trace': {\n      transition: 'var(--trace-transition)',\n    },\n    '.scatterlayer.is-highlight g.trace:not(.is-band)': {\n      opacity: 'var(--trace-opacity-dimmed-low) !important',\n    },\n    '.scatterlayer g.trace.is-hover-highlight:not(.is-band)': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n    },\n    '.scatterlayer g.trace.is-selection-highlight:not(.is-band)': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n    },\n    '.scatterlayer g.trace.is-selection-highlight path.point': {\n      stroke: 'var(--trace-stroke-color)',\n      strokeWidth: 'var(--trace-stroke-width) !important',\n    },\n    '.scatterlayer.is-highlight g.trace.is-band:not(.is-band-highlighted)': {\n      opacity: 'var(--trace-opacity-dimmed) !important',\n    },\n  },\n};\n","import { isUndefined } from 'lodash';\n\nimport { RunsCompareMultipleTracesTooltipData } from './RunsMetricsLinePlot';\nimport React from 'react';\nimport { TraceLabelColorIndicator } from './RunsMetricsLegend';\nimport { FormattedDate, FormattedTime, useIntl } from 'react-intl';\nimport { getChartAxisLabelDescriptor, RunsChartsLineChartXAxisType } from './RunsCharts.common';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { shouldEnableRelativeTimeDateAxis } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\n\n// Sadly when hovering outside data point, we can't get the date-time value from Plotly chart\n// so we have to format it ourselves in a way that resembles Plotly's logic\nconst PlotlyLikeFormattedTime = ({ value }: { value: string | number }) => (\n  <>\n    <FormattedDate value={value} year=\"numeric\" />-\n    <FormattedDate value={value} month=\"2-digit\" />-\n    <FormattedDate value={value} day=\"2-digit\" /> <FormattedTime value={value} hour=\"numeric\" hourCycle=\"h24\" />:\n    <FormattedTime value={value} minute=\"2-digit\" />:\n    {/* @ts-expect-error \"fractionalSecondDigits\" is supported but missing from TS types */}\n    <FormattedTime value={value} second=\"2-digit\" fractionalSecondDigits={3} />\n  </>\n);\n\n// Sadly when hovering outside data point, we can't get the date-time value from Plotly chart\n// so we have to format it ourselves in a way that resembles Plotly's logic\nconst PlotlyLikeFormattedTimestamp = ({ value }: { value: string | number }) => (\n  <>\n    <FormattedTime value={value} hour=\"2-digit\" hourCycle=\"h23\" />:\n    <FormattedTime value={value} minute=\"2-digit\" />:\n    {/* @ts-expect-error \"fractionalSecondDigits\" is supported but missing from TS types */}\n    <FormattedTime value={value} second=\"2-digit\" fractionalSecondDigits={3} />\n  </>\n);\n\n/**\n * Variant of the tooltip body for the line chart that displays multiple traces at once.\n * Used in the compare runs page and run details metrics page.\n */\nexport const RunsMultipleTracesTooltipBody = ({ hoverData }: { hoverData: RunsCompareMultipleTracesTooltipData }) => {\n  const { tooltipLegendItems, hoveredDataPoint: singleTraceHoverData, xValue, xAxisKeyLabel } = hoverData;\n  const { traceUuid: runUuid, metricEntity } = singleTraceHoverData || {};\n\n  const intl = useIntl();\n  const { theme } = useDesignSystemTheme();\n\n  const hoveredTraceUuid = `${runUuid}.${metricEntity?.key}`;\n  const displayedXValueLabel =\n    hoverData.xAxisKey === RunsChartsLineChartXAxisType.METRIC\n      ? xAxisKeyLabel\n      : intl.formatMessage(getChartAxisLabelDescriptor(hoverData.xAxisKey));\n\n  if (tooltipLegendItems) {\n    return (\n      <div>\n        {!isUndefined(xValue) && (\n          <div css={{ marginBottom: theme.spacing.xs }}>\n            <span css={{ fontWeight: 'bold' }}>{displayedXValueLabel}</span>{' '}\n            {hoverData.xAxisKey === RunsChartsLineChartXAxisType.TIME ? (\n              <PlotlyLikeFormattedTime value={xValue} />\n            ) : shouldEnableRelativeTimeDateAxis() &&\n              hoverData.xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE ? (\n              <PlotlyLikeFormattedTimestamp value={xValue} />\n            ) : (\n              xValue\n            )}\n          </div>\n        )}\n        <div\n          css={{\n            display: 'grid',\n            gridTemplateColumns: `${theme.general.iconSize}px auto auto`,\n            columnGap: theme.spacing.sm,\n            rowGap: theme.spacing.sm / 4,\n            alignItems: 'center',\n          }}\n        >\n          {tooltipLegendItems.map(({ displayName, color, uuid, value, dashStyle }) => (\n            <React.Fragment key={uuid}>\n              <TraceLabelColorIndicator color={color || 'transparent'} dashStyle={dashStyle} />\n\n              <div\n                css={{\n                  marginRight: theme.spacing.md,\n                  fontSize: theme.typography.fontSizeSm,\n                  color: hoveredTraceUuid === uuid ? 'unset' : theme.colors.textPlaceholder,\n                }}\n              >\n                {displayName}\n              </div>\n              <div>\n                {!isUndefined(value) && (\n                  <span\n                    css={{\n                      fontWeight: hoveredTraceUuid === uuid ? 'bold' : 'normal',\n                      color: hoveredTraceUuid === uuid ? 'unset' : theme.colors.textPlaceholder,\n                    }}\n                  >\n                    {value}\n                  </span>\n                )}\n              </div>\n            </React.Fragment>\n          ))}\n        </div>\n      </div>\n    );\n  }\n  return null;\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { Data, Datum, Layout, PlotMouseEvent } from 'plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightScatterTraces, useRenderRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  RunsChartAxisDef,\n  runsChartDefaultMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  useDynamicPlotSize,\n  getLegendDataFromRuns,\n} from './RunsCharts.common';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\n\nexport interface RunsScatterPlotProps extends RunsPlotsCommonProps {\n  /**\n   * Horizontal axis with a metric or a param\n   */\n  xAxis: RunsChartAxisDef;\n\n  /**\n   * Vertical axis with a metric or a param\n   */\n  yAxis: RunsChartAxisDef;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: RunsChartsRunData[];\n}\n\nconst PLOT_CONFIG = {\n  displaylogo: false,\n  scrollZoom: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nexport const createTooltipTemplate = () =>\n  '<b>%{customdata[1]}:</b><br>' +\n  '<b>%{xaxis.title.text}:</b> %{x:.2f}<br>' +\n  '<b>%{yaxis.title.text}:</b> %{y:.2f}<br>' +\n  '<extra></extra>';\n\n/**\n * Implementation of plotly.js chart displaying\n * scatter plot comparing values for a given\n * set of experiments runs\n */\nexport const RunsScatterPlot = React.memo(\n  ({\n    runsData,\n    xAxis,\n    yAxis,\n    markerSize = 10,\n    className,\n    margin = runsChartDefaultMargin,\n    onUpdate,\n    onHover,\n    onUnhover,\n    width,\n    height,\n    useDefaultHoverBox = true,\n    selectedRunUuid,\n    onSetDownloadHandler,\n  }: RunsScatterPlotProps) => {\n    const { theme } = useDesignSystemTheme();\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const plotData = useMemo(() => {\n      // Prepare empty values\n      const xValues: (number | string)[] = [];\n      const yValues: (number | string)[] = [];\n      const colors: (number | string)[] = [];\n      const tooltipData: Datum[] = [];\n\n      // Iterate through all the runs and aggregate selected metrics/params\n      for (const runData of runsData) {\n        const { runInfo, metrics, params, color, uuid, displayName } = runData;\n        const { runUuid, runName } = runInfo || {};\n        const xAxisData = xAxis.type === 'METRIC' ? metrics : params;\n        const yAxisData = yAxis.type === 'METRIC' ? metrics : params;\n\n        const x = xAxisData?.[xAxis.key]?.value || undefined;\n        const y = yAxisData?.[yAxis.key]?.value || undefined;\n\n        if (x && y) {\n          xValues.push(x);\n          yValues.push(y);\n          colors.push(color || theme.colors.primary);\n          if (runUuid) {\n            tooltipData.push([runUuid, runName || runUuid] as any);\n          } else {\n            tooltipData.push([uuid, displayName] as any);\n          }\n        }\n      }\n\n      return [\n        {\n          x: xValues,\n          y: yValues,\n          customdata: tooltipData,\n          text: runsData.map(({ displayName }) => displayName),\n          hovertemplate: useDefaultHoverBox ? createTooltipTemplate() : undefined,\n          hoverinfo: useDefaultHoverBox ? undefined : 'none',\n          hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n          type: 'scatter',\n          mode: 'markers',\n          textposition: 'bottom center',\n          marker: {\n            size: markerSize,\n            color: colors,\n          },\n        } as Data,\n      ];\n    }, [runsData, xAxis, yAxis, theme, markerSize, useDefaultHoverBox]);\n\n    const plotlyThemedLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: { title: xAxis.key, tickfont: { size: 11, color: theme.colors.textSecondary } },\n      yaxis: { title: yAxis.key, tickfont: { size: 11, color: theme.colors.textSecondary } },\n      template: { layout: plotlyThemedLayout },\n    });\n\n    useEffect(() => {\n      setLayout((current) => {\n        const newLayout = {\n          ...current,\n          width: width || layoutWidth,\n          height: height || layoutHeight,\n          margin,\n        };\n\n        if (newLayout.xaxis) {\n          newLayout.xaxis.title = xAxis.key;\n        }\n\n        if (newLayout.yaxis) {\n          newLayout.yaxis.title = yAxis.key;\n        }\n\n        return newLayout;\n      });\n    }, [layoutWidth, layoutHeight, margin, xAxis.key, yAxis.key, width, height]);\n\n    const { setHoveredPointIndex } = useRenderRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      runsData,\n      highlightScatterTraces,\n    );\n\n    const hoverCallback = useCallback(\n      ({ points }: PlotMouseEvent) => {\n        // Find the corresponding run UUID by basing on \"customdata\" field set in the trace data.\n        // Plotly TS typings don't support custom fields so we need to cast to \"any\" first\n        const pointCustomDataRunUuid = (points[0] as any)?.customdata?.[0];\n        setHoveredPointIndex(points[0]?.pointIndex ?? -1);\n\n        if (pointCustomDataRunUuid) {\n          onHover?.(pointCustomDataRunUuid);\n        }\n      },\n      [onHover, setHoveredPointIndex],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(hoverCallback);\n\n    const legendLabelData = useMemo(() => getLegendDataFromRuns(runsData), [runsData]);\n\n    useEffect(() => {\n      const dataToExport: Data[] = plotData.map((trace: Data) => ({\n        ...trace,\n        mode: 'text+markers',\n      }));\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layout));\n    }, [layout, onSetDownloadHandler, plotData]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), commonRunsChartStyles.scatterChartHighlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotData}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          layout={layout}\n          config={PLOT_CONFIG}\n          onUpdate={onUpdate}\n          onHover={mutableHoverCallback}\n          onUnhover={unhoverCallback}\n        />\n      </div>\n    );\n\n    return <RunsMetricsLegendWrapper labelData={legendLabelData}>{chart}</RunsMetricsLegendWrapper>;\n  },\n);\n","import {\n  Button,\n  DragIcon,\n  DropdownMenu,\n  OverflowIcon,\n  Typography,\n  useDesignSystemTheme,\n  LegacyInfoTooltip,\n  FullscreenIcon,\n  Switch,\n  Spinner,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { PropsWithChildren, ReactNode, memo, useCallback, useRef } from 'react';\nimport { useDragAndDropElement } from '../../../../../common/hooks/useDragAndDropElement';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\nimport { FormattedMessage } from 'react-intl';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport type { RunsChartsCardConfig } from '../../runs-charts.types';\nimport type { ExperimentChartImageDownloadFileFormat } from '../../hooks/useChartImageDownloadHandler';\nimport { noop } from 'lodash';\n\nexport enum RunsChartsChartsDragGroup {\n  PARALLEL_CHARTS_AREA = 'PARALLEL_CHARTS_AREA',\n  GENERAL_AREA = 'GENERAL_AREA',\n}\n\nexport interface RunsChartCardReorderProps {\n  onReorderWith: (draggedKey: string, targetDropKey: string) => void;\n  canMoveUp: boolean;\n  canMoveDown: boolean;\n  previousChartUuid?: string;\n  nextChartUuid?: string;\n}\n\nexport type RunsChartCardSetFullscreenFn = (chart: {\n  config: RunsChartsCardConfig;\n  title: string;\n  subtitle: ReactNode;\n}) => void;\n\nexport interface RunsChartCardFullScreenProps {\n  fullScreen?: boolean;\n  setFullScreenChart?: RunsChartCardSetFullscreenFn;\n}\n\nexport interface ChartCardToggleProps {\n  toggleLabel: string;\n  currentToggle: boolean;\n  setToggle: () => void;\n}\n\nexport interface ChartCardWrapperProps extends RunsChartCardReorderProps {\n  title: React.ReactNode;\n  subtitle?: React.ReactNode;\n  onEdit: () => void;\n  onDelete: () => void;\n  tooltip?: string;\n  uuid?: string;\n  dragGroupKey: RunsChartsChartsDragGroup;\n  additionalMenuContent?: React.ReactNode;\n  toggleFullScreenChart?: () => void;\n  toggles?: ChartCardToggleProps[];\n  isRefreshing?: boolean;\n  onClickDownload?: (format: ExperimentChartImageDownloadFileFormat | 'csv' | 'csv-full') => void;\n  supportedDownloadFormats?: (ExperimentChartImageDownloadFileFormat | 'csv' | 'csv-full')[];\n  isHidden?: boolean;\n}\n\nexport const ChartRunsCountIndicator = memo(({ runsOrGroups }: { runsOrGroups: RunsChartsRunData[] }) => {\n  const containsGroups = runsOrGroups.some(({ groupParentInfo }) => groupParentInfo);\n  const containsRuns = runsOrGroups.some(({ runInfo }) => runInfo);\n\n  // After moving to the new run rows visibility model, we don't configure run count per chart\n  if (shouldUseNewRunRowsVisibilityModel()) {\n    return null;\n  }\n\n  return containsRuns && containsGroups ? (\n    <FormattedMessage\n      defaultMessage=\"Comparing first {count} groups and runs\"\n      values={{ count: runsOrGroups.length }}\n      description=\"Experiment page > compare runs > chart header > compared groups and runs count label\"\n    />\n  ) : containsGroups ? (\n    <FormattedMessage\n      defaultMessage=\"Comparing first {count} groups\"\n      values={{ count: runsOrGroups.length }}\n      description=\"Experiment page > compare runs > chart header > compared groups count label\"\n    />\n  ) : (\n    <FormattedMessage\n      defaultMessage=\"Comparing first {count} runs\"\n      values={{ count: runsOrGroups.length }}\n      description=\"Experiment page > compare runs > chart header > compared runs count label\"\n    />\n  );\n});\n\n/**\n * Wrapper components for all chart cards. Provides styles and adds\n * a dropdown menu with actions for configure and delete.\n */\nexport const RunsChartCardWrapperRaw = ({\n  title,\n  subtitle,\n  onDelete,\n  onEdit,\n  children,\n  uuid,\n  dragGroupKey,\n  tooltip = '',\n  onReorderWith = noop,\n  canMoveDown,\n  canMoveUp,\n  previousChartUuid,\n  nextChartUuid,\n  additionalMenuContent,\n  toggleFullScreenChart,\n  toggles,\n  supportedDownloadFormats = [],\n  onClickDownload,\n  isHidden,\n  isRefreshing = false,\n}: PropsWithChildren<ChartCardWrapperProps>) => {\n  const { theme } = useDesignSystemTheme();\n\n  const { dragHandleRef, dragPreviewRef, dropTargetRef, isDraggingOtherGroup, isOver } = useDragAndDropElement({\n    dragGroupKey,\n    dragKey: uuid || '',\n    onDrop: onReorderWith,\n    disabled: isHidden,\n  });\n\n  const onMoveUp = useCallback(\n    () => onReorderWith(uuid || '', previousChartUuid || ''),\n    [onReorderWith, uuid, previousChartUuid],\n  );\n  const onMoveDown = useCallback(\n    () => onReorderWith(uuid || '', nextChartUuid || ''),\n    [onReorderWith, uuid, nextChartUuid],\n  );\n\n  return (\n    <div\n      css={{\n        height: 360,\n        overflow: 'hidden',\n        display: 'grid',\n        gridTemplateRows: 'auto 1fr',\n        backgroundColor: theme.colors.backgroundPrimary,\n        padding: 12,\n        // have a slightly smaller padding when the enableDeepLearningUI\n        // flag is on to accomodate the legend in the charts\n        paddingBottom: theme.spacing.sm,\n        border: `1px solid ${theme.colors.border}`,\n        borderRadius: theme.general.borderRadiusBase,\n        transition: 'opacity 0.12s',\n        position: 'relative',\n      }}\n      style={{\n        opacity: isDraggingOtherGroup ? 0.1 : isOver ? 0.5 : 1,\n      }}\n      data-testid=\"experiment-view-compare-runs-card\"\n      ref={(element) => {\n        // Use this element for both drag preview and drop target\n        dragPreviewRef?.(element);\n        dropTargetRef?.(element);\n      }}\n    >\n      <div\n        css={{\n          display: 'flex',\n          overflow: 'hidden',\n        }}\n      >\n        <div\n          ref={dragHandleRef}\n          data-testid=\"experiment-view-compare-runs-card-drag-handle\"\n          css={{\n            marginTop: theme.spacing.xs,\n            marginRight: theme.spacing.sm,\n            cursor: 'grab',\n          }}\n        >\n          <DragIcon />\n        </div>\n        <div css={{ overflow: 'hidden', flex: 1, flexShrink: 1 }}>\n          <Typography.Title\n            title={String(title)}\n            level={4}\n            css={{\n              marginBottom: 0,\n              overflow: 'hidden',\n              whiteSpace: 'nowrap',\n              textOverflow: 'ellipsis',\n            }}\n          >\n            {title}\n          </Typography.Title>\n          {subtitle && <span css={styles.subtitle(theme)}>{subtitle}</span>}\n          {tooltip && <LegacyInfoTooltip css={{ verticalAlign: 'middle' }} title={tooltip} />}\n        </div>\n        {isRefreshing && (\n          <div\n            css={{\n              width: theme.general.heightSm,\n              height: theme.general.heightSm,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n            }}\n          >\n            <Spinner />\n          </div>\n        )}\n        {toggles && (\n          <div\n            css={{\n              display: 'flex',\n              padding: `0px ${theme.spacing.lg}px`,\n              gap: theme.spacing.md,\n              alignItems: 'flex-start',\n            }}\n          >\n            {toggles.map((toggle) => {\n              return (\n                <Switch\n                  key={toggle.toggleLabel}\n                  checked={toggle.currentToggle}\n                  onChange={toggle.setToggle}\n                  label={toggle.toggleLabel}\n                />\n              );\n            })}\n          </div>\n        )}\n        <Button\n          componentId=\"fullscreen_button_chartcard\"\n          icon={<FullscreenIcon />}\n          onClick={toggleFullScreenChart}\n          disabled={!toggleFullScreenChart}\n        />\n        <DropdownMenu.Root modal={false}>\n          <DropdownMenu.Trigger asChild>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_cards_chartcard.common.tsx_158\"\n              type=\"tertiary\"\n              icon={<OverflowIcon />}\n              data-testid=\"experiment-view-compare-runs-card-menu\"\n            />\n          </DropdownMenu.Trigger>\n          <DropdownMenu.Content align=\"end\" minWidth={100}>\n            <DropdownMenu.Item onClick={onEdit} data-testid=\"experiment-view-compare-runs-card-edit\">\n              Configure\n            </DropdownMenu.Item>\n            <DropdownMenu.Item onClick={onDelete} data-testid=\"experiment-view-compare-runs-card-delete\">\n              Delete\n            </DropdownMenu.Item>\n            {supportedDownloadFormats.length > 0 && onClickDownload && (\n              <>\n                <DropdownMenu.Separator />\n                {supportedDownloadFormats.includes('csv') && (\n                  <DropdownMenu.Item onClick={() => onClickDownload('csv')}>\n                    <FormattedMessage\n                      defaultMessage=\"Export as CSV\"\n                      description=\"Experiment page > compare runs tab > chart header > export CSV data option\"\n                    />\n                  </DropdownMenu.Item>\n                )}\n                {supportedDownloadFormats.includes('svg') && (\n                  <DropdownMenu.Item onClick={() => onClickDownload('svg')}>\n                    <FormattedMessage\n                      defaultMessage=\"Download as SVG\"\n                      description=\"Experiment page > compare runs tab > chart header > download as SVG option\"\n                    />\n                  </DropdownMenu.Item>\n                )}\n                {supportedDownloadFormats.includes('png') && (\n                  <DropdownMenu.Item onClick={() => onClickDownload('png')}>\n                    <FormattedMessage\n                      defaultMessage=\"Download as PNG\"\n                      description=\"Experiment page > compare runs tab > chart header > download as PNG option\"\n                    />\n                  </DropdownMenu.Item>\n                )}\n              </>\n            )}\n            <DropdownMenu.Separator />\n            <DropdownMenu.Item\n              disabled={!canMoveUp}\n              onClick={onMoveUp}\n              data-testid=\"experiment-view-compare-runs-move-up\"\n            >\n              <FormattedMessage\n                defaultMessage=\"Move up\"\n                description=\"Experiment page > compare runs tab > chart header > move up option\"\n              />\n            </DropdownMenu.Item>\n            <DropdownMenu.Item\n              disabled={!canMoveDown}\n              onClick={onMoveDown}\n              data-testid=\"experiment-view-compare-runs-move-down\"\n            >\n              <FormattedMessage\n                defaultMessage=\"Move down\"\n                description=\"Experiment page > compare runs tab > chart header > move down option\"\n              />\n            </DropdownMenu.Item>\n            {additionalMenuContent}\n          </DropdownMenu.Content>\n        </DropdownMenu.Root>\n      </div>\n      {children}\n    </div>\n  );\n};\n\nconst styles = {\n  chartEntry: (theme: Theme) => ({\n    height: 360,\n    overflow: 'hidden',\n    display: 'grid',\n    gridTemplateRows: 'auto 1fr',\n    backgroundColor: theme.colors.backgroundPrimary,\n    padding: theme.spacing.md,\n    border: `1px solid ${theme.colors.border}`,\n    borderRadius: theme.general.borderRadiusBase,\n  }),\n  chartComponentWrapper: () => ({\n    overflow: 'hidden',\n  }),\n  subtitle: (theme: Theme) => ({\n    color: theme.colors.textSecondary,\n    fontSize: 11,\n    marginRight: 4,\n    verticalAlign: 'middle',\n  }),\n};\n\nexport const RunsChartCardWrapper = memo(RunsChartCardWrapperRaw);\n","import { useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsMetricsBarPlot } from '../RunsMetricsBarPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport type { RunsChartsBarCardConfig } from '../../runs-charts.types';\nimport { useIsInViewport } from '../../hooks/useIsInViewport';\nimport {\n  shouldEnableHidingChartsWithNoData,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport {\n  RunsChartCardWrapper,\n  type RunsChartCardReorderProps,\n  RunsChartsChartsDragGroup,\n  ChartRunsCountIndicator,\n  RunsChartCardFullScreenProps,\n} from './ChartCard.common';\nimport { useChartImageDownloadHandler } from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { customMetricBehaviorDefs } from '../../../experiment-page/utils/customMetricBehaviorUtils';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\n\nexport interface RunsChartsBarChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsBarCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n}\n\nexport const barChartCardDefaultMargin = {\n  t: 24,\n  b: 48,\n  r: 0,\n  l: 4,\n  pad: 0,\n};\n\nexport const RunsChartsBarChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  ...reorderProps\n}: RunsChartsBarChartCardProps) => {\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: customMetricBehaviorDefs[config.metricKey]?.displayName ?? config.metricKey,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      // If hiding empty charts is supported, we additionally filter out bars without recorded metric of interest\n      if (shouldEnableHidingChartsWithNoData()) {\n        return chartRunData.filter(({ hidden, metrics }) => !hidden && metrics[config.metricKey]);\n      }\n      return chartRunData.filter(({ hidden }) => !hidden);\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const isEmptyDataset = useMemo(() => {\n    if (!shouldEnableHidingChartsWithNoData()) {\n      return false;\n    }\n    const metricsInRuns = slicedRuns.flatMap(({ metrics }) => Object.keys(metrics));\n    return !metricsInRuns.includes(config.metricKey);\n  }, [config, slicedRuns]);\n\n  const { setTooltip, resetTooltip, selectedRunUuid } = useRunsChartsTooltip(config);\n\n  const { elementRef, isInViewport } = useIsInViewport();\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  const chartBody = (\n    <div\n      css={[\n        styles.barChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n      ref={elementRef}\n    >\n      {isInViewport ? (\n        <RunsMetricsBarPlot\n          runsData={slicedRuns}\n          metricKey={config.metricKey}\n          displayRunNames={false}\n          displayMetricKey={false}\n          useDefaultHoverBox={false}\n          margin={barChartCardDefaultMargin}\n          onHover={setTooltip}\n          onUnhover={resetTooltip}\n          selectedRunUuid={selectedRunUuid}\n          onSetDownloadHandler={setImageDownloadHandler}\n        />\n      ) : null}\n    </div>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={customMetricBehaviorDefs[config.metricKey]?.displayName ?? config.metricKey}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={isEmptyDataset ? undefined : toggleFullScreenChart}\n      supportedDownloadFormats={['png', 'svg', 'csv']}\n      onClickDownload={(format) => {\n        if (format === 'csv' || format === 'csv-full') {\n          const runsToExport = [...slicedRuns].reverse();\n          downloadChartDataCsv(runsToExport, [config.metricKey], [], config.metricKey);\n          return;\n        }\n        imageDownloadHandler?.(format, config.metricKey);\n      }}\n      {...reorderProps}\n    >\n      {isEmptyDataset ? <RunsChartsNoDataFoundIndicator /> : chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  barChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","import { LegacySkeleton } from '@databricks/design-system';\nimport { ReactNode, memo, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { RunsChartsRunData, RunsChartsLineChartXAxisType, removeOutliersFromMetricHistory } from '../RunsCharts.common';\nimport { RunsMetricsLinePlot } from '../RunsMetricsLinePlot';\nimport { RunsChartsTooltipMode, useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport type { ChartRange, RunsChartsCardConfig, RunsChartsLineCardConfig } from '../../runs-charts.types';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  ChartRunsCountIndicator,\n} from './ChartCard.common';\nimport { useSampledMetricHistory } from '../../hooks/useSampledMetricHistory';\nimport { compact, intersection, isEqual, isUndefined, pick, uniq } from 'lodash';\nimport { useIsInViewport } from '../../hooks/useIsInViewport';\nimport {\n  shouldEnableDeepLearningUIPhase3,\n  shouldUseNewRunRowsVisibilityModel,\n  shouldEnableRelativeTimeDateAxis,\n  shouldEnableManualRangeControls,\n  shouldEnableHidingChartsWithNoData,\n} from '../../../../../common/utils/FeatureUtils';\nimport { findAbsoluteTimestampRangeForRelativeRange } from '../../utils/findChartStepsByTimestamp';\nimport { Figure } from 'react-plotly.js';\nimport { ReduxState } from '../../../../../redux-types';\nimport { shallowEqual, useSelector } from 'react-redux';\nimport { useCompareRunChartSelectedRange } from '../../hooks/useCompareRunChartSelectedRange';\nimport { MetricHistoryByName } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { useGroupedChartRunData } from '../../../runs-compare/hooks/useGroupedChartRunData';\nimport {\n  ExperimentChartImageDownloadFileFormat,\n  useChartImageDownloadHandler,\n} from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartMetricHistoryCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { useConfirmChartCardConfigurationFn } from '../../hooks/useRunsChartsUIConfiguration';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\n\nconst getV2ChartTitle = (cardConfig: RunsChartsLineCardConfig): string => {\n  if (!cardConfig.selectedMetricKeys || cardConfig.selectedMetricKeys.length === 0) {\n    return cardConfig.metricKey;\n  }\n\n  return cardConfig.selectedMetricKeys.join(' vs ');\n};\n\nexport interface RunsChartsLineChartCardProps extends RunsChartCardReorderProps {\n  config: RunsChartsLineCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  groupBy: RunsGroupByConfig | null;\n\n  onDelete: () => void;\n  onEdit: () => void;\n\n  fullScreen?: boolean;\n\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n\n  setFullScreenChart?: (chart: { config: RunsChartsCardConfig; title: string; subtitle: ReactNode }) => void;\n  onDownloadFullMetricHistoryCsv?: (runUuids: string[], metricKeys: string[]) => void;\n}\n\nconst SUPPORTED_DOWNLOAD_FORMATS: (ExperimentChartImageDownloadFileFormat | 'csv' | 'csv-full')[] = [\n  'png',\n  'svg',\n  'csv',\n  'csv-full',\n];\n\nexport const RunsChartsLineChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  onDownloadFullMetricHistoryCsv,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n  autoRefreshEnabled,\n  hideEmptyCharts,\n  ...reorderProps\n}: RunsChartsLineChartCardProps) => {\n  const usingMultipleRunsHoverTooltip = shouldEnableDeepLearningUIPhase3();\n  const usingManualRangeControls = shouldEnableManualRangeControls();\n\n  const toggleFullScreenChart = useCallback(() => {\n    setFullScreenChart?.({\n      config,\n      title: getV2ChartTitle(config),\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  }, [chartRunData, config, setFullScreenChart]);\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const isGrouped = useMemo(() => slicedRuns.some((r) => r.groupParentInfo), [slicedRuns]);\n\n  const isEmptyDataset = useMemo(() => {\n    if (!shouldEnableHidingChartsWithNoData()) {\n      return false;\n    }\n    const metricKeys = config.selectedMetricKeys ?? [config.metricKey];\n    const metricsInRuns = slicedRuns.flatMap(({ metrics }) => Object.keys(metrics));\n    return intersection(metricKeys, uniq(metricsInRuns)).length === 0;\n  }, [config, slicedRuns]);\n\n  const runUuidsToFetch = useMemo(() => {\n    if (isGrouped) {\n      // First, get all runs inside visible groups\n      const runsInGroups = compact(slicedRuns.map((r) => r.groupParentInfo)).flatMap((g) => g.runUuids);\n\n      // Finally, get \"remaining\" runs that are not grouped\n      const ungroupedRuns = compact(\n        slicedRuns.filter((r) => !r.groupParentInfo && !r.belongsToGroup).map((r) => r.runInfo?.runUuid),\n      );\n      return [...runsInGroups, ...ungroupedRuns];\n    }\n    // If grouping is disabled, just get all run UUIDs from runInfo\n    return compact(slicedRuns.map((r) => r.runInfo?.runUuid));\n  }, [slicedRuns, isGrouped]);\n\n  const metricKeys = useMemo(() => {\n    const fallback = [config.metricKey];\n\n    const yAxisKeys = config.selectedMetricKeys ?? fallback;\n    const xAxisKeys = !config.selectedXAxisMetricKey ? [] : [config.selectedXAxisMetricKey];\n\n    return yAxisKeys.concat(xAxisKeys);\n  }, [config.metricKey, config.selectedMetricKeys, config.selectedXAxisMetricKey]);\n\n  const { setTooltip, resetTooltip, destroyTooltip, selectedRunUuid } = useRunsChartsTooltip(\n    config,\n    usingMultipleRunsHoverTooltip ? RunsChartsTooltipMode.MultipleTracesWithScanline : RunsChartsTooltipMode.Simple,\n  );\n\n  const { elementRef, isInViewport, isInViewportDeferred } = useIsInViewport();\n\n  const { aggregateFunction } = groupBy || {};\n\n  const sampledMetricsByRunUuid = useSelector(\n    (state: ReduxState) => pick(state.entities.sampledMetricsByRunUuid, runUuidsToFetch),\n    shallowEqual,\n  );\n\n  /**\n   * We set a local state for changes because full screen and non-full screen charts are\n   * different components - this prevents having to sync them.\n   */\n  const [yRangeLocal, setYRangeLocal] = useState<[number, number] | undefined>(() => {\n    if (config.range && !isUndefined(config.range.yMin) && !isUndefined(config.range.yMax)) {\n      return [config.range.yMin, config.range.yMax];\n    }\n    return undefined;\n  });\n\n  // Memoizes last Y-axis range. Does't use stateful value, used only in the last immediate render dowstream.\n  const yRangeLegacy = useRef<[number, number] | undefined>(undefined);\n\n  const { setOffsetTimestamp, stepRange, xRangeLocal, setXRangeLocal } = useCompareRunChartSelectedRange(\n    config,\n    config.xAxisKey,\n    config.metricKey,\n    sampledMetricsByRunUuid,\n    runUuidsToFetch,\n    config.xAxisKey === RunsChartsLineChartXAxisType.STEP ? config.xAxisScaleType : 'linear',\n  );\n\n  const { resultsByRunUuid, isLoading, isRefreshing } = useSampledMetricHistory({\n    runUuids: runUuidsToFetch,\n    metricKeys,\n    enabled: isInViewportDeferred,\n    maxResults: 320,\n    range: stepRange,\n    autoRefreshEnabled,\n  });\n\n  const chartLayoutUpdated = ({ layout }: Readonly<Figure>) => {\n    // We only want to update the local state if the chart is not in full screen mode.\n    // If not, this can cause synchronization issues between the full screen and non-full screen charts.\n    if (!fullScreen) {\n      let yAxisMin = yRangeLocal?.[0];\n      let yAxisMax = yRangeLocal?.[1];\n      let xAxisMin = xRangeLocal?.[0];\n      let xAxisMax = xRangeLocal?.[1];\n\n      const { autorange: yAxisAutorange, range: newYRange } = layout.yaxis || {};\n      const yRangeChanged = !isEqual(yAxisAutorange ? [undefined, undefined] : newYRange, [yAxisMin, yAxisMax]);\n\n      if (yRangeChanged) {\n        // When user zoomed in/out or changed the Y range manually, hide the tooltip\n        destroyTooltip();\n      }\n\n      if (yAxisAutorange) {\n        yAxisMin = undefined;\n        yAxisMax = undefined;\n      } else if (newYRange) {\n        yAxisMin = newYRange[0];\n        yAxisMax = newYRange[1];\n      }\n\n      const { autorange: xAxisAutorange, range: newXRange } = layout.xaxis || {};\n      if (xAxisAutorange) {\n        // Remove saved range if chart is back to default viewport\n        xAxisMin = undefined;\n        xAxisMax = undefined;\n      } else if (newXRange) {\n        const ungroupedRunUuids = compact(slicedRuns.map(({ runInfo }) => runInfo?.runUuid));\n        const groupedRunUuids = slicedRuns.flatMap(({ groupParentInfo }) => groupParentInfo?.runUuids ?? []);\n\n        if (!shouldEnableRelativeTimeDateAxis() && config.xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n          const timestampRange = findAbsoluteTimestampRangeForRelativeRange(\n            resultsByRunUuid,\n            [...ungroupedRunUuids, ...groupedRunUuids],\n            newXRange as [number, number],\n          );\n          setOffsetTimestamp([...(timestampRange as [number, number])]);\n        } else if (config.xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS) {\n          const timestampRange = findAbsoluteTimestampRangeForRelativeRange(\n            resultsByRunUuid,\n            [...ungroupedRunUuids, ...groupedRunUuids],\n            newXRange as [number, number],\n            1000 * 60 * 60, // Convert hours to milliseconds\n          );\n          setOffsetTimestamp([...(timestampRange as [number, number])]);\n        } else {\n          setOffsetTimestamp(undefined);\n        }\n        xAxisMin = newXRange[0];\n        xAxisMax = newXRange[1];\n      }\n\n      if (\n        !isEqual(\n          { xMin: xRangeLocal?.[0], xMax: xRangeLocal?.[1], yMin: yRangeLocal?.[0], yMax: yRangeLocal?.[1] },\n          { xMin: xAxisMin, xMax: xAxisMax, yMin: yAxisMin, yMax: yAxisMax },\n        )\n      ) {\n        setXRangeLocal(isUndefined(xAxisMin) || isUndefined(xAxisMax) ? undefined : [xAxisMin, xAxisMax]);\n        setYRangeLocal(isUndefined(yAxisMin) || isUndefined(yAxisMax) ? undefined : [yAxisMin, yAxisMax]);\n      }\n    }\n  };\n\n  const chartLayoutUpdatedLegacy = ({ layout }: Readonly<Figure>) => {\n    const { range: newYRange } = layout.yaxis || {};\n    const yRangeChanged = !isEqual(newYRange, yRangeLegacy.current);\n    if (yRangeChanged) {\n      // When user zoomed in/out or changed the Y range manually, hide the tooltip\n      destroyTooltip();\n    }\n\n    // Save the last Y range value (copy the values since plotly works on mutable arrays)\n    yRangeLegacy.current = [...(newYRange as [number, number])];\n\n    // Make sure that the x-axis is initialized\n    if (!layout.xaxis) {\n      return;\n    }\n    const { autorange, range: newXRange } = layout.xaxis;\n    if (autorange) {\n      // Remove saved range if chart is back to default viewport\n      setXRangeLocal(undefined);\n      return;\n    }\n    if (isEqual(newXRange, xRangeLocal)) {\n      // If it's the same as previous, do nothing.\n      // Note: we're doing deep comparison here because the range has\n      // to be cloned due to plotly handling values in mutable way.\n      return;\n    }\n    // If the custom range is used, memoize it\n    if (!autorange && newXRange) {\n      const ungroupedRunUuids = compact(slicedRuns.map(({ runInfo }) => runInfo?.runUuid));\n      const groupedRunUuids = slicedRuns.flatMap(({ groupParentInfo }) => groupParentInfo?.runUuids ?? []);\n\n      if (!shouldEnableRelativeTimeDateAxis() && config.xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n        const timestampRange = findAbsoluteTimestampRangeForRelativeRange(\n          resultsByRunUuid,\n          [...ungroupedRunUuids, ...groupedRunUuids],\n          newXRange as [number, number],\n        );\n        setOffsetTimestamp([...(timestampRange as [number, number])]);\n      } else if (config.xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS) {\n        const timestampRange = findAbsoluteTimestampRangeForRelativeRange(\n          resultsByRunUuid,\n          [...ungroupedRunUuids, ...groupedRunUuids],\n          newXRange as [number, number],\n          1000 * 60 * 60, // Convert hours to milliseconds\n        );\n        setOffsetTimestamp([...(timestampRange as [number, number])]);\n      } else {\n        setOffsetTimestamp(undefined);\n      }\n      setXRangeLocal([...(newXRange as [number, number])]);\n    }\n  };\n\n  useEffect(() => {\n    destroyTooltip();\n  }, [destroyTooltip, isLoading]);\n\n  const sampledData: RunsChartsRunData[] = useMemo(\n    () =>\n      slicedRuns.map((run) => {\n        const metricsHistory = metricKeys.reduce((acc: MetricHistoryByName, key) => {\n          const history = resultsByRunUuid[run.uuid]?.[key]?.metricsHistory;\n          if (history) {\n            acc[key] = config.ignoreOutliers ? removeOutliersFromMetricHistory(history) : history;\n          }\n          return acc;\n        }, {});\n\n        return {\n          ...run,\n          metricsHistory,\n        };\n      }),\n    [metricKeys, resultsByRunUuid, slicedRuns, config.ignoreOutliers],\n  );\n\n  const sampledGroupData = useGroupedChartRunData({\n    enabled: isGrouped,\n    ungroupedRunsData: sampledData,\n    metricKeys,\n    sampledDataResultsByRunUuid: resultsByRunUuid,\n    aggregateFunction,\n    selectedXAxisMetricKey:\n      config.xAxisKey === RunsChartsLineChartXAxisType.METRIC ? config.selectedXAxisMetricKey : undefined,\n    ignoreOutliers: config.ignoreOutliers ?? false,\n  });\n\n  // Use grouped data traces only if enabled and if there are any groups\n  const chartData = isGrouped ? sampledGroupData : sampledData;\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  // If the component is not in the viewport, we don't want to render the chart\n  const renderChartBody = isInViewport;\n\n  // If the data is loading or chart has just entered the viewport, show a skeleton\n  const renderSkeleton = isLoading || !isInViewportDeferred;\n\n  const chartBody = (\n    <div\n      css={[\n        styles.lineChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n      ref={elementRef}\n    >\n      {!renderChartBody ? null : renderSkeleton ? (\n        <LegacySkeleton />\n      ) : (\n        <RunsMetricsLinePlot\n          runsData={chartData}\n          metricKey={config.metricKey}\n          selectedMetricKeys={config.selectedMetricKeys}\n          scaleType={config.scaleType}\n          xAxisKey={config.xAxisKey}\n          xAxisScaleType={config.xAxisScaleType}\n          selectedXAxisMetricKey={config.selectedXAxisMetricKey}\n          lineSmoothness={config.lineSmoothness}\n          useDefaultHoverBox={false}\n          onHover={setTooltip}\n          onUnhover={resetTooltip}\n          selectedRunUuid={selectedRunUuid}\n          onUpdate={usingManualRangeControls ? chartLayoutUpdated : chartLayoutUpdatedLegacy}\n          xRange={xRangeLocal}\n          yRange={usingManualRangeControls ? yRangeLocal : yRangeLegacy.current}\n          fullScreen={fullScreen}\n          displayPoints={config.displayPoints}\n          onSetDownloadHandler={setImageDownloadHandler}\n        />\n      )}\n    </div>\n  );\n\n  const onClickDownload = useCallback(\n    (format) => {\n      const savedChartTitle = config.selectedMetricKeys?.join('-') ?? config.metricKey;\n      if (format === 'csv-full') {\n        const singleRunUuids = compact(chartData.map((d) => d.runInfo?.runUuid));\n        const runUuidsFromGroups = compact(\n          chartData\n            .filter(({ groupParentInfo }) => groupParentInfo)\n            .flatMap((group) => group.groupParentInfo?.runUuids),\n        );\n        const runUuids = [...singleRunUuids, ...runUuidsFromGroups];\n        onDownloadFullMetricHistoryCsv?.(runUuids, config.selectedMetricKeys || [config.metricKey]);\n        return;\n      }\n      if (format === 'csv') {\n        downloadChartMetricHistoryCsv(chartData, config.selectedMetricKeys || [config.metricKey], savedChartTitle);\n        return;\n      }\n      imageDownloadHandler?.(format, savedChartTitle);\n    },\n    [chartData, config, imageDownloadHandler, onDownloadFullMetricHistoryCsv],\n  );\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={getV2ChartTitle(config)}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      supportedDownloadFormats={SUPPORTED_DOWNLOAD_FORMATS}\n      onClickDownload={onClickDownload}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={isEmptyDataset ? undefined : toggleFullScreenChart}\n      isRefreshing={isRefreshing}\n      isHidden={!isInViewport}\n      {...reorderProps}\n    >\n      {isEmptyDataset ? <RunsChartsNoDataFoundIndicator /> : chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  lineChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","import { useMemo, useState } from 'react';\nimport { findChartStepsByTimestampForRuns } from '../utils/findChartStepsByTimestamp';\nimport { SampledMetricsByRunUuidState } from '../../../types';\nimport { isNumber, isString, isUndefined } from 'lodash';\nimport { RunsChartsLineChartXAxisType } from '../components/RunsCharts.common';\nimport { RunsChartsLineCardConfig } from '../runs-charts.types';\nimport { shouldEnableManualRangeControls } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\n\n/**\n * Hook used in compare run charts. It's responsible for converting selected range\n * (which can be either step or timestamp) to step range, based on chart axis type.\n * @param config Line chart configuration\n * @param xAxisKey Can be 'step', 'time' or 'time-relative'\n * @param metricKey\n * @param sampledMetricsByRunUuid Recorded history for metrics for runs in compare chart\n * @param runUuids List of run UUIDs in compare chart\n * @param scaleType Scale type for the chart\n */\nexport const useCompareRunChartSelectedRange = (\n  config: RunsChartsLineCardConfig,\n  xAxisKey: RunsChartsLineChartXAxisType,\n  metricKey: string,\n  sampledMetricsByRunUuid: SampledMetricsByRunUuidState,\n  runUuids: string[],\n  scaleType: 'linear' | 'log' = 'linear',\n) => {\n  const [xRangeLocal, setXRangeLocal] = useState<[number | string, number | string] | undefined>(() => {\n    if (\n      shouldEnableManualRangeControls() &&\n      config.range &&\n      !isUndefined(config.range.xMin) &&\n      !isUndefined(config.range.xMax)\n    ) {\n      return [config.range.xMin, config.range.xMax];\n    }\n    return undefined;\n  });\n  const [offsetTimestamp, setOffsetTimestamp] = useState<[number, number] | undefined>(undefined);\n  const stepRange = useMemo<[number, number] | undefined>(() => {\n    if (!xRangeLocal) {\n      return undefined;\n    }\n    if (xAxisKey === RunsChartsLineChartXAxisType.TIME && isString(xRangeLocal[0]) && isString(xRangeLocal[1])) {\n      // If we're dealing with absolute time-based chart axis, find corresponding steps based on timestamp\n      const bounds = findChartStepsByTimestampForRuns(\n        sampledMetricsByRunUuid,\n        runUuids,\n        metricKey,\n        xRangeLocal as [string, string],\n      );\n      return bounds;\n    }\n\n    if (\n      xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE &&\n      offsetTimestamp &&\n      isNumber(xRangeLocal[0]) &&\n      isNumber(xRangeLocal[1])\n    ) {\n      // If we're dealing with absolute time-based chart axis, find corresponding steps based on timestamp\n      const bounds = findChartStepsByTimestampForRuns(\n        sampledMetricsByRunUuid,\n        runUuids,\n        metricKey,\n        offsetTimestamp as [number, number],\n      );\n      return bounds;\n    }\n\n    if (xAxisKey === RunsChartsLineChartXAxisType.STEP && isNumber(xRangeLocal[0]) && isNumber(xRangeLocal[1])) {\n      // If we're dealing with step-based chart axis, use those steps but incremented/decremented\n      const lowerBound = Math.floor(scaleType === 'log' ? 10 ** xRangeLocal[0] : xRangeLocal[0]);\n      const upperBound = Math.ceil(scaleType === 'log' ? 10 ** xRangeLocal[1] : xRangeLocal[1]);\n      return lowerBound && upperBound ? [lowerBound - 1, upperBound + 1] : undefined;\n    }\n\n    // return undefined for xAxisKey === 'metric' because there isn't\n    // necessarily a mapping between value range and step range\n    return undefined;\n  }, [xAxisKey, metricKey, xRangeLocal, sampledMetricsByRunUuid, runUuids, offsetTimestamp, scaleType]);\n\n  return {\n    /**\n     * If there's an offset timestamp calculated from relative runs, set it using this function\n     */\n    setOffsetTimestamp,\n    /**\n     * Resulting step range\n     */\n    stepRange,\n    /**\n     * Local range selected by user\n     */\n    xRangeLocal,\n    /**\n     * Set selected range\n     */\n    setXRangeLocal,\n  };\n};\n","import { useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport type { RunsChartsScatterCardConfig } from '../../runs-charts.types';\nimport {\n  ChartRunsCountIndicator,\n  RunsChartCardFullScreenProps,\n  RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n} from './ChartCard.common';\nimport { RunsScatterPlot } from '../RunsScatterPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { useIsInViewport } from '../../hooks/useIsInViewport';\nimport {\n  shouldEnableHidingChartsWithNoData,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport { useChartImageDownloadHandler } from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { intersection, uniq } from 'lodash';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\n\nexport interface RunsChartsScatterChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsScatterCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n}\n\nexport const RunsChartsScatterChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  ...reorderProps\n}: RunsChartsScatterChartCardProps) => {\n  const title = `${config.xaxis.key} vs. ${config.yaxis.key}`;\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const isEmptyDataset = useMemo(() => {\n    if (!shouldEnableHidingChartsWithNoData()) {\n      return false;\n    }\n    const metricKeys = [config.xaxis.key, config.yaxis.key];\n    const metricsInRuns = slicedRuns.flatMap(({ metrics }) => Object.keys(metrics));\n    return intersection(metricKeys, uniq(metricsInRuns)).length === 0;\n  }, [config, slicedRuns]);\n\n  const { setTooltip, resetTooltip, selectedRunUuid } = useRunsChartsTooltip(config);\n\n  const { elementRef, isInViewport } = useIsInViewport();\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  const chartBody = (\n    <div\n      css={[\n        styles.scatterChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n      ref={elementRef}\n    >\n      {isInViewport ? (\n        <RunsScatterPlot\n          runsData={slicedRuns}\n          xAxis={config.xaxis}\n          yAxis={config.yaxis}\n          onHover={setTooltip}\n          onUnhover={resetTooltip}\n          useDefaultHoverBox={false}\n          selectedRunUuid={selectedRunUuid}\n          onSetDownloadHandler={setImageDownloadHandler}\n        />\n      ) : null}\n    </div>\n  );\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={title}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={isEmptyDataset ? undefined : toggleFullScreenChart}\n      supportedDownloadFormats={['png', 'svg', 'csv']}\n      onClickDownload={(format) => {\n        const savedChartTitle = [config.xaxis.key, config.yaxis.key].join('-');\n        if (format === 'csv' || format === 'csv-full') {\n          const paramsToExport = [];\n          const metricsToExport = [];\n          for (const axis of ['xaxis' as const, 'yaxis' as const]) {\n            if (config[axis].type === 'PARAM') {\n              paramsToExport.push(config[axis].key);\n            } else {\n              metricsToExport.push(config[axis].key);\n            }\n          }\n          downloadChartDataCsv(slicedRuns, metricsToExport, paramsToExport, savedChartTitle);\n          return;\n        }\n        imageDownloadHandler?.(format, savedChartTitle);\n      }}\n      {...reorderProps}\n    >\n      {isEmptyDataset ? <RunsChartsNoDataFoundIndicator /> : chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  scatterChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","import { useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport type { RunsChartsContourCardConfig } from '../../runs-charts.types';\nimport {\n  ChartRunsCountIndicator,\n  RunsChartCardFullScreenProps,\n  RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n} from './ChartCard.common';\nimport { RunsContourPlot } from '../RunsContourPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport {\n  shouldEnableHidingChartsWithNoData,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport { useChartImageDownloadHandler } from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { intersection, uniq } from 'lodash';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\n\nexport interface RunsChartsContourChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsContourCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n}\n\nexport const RunsChartsContourChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  ...reorderProps\n}: RunsChartsContourChartCardProps) => {\n  const title = `${config.xaxis.key} vs. ${config.yaxis.key} vs. ${config.zaxis.key}`;\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const isEmptyDataset = useMemo(() => {\n    if (!shouldEnableHidingChartsWithNoData()) {\n      return false;\n    }\n    const metricKeys = [config.xaxis.key, config.yaxis.key, config.zaxis.key];\n    const metricsInRuns = slicedRuns.flatMap(({ metrics }) => Object.keys(metrics));\n    return intersection(metricKeys, uniq(metricsInRuns)).length === 0;\n  }, [config, slicedRuns]);\n\n  const { setTooltip, resetTooltip, selectedRunUuid } = useRunsChartsTooltip(config);\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  const chartBody = (\n    <div\n      css={[\n        styles.contourChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n    >\n      <RunsContourPlot\n        runsData={slicedRuns}\n        xAxis={config.xaxis}\n        yAxis={config.yaxis}\n        zAxis={config.zaxis}\n        useDefaultHoverBox={false}\n        onHover={setTooltip}\n        onUnhover={resetTooltip}\n        selectedRunUuid={selectedRunUuid}\n        onSetDownloadHandler={setImageDownloadHandler}\n      />\n    </div>\n  );\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={title}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={isEmptyDataset ? undefined : toggleFullScreenChart}\n      supportedDownloadFormats={['png', 'svg', 'csv']}\n      onClickDownload={(format) => {\n        const savedChartTitle = [config.xaxis.key, config.yaxis.key, config.zaxis.key].join('-');\n        if (format === 'csv' || format === 'csv-full') {\n          const paramsToExport = [];\n          const metricsToExport = [];\n          for (const axis of ['xaxis' as const, 'yaxis' as const, 'zaxis' as const]) {\n            if (config[axis].type === 'PARAM') {\n              paramsToExport.push(config[axis].key);\n            } else {\n              metricsToExport.push(config[axis].key);\n            }\n          }\n          downloadChartDataCsv(slicedRuns, metricsToExport, paramsToExport, savedChartTitle);\n          return;\n        }\n        imageDownloadHandler?.(format, savedChartTitle);\n      }}\n      {...reorderProps}\n    >\n      {isEmptyDataset ? <RunsChartsNoDataFoundIndicator /> : chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  contourChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","var _path, _path2, _g, _defs;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nfunction SvgParallelChartPlaceholder(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 80,\n    height: 42,\n    viewBox: \"0 0 80 42\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.28418 2.34094L39.4998 17.0908L76.3746 7.87216\",\n    stroke: \"#CF797B\",\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.95459 20.443L40.1702 25.1361L77.045 21.1134M1.95459 36.5338L40.1702 35.1929L77.045 25.1361\",\n    stroke: \"#A88E6F\",\n    strokeLinecap: \"round\"\n  })), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    opacity: 0.8\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.28418 1V40.3341\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M40.6189 2.07251V39.9763\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M77.7156 2.07251V39.9763\",\n    stroke: \"url(#paint0_linear_2781_406689)\",\n    strokeWidth: 4,\n    strokeLinecap: \"square\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"linearGradient\", {\n    id: \"paint0_linear_2781_406689\",\n    x1: 78.2156,\n    y1: 2.07251,\n    x2: 78.2156,\n    y2: 39.9763,\n    gradientUnits: \"userSpaceOnUse\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#D04F5E\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: 1,\n    stopColor: \"#4D9734\"\n  })))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgParallelChartPlaceholder);\nexport default __webpack_public_path__ + \"static/media/parallel-chart-placeholder.234ef0c5b220ef2a5a6fa5bafff173f7.svg\";\nexport { ForwardRef as ReactComponent };","import { Button, DropdownMenu, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { useCallback, useMemo } from 'react';\nimport { ReactComponent as ParallelChartSvg } from '../../../../../common/static/parallel-chart-placeholder.svg';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport LazyParallelCoordinatesPlot, { processParallelCoordinateData } from '../charts/LazyParallelCoordinatesPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport type { RunsChartsParallelCardConfig } from '../../runs-charts.types';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  RunsChartCardFullScreenProps,\n} from './ChartCard.common';\nimport { useIsInViewport } from '../../hooks/useIsInViewport';\nimport {\n  shouldEnableHidingChartsWithNoData,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport { FormattedMessage } from 'react-intl';\nimport { useUpdateExperimentViewUIState } from '../../../experiment-page/contexts/ExperimentPageUIStateContext';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsNoDataFoundIndicator } from '../RunsChartsNoDataFoundIndicator';\n\nexport interface RunsChartsParallelChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsParallelCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n  groupBy: RunsGroupByConfig | null;\n}\n\n/**\n * A placeholder component displayed before parallel coords chart is being configured by user\n */\nconst NotConfiguredParallelCoordsPlaceholder = ({ onEdit }: { onEdit: () => void }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ display: 'flex', flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n      <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'center', maxWidth: 360 }}>\n        <ParallelChartSvg />\n        <Typography.Title css={{ marginTop: theme.spacing.md }} color=\"secondary\" level={3}>\n          <FormattedMessage\n            defaultMessage=\"Compare parameter importance\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > chart not configured warning > title\"\n          />\n        </Typography.Title>\n        <Typography.Text css={{ marginBottom: theme.spacing.md }} color=\"secondary\">\n          <FormattedMessage\n            defaultMessage=\"Use the parallel coordinates chart to compare how various parameters in model affect your model metrics.\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > chart not configured warning > description\"\n          />\n        </Typography.Text>\n        <Button componentId=\"mlflow.charts.parallel_coords_chart_configure_button\" type=\"primary\" onClick={onEdit}>\n          <FormattedMessage\n            defaultMessage=\"Configure chart\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > configure chart button\"\n          />\n        </Button>\n      </div>\n    </div>\n  );\n};\n\n/**\n * A placeholder component displayed before parallel coords chart is being configured by user\n */\nconst UnsupportedDataPlaceholder = () => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ display: 'flex', flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n      <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'center', maxWidth: 360 }}>\n        <ParallelChartSvg />\n        <Typography.Title css={{ marginTop: theme.spacing.md, textAlign: 'center' }} color=\"secondary\" level={3}>\n          <FormattedMessage\n            defaultMessage=\"Parallel coordinates chart does not support aggregated string values.\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > unsupported string values warning > title\"\n          />\n        </Typography.Title>\n        <Typography.Text css={{ marginBottom: theme.spacing.md }} color=\"secondary\">\n          <FormattedMessage\n            defaultMessage=\"Use other parameters or disable run grouping to continue.\"\n            description=\"Experiment page > compare runs > parallel coordinates chart > unsupported string values warning > description\"\n          />\n        </Typography.Text>\n      </div>\n    </div>\n  );\n};\n\nexport const RunsChartsParallelChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  ...reorderProps\n}: RunsChartsParallelChartCardProps) => {\n  const updateUIState = useUpdateExperimentViewUIState();\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: 'Parallel Coordinates',\n      subtitle: displaySubtitle ? subtitle : null,\n    });\n  };\n\n  const configuredChartRunData = useMemo(() => {\n    if (!shouldUseNewRunRowsVisibilityModel() || config?.showAllRuns) {\n      return chartRunData;\n    }\n    return chartRunData?.filter(({ hidden }) => !hidden);\n  }, [chartRunData, config?.showAllRuns]);\n\n  const containsStringValues = useMemo(\n    () =>\n      config.selectedParams?.some(\n        (paramKey) => configuredChartRunData?.some((dataTrace) => isNaN(Number(dataTrace.params[paramKey]?.value))),\n        [config.selectedParams, configuredChartRunData],\n      ),\n    [config.selectedParams, configuredChartRunData],\n  );\n\n  const updateVisibleOnlySetting = useCallback(\n    (showAllRuns: boolean) => {\n      updateUIState((state) => {\n        const newCompareRunCharts = state.compareRunCharts?.map((existingChartConfig) => {\n          if (existingChartConfig.uuid === config.uuid) {\n            const parallelChartConfig = existingChartConfig as RunsChartsParallelCardConfig;\n            return { ...parallelChartConfig, showAllRuns };\n          }\n          return existingChartConfig;\n        });\n\n        return { ...state, compareRunCharts: newCompareRunCharts };\n      });\n    },\n    [config.uuid, updateUIState],\n  );\n\n  const [isConfigured, parallelCoordsData] = useMemo(() => {\n    const selectedParamsCount = config.selectedParams?.length || 0;\n    const selectedMetricsCount = config.selectedMetrics?.length || 0;\n\n    const configured = selectedParamsCount + selectedMetricsCount >= 2;\n\n    // Prepare the data in the parcoord-es format\n    const data = configured\n      ? processParallelCoordinateData(configuredChartRunData, config.selectedParams, config.selectedMetrics)\n      : [];\n\n    return [configured, data];\n  }, [config, configuredChartRunData]);\n\n  const isEmptyDataset = useMemo(() => {\n    return shouldEnableHidingChartsWithNoData() && parallelCoordsData.length === 0;\n  }, [parallelCoordsData]);\n\n  const { elementRef, isInViewport } = useIsInViewport();\n\n  const { setTooltip, resetTooltip, selectedRunUuid, closeContextMenu } = useRunsChartsTooltip(config);\n\n  const containsUnsupportedValues = containsStringValues && groupBy;\n  const displaySubtitle = isConfigured && !containsUnsupportedValues;\n\n  const subtitle = shouldUseNewRunRowsVisibilityModel() ? (\n    <>\n      {config.showAllRuns ? (\n        <FormattedMessage\n          defaultMessage=\"Showing all runs\"\n          description=\"Experiment page > compare runs > parallel chart > header > indicator for all runs shown\"\n        />\n      ) : (\n        <FormattedMessage\n          defaultMessage=\"Showing only visible runs\"\n          description=\"Experiment page > compare runs > parallel chart > header > indicator for only visible runs shown\"\n        />\n      )}\n    </>\n  ) : (\n    <>Comparing {parallelCoordsData.length} runs</>\n  );\n\n  const chartBody = (\n    <>\n      {!isConfigured ? (\n        <NotConfiguredParallelCoordsPlaceholder onEdit={onEdit} />\n      ) : containsUnsupportedValues ? (\n        <UnsupportedDataPlaceholder />\n      ) : parallelCoordsData.length === 0 ? (\n        <RunsChartsNoDataFoundIndicator />\n      ) : (\n        // Avoid displaying empty set, otherwise parcoord-es goes crazy\n        <div\n          css={[\n            styles.parallelChartCardWrapper,\n            {\n              height: fullScreen ? '100%' : undefined,\n            },\n          ]}\n          ref={elementRef}\n        >\n          {isInViewport ? (\n            <LazyParallelCoordinatesPlot\n              data={parallelCoordsData}\n              selectedParams={config.selectedParams}\n              selectedMetrics={config.selectedMetrics}\n              onHover={setTooltip}\n              onUnhover={resetTooltip}\n              axesRotateThreshold={8}\n              selectedRunUuid={selectedRunUuid}\n              closeContextMenu={closeContextMenu}\n            />\n          ) : null}\n        </div>\n      )}\n    </>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  const fullScreenEnabled = isConfigured && !containsUnsupportedValues && !isEmptyDataset;\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title=\"Parallel Coordinates\"\n      subtitle={displaySubtitle ? subtitle : null}\n      uuid={config.uuid}\n      tooltip=\"The Parallel Coordinates Chart now only shows runs with columns that are either numbers or strings. If a column has string entries, the runs corresponding to the 30 most recent unique values will be shown.\"\n      dragGroupKey={RunsChartsChartsDragGroup.PARALLEL_CHARTS_AREA}\n      // Disable fullscreen button if the chart is empty\n      toggleFullScreenChart={fullScreenEnabled ? toggleFullScreenChart : undefined}\n      additionalMenuContent={\n        shouldUseNewRunRowsVisibilityModel() ? (\n          <>\n            <DropdownMenu.Separator />\n            <DropdownMenu.CheckboxItem checked={!config.showAllRuns} onClick={() => updateVisibleOnlySetting(false)}>\n              <DropdownMenu.ItemIndicator />\n              <FormattedMessage\n                defaultMessage=\"Show only visible\"\n                description=\"Experiment page > compare runs tab > chart header > move down option\"\n              />\n            </DropdownMenu.CheckboxItem>\n            <DropdownMenu.CheckboxItem checked={config.showAllRuns} onClick={() => updateVisibleOnlySetting(true)}>\n              <DropdownMenu.ItemIndicator />\n              <FormattedMessage\n                defaultMessage=\"Show all runs\"\n                description=\"Experiment page > compare runs tab > chart header > move down option\"\n              />\n            </DropdownMenu.CheckboxItem>\n          </>\n        ) : null\n      }\n      supportedDownloadFormats={['csv']}\n      onClickDownload={(format) => {\n        const savedChartTitle = [...config.selectedMetrics, ...config.selectedParams].join('-');\n\n        if (format === 'csv') {\n          downloadChartDataCsv(configuredChartRunData, config.selectedMetrics, config.selectedParams, savedChartTitle);\n        }\n      }}\n      {...reorderProps}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  parallelChartCardWrapper: {\n    // Set \"display: flex\" here (and \"flex: 1\" in the child element)\n    // so the chart will grow in width and height\n    display: 'flex',\n    overflow: 'hidden',\n    cursor: 'pointer',\n  },\n};\n","import { Button, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { useCallback, useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  DISABLED_GROUP_WHEN_GROUPBY,\n  DifferenceCardConfigCompareGroup,\n  type RunsChartsCardConfig,\n  type RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  RunsChartCardFullScreenProps,\n  ChartRunsCountIndicator,\n} from './ChartCard.common';\nimport {\n  shouldEnableHidingChartsWithNoData,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport { DifferenceViewPlot } from '../charts/DifferenceViewPlot';\nimport { useConfirmChartCardConfigurationFn } from '../../hooks/useRunsChartsUIConfiguration';\nimport { useIntl, FormattedMessage } from 'react-intl';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\nexport interface RunsChartsDifferenceChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsDifferenceCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  hideEmptyCharts?: boolean;\n\n  onDelete: () => void;\n  onEdit: () => void;\n  groupBy: RunsGroupByConfig | null;\n}\n\n/**\n * A placeholder component displayed before runs difference chart is being configured by user\n */\nconst NotConfiguredDifferenceChartPlaceholder = ({ onEdit }: { onEdit: () => void }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ display: 'flex', flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n      <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'center', maxWidth: 360 }}>\n        <Typography.Title css={{ marginTop: theme.spacing.md }} color=\"secondary\" level={3}>\n          <FormattedMessage\n            defaultMessage=\"Compare runs\"\n            description=\"Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > chart not configured warning > title\"\n          />\n        </Typography.Title>\n        <Typography.Text css={{ marginBottom: theme.spacing.md }} color=\"secondary\">\n          <FormattedMessage\n            defaultMessage=\"Use the runs difference view to compare model and system metrics, parameters, attributes,\n            and tags across runs.\"\n            description=\"Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > chart not configured warning > description\"\n          />\n        </Typography.Text>\n        <Button componentId=\"mlflow.charts.difference_chart_configure_button\" type=\"primary\" onClick={onEdit}>\n          <FormattedMessage\n            defaultMessage=\"Configure chart\"\n            description=\"Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > configure chart button\"\n          />\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport const RunsChartsDifferenceChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n  hideEmptyCharts,\n  ...reorderProps\n}: RunsChartsDifferenceChartCardProps) => {\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: config.chartName,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const [isConfigured, slicedRuns] = useMemo(() => {\n    const configured = Boolean(config.compareGroups?.length);\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return [configured, chartRunData.filter(({ hidden }) => !hidden).reverse()];\n    }\n    return [configured, chartRunData.slice(0, config.runsCountToCompare || 10).reverse()];\n  }, [chartRunData, config]);\n\n  const isEmptyDataset = useMemo(() => {\n    return shouldEnableHidingChartsWithNoData() && !isConfigured;\n  }, [isConfigured]);\n\n  const confirmChartCardConfiguration = useConfirmChartCardConfigurationFn();\n\n  const setCardConfig = (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => {\n    confirmChartCardConfiguration(setter(config));\n  };\n\n  const showChangeFromBaselineToggle = useCallback(() => {\n    confirmChartCardConfiguration({\n      ...config,\n      showChangeFromBaseline: !config.showChangeFromBaseline,\n    } as RunsChartsCardConfig);\n  }, [config, confirmChartCardConfiguration]);\n\n  const showDifferencesOnlyToggle = useCallback(() => {\n    confirmChartCardConfiguration({\n      ...config,\n      showDifferencesOnly: !config.showDifferencesOnly,\n    } as RunsChartsCardConfig);\n  }, [config, confirmChartCardConfiguration]);\n\n  const { formatMessage } = useIntl();\n\n  const chartBody = (\n    <>\n      {!isConfigured ? (\n        <NotConfiguredDifferenceChartPlaceholder onEdit={onEdit} />\n      ) : (\n        <DifferenceViewPlot\n          previewData={slicedRuns}\n          groupBy={groupBy}\n          cardConfig={config}\n          setCardConfig={setCardConfig}\n        />\n      )}\n    </>\n  );\n  let showTooltip = undefined;\n  if (groupBy && DISABLED_GROUP_WHEN_GROUPBY.some((group) => config.compareGroups.includes(group))) {\n    showTooltip = formatMessage({\n      defaultMessage: 'Disable grouped runs to compare parameters, tag, or attributes',\n      description:\n        'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > disable group runs tooltip message',\n    });\n  }\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  // Do not render the card if the chart is empty and the user has enabled hiding empty charts\n  if (hideEmptyCharts && isEmptyDataset) {\n    return null;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={config.chartName}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      toggleFullScreenChart={toggleFullScreenChart}\n      toggles={[\n        {\n          toggleLabel: formatMessage({\n            defaultMessage: 'Show change from baseline',\n            description:\n              'Runs charts > components > cards > RunsChartsDifferenceChartCard > Show change from baseline toggle label',\n          }),\n          currentToggle: config.showChangeFromBaseline,\n          setToggle: showChangeFromBaselineToggle,\n        },\n        {\n          toggleLabel: formatMessage({\n            defaultMessage: 'Show differences only',\n            description:\n              'Runs charts > components > cards > RunsChartsDifferenceChartCard > Show differences only toggle label',\n          }),\n          currentToggle: config.showDifferencesOnly,\n          setToggle: showDifferencesOnlyToggle,\n        },\n      ]}\n      tooltip={showTooltip}\n      {...reorderProps}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n","import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  RunsChartCardFullScreenProps,\n  ChartRunsCountIndicator,\n} from './ChartCard.common';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\nimport { DifferenceViewPlot } from '../charts/DifferenceViewPlot';\nimport { useConfirmChartCardConfigurationFn } from '../../hooks/useRunsChartsUIConfiguration';\nimport { useIntl, FormattedMessage } from 'react-intl';\nimport { RunsChartsCardConfig, RunsChartsImageCardConfig } from '../../runs-charts.types';\nimport { ImageGridPlot } from '../charts/ImageGridPlot';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { useImageSliderStepMarks } from '../../hooks/useImageSliderStepMarks';\nimport {\n  DEFAULT_IMAGE_GRID_CHART_NAME,\n  LOG_IMAGE_TAG_INDICATOR,\n  NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE,\n} from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { LineSmoothSlider } from '@mlflow/mlflow/src/experiment-tracking/components/LineSmoothSlider';\nimport { RunsGroupByConfig } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/utils/experimentPage.group-row-utils';\n\nexport interface RunsChartsImageChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsImageCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  onDelete: () => void;\n  onEdit: () => void;\n  groupBy: RunsGroupByConfig | null;\n}\n\nexport const RunsChartsImageChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n  ...reorderProps\n}: RunsChartsImageChartCardProps) => {\n  const { theme } = useDesignSystemTheme();\n  const containerRef = useRef(null);\n  const [containerWidth, setContainerWidth] = useState(0);\n\n  useEffect(() => {\n    const resizeObserver = new ResizeObserver((entries) => {\n      setContainerWidth(entries[0].contentRect.width);\n    });\n    if (containerRef.current) {\n      resizeObserver.observe(containerRef.current);\n    }\n    return () => {\n      resizeObserver.disconnect();\n    };\n  }, [containerRef]);\n\n  // Optimizations for smoother slider experience. Maintain a local copy of config, and update\n  // the global state only after the user has finished dragging the slider.\n  const [tmpConfig, setTmpConfig] = useState(config);\n  const confirmChartCardConfiguration = useConfirmChartCardConfigurationFn();\n  const updateStep = useCallback(\n    (step: number) => {\n      confirmChartCardConfiguration({ ...config, step } as RunsChartsImageCardConfig);\n    },\n    [config, confirmChartCardConfiguration],\n  );\n  const tmpStepChange = (step: number) => {\n    setTmpConfig((conf) => ({ ...conf, step }));\n  };\n\n  const chartName = config.imageKeys.length === 1 ? config.imageKeys[0] : DEFAULT_IMAGE_GRID_CHART_NAME;\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: chartName,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const setCardConfig = (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => {\n    confirmChartCardConfiguration(setter(config));\n  };\n\n  const { stepMarks, maxMark, minMark } = useImageSliderStepMarks({\n    data: slicedRuns,\n    selectedImageKeys: config.imageKeys || [],\n  });\n\n  const stepMarkLength = Object.keys(stepMarks).length;\n\n  useEffect(() => {\n    // If there is only one step mark, set the step to the min mark\n    if (stepMarkLength === 1 && tmpConfig.step !== minMark) {\n      updateStep(minMark);\n    }\n  }, [minMark, stepMarkLength, tmpConfig.step, updateStep]);\n\n  const shouldDisplayImageLimitIndicator =\n    slicedRuns.filter((run) => {\n      return run.tags[LOG_IMAGE_TAG_INDICATOR];\n    }).length > NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE;\n\n  const chartBody = (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        height: fullScreen ? '100%' : undefined,\n        width: '100%',\n        overflow: 'auto',\n      }}\n    >\n      <div\n        ref={containerRef}\n        css={{\n          cursor: 'pointer',\n          height: `calc(100% - ${theme.spacing.md * 2}px)`,\n          overflow: 'auto',\n        }}\n      >\n        <ImageGridPlot\n          previewData={slicedRuns}\n          groupBy={groupBy}\n          cardConfig={tmpConfig}\n          setCardConfig={setCardConfig}\n          containerWidth={containerWidth}\n        />\n      </div>\n      <div\n        css={{\n          justifyContent: 'center',\n          alignItems: 'center',\n          display: 'inline-flex',\n          gap: theme.spacing.md,\n        }}\n      >\n        <div css={{ width: '350px' }}>\n          <LineSmoothSlider\n            defaultValue={tmpConfig.step}\n            onChange={tmpStepChange}\n            max={maxMark}\n            min={minMark}\n            marks={stepMarks}\n            step={null}\n            disabled={Object.keys(stepMarks).length <= 1}\n            onAfterChange={updateStep}\n          />\n        </div>\n      </div>\n    </div>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={chartName}\n      subtitle={\n        shouldDisplayImageLimitIndicator && `Displaying images from first ${NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE} runs`\n      }\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      toggleFullScreenChart={toggleFullScreenChart}\n      {...reorderProps}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n","import { useMemo, memo } from 'react';\nimport { RunsChartType } from '../../runs-charts.types';\nimport type {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartsContourCardConfig,\n  RunsChartsDifferenceCardConfig,\n  RunsChartsImageCardConfig,\n  RunsChartsLineCardConfig,\n  RunsChartsParallelCardConfig,\n  RunsChartsScatterCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  shouldEnableDifferenceViewCharts,\n  shouldEnableImageGridCharts,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport { RunsChartsBarChartCard } from './RunsChartsBarChartCard';\nimport { RunsChartsLineChartCard } from './RunsChartsLineChartCard';\nimport { RunsChartsScatterChartCard } from './RunsChartsScatterChartCard';\nimport { RunsChartsContourChartCard } from './RunsChartsContourChartCard';\nimport { RunsChartsParallelChartCard } from './RunsChartsParallelChartCard';\nimport { RunsChartCardFullScreenProps, RunsChartCardReorderProps } from './ChartCard.common';\nimport { RunsChartsDifferenceChartCard } from './RunsChartsDifferenceChartCard';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsImageChartCard } from './RunsChartsImageChartCard';\n\nexport interface RunsChartsCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  cardConfig: RunsChartsCardConfig;\n  chartRunData: RunsChartsRunData[];\n  onStartEditChart: (chart: RunsChartsCardConfig) => void;\n  onRemoveChart: (chart: RunsChartsCardConfig) => void;\n  onReorderCharts: (sourceChartUuid: string, targetChartUuid: string) => void;\n  onDownloadFullMetricHistoryCsv?: (runUuids: string[], metricKeys: string[]) => void;\n  index: number;\n  sectionIndex: number;\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n  groupBy: RunsGroupByConfig | null;\n}\n\nconst RunsChartsCardRaw = ({\n  cardConfig,\n  chartRunData,\n  index,\n  sectionIndex,\n  onStartEditChart,\n  onRemoveChart,\n  setFullScreenChart,\n  groupBy,\n  fullScreen,\n  canMoveDown,\n  canMoveUp,\n  previousChartUuid,\n  nextChartUuid,\n  onReorderWith,\n  autoRefreshEnabled,\n  onDownloadFullMetricHistoryCsv,\n  hideEmptyCharts,\n}: RunsChartsCardProps) => {\n  const chartElementKey = `${cardConfig.uuid}-${index}-${sectionIndex}`;\n\n  const reorderProps = useMemo(\n    () => ({\n      onReorderWith,\n      canMoveDown,\n      canMoveUp,\n      previousChartUuid,\n      nextChartUuid,\n    }),\n    [onReorderWith, canMoveDown, canMoveUp, previousChartUuid, nextChartUuid],\n  );\n\n  const editProps = useMemo(\n    () => ({\n      onEdit: () => onStartEditChart(cardConfig),\n      onDelete: () => onRemoveChart(cardConfig),\n      setFullScreenChart,\n    }),\n    [onStartEditChart, onRemoveChart, setFullScreenChart, cardConfig],\n  );\n\n  const commonChartProps = useMemo(\n    () => ({\n      fullScreen,\n      key: chartElementKey,\n      autoRefreshEnabled,\n      groupBy,\n      hideEmptyCharts,\n      ...editProps,\n      ...reorderProps,\n    }),\n    [fullScreen, chartElementKey, autoRefreshEnabled, groupBy, editProps, reorderProps, hideEmptyCharts],\n  );\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, cardConfig.runsCountToCompare || 10).reverse();\n  }, [chartRunData, cardConfig]);\n\n  if (cardConfig.type === RunsChartType.PARALLEL) {\n    return (\n      <RunsChartsParallelChartCard\n        config={cardConfig as RunsChartsParallelCardConfig}\n        chartRunData={chartRunData}\n        {...commonChartProps}\n      />\n    );\n  }\n\n  if (shouldEnableDifferenceViewCharts() && cardConfig.type === RunsChartType.DIFFERENCE) {\n    return (\n      <RunsChartsDifferenceChartCard\n        config={cardConfig as RunsChartsDifferenceCardConfig}\n        chartRunData={chartRunData}\n        {...commonChartProps}\n      />\n    );\n  }\n\n  if (shouldEnableImageGridCharts() && cardConfig.type === RunsChartType.IMAGE) {\n    return (\n      <RunsChartsImageChartCard\n        config={cardConfig as RunsChartsImageCardConfig}\n        chartRunData={chartRunData}\n        {...commonChartProps}\n      />\n    );\n  }\n\n  if (cardConfig.type === RunsChartType.BAR) {\n    return (\n      <RunsChartsBarChartCard\n        config={cardConfig as RunsChartsBarCardConfig}\n        chartRunData={slicedRuns}\n        {...commonChartProps}\n      />\n    );\n  } else if (cardConfig.type === RunsChartType.LINE) {\n    return (\n      <RunsChartsLineChartCard\n        config={cardConfig as RunsChartsLineCardConfig}\n        chartRunData={slicedRuns}\n        onDownloadFullMetricHistoryCsv={onDownloadFullMetricHistoryCsv}\n        {...commonChartProps}\n      />\n    );\n  } else if (cardConfig.type === RunsChartType.SCATTER) {\n    return (\n      <RunsChartsScatterChartCard\n        config={cardConfig as RunsChartsScatterCardConfig}\n        chartRunData={slicedRuns}\n        {...commonChartProps}\n      />\n    );\n  } else if (cardConfig.type === RunsChartType.CONTOUR) {\n    return (\n      <RunsChartsContourChartCard\n        config={cardConfig as RunsChartsContourCardConfig}\n        chartRunData={slicedRuns}\n        {...commonChartProps}\n      />\n    );\n  }\n  return null;\n};\n\nexport const RunsChartsCard = memo(RunsChartsCardRaw);\n","import { MLFLOW_SYSTEM_METRIC_PREFIX } from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { KeyValueEntity, MetricEntitiesByName } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { useCallback, useMemo } from 'react';\nimport { RunsChartsRunData } from '../components/RunsCharts.common';\nimport { DifferenceCardAttributes, RunsChartsDifferenceCardConfig } from '../runs-charts.types';\nimport Utils from '@mlflow/mlflow/src/common/utils/Utils';\nimport { Run } from '@mlflow/mlflow/src/experiment-tracking/sdk/MlflowMessages';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\n\nconst DEFAULT_EMPTY_VALUE = '-';\nconst DIFFERENCE_EPSILON = 1e-6;\nexport const getFixedPointValue = (val: string | number, places = 2) =>\n  typeof val === 'number' ? val.toFixed(places) : val;\n\nexport const differenceView = (a: string | number, b: string | number) => {\n  if (typeof a === 'string' || typeof b === 'string') {\n    return undefined;\n  } else {\n    const diff = a - b;\n    if (diff >= 0) {\n      return `+${getFixedPointValue(diff)}`;\n    } else {\n      return getFixedPointValue(diff).toString();\n    }\n  }\n};\n\nexport const isDifferent = (a: string | number, b: string | number) => {\n  if (a === DEFAULT_EMPTY_VALUE || b === DEFAULT_EMPTY_VALUE) {\n    return false;\n  }\n  // Check if type a and b are the same\n  if (typeof a !== typeof b) {\n    return true;\n  } else if (typeof a === 'number' && typeof b === 'number') {\n    return Math.abs(a - b) > DIFFERENCE_EPSILON;\n  } else if (typeof a === 'string' && typeof b === 'string') {\n    return a !== b;\n  }\n  return false;\n};\n\nexport const getDifferenceViewDataGroups = (\n  previewData: RunsChartsRunData[],\n  cardConfig: RunsChartsDifferenceCardConfig,\n  headingColumnId: string,\n  groupBy: RunsGroupByConfig | null,\n) => {\n  const getMetrics = (\n    filterCondition: (metric: string) => boolean,\n    runDataKeys: (data: RunsChartsRunData) => string[],\n    runDataAttribute: (\n      data: RunsChartsRunData,\n    ) =>\n      | MetricEntitiesByName\n      | Record<string, KeyValueEntity>\n      | Record<string, { key: string; value: string | number }>,\n  ) => {\n    // Get array of sorted keys\n    const keys = Array.from(new Set(previewData.flatMap((runData) => runDataKeys(runData))))\n      .filter((key) => filterCondition(key))\n      .sort();\n    const values = keys.flatMap((key: string) => {\n      const data: Record<string, string | number> = {};\n      let hasDifference = false;\n\n      previewData.forEach((runData, index) => {\n        // Set the key as runData.uuid and the value as the metric's value or DEFAULT_EMPTY_VALUE\n        data[runData.uuid] = runDataAttribute(runData)[key]\n          ? runDataAttribute(runData)[key].value\n          : DEFAULT_EMPTY_VALUE;\n        if (index > 0) {\n          const prev = previewData[index - 1];\n          if (isDifferent(data[prev.uuid], data[runData.uuid])) {\n            hasDifference = true;\n          }\n        }\n      });\n      if (cardConfig.showDifferencesOnly && !hasDifference) {\n        return [];\n      }\n      return [\n        {\n          [headingColumnId]: key,\n          ...data,\n        },\n      ];\n    });\n    return values;\n  };\n\n  const modelMetrics = getMetrics(\n    (metric: string) => !metric.startsWith(MLFLOW_SYSTEM_METRIC_PREFIX),\n    (runData: RunsChartsRunData) => Object.keys(runData.metrics),\n    (runData: RunsChartsRunData) => runData.metrics,\n  );\n\n  const systemMetrics = getMetrics(\n    (metric: string) => metric.startsWith(MLFLOW_SYSTEM_METRIC_PREFIX),\n    (runData: RunsChartsRunData) => Object.keys(runData.metrics),\n    (runData: RunsChartsRunData) => runData.metrics,\n  );\n\n  if (groupBy) {\n    return { modelMetrics, systemMetrics, parameters: [], tags: [], attributes: [] };\n  }\n\n  const parameters = getMetrics(\n    () => true,\n    (runData: RunsChartsRunData) => Object.keys(runData.params),\n    (runData: RunsChartsRunData) => runData.params,\n  );\n\n  const tags = getMetrics(\n    () => true,\n    (runData: RunsChartsRunData) => Utils.getVisibleTagValues(runData.tags).map(([key]) => key),\n    (runData: RunsChartsRunData) => runData.tags,\n  );\n\n  // Get attributes\n  const attributeGroups = [\n    DifferenceCardAttributes.USER,\n    DifferenceCardAttributes.SOURCE,\n    DifferenceCardAttributes.VERSION,\n    DifferenceCardAttributes.MODELS,\n  ];\n  const attributes = attributeGroups.flatMap((attribute) => {\n    const attributeData: Record<string, string | number> = {};\n    let hasDifference = false;\n    previewData.forEach((runData, index) => {\n      if (attribute === DifferenceCardAttributes.USER) {\n        const user = Utils.getUser(runData.runInfo, runData.tags);\n        attributeData[runData.uuid] = user;\n      } else if (attribute === DifferenceCardAttributes.SOURCE) {\n        const source = Utils.getSourceName(runData.tags);\n        attributeData[runData.uuid] = source;\n      } else if (attribute === DifferenceCardAttributes.VERSION) {\n        const version = Utils.getSourceVersion(runData.tags);\n        attributeData[runData.uuid] = version;\n      } else {\n        const models = Utils.getLoggedModelsFromTags(runData.tags);\n        attributeData[runData.uuid] = models.join(',');\n      }\n      if (index > 0) {\n        const prev = previewData[index - 1];\n        if (isDifferent(attributeData[prev.uuid], attributeData[runData.uuid])) {\n          hasDifference = true;\n        }\n      }\n    });\n    if (cardConfig.showDifferencesOnly && !hasDifference) {\n      return [];\n    }\n    return [\n      {\n        [headingColumnId]: attribute,\n        ...attributeData,\n      },\n    ];\n  });\n  return { modelMetrics, systemMetrics, parameters, tags, attributes };\n};\n","import { ExperimentRunsSelectorResult } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/utils/experimentRuns.selector';\nimport {\n  DifferenceCardAttributes,\n  DifferenceCardConfigCompareGroup,\n  RunsChartsCardConfig,\n  RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { ReactChild, ReactFragment, ReactPortal, useCallback, useMemo, useState } from 'react';\nimport { MLFLOW_SYSTEM_METRIC_PREFIX } from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { ColumnDef, flexRender, getCoreRowModel, useReactTable } from '@tanstack/react-table';\nimport {\n  Table,\n  TableCell,\n  TableHeader,\n  TableRow,\n  useDesignSystemTheme,\n  Typography,\n  Tag,\n  LegacyTooltip,\n} from '@databricks/design-system';\nimport { RunColorPill } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/components/RunColorPill';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { MetricEntitiesByName } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { differenceView, getDifferenceViewDataGroups, getFixedPointValue } from '../../utils/differenceView';\nimport { OverflowIcon, Button, DropdownMenu } from '@databricks/design-system';\nimport Utils from '@mlflow/mlflow/src/common/utils/Utils';\nimport { TableSkeletonRows } from '@databricks/design-system';\nimport { ArrowUpIcon } from '@databricks/design-system';\nimport { ArrowDownIcon } from '@databricks/design-system';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\nconst HEADING_COLUMN_ID = 'headingColumn';\nconst COLUMN_WIDTH = 200;\n\n/**\n * A placeholder component displayed when no difference view data is available to be displayed\n */\n\nconst NoDifferenceDataPlaceholder = () => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ display: 'flex', flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n      <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'center', maxWidth: 360 }}>\n        <Typography.Title css={{ marginTop: theme.spacing.md, textAlign: 'center' }} color=\"secondary\" level={3}>\n          <FormattedMessage\n            defaultMessage=\"No run differences to display\"\n            description=\"Experiment tracking > runs charts > charts > DifferenceViewPlot > no runs to display warning > title\"\n          />\n        </Typography.Title>\n        <Typography.Text css={{ marginBottom: theme.spacing.md, textAlign: 'center' }} color=\"secondary\">\n          <FormattedMessage\n            defaultMessage=\"Select other runs, toggle 'Show differences only', or re-configure the chart to compare model metrics, system metrics, parameters, tag, or attributes.\"\n            description=\"Experiment tracking > runs charts > charts > DifferenceViewPlot > no runs to display warning > text\"\n          />\n        </Typography.Text>\n      </div>\n    </div>\n  );\n};\n\nexport const DifferenceViewPlot = ({\n  previewData,\n  cardConfig,\n  groupBy,\n  setCardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsDifferenceCardConfig;\n  groupBy: RunsGroupByConfig | null;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n  const { theme } = useDesignSystemTheme();\n\n  const { modelMetrics, systemMetrics, parameters, tags, attributes } = useMemo(\n    () => getDifferenceViewDataGroups(previewData, cardConfig, HEADING_COLUMN_ID, groupBy),\n    [previewData, cardConfig, groupBy],\n  );\n  // Each metric/param is a row in the table\n  const getData = [\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.MODEL_METRICS) ? modelMetrics : []),\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.SYSTEM_METRICS) ? systemMetrics : []),\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.PARAMETERS) ? parameters : []),\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.ATTRIBUTES) ? attributes : []),\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.TAGS) ? tags : []),\n  ];\n\n  const { baselineColumn, nonBaselineColumns } = useMemo(() => {\n    // baseline column (can be undefined if no baseline selected)\n    let baselineColumn = previewData.find((runData) => runData.uuid === cardConfig.baselineColumnUuid);\n    if (baselineColumn === undefined && previewData.length > 0) {\n      // Set the first column as baseline column\n      baselineColumn = previewData[0];\n    }\n    // non-baseline columns\n    const nonBaselineColumns = previewData.filter(\n      (runData) => baselineColumn === undefined || runData.uuid !== baselineColumn.uuid,\n    );\n\n    return { baselineColumn, nonBaselineColumns };\n  }, [previewData, cardConfig.baselineColumnUuid]);\n\n  // Split columns into baseline/non-baseline\n  const getColumns = useMemo(() => {\n    const convertRunToColumnInfo = (runData: RunsChartsRunData, isBaseline: boolean) => {\n      const accessorFn = (row: Record<string, string | number>) => {\n        return {\n          text: row[runData.uuid],\n          difference: baselineColumn ? differenceView(row[runData.uuid], row[baselineColumn.uuid]) : null,\n        };\n      };\n\n      const baselineAccessorFn = (row: Record<string, string | number>) => {\n        return row[runData.uuid];\n      };\n      if (isBaseline) {\n        return {\n          id: runData.uuid,\n          header: () => {\n            return (\n              <span css={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-between' }}>\n                <span css={{ display: 'inline-flex', gap: theme.spacing.sm, alignItems: 'center' }}>\n                  <RunColorPill color={runData.color} />\n                  {runData.displayName}\n                  <Tag css={{ margin: 0 }}>\n                    <FormattedMessage\n                      defaultMessage=\"baseline\"\n                      description=\"Runs charts > components > charts > DifferenceViewPlot > baseline tag\"\n                    />\n                  </Tag>\n                </span>\n              </span>\n            );\n          },\n          size: COLUMN_WIDTH,\n          accessorFn: baselineAccessorFn,\n          cell: (row: any) => <span>{getFixedPointValue(row.getValue())}</span>,\n        };\n      }\n      return {\n        id: runData.uuid,\n        header: () => {\n          return (\n            <span css={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-between' }}>\n              <span css={{ display: 'inline-flex', gap: theme.spacing.sm, alignItems: 'center' }}>\n                <RunColorPill color={runData.color} />\n                {runData.displayName}\n              </span>\n            </span>\n          );\n        },\n        size: COLUMN_WIDTH,\n        accessorFn: accessorFn,\n        cell: (row: any) => (\n          <span css={{ display: 'inline-flex', gap: theme.spacing.md, verticalAlign: 'middle' }}>\n            <Typography.Text>{getFixedPointValue(row.getValue().text)}</Typography.Text>\n            {baselineColumn &&\n              cardConfig.showChangeFromBaseline &&\n              row.getValue().difference &&\n              (row.getValue().difference[0] === '-' ? (\n                <div css={{ display: 'inline-flex', gap: theme.spacing.xs }}>\n                  <Typography.Paragraph color=\"error\">{row.getValue().difference}</Typography.Paragraph>\n                  <ArrowDownIcon color=\"danger\" />\n                </div>\n              ) : (\n                <div css={{ display: 'inline-flex', gap: theme.spacing.xs }}>\n                  <Typography.Paragraph color=\"success\">{row.getValue().difference}</Typography.Paragraph>\n                  <ArrowUpIcon color=\"success\" />\n                </div>\n              ))}\n          </span>\n        ),\n      };\n    };\n\n    return [\n      {\n        id: HEADING_COLUMN_ID,\n        header: formatMessage({\n          defaultMessage: 'Compare by',\n          description: 'Runs charts > components > charts > DifferenceViewPlot > Compare by column heading',\n        }),\n        accessorKey: HEADING_COLUMN_ID,\n        size: COLUMN_WIDTH,\n      },\n      ...(baselineColumn ? [convertRunToColumnInfo(baselineColumn, true)] : []),\n      ...nonBaselineColumns.map((runData) => convertRunToColumnInfo(runData, false)),\n    ];\n  }, [theme.spacing, formatMessage, baselineColumn, nonBaselineColumns, cardConfig.showChangeFromBaseline]);\n\n  const table = useReactTable({\n    data: getData,\n    columns: getColumns,\n    enableColumnResizing: true,\n    columnResizeMode: 'onChange',\n    getCoreRowModel: getCoreRowModel(),\n  });\n\n  const updateBaselineColumnUuid = useCallback(\n    (baselineColumnUuid: string) => {\n      if (setCardConfig) {\n        setCardConfig((current) => ({\n          ...(current as RunsChartsDifferenceCardConfig),\n          baselineColumnUuid,\n        }));\n      }\n    },\n    [setCardConfig],\n  );\n\n  if (previewData.length === 0) {\n    return null;\n  }\n\n  if (table.getRowModel().rows.length === 0) {\n    return <NoDifferenceDataPlaceholder />;\n  }\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        overflow: 'auto hidden',\n        cursor: 'pointer',\n        height: undefined,\n        width: '100%',\n      }}\n    >\n      <div css={{ width: '100%' }}>\n        <Table style={{ width: table.getTotalSize() }} scrollable>\n          {table.getHeaderGroups().map((headerGroup) => (\n            <TableRow key={headerGroup.id} isHeader>\n              {headerGroup.headers.map((header, index) => {\n                return (\n                  <TableHeader\n                    key={header.id}\n                    style={{\n                      maxWidth: header.column.getSize(),\n                    }}\n                    resizable={header.column.getCanResize()}\n                    resizeHandler={header.getResizeHandler()}\n                  >\n                    <div\n                      css={{\n                        display: 'flex',\n                        flexDirection: 'row',\n                        gap: theme.spacing.xs,\n                        alignItems: 'center',\n                      }}\n                    >\n                      <div css={{ flexShrink: 1, flexGrow: 1, overflow: 'hidden' }}>\n                        {flexRender(header.column.columnDef.header, header.getContext())}\n                      </div>\n                      {index !== 0 && setCardConfig && (\n                        <div>\n                          <DropdownMenu.Root>\n                            <DropdownMenu.Trigger asChild>\n                              <Button componentId=\"set_as_baseline_button\" icon={<OverflowIcon />} />\n                            </DropdownMenu.Trigger>\n                            <DropdownMenu.Content>\n                              <DropdownMenu.Item onClick={() => updateBaselineColumnUuid(header.id)}>\n                                <FormattedMessage\n                                  defaultMessage=\"Set as baseline\"\n                                  description=\"Runs charts > components > charts > DifferenceViewPlot > Set as baseline dropdown option\"\n                                />\n                              </DropdownMenu.Item>\n                            </DropdownMenu.Content>\n                          </DropdownMenu.Root>\n                        </div>\n                      )}\n                    </div>\n                  </TableHeader>\n                );\n              })}\n            </TableRow>\n          ))}\n          {table.getRowModel().rows.map((row) => (\n            <TableRow key={row.id}>\n              {row.getAllCells().map((cell) => (\n                <TableCell key={cell.id} style={{ maxWidth: cell.column.getSize() }} multiline>\n                  {flexRender(cell.column.columnDef.cell, cell.getContext())}\n                </TableCell>\n              ))}\n            </TableRow>\n          ))}\n        </Table>\n      </div>\n    </div>\n  );\n};\n","import { ImageIcon } from '@databricks/design-system';\nimport { GenericSkeleton, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { getArtifactLocationUrl } from '@mlflow/mlflow/src/common/utils/ArtifactUtils';\nimport { ImageEntity } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { useState } from 'react';\nimport { Typography } from '@databricks/design-system';\nimport { ImagePreviewGroup, Image } from '../../../../../shared/building_blocks/Image';\n\nexport const MAX_IMAGE_SIZE = 225;\nexport const MIN_IMAGE_SIZE = 120;\nexport const IMAGE_GAP_SIZE = 10;\n\nexport const getImageSize = (numImages: number, width: number) => {\n  // Scale image size based on number of images\n  const maxImagesPerRow = Math.floor(width / MIN_IMAGE_SIZE);\n  if (numImages < maxImagesPerRow) {\n    return Math.min(width / numImages - IMAGE_GAP_SIZE, MAX_IMAGE_SIZE);\n  }\n  return width / maxImagesPerRow - IMAGE_GAP_SIZE;\n};\n\ntype ImagePlotProps = {\n  imageUrl: string;\n  compressedImageUrl: string;\n  imageSize?: number;\n  maxImageSize?: number;\n};\n\nexport const ImagePlot = ({ imageUrl, compressedImageUrl, imageSize, maxImageSize }: ImagePlotProps) => {\n  const [previewVisible, setPreviewVisible] = useState(false);\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ width: imageSize, height: imageSize || '100%' }}>\n      <div css={{ height: imageSize || '100%' }}>\n        {compressedImageUrl === undefined ? (\n          <GenericSkeleton label=\"Loading...\" css={{ height: imageSize, width: imageSize }} />\n        ) : (\n          <div\n            css={{\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              width: imageSize || '100%',\n              height: imageSize || '100%',\n              maxWidth: maxImageSize,\n              maxHeight: maxImageSize,\n              backgroundColor: theme.colors.backgroundSecondary,\n              '& .ant-image': {\n                height: '100%',\n                display: 'flex',\n                alignItems: 'center',\n              },\n            }}\n          >\n            <ImagePreviewGroup visible={previewVisible} onVisibleChange={setPreviewVisible}>\n              <Image\n                src={compressedImageUrl}\n                preview={{ src: imageUrl }}\n                style={{ maxWidth: maxImageSize || '100%', maxHeight: maxImageSize || '100%' }}\n              />\n            </ImagePreviewGroup>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport const ImagePlotWithHistory = ({\n  metadataByStep,\n  imageSize,\n  step,\n  runUuid,\n}: {\n  metadataByStep: Record<number, ImageEntity>;\n  imageSize?: number;\n  step: number;\n  runUuid: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  if (metadataByStep[step] === undefined) {\n    return (\n      <div\n        css={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          textAlign: 'center',\n          width: imageSize,\n          height: imageSize,\n          backgroundColor: theme.colors.backgroundSecondary,\n          padding: theme.spacing.md,\n        }}\n      >\n        <ImageIcon />\n        <FormattedMessage\n          defaultMessage=\"No image logged at this step\"\n          description=\"Experiment tracking > runs charts > charts > image plot with history > no image text\"\n        />\n      </div>\n    );\n  }\n  return (\n    <ImagePlot\n      imageUrl={getArtifactLocationUrl(metadataByStep[step].filepath, runUuid)}\n      compressedImageUrl={getArtifactLocationUrl(metadataByStep[step].compressed_filepath, runUuid)}\n      imageSize={imageSize}\n    />\n  );\n};\n\nexport const EmptyImageGridPlot = () => {\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n        alignItems: 'center',\n        height: '100%',\n        width: '100%',\n        fontSize: 16,\n      }}\n    >\n      <Typography.Title css={{ marginTop: 16 }} color=\"secondary\" level={3}>\n        Compare logged images\n      </Typography.Title>\n      <Typography.Text css={{ marginBottom: 16 }} color=\"secondary\">\n        Use the image grid chart to compare logged images across runs.\n      </Typography.Text>\n    </div>\n  );\n};\n","import { LegacyTooltip, useDesignSystemTheme } from '@databricks/design-system';\nimport { RunColorPill } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/components/RunColorPill';\nimport { useMemo } from 'react';\nimport { RunsChartsImageCardConfig, RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { EmptyImageGridPlot, IMAGE_GAP_SIZE, ImagePlotWithHistory, getImageSize } from './ImageGridPlot.common';\nimport { ImageEntity } from '@mlflow/mlflow/src/experiment-tracking/types';\n\nexport const ImageGridSingleKeyPlot = ({\n  previewData,\n  cardConfig,\n  width,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  groupBy?: string;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n  width: number;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  const displayRuns = previewData.filter((run: RunsChartsRunData) => {\n    const imageMetadata = run.images[cardConfig.imageKeys[0]];\n    return imageMetadata && Object.keys(imageMetadata).length > 0;\n  });\n\n  const imageSize = useMemo(() => {\n    return getImageSize(displayRuns.length, width);\n  }, [displayRuns, width]);\n\n  if (displayRuns.length === 0) {\n    return <EmptyImageGridPlot />;\n  }\n  return (\n    <div css={{ display: 'flex', justifyContent: 'flex-start', flexWrap: 'wrap' }}>\n      {displayRuns.map((run: RunsChartsRunData) => {\n        // There is exactly one key in this plot\n        const imageMetadataByStep = Object.values(run.images[cardConfig.imageKeys[0]]).reduce(\n          (acc, metadata: ImageEntity) => {\n            if (metadata.step !== undefined) {\n              acc[metadata.step] = metadata;\n            }\n            return acc;\n          },\n          {} as Record<number, ImageEntity>,\n        );\n        return (\n          <div key={run.uuid} css={{ padding: `${IMAGE_GAP_SIZE / 2}px` }}>\n            <LegacyTooltip title={run.displayName}>\n              <div\n                css={{\n                  width: imageSize,\n                  height: theme.typography.lineHeightMd,\n                  overflow: 'hidden',\n                  whiteSpace: 'nowrap',\n                  display: 'inline-flex',\n                  alignItems: 'center',\n                  gap: theme.spacing.sm,\n                }}\n              >\n                <RunColorPill color={run.color} />\n                {run.displayName}\n              </div>\n            </LegacyTooltip>\n            <ImagePlotWithHistory\n              key={run.uuid}\n              step={cardConfig.step}\n              metadataByStep={imageMetadataByStep}\n              imageSize={imageSize}\n              runUuid={run.uuid}\n            />\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n","import {\n  useDesignSystemTheme,\n  TableRow,\n  TableHeader,\n  TableCell,\n  Table,\n  LegacyTooltip,\n  Typography,\n} from '@databricks/design-system';\nimport { RunColorPill } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/components/RunColorPill';\nimport { useMemo } from 'react';\nimport { RunsChartsImageCardConfig, RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { EmptyImageGridPlot, getImageSize, ImagePlotWithHistory } from './ImageGridPlot.common';\nimport { ImageEntity } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { FormattedMessage } from 'react-intl';\n\nexport const ImageGridMultipleKeyPlot = ({\n  previewData,\n  cardConfig,\n  width,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  groupBy?: string;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n  width: number;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  const displayRuns = previewData.filter((run: RunsChartsRunData) => Object.keys(run.images).length !== 0);\n\n  const imageSize = useMemo(() => {\n    return getImageSize(displayRuns.length, width);\n  }, [displayRuns, width]);\n\n  if (displayRuns.length === 0) {\n    return <EmptyImageGridPlot />;\n  }\n  return (\n    <div css={{ height: '100%', width: '100%' }}>\n      <Table grid scrollable>\n        <TableRow isHeader>\n          <TableHeader css={{ minWidth: imageSize + theme.spacing.md }}>\n            <FormattedMessage\n              defaultMessage=\"images\"\n              description=\"Experiment tracking > runs charts > charts > image grid multiple key > table header text\"\n            />\n          </TableHeader>\n          {displayRuns.map((run: RunsChartsRunData) => {\n            return (\n              <TableHeader key={run.uuid} css={{ minWidth: imageSize + theme.spacing.md }}>\n                <LegacyTooltip title={run.displayName}>\n                  <div\n                    css={{\n                      height: theme.typography.lineHeightMd,\n                      whiteSpace: 'nowrap',\n                      display: 'inline-flex',\n                      alignItems: 'center',\n                      margin: 'auto',\n                      gap: theme.spacing.sm,\n                    }}\n                  >\n                    <RunColorPill color={run.color} />\n                    {run.displayName}\n                  </div>\n                </LegacyTooltip>\n              </TableHeader>\n            );\n          })}\n        </TableRow>\n        {cardConfig.imageKeys.map((imageKey) => {\n          return (\n            <TableRow key={imageKey}>\n              <TableCell css={{ minWidth: imageSize + theme.spacing.md }}>\n                <div style={{ whiteSpace: 'normal' }}>{imageKey}</div>\n              </TableCell>\n              {displayRuns.map((run: RunsChartsRunData) => {\n                if (run.images[imageKey] && Object.keys(run.images[imageKey]).length > 0) {\n                  const metadataByStep = Object.values(run.images[imageKey]).reduce((acc, metadata) => {\n                    if (metadata.step !== undefined) {\n                      acc[metadata.step] = metadata;\n                    }\n                    return acc;\n                  }, {} as Record<number, ImageEntity>);\n                  return (\n                    <TableCell key={run.uuid} css={{ minWidth: imageSize + theme.spacing.md }}>\n                      <ImagePlotWithHistory\n                        metadataByStep={metadataByStep}\n                        imageSize={imageSize}\n                        step={cardConfig.step}\n                        runUuid={run.uuid}\n                      />\n                    </TableCell>\n                  );\n                }\n                return <TableCell key={run.uuid} css={{ minWidth: imageSize + theme.spacing.md }} />;\n              })}\n            </TableRow>\n          );\n        })}\n      </Table>\n    </div>\n  );\n};\n","import { useDispatch } from 'react-redux';\nimport { RunsChartsImageCardConfig, RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { ThunkDispatch } from '@mlflow/mlflow/src/redux-types';\nimport { useEffect } from 'react';\nimport { shouldEnableImageGridCharts } from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { ImageGridSingleKeyPlot } from './ImageGridSingleKeyPlot';\nimport { ImageGridMultipleKeyPlot } from './ImageGridMultipleKeyPlot';\nimport {\n  DEFAULT_IMAGE_GRID_CHART_NAME,\n  LOG_IMAGE_TAG_INDICATOR,\n  NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE,\n} from '@mlflow/mlflow/src/experiment-tracking/constants';\nimport { RunsGroupByConfig } from '@mlflow/mlflow/src/experiment-tracking/components/experiment-page/utils/experimentPage.group-row-utils';\n\nexport const ImageGridPlot = ({\n  previewData,\n  cardConfig,\n  groupBy,\n  setCardConfig,\n  containerWidth,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  groupBy: RunsGroupByConfig | null;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n  containerWidth: number;\n}) => {\n  const filteredPreviewData = previewData\n    .filter((run: RunsChartsRunData) => {\n      return run.tags[LOG_IMAGE_TAG_INDICATOR];\n    })\n    .slice(-NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE);\n\n  if (cardConfig.imageKeys.length === 1) {\n    return <ImageGridSingleKeyPlot previewData={filteredPreviewData} cardConfig={cardConfig} width={containerWidth} />;\n  } else if (cardConfig.imageKeys.length > 1) {\n    return (\n      <ImageGridMultipleKeyPlot previewData={filteredPreviewData} cardConfig={cardConfig} width={containerWidth} />\n    );\n  }\n  return null;\n};\n","import { LegacySkeleton } from '@databricks/design-system';\nimport React, { Suspense } from 'react';\nimport { RunsChartsRunData } from '../RunsCharts.common';\n\nconst ParallelCoordinatesPlot = React.lazy(() => import('./ParallelCoordinatesPlot'));\n\nexport const MAX_NUMBER_STRINGS = 30;\nexport type ParallelCoordinateDataEntry = Record<string, string | number | null>;\n\nconst LazyParallelCoordinatesPlot = (props: any) => {\n  return (\n    <Suspense fallback={<LegacySkeleton />}>\n      <ParallelCoordinatesPlot {...props}></ParallelCoordinatesPlot>\n    </Suspense>\n  );\n};\n\n// Map all metrics, params and run uuid\n// Filter data to only keep the selected params and metrics from each run\nexport function processParallelCoordinateData(\n  chartRunData: RunsChartsRunData[],\n  selectedParams: string[],\n  selectedMetrics: string[],\n): ParallelCoordinateDataEntry[] {\n  const allRuns = chartRunData.map((run) => {\n    const result: ParallelCoordinateDataEntry = {\n      uuid: run.uuid,\n    };\n    function computeSelectedAttrs(attrs: string[], runvalue: Record<string, any>) {\n      if (Array.isArray(attrs)) {\n        for (const attr of attrs) {\n          if (attr in runvalue) {\n            result[attr] = runvalue[attr].value;\n          } else {\n            result[attr] = null;\n          }\n        }\n      }\n    }\n    computeSelectedAttrs(selectedParams, run.params);\n    computeSelectedAttrs(selectedMetrics, run.metrics);\n    return result;\n  });\n\n  return filterParallelCoordinateData(allRuns);\n}\n\n// filter data so each column only shows #s or strs, whichever allows more to be displayed\nexport function filterParallelCoordinateData(allRuns: ParallelCoordinateDataEntry[]): ParallelCoordinateDataEntry[] {\n  if (allRuns.length === 0) {\n    return allRuns;\n  }\n\n  const keys = Object.keys(allRuns[0]);\n  keys.shift(); // remove uuid as a key\n  let stringRuns: ParallelCoordinateDataEntry[] = allRuns;\n\n  // add runs with any string values until 30 unique values in any column\n  keys.forEach((key) => {\n    const numberRuns = stringRuns.filter((x) => {\n      return !isNaN(Number(x[key])) && x[key] !== null;\n    }); // this logic should remain the same as in getAxesTypes() for casting\n\n    if (numberRuns.length >= stringRuns.length / 2) {\n      stringRuns = numberRuns;\n      return;\n    }\n\n    const seenVals: Set<string> = new Set();\n    const tempRuns = [];\n    for (const run of stringRuns) {\n      const value = run[key];\n      if (seenVals.size === MAX_NUMBER_STRINGS && seenVals.has(String(value))) {\n        tempRuns.push(run);\n      } else if (seenVals.size < MAX_NUMBER_STRINGS && isNaN(Number(value))) {\n        seenVals.add(String(value));\n        tempRuns.push(run);\n      }\n    }\n    stringRuns = tempRuns;\n  });\n\n  return stringRuns;\n}\n\nexport default LazyParallelCoordinatesPlot;\n","import { Accordion, useDesignSystemTheme } from '@databricks/design-system';\nimport { CSSObject, css } from '@emotion/react';\nimport { useMemo } from 'react';\n\nexport const METRIC_CHART_SECTION_HEADER_SIZE = 55;\n\ninterface MetricChartsAccordionProps {\n  activeKey?: string | string[];\n  onActiveKeyChange?: (key: string | string[]) => void;\n  children: React.ReactNode;\n  disableCollapse?: boolean;\n}\n\nconst MetricChartsAccordion = ({\n  activeKey,\n  onActiveKeyChange,\n  children,\n  disableCollapse = false,\n}: MetricChartsAccordionProps) => {\n  const { theme, getPrefixedClassName } = useDesignSystemTheme();\n  const clsPrefix = getPrefixedClassName('collapse');\n\n  const styles = useMemo(() => {\n    const classItem = `.${clsPrefix}-item`;\n    const classItemActive = `${classItem}-active`;\n    const classHeader = `.${clsPrefix}-header`;\n    const classContent = `.${clsPrefix}-content`;\n    const classContentBox = `.${clsPrefix}-content-box`;\n    const classArrow = `.${clsPrefix}-arrow`;\n\n    const styles: CSSObject = {\n      [classContent]: {\n        padding: '0px !important',\n        backgroundColor: 'transparent !important',\n      },\n\n      [classContentBox]: {\n        padding: '0 0 12px 0px !important',\n        backgroundColor: 'transparent !important',\n      },\n\n      [`& > ${classItem} > ${classHeader} > ${classArrow}`]: {\n        fontSize: theme.general.iconSize,\n        left: 12,\n        // TODO: This is needed currently because the rotated icon isn't centered, remove when accordion is fixed\n        verticalAlign: '-7px',\n        transform: 'rotate(-90deg)',\n        display: disableCollapse ? 'none' : undefined,\n      },\n\n      [`& > ${classItemActive} > ${classHeader} > ${classArrow}`]: {\n        transform: 'rotate(0deg)',\n      },\n\n      [classHeader]: {\n        display: 'flex',\n        color: theme.colors.textPrimary,\n        fontWeight: 600,\n        alignItems: 'center',\n\n        '&:focus-visible': {\n          outlineColor: `${theme.colors.primary} !important`,\n          outlineStyle: 'auto !important',\n        },\n      },\n\n      [`& > ${classItem}`]: {\n        borderBottom: `1px solid ${theme.colors.border}`,\n        borderRadius: 0,\n      },\n\n      [`& > ${classItem} > ${classHeader}`]: {\n        padding: 0,\n        lineHeight: '20px',\n        height: METRIC_CHART_SECTION_HEADER_SIZE,\n      },\n    };\n    return styles;\n  }, [theme, clsPrefix, disableCollapse]);\n\n  return (\n    <Accordion\n      {...(activeKey ? { activeKey } : {})}\n      {...(onActiveKeyChange ? { onChange: onActiveKeyChange } : {})}\n      dangerouslyAppendEmotionCSS={css(styles)}\n      dangerouslySetAntdProps={{ expandIconPosition: 'left' }}\n    >\n      {children}\n    </Accordion>\n  );\n};\n\nexport default MetricChartsAccordion;\n","import { Button, DropdownMenu, PlusIcon } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\n\nimport { ReactComponent as ChartBarIcon } from '../../../../common/static/chart-bar.svg';\nimport { ReactComponent as ChartContourIcon } from '../../../../common/static/chart-contour.svg';\nimport { ReactComponent as ChartLineIcon } from '../../../../common/static/chart-line.svg';\nimport { ReactComponent as ChartParallelIcon } from '../../../../common/static/chart-parallel.svg';\nimport { ReactComponent as ChartScatterIcon } from '../../../../common/static/chart-scatter.svg';\nimport { ReactComponent as ChartDifferenceIcon } from '../../../../common/static/chart-difference.svg';\nimport { ReactComponent as ChartImageIcon } from '../../../../common/static/chart-image.svg';\nimport { RunsChartType } from '../runs-charts.types';\nimport {\n  shouldEnableDifferenceViewCharts,\n  shouldEnableImageGridCharts,\n} from '@mlflow/mlflow/src/common/utils/FeatureUtils';\nimport { FormattedMessage } from 'react-intl';\n\nexport interface RunsChartsAddChartMenuProps {\n  onAddChart: (type: RunsChartType) => void;\n  supportedChartTypes?: RunsChartType[];\n}\n\nexport const RunsChartsAddChartMenu = ({ onAddChart, supportedChartTypes }: RunsChartsAddChartMenuProps) => {\n  const isChartTypeSupported = (type: RunsChartType) => !supportedChartTypes || supportedChartTypes.includes(type);\n  return (\n    <DropdownMenu.Root modal={false}>\n      <DropdownMenu.Trigger asChild>\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscompareaddchartmenu.tsx_19\"\n          css={styles.addChartButton}\n          icon={<PlusIcon />}\n          data-testid=\"experiment-view-compare-runs-add-chart\"\n        >\n          <FormattedMessage\n            defaultMessage=\"Add chart\"\n            description=\"Experiment tracking > runs charts > add chart menu\"\n          />\n        </Button>\n      </DropdownMenu.Trigger>\n      <DropdownMenu.Content align=\"end\">\n        {isChartTypeSupported(RunsChartType.BAR) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.BAR)}\n            data-testid=\"experiment-view-compare-runs-chart-type-bar\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartBarIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Bar chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > bar chart\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.LINE) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.LINE)}\n            data-testid=\"experiment-view-compare-runs-chart-type-line\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartLineIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Line chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > line chart\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.PARALLEL) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.PARALLEL)}\n            data-testid=\"experiment-view-compare-runs-chart-type-parallel\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartParallelIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Parallel coordinates\"\n              description=\"Experiment tracking > runs charts > add chart menu > parallel coordinates\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.SCATTER) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.SCATTER)}\n            data-testid=\"experiment-view-compare-runs-chart-type-scatter\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartScatterIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Scatter chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > scatter plot\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.CONTOUR) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.CONTOUR)}\n            data-testid=\"experiment-view-compare-runs-chart-type-contour\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartContourIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Contour chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > contour chart\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {shouldEnableDifferenceViewCharts() && isChartTypeSupported(RunsChartType.DIFFERENCE) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.DIFFERENCE)}\n            data-testid=\"experiment-view-compare-runs-chart-type-difference\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartDifferenceIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Difference view\"\n              description=\"Experiment tracking > runs charts > add chart menu > difference view\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {shouldEnableImageGridCharts() && isChartTypeSupported(RunsChartType.IMAGE) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.IMAGE)}\n            data-testid=\"experiment-view-compare-runs-chart-type-image\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartImageIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Image grid\"\n              description=\"Experiment tracking > runs charts > add chart menu > image grid\"\n            />\n          </DropdownMenu.Item>\n        )}\n      </DropdownMenu.Content>\n    </DropdownMenu.Root>\n  );\n};\n\nconst styles = {\n  addChartButton: (theme: Theme) => ({\n    // Overriden while waiting for design decision in DuBois (FEINF-1711)\n    backgroundColor: `${theme.colors.backgroundPrimary} !important`,\n  }),\n  iconWrapper: (theme: Theme) => ({\n    width: theme.general.iconSize + theme.spacing.xs,\n  }),\n};\n","import {\n  Button,\n  DangerModal,\n  DragIcon,\n  DropdownMenu,\n  Input,\n  Modal,\n  OverflowIcon,\n  PencilIcon,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { ChartSectionConfig } from '../../../../types';\nimport { RunsChartsAddChartMenu } from '../RunsChartsAddChartMenu';\nimport { RunsChartType } from '../../runs-charts.types';\nimport { useEffect, useRef, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { useDragAndDropElement } from '@mlflow/mlflow/src/common/hooks/useDragAndDropElement';\nimport { CheckIcon } from '@databricks/design-system';\nimport { METRIC_CHART_SECTION_HEADER_SIZE } from '../../../MetricChartsAccordion';\nimport cx from 'classnames';\n\nexport interface RunsChartsSectionHeaderProps {\n  index: number;\n  section: ChartSectionConfig;\n  sectionChartsLength: number;\n  addNewChartCard: (metricSectionId: string) => (type: RunsChartType) => void;\n  onDeleteSection: (sectionId: string) => void;\n  onAddSection: (sectionId: string, above: boolean) => void;\n  editSection: number;\n  onSetEditSection: React.Dispatch<React.SetStateAction<number>>;\n  onSetSectionName: (sectionId: string, name: string) => void;\n  onSectionReorder: (sourceSectionId: string, targetSectionId: string) => void;\n  isExpanded: boolean;\n  supportedChartTypes?: RunsChartType[] | undefined;\n  /**\n   * Set to \"true\" to hide various controls (e.g. edit, add, delete) in the section header.\n   */\n  hideExtraControls: boolean;\n}\n\nexport const RunsChartsSectionHeader = ({\n  index,\n  section,\n  sectionChartsLength,\n  addNewChartCard,\n  onDeleteSection,\n  onAddSection,\n  editSection,\n  onSetEditSection,\n  onSetSectionName,\n  onSectionReorder,\n  isExpanded,\n  hideExtraControls,\n  supportedChartTypes,\n}: RunsChartsSectionHeaderProps) => {\n  const { theme } = useDesignSystemTheme();\n  // Change name locally for better performance\n  const [tmpSectionName, setTmpSectionName] = useState(section.name);\n  // State to check if element is being dragged\n  const [isDraggingHandle, setIsDraggingHandle] = useState(false);\n\n  // Ref and state to measure the width of the section name\n  const sectionNameRef = useRef<HTMLDivElement>(null);\n  const confirmButtonRef = useRef<HTMLButtonElement>(null);\n  const [sectionNameWidth, setSectionNameWidth] = useState(0.0);\n\n  // Delete section modal\n  const [isDeleteSectionModalOpen, setIsDeleteSectionModalOpen] = useState(false);\n\n  const stopPropagation = (e: any) => {\n    e.stopPropagation();\n  };\n\n  const deleteModalConfirm = () => {\n    onDeleteSection(section.uuid);\n  };\n\n  const deleteModalCancel = () => {\n    setIsDeleteSectionModalOpen(false);\n  };\n\n  const deleteSection = () => {\n    setIsDeleteSectionModalOpen(true);\n  };\n\n  const addSectionAbove = () => {\n    onAddSection(section.uuid, true);\n  };\n\n  const addSectionBelow = () => {\n    onAddSection(section.uuid, false);\n  };\n\n  const onEdit = (e: React.MouseEvent<HTMLElement>) => {\n    e.stopPropagation();\n    onSetEditSection(index);\n  };\n\n  const onChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setTmpSectionName(e.target.value);\n  };\n\n  const onSubmit = (e: React.KeyboardEvent<HTMLInputElement> | React.MouseEvent<HTMLElement>) => {\n    e.stopPropagation();\n    if (!tmpSectionName.trim()) {\n      e.preventDefault();\n      return;\n    }\n    onSetEditSection(-1);\n    onSetSectionName(section.uuid, tmpSectionName);\n  };\n\n  const onEsc = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Escape') {\n      e.stopPropagation();\n      onSetEditSection(-1);\n      setTmpSectionName(section.name);\n    }\n  };\n\n  const onBlur = (e: React.FocusEvent) => {\n    if (e.relatedTarget === confirmButtonRef.current) {\n      return;\n    }\n    onSetEditSection(-1);\n    onSetSectionName(section.uuid, tmpSectionName);\n  };\n\n  useEffect(() => {\n    if (!sectionNameRef.current) {\n      return;\n    }\n\n    const resizeObserver = new ResizeObserver(([entry]) => {\n      setSectionNameWidth(entry.contentRect.width);\n    });\n\n    resizeObserver.observe(sectionNameRef.current);\n\n    return () => resizeObserver.disconnect();\n  }, []);\n\n  // For explicitness:\n  const EDITABLE_LABEL_PADDING_WIDTH = 6;\n  const EDITABLE_LABEL_BORDER_WIDTH = 1;\n  const EDITABLE_LABEL_OFFSET = EDITABLE_LABEL_PADDING_WIDTH + EDITABLE_LABEL_BORDER_WIDTH;\n\n  const isCurrentlyEdited = editSection === index;\n  const [isCurrentlyHovered, setIsCurrentlyHovered] = useState(false);\n\n  const { dragHandleRef, dragPreviewRef, dropTargetRef, isOver, isDragging } = useDragAndDropElement({\n    dragGroupKey: 'sections',\n    dragKey: section.uuid,\n    onDrop: onSectionReorder,\n  });\n\n  return (\n    <>\n      <div\n        role=\"figure\"\n        css={{\n          display: 'flex',\n          alignItems: 'center',\n          width: '100%',\n          padding: `${theme.spacing.xs}px 0px`,\n          height: `${METRIC_CHART_SECTION_HEADER_SIZE}px`,\n          '.section-element-visibility-on-hover': {\n            visibility: isCurrentlyHovered ? 'visible' : 'hidden',\n            opacity: isCurrentlyHovered ? 1 : 0,\n          },\n          '.section-element-visibility-on-hover-and-not-drag': {\n            visibility: isCurrentlyHovered ? 'visible' : 'hidden',\n            opacity: isCurrentlyHovered ? (isDraggingHandle ? 0 : 1) : 0,\n          },\n          '.section-element-hidden-on-edit': { display: isCurrentlyEdited ? 'none' : 'inherit' },\n        }}\n        onMouseMove={() => setIsCurrentlyHovered(true)}\n        onMouseLeave={() => setIsCurrentlyHovered(false)}\n        ref={(element) => {\n          // Use this element for both drag preview and drop target\n          dropTargetRef?.(element);\n          dragPreviewRef?.(element);\n        }}\n        data-testid=\"experiment-view-compare-runs-section-header\"\n      >\n        {isOver && (\n          // Visual overlay for target drop element\n          <div\n            css={{\n              position: 'absolute',\n              inset: 0,\n              backgroundColor: theme.isDarkMode ? theme.colors.blue800 : theme.colors.blue100,\n              border: `2px dashed ${theme.colors.blue400}`,\n              opacity: 0.75,\n            }}\n          />\n        )}\n        <div\n          style={{\n            maxWidth: '40%',\n            display: 'flex',\n            alignItems: 'center',\n          }}\n        >\n          <div\n            ref={sectionNameRef}\n            style={{\n              position: !isCurrentlyEdited ? 'relative' : 'absolute',\n              visibility: !isCurrentlyEdited ? 'visible' : 'hidden',\n              textOverflow: isCurrentlyEdited ? undefined : 'ellipsis',\n              maxWidth: '100%',\n              overflow: 'clip',\n              paddingLeft: EDITABLE_LABEL_OFFSET,\n              whiteSpace: 'pre',\n            }}\n          >\n            {tmpSectionName}\n          </div>\n          {editSection === index && (\n            <Input\n              autoFocus\n              onClick={stopPropagation}\n              onMouseDown={stopPropagation}\n              onMouseUp={stopPropagation}\n              onDoubleClick={stopPropagation}\n              onChange={onChange}\n              value={tmpSectionName}\n              css={{\n                color: theme.colors.textPrimary,\n                fontWeight: 600,\n                padding: `1px ${EDITABLE_LABEL_PADDING_WIDTH}px 1px ${EDITABLE_LABEL_PADDING_WIDTH}px`,\n                background: theme.colors.backgroundSecondary,\n                minWidth: '50px',\n                width: sectionNameWidth + 2 * EDITABLE_LABEL_OFFSET,\n                position: 'relative',\n                lineHeight: theme.typography.lineHeightBase,\n                maxWidth: '100%',\n              }}\n              onKeyDown={onEsc}\n              onPressEnter={onSubmit}\n              dangerouslyAppendEmotionCSS={{ '&&': { minHeight: '20px !important' } }}\n              onBlur={onBlur}\n            />\n          )}\n          <div\n            css={{\n              padding: theme.spacing.xs,\n              position: 'relative',\n            }}\n            style={{\n              visibility: !isCurrentlyEdited ? 'visible' : 'hidden',\n              display: isCurrentlyEdited ? 'none' : 'inherit',\n            }}\n          >\n            {`(${sectionChartsLength})`}\n          </div>\n          {!hideExtraControls && (\n            <div className=\"section-element-visibility-on-hover-and-not-drag section-element-hidden-on-edit\">\n              <Button\n                componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionheader.tsx_246\"\n                onClick={onEdit}\n                aria-label=\"Icon label\"\n                icon={<PencilIcon />}\n              />\n            </div>\n          )}\n        </div>\n        {editSection === index && !hideExtraControls && (\n          <div style={{ padding: `0 ${theme.spacing.xs}px` }}>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionheader.tsx_251\"\n              onClick={onSubmit}\n              icon={<CheckIcon />}\n              ref={confirmButtonRef}\n            />\n          </div>\n        )}\n        {!hideExtraControls && (\n          <div\n            className=\"section-element-visibility-on-hover section-element-hidden-on-edit\"\n            css={{ position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', cursor: 'grab' }}\n          >\n            <DragIcon\n              rotate={90}\n              style={{ color: theme.colors.textSecondary }}\n              ref={dragHandleRef}\n              onMouseDown={() => setIsDraggingHandle(true)}\n              onMouseLeave={() => {\n                setIsDraggingHandle(false);\n              }}\n              data-testid=\"experiment-view-compare-runs-section-header-drag-handle\"\n            />\n          </div>\n        )}\n        {!hideExtraControls && (\n          <div\n            style={{\n              position: 'absolute',\n              top: '50%',\n              right: '0',\n              transform: 'translate(0, -50%)',\n              display: 'flex',\n              alignItems: 'center',\n            }}\n          >\n            <div\n              onClick={stopPropagation}\n              onMouseDown={stopPropagation}\n              onMouseUp={stopPropagation}\n              onDoubleClick={stopPropagation}\n              className=\"section-element-visibility-on-hover-and-not-drag section-element-hidden-on-edit\"\n            >\n              <DropdownMenu.Root modal={false}>\n                <DropdownMenu.Trigger asChild>\n                  <Button\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionheader.tsx_288\"\n                    icon={<OverflowIcon />}\n                  />\n                </DropdownMenu.Trigger>\n                <DropdownMenu.Content>\n                  <DropdownMenu.Item onClick={addSectionAbove}>\n                    <FormattedMessage\n                      defaultMessage=\"Add section above\"\n                      description=\"Experiment page > compare runs > chart section > add section above label\"\n                    />\n                  </DropdownMenu.Item>\n                  <DropdownMenu.Item onClick={addSectionBelow}>\n                    <FormattedMessage\n                      defaultMessage=\"Add section below\"\n                      description=\"Experiment page > compare runs > chart section > add section below label\"\n                    />\n                  </DropdownMenu.Item>\n                  <DropdownMenu.Item onClick={deleteSection}>\n                    <FormattedMessage\n                      defaultMessage=\"Delete section\"\n                      description=\"Experiment page > compare runs > chart section > delete section label\"\n                    />\n                  </DropdownMenu.Item>\n                </DropdownMenu.Content>\n              </DropdownMenu.Root>\n              <DangerModal\n                visible={isDeleteSectionModalOpen}\n                onOk={deleteModalConfirm}\n                onCancel={deleteModalCancel}\n                title=\"Delete section\"\n              >\n                <FormattedMessage\n                  defaultMessage=\"Deleting the section will permanently remove it and the charts it contains. This cannot be undone.\"\n                  description=\"Experiment page > compare runs > chart section > delete section warning message\"\n                />\n              </DangerModal>\n            </div>\n\n            <div\n              onClick={stopPropagation}\n              onMouseDown={stopPropagation}\n              onMouseUp={stopPropagation}\n              onDoubleClick={stopPropagation}\n              className={cx(\n                {\n                  'section-element-visibility-on-hover-and-not-drag': !isExpanded,\n                },\n                'section-element-hidden-on-edit',\n              )}\n              css={{\n                alignSelf: 'flex-end',\n                marginLeft: theme.spacing.xs,\n              }}\n            >\n              <RunsChartsAddChartMenu\n                onAddChart={addNewChartCard(section.uuid)}\n                supportedChartTypes={supportedChartTypes}\n              />\n            </div>\n          </div>\n        )}\n      </div>\n    </>\n  );\n};\n","import { useMemo, useState } from 'react';\nimport type { RunsChartsRunData } from './RunsCharts.common';\nimport type { RunsChartsCardConfig } from '../runs-charts.types';\nimport { RunsChartType } from '../runs-charts.types';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { getGridColumnSetup } from '../../../../common/utils/CssGrid.utils';\nimport { RunsChartCardSetFullscreenFn, RunsChartsChartsDragGroup } from './cards/ChartCard.common';\nimport { useDragAndDropElement } from '@mlflow/mlflow/src/common/hooks/useDragAndDropElement';\nimport { FormattedMessage } from 'react-intl';\nimport { Empty } from '@databricks/design-system';\nimport { RunsChartsCard } from './cards/RunsChartsCard';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\n\nexport interface RunsChartsProps {\n  sectionId: string;\n  chartRunData: RunsChartsRunData[];\n  cardsConfig: RunsChartsCardConfig[];\n  isMetricHistoryLoading?: boolean;\n  onRemoveChart: (chart: RunsChartsCardConfig) => void;\n  onStartEditChart: (chart: RunsChartsCardConfig) => void;\n  onReorderCharts: (sourceChartUuid: string, targetChartUuid: string) => void;\n  onInsertCharts: (sourceChartUuid: string, targetSectionId: string) => void;\n  groupBy: RunsGroupByConfig | null;\n  sectionIndex: number;\n  setFullScreenChart: RunsChartCardSetFullscreenFn;\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n}\n\nexport const RunsCharts = ({\n  sectionId,\n  chartRunData,\n  cardsConfig,\n  isMetricHistoryLoading,\n  onRemoveChart,\n  onStartEditChart,\n  onReorderCharts,\n  onInsertCharts,\n  groupBy,\n  sectionIndex,\n  setFullScreenChart,\n  autoRefreshEnabled,\n  hideEmptyCharts,\n}: RunsChartsProps) => {\n  const { theme } = useDesignSystemTheme();\n\n  const [parallelChartCards, differenceChartCards, imageChartCards, remainingChartCards] = useMemo(() => {\n    // Play it safe in case that cards config somehow failed to load\n    if (!Array.isArray(cardsConfig)) {\n      return [[], [], [], []];\n    }\n    return [\n      cardsConfig.filter((c) => c.type === RunsChartType.PARALLEL),\n      cardsConfig.filter((c) => c.type === RunsChartType.DIFFERENCE),\n      cardsConfig.filter((c) => c.type === RunsChartType.IMAGE),\n      cardsConfig.filter(\n        (c) =>\n          c.type !== RunsChartType.PARALLEL && c.type !== RunsChartType.DIFFERENCE && c.type !== RunsChartType.IMAGE,\n      ),\n    ];\n  }, [cardsConfig]);\n\n  const gridSetup = useMemo(\n    () =>\n      getGridColumnSetup({\n        maxColumns: 3,\n        gap: theme.spacing.md,\n        additionalBreakpoints: [{ breakpointWidth: 3 * 720, minColumnWidthForBreakpoint: 600 }],\n      }),\n    [theme],\n  );\n\n  const { dropTargetRef: dropTargetGeneralRef, isOver: isOverGeneral } = useDragAndDropElement({\n    dragGroupKey: RunsChartsChartsDragGroup.GENERAL_AREA,\n    dragKey: sectionId,\n    onDrop: onInsertCharts,\n  });\n\n  const { dropTargetRef: dropTargetParallelRef, isOver: isOverParallel } = useDragAndDropElement({\n    dragGroupKey: RunsChartsChartsDragGroup.PARALLEL_CHARTS_AREA,\n    dragKey: sectionId,\n    onDrop: onInsertCharts,\n  });\n\n  const isChartsEmpty =\n    !parallelChartCards.length &&\n    !differenceChartCards.length &&\n    !imageChartCards.length &&\n    !remainingChartCards.length;\n\n  return (\n    <div\n      role=\"figure\"\n      ref={(element) => {\n        // Use this element for drop target\n        dropTargetGeneralRef?.(element);\n        dropTargetParallelRef?.(element);\n      }}\n      css={{\n        padding: cardsConfig.length === 0 ? theme.spacing.lg : 0,\n        position: 'relative',\n        overflow: 'hidden',\n      }}\n    >\n      {(isOverGeneral || isOverParallel) && cardsConfig.length === 0 && (\n        // Visual overlay for target drop element\n        <div\n          css={{\n            position: 'absolute',\n            inset: 0,\n            backgroundColor: theme.isDarkMode ? theme.colors.blue800 : theme.colors.blue100,\n            border: `2px dashed ${theme.colors.blue400}`,\n            opacity: 0.75,\n          }}\n        />\n      )}\n      {isChartsEmpty && (\n        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n          <Empty\n            title={\n              <FormattedMessage\n                defaultMessage=\"No charts in this section\"\n                description=\"Runs compare page > Charts tab > No charts placeholder title\"\n              />\n            }\n            description={\n              <FormattedMessage\n                defaultMessage=\"Click 'Add chart' or drag and drop to add charts here.\"\n                description=\"Runs compare page > Charts tab > No charts placeholder description\"\n              />\n            }\n          />\n        </div>\n      )}\n      {[differenceChartCards, parallelChartCards, imageChartCards].map((chartCards, index) => {\n        if (chartCards.length) {\n          return (\n            <div\n              key={`chart-cards-${index}`}\n              css={{\n                display: 'flex',\n                flexDirection: 'column',\n                gap: theme.spacing.md,\n                marginBottom: theme.spacing.md,\n              }}\n            >\n              {chartCards.map((cardConfig, index) => {\n                const reorderProps = {\n                  onReorderWith: onReorderCharts,\n                  canMoveDown: index < chartCards.length - 1,\n                  canMoveUp: index > 0,\n                  onMoveDown: () => onReorderCharts(cardConfig.uuid || '', chartCards[index + 1]?.uuid || ''),\n                  onMoveUp: () => onReorderCharts(cardConfig.uuid || '', chartCards[index - 1]?.uuid || ''),\n                };\n                return (\n                  <RunsChartsCard\n                    cardConfig={cardConfig}\n                    chartRunData={chartRunData}\n                    onStartEditChart={onStartEditChart}\n                    onRemoveChart={onRemoveChart}\n                    setFullScreenChart={setFullScreenChart}\n                    onReorderCharts={onReorderCharts}\n                    index={index}\n                    sectionIndex={sectionIndex}\n                    groupBy={groupBy}\n                    autoRefreshEnabled={autoRefreshEnabled}\n                    hideEmptyCharts={hideEmptyCharts}\n                    key={`${cardConfig.uuid}-${index}-${sectionIndex}`}\n                    {...reorderProps}\n                  />\n                );\n              })}\n            </div>\n          );\n        }\n        return null;\n      })}\n      <div css={gridSetup}>\n        {remainingChartCards.map((cardConfig, index) => {\n          const reorderProps = {\n            onReorderWith: onReorderCharts,\n            canMoveDown: index < remainingChartCards.length - 1,\n            canMoveUp: index > 0,\n            previousChartUuid: remainingChartCards[index - 1]?.uuid,\n            nextChartUuid: remainingChartCards[index + 1]?.uuid,\n          };\n\n          return (\n            <RunsChartsCard\n              cardConfig={cardConfig}\n              chartRunData={chartRunData}\n              onStartEditChart={onStartEditChart}\n              onRemoveChart={onRemoveChart}\n              setFullScreenChart={setFullScreenChart}\n              onReorderCharts={onReorderCharts}\n              index={index}\n              sectionIndex={sectionIndex}\n              groupBy={groupBy}\n              autoRefreshEnabled={autoRefreshEnabled}\n              hideEmptyCharts={hideEmptyCharts}\n              key={`${cardConfig.uuid}-${index}-${sectionIndex}`}\n              {...reorderProps}\n            />\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n","import type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsCharts } from '../RunsCharts';\nimport type { RunsChartCardSetFullscreenFn } from '../cards/ChartCard.common';\n\nexport interface RunsChartsSectionProps {\n  sectionId: string;\n  sectionCharts: RunsChartsCardConfig[];\n  reorderCharts: (sourceChartUuid: string, targetChartUuid: string) => void;\n  insertCharts: (sourceChartUuid: string, targetSectionId: string) => void;\n  isMetricHistoryLoading: boolean;\n  chartData: RunsChartsRunData[];\n  startEditChart: (chartCard: RunsChartsCardConfig) => void;\n  removeChart: (configToDelete: RunsChartsCardConfig) => void;\n  groupBy: RunsGroupByConfig | null;\n  sectionIndex: number;\n  setFullScreenChart: RunsChartCardSetFullscreenFn;\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n}\n\nexport const RunsChartsSection = ({\n  sectionId,\n  sectionCharts,\n  reorderCharts,\n  insertCharts,\n  isMetricHistoryLoading,\n  chartData,\n  startEditChart,\n  removeChart,\n  groupBy,\n  sectionIndex,\n  setFullScreenChart,\n  autoRefreshEnabled,\n  hideEmptyCharts,\n}: RunsChartsSectionProps) => {\n  return (\n    <RunsCharts\n      sectionId={sectionId}\n      chartRunData={chartData}\n      cardsConfig={sectionCharts}\n      isMetricHistoryLoading={isMetricHistoryLoading}\n      onRemoveChart={removeChart}\n      onStartEditChart={startEditChart}\n      onReorderCharts={reorderCharts}\n      onInsertCharts={insertCharts}\n      groupBy={groupBy}\n      sectionIndex={sectionIndex}\n      setFullScreenChart={setFullScreenChart}\n      autoRefreshEnabled={autoRefreshEnabled}\n      hideEmptyCharts={hideEmptyCharts}\n    />\n  );\n};\n","import { Accordion } from '@databricks/design-system';\nimport { ChartSectionConfig } from '../../../../types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartType,\n  RunsChartsLineCardConfig,\n  RunsChartsScatterCardConfig,\n  RunsChartsContourCardConfig,\n  SerializedRunsChartsCardConfigCard,\n} from '../../runs-charts.types';\nimport MetricChartsAccordion, { METRIC_CHART_SECTION_HEADER_SIZE } from '../../../MetricChartsAccordion';\nimport { RunsChartsSectionHeader } from './RunsChartsSectionHeader';\nimport { RunsChartsSection } from './RunsChartsSection';\nimport { useCallback, useMemo } from 'react';\nimport { getUUID } from '@mlflow/mlflow/src/common/utils/ActionUtils';\nimport { useState } from 'react';\nimport { Button, PlusIcon } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { Empty } from '@databricks/design-system';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { Spacer } from '@databricks/design-system';\nimport { useUpdateRunsChartsUIConfiguration } from '../../hooks/useRunsChartsUIConfiguration';\nimport { isArray } from 'lodash';\nimport { RunsChartCardSetFullscreenFn } from '../cards/ChartCard.common';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { shouldEnableHidingChartsWithNoData } from '../../../../../common/utils/FeatureUtils';\n\nconst chartMatchesFilter = (filter: string, config: RunsChartsCardConfig) => {\n  const filterLowerCase = filter.toLowerCase();\n\n  if (config.type === RunsChartType.BAR) {\n    const barConfig = config as RunsChartsBarCardConfig;\n    return barConfig.metricKey.toLowerCase().includes(filterLowerCase);\n  } else if (config.type === RunsChartType.LINE) {\n    const lineConfig = config as RunsChartsLineCardConfig;\n    if (isArray(lineConfig.selectedMetricKeys)) {\n      return lineConfig.selectedMetricKeys.some((metricKey) => metricKey.toLowerCase().includes(filterLowerCase));\n    }\n    return lineConfig.metricKey.toLowerCase().includes(filterLowerCase);\n  } else if (config.type === RunsChartType.SCATTER) {\n    const scatterConfig = config as RunsChartsScatterCardConfig;\n    return (\n      scatterConfig.xaxis.key.toLowerCase().includes(filterLowerCase) ||\n      scatterConfig.yaxis.key.toLowerCase().includes(filterLowerCase)\n    );\n  } else if (config.type === RunsChartType.PARALLEL) {\n    return 'Parallel Coordinates'.toLowerCase().includes(filterLowerCase);\n  } else {\n    // Must be contour\n    const contourConfig = config as RunsChartsContourCardConfig;\n    return (\n      contourConfig.xaxis.key.toLowerCase().includes(filterLowerCase) ||\n      contourConfig.yaxis.key.toLowerCase().includes(filterLowerCase) ||\n      contourConfig.zaxis.key.toLowerCase().includes(filterLowerCase)\n    );\n  }\n};\n\nexport interface RunsChartsSectionAccordionProps {\n  compareRunSections?: ChartSectionConfig[];\n  compareRunCharts?: SerializedRunsChartsCardConfigCard[];\n  reorderCharts: (sourceChartUuid: string, targetChartUuid: string) => void;\n  insertCharts: (sourceChartUuid: string, targetSectionId: string) => void;\n  chartData: RunsChartsRunData[];\n  isMetricHistoryLoading?: boolean;\n  startEditChart: (chartCard: RunsChartsCardConfig) => void;\n  removeChart: (configToDelete: RunsChartsCardConfig) => void;\n  addNewChartCard: (metricSectionId: string) => (type: RunsChartType) => void;\n  search: string;\n  groupBy: RunsGroupByConfig | null;\n  autoRefreshEnabled?: boolean;\n  hideEmptyCharts?: boolean;\n  supportedChartTypes?: RunsChartType[] | undefined;\n  setFullScreenChart: RunsChartCardSetFullscreenFn;\n}\n\nexport const RunsChartsSectionAccordion = ({\n  compareRunSections,\n  compareRunCharts,\n  reorderCharts,\n  insertCharts,\n  chartData,\n  isMetricHistoryLoading = false,\n  autoRefreshEnabled = false,\n  startEditChart,\n  removeChart,\n  addNewChartCard,\n  search,\n  groupBy,\n  supportedChartTypes,\n  hideEmptyCharts,\n  setFullScreenChart = () => {},\n}: RunsChartsSectionAccordionProps) => {\n  const updateUIState = useUpdateRunsChartsUIConfiguration();\n  const [editSection, setEditSection] = useState(-1);\n  const { theme } = useDesignSystemTheme();\n\n  /**\n   * Get the active (expanded) panels for the accordion\n   */\n  const activeKey = useMemo(() => {\n    const activeSections = (compareRunSections || []).flatMap((sectionConfig: ChartSectionConfig) => {\n      if (sectionConfig.display) {\n        return [sectionConfig.uuid];\n      } else {\n        return [];\n      }\n    });\n    return activeSections;\n  }, [compareRunSections]);\n\n  /**\n   * Updates the active (expanded) panels for the accordion\n   */\n  const onActivePanelChange = useCallback(\n    (key: string | string[]) => {\n      updateUIState((current) => {\n        const newCompareRunPanels = (current.compareRunSections || []).map((sectionConfig: ChartSectionConfig) => {\n          const sectionId = sectionConfig.uuid;\n          const shouldDisplaySection =\n            (typeof key === 'string' && sectionId === key) || (Array.isArray(key) && key.includes(sectionId));\n          return {\n            ...sectionConfig,\n            display: shouldDisplaySection,\n          };\n        });\n        return {\n          ...current,\n          compareRunSections: newCompareRunPanels,\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  /**\n   * Deletes a section from the accordion\n   */\n  const deleteSection = useCallback(\n    (sectionId: string) => {\n      updateUIState((current) => {\n        const newCompareRunCharts = (current.compareRunCharts || [])\n          // Keep charts that are generated or not in section\n          .filter((chartConfig: RunsChartsCardConfig) => {\n            return chartConfig.isGenerated || chartConfig.metricSectionId !== sectionId;\n          })\n          // For charts that are generated and in section, set deleted to true\n          .map((chartConfig: RunsChartsCardConfig) => {\n            if (chartConfig.isGenerated && chartConfig.metricSectionId === sectionId) {\n              return { ...chartConfig, deleted: true };\n            } else {\n              return chartConfig;\n            }\n          });\n\n        // Delete section\n        const newCompareRunSections = (current.compareRunSections || [])\n          .slice()\n          .filter((sectionConfig: ChartSectionConfig) => {\n            return sectionConfig.uuid !== sectionId;\n          });\n\n        return {\n          ...current,\n          compareRunCharts: newCompareRunCharts,\n          compareRunSections: newCompareRunSections,\n          isAccordionReordered: true,\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  /**\n   * Adds a section to the accordion\n   * @param sectionId indicates the section selected to anchor at\n   * @param above is a boolean value indicating whether to add the section above or below the anchor\n   */\n  const addSection = useCallback(\n    (sectionId: string, above: boolean) => {\n      let idx = -1;\n      updateUIState((current) => {\n        // Look for index\n        const newCompareRunSections = [...(current.compareRunSections || [])];\n        idx = newCompareRunSections.findIndex((sectionConfig: ChartSectionConfig) => sectionConfig.uuid === sectionId);\n        const newSection = { name: '', uuid: getUUID(), display: false, isReordered: false };\n        if (idx < 0) {\n          // Index not found, add to end\n          newCompareRunSections.push(newSection);\n        } else if (above) {\n          newCompareRunSections.splice(idx, 0, newSection);\n        } else {\n          idx += 1;\n          newCompareRunSections.splice(idx, 0, newSection);\n        }\n        return {\n          ...current,\n          compareRunSections: newCompareRunSections,\n          isAccordionReordered: true,\n        };\n      });\n      return idx;\n    },\n    [updateUIState],\n  );\n\n  /**\n   * Appends a section to the end of the accordion\n   */\n  const appendSection = useCallback(() => {\n    updateUIState((current) => {\n      const newCompareRunSections = [\n        ...(current.compareRunSections || []),\n        { name: '', uuid: getUUID(), display: false, isReordered: false },\n      ];\n      return {\n        ...current,\n        compareRunSections: newCompareRunSections,\n        isAccordionReordered: true,\n      };\n    });\n    setEditSection(compareRunSections?.length || -1);\n  }, [updateUIState, compareRunSections?.length]);\n\n  /**\n   * Updates the name of a section\n   * @param sectionId the section to update the name of\n   * @param name the new name of the section\n   */\n  const setSectionName = useCallback(\n    (sectionId: string, name: string) => {\n      updateUIState((current) => {\n        const newCompareRunSections = (current.compareRunSections || []).map((sectionConfig: ChartSectionConfig) => {\n          if (sectionConfig.uuid === sectionId) {\n            return { ...sectionConfig, name: name };\n          } else {\n            return sectionConfig;\n          }\n        });\n        return {\n          ...current,\n          compareRunSections: newCompareRunSections,\n          isAccordionReordered: true,\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  /**\n   * Reorders the sections in the accordion\n   * @param sourceSectionId the section you are dragging\n   * @param targetSectionId the section to drop\n   */\n  const sectionReorder = useCallback(\n    (sourceSectionId: string, targetSectionId: string) => {\n      updateUIState((current) => {\n        const newCompareRunSections = (current.compareRunSections || []).slice();\n        const sourceSectionIdx = newCompareRunSections.findIndex(\n          (sectionConfig: ChartSectionConfig) => sectionConfig.uuid === sourceSectionId,\n        );\n        const targetSectionIdx = newCompareRunSections.findIndex(\n          (sectionConfig: ChartSectionConfig) => sectionConfig.uuid === targetSectionId,\n        );\n        const sourceSection = newCompareRunSections.splice(sourceSectionIdx, 1)[0];\n        // If the source section is above the target section, the target section index will be shifted down by 1\n        newCompareRunSections.splice(targetSectionIdx, 0, sourceSection);\n        return {\n          ...current,\n          compareRunSections: newCompareRunSections,\n          isAccordionReordered: true,\n        };\n      });\n    },\n    [updateUIState],\n  );\n\n  const noRunsSelected = useMemo(() => chartData.filter(({ hidden }) => !hidden).length === 0, [chartData]);\n\n  const { sectionsToRender, chartsToRender } = useMemo(() => {\n    if (search === '') {\n      return { sectionsToRender: compareRunSections, chartsToRender: compareRunCharts };\n    }\n\n    const compareRunChartsFiltered = (compareRunCharts || []).filter((config: RunsChartsCardConfig) => {\n      return !config.deleted && chartMatchesFilter(search, config);\n    });\n    // Get the sections that have these charts\n    const sectionsWithCharts = new Set<string>();\n    compareRunChartsFiltered.forEach((config: RunsChartsCardConfig) => {\n      if (config.metricSectionId) {\n        sectionsWithCharts.add(config.metricSectionId);\n      }\n    });\n    // Filter the sections\n    const compareRunSectionsFiltered = (compareRunSections || []).filter((sectionConfig: ChartSectionConfig) => {\n      return sectionsWithCharts.has(sectionConfig.uuid);\n    });\n\n    return { sectionsToRender: compareRunSectionsFiltered, chartsToRender: compareRunChartsFiltered };\n  }, [search, compareRunCharts, compareRunSections]);\n\n  const isSearching = search !== '';\n\n  if (!compareRunSections || !compareRunCharts) {\n    return null;\n  }\n\n  if (noRunsSelected && shouldEnableHidingChartsWithNoData()) {\n    return (\n      <div css={{ marginTop: theme.spacing.lg }}>\n        <Empty\n          description={\n            <FormattedMessage\n              defaultMessage=\"All runs are hidden. Select at least one run to view charts.\"\n              description=\"Experiment tracking > runs charts > indication displayed when no runs are selected for comparison\"\n            />\n          }\n        />\n      </div>\n    );\n  }\n\n  if (isSearching && chartsToRender?.length === 0) {\n    // Render empty in the center of the page\n    return (\n      <>\n        <Spacer size=\"lg\" />\n        <Empty\n          title={\n            <FormattedMessage\n              defaultMessage=\"No metric charts\"\n              description=\"Experiment page > compare runs > no metric charts\"\n            />\n          }\n          description={\n            <FormattedMessage\n              defaultMessage=\"All charts are filtered. Clear the search filter to see hidden metric charts.\"\n              description=\"Experiment page > compare runs > no metric charts > description\"\n            />\n          }\n        />\n      </>\n    );\n  }\n\n  return (\n    <div>\n      <MetricChartsAccordion activeKey={activeKey} onActiveKeyChange={onActivePanelChange}>\n        {(sectionsToRender || []).map((sectionConfig: ChartSectionConfig, index: number) => {\n          const sectionCharts = (chartsToRender || []).filter((config: RunsChartsCardConfig) => {\n            const section = (config as RunsChartsBarCardConfig).metricSectionId;\n            return !config.deleted && section === sectionConfig.uuid;\n          });\n\n          return (\n            <Accordion.Panel\n              header={\n                <RunsChartsSectionHeader\n                  index={index}\n                  section={sectionConfig}\n                  onDeleteSection={deleteSection}\n                  onAddSection={addSection}\n                  editSection={editSection}\n                  onSetEditSection={setEditSection}\n                  onSetSectionName={setSectionName}\n                  sectionChartsLength={sectionCharts.length}\n                  addNewChartCard={addNewChartCard}\n                  onSectionReorder={sectionReorder}\n                  isExpanded={activeKey.includes(sectionConfig.uuid)}\n                  supportedChartTypes={supportedChartTypes}\n                  // When searching, hide the section placement controls\n                  hideExtraControls={isSearching}\n                />\n              }\n              key={sectionConfig.uuid}\n              aria-hidden={!activeKey.includes(sectionConfig.uuid)}\n            >\n              <RunsChartsSection\n                sectionId={sectionConfig.uuid}\n                sectionCharts={sectionCharts}\n                reorderCharts={reorderCharts}\n                insertCharts={insertCharts}\n                isMetricHistoryLoading={isMetricHistoryLoading}\n                chartData={chartData}\n                startEditChart={startEditChart}\n                removeChart={removeChart}\n                groupBy={groupBy}\n                sectionIndex={index}\n                setFullScreenChart={setFullScreenChart}\n                autoRefreshEnabled={autoRefreshEnabled}\n                hideEmptyCharts={hideEmptyCharts}\n              />\n            </Accordion.Panel>\n          );\n        })}\n      </MetricChartsAccordion>\n      {!isSearching && (\n        <div>\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionaccordion.tsx_405\"\n            block\n            onClick={appendSection}\n            icon={<PlusIcon />}\n            style={{ border: 'none', marginTop: '6px' }}\n          >\n            <FormattedMessage\n              defaultMessage=\"Add section\"\n              description=\"Experiment page > compare runs > chart section > add section bar\"\n            />\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n};\n","import { useCallback, useRef, useState } from 'react';\nimport { type Data, type Layout, type Config, downloadImage } from 'plotly.js';\n\nexport type ExperimentChartImageDownloadFileFormat = 'svg' | 'png';\nexport type ExperimentChartImageDownloadHandler = (\n  format: ExperimentChartImageDownloadFileFormat,\n  chartTitle: string,\n) => void;\n\nconst experimentChartImageDefaultDownloadLayout: Partial<Layout> = {\n  paper_bgcolor: 'white',\n  plot_bgcolor: 'white',\n};\n\nconst experimentChartImageDefaultDownloadSettings = {\n  width: 1200,\n  height: 600,\n};\n\nconst experimentChartImageDefaultDownloadPlotConfig: Partial<Config> = {\n  displaylogo: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nexport const createChartImageDownloadHandler =\n  (data: Data[], layout: Partial<Layout>) => (format: 'svg' | 'png', title: string) =>\n    downloadImage(\n      {\n        data,\n        layout: { ...layout, ...experimentChartImageDefaultDownloadLayout },\n        config: experimentChartImageDefaultDownloadPlotConfig,\n      },\n      { ...experimentChartImageDefaultDownloadSettings, format, filename: title },\n    );\n\n/**\n * Returns a memoized download handler for chart images.\n * Uses ref-based caching to ensure that the download handler is not recreated on every render.\n */\nexport const useChartImageDownloadHandler = () => {\n  const downloadHandlerRef = useRef<ExperimentChartImageDownloadHandler | null>(null);\n  const [downloadHandler, setDownloadHandler] = useState<ExperimentChartImageDownloadHandler | null>(null);\n\n  const setDownloadHandlerCached = useCallback((downloadHandler: ExperimentChartImageDownloadHandler) => {\n    downloadHandlerRef.current = downloadHandler;\n    setDownloadHandler((existingHandler: ExperimentChartImageDownloadHandler | null) => {\n      if (existingHandler) {\n        return existingHandler;\n      }\n\n      return (format: ExperimentChartImageDownloadFileFormat, chartTitle: string) =>\n        downloadHandlerRef.current?.(format, chartTitle);\n    });\n  }, []);\n\n  return [downloadHandler, setDownloadHandlerCached] as const;\n};\n","import { ImageEntity } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { RunsChartsRunData } from '../components/RunsCharts.common';\n\nexport const useImageSliderStepMarks = ({\n  data,\n  selectedImageKeys,\n}: {\n  data: RunsChartsRunData[];\n  selectedImageKeys: string[];\n}) => {\n  const stepMarks = data.reduce((acc, run: RunsChartsRunData) => {\n    for (const imageKey of Object.keys(run.images)) {\n      if (selectedImageKeys?.includes(imageKey)) {\n        const metadata = run.images[imageKey];\n        for (const meta of Object.values(metadata)) {\n          if (meta.step !== undefined) {\n            acc[meta.step] = {\n              style: { display: 'none' },\n              label: '',\n            };\n          }\n        }\n      }\n    }\n    return acc;\n  }, {} as Record<number, any>);\n\n  return {\n    stepMarks,\n    maxMark: Math.max(...Object.keys(stepMarks).map(Number)),\n    minMark: Math.min(...Object.keys(stepMarks).map(Number)),\n  };\n};\n","import { useCallback, useEffect, useRef, useState } from 'react';\nimport { shouldDeferLineChartRendering } from '../../../../common/utils/FeatureUtils';\nimport { useDebounce } from 'use-debounce';\n\nconst VIEWPORT_DEBOUNCE_MS = 150;\n\n/**\n * Checks if the element is currently visible within the viewport using IntersectionObserver.\n * If \"enabled\" is set to false, the returned value will always be true.\n */\nexport const useIsInViewport = ({\n  enabled = true,\n  deferTimeoutMs = VIEWPORT_DEBOUNCE_MS,\n}: { enabled?: boolean; deferTimeoutMs?: number } = {}) => {\n  const activeObserver = useRef<IntersectionObserver | null>(null);\n  const [isInViewport, setIsInViewport] = useState(!enabled);\n  // Let's use IntersectionObserver to determine if the element is displayed within the viewport\n  const startObserver = useCallback(\n    (element: Element | null) => {\n      // If \"enabled\" is set to false or IntersectionObserver is not available, assume that the element is visible\n      if (!enabled || !window.IntersectionObserver) {\n        setIsInViewport(true);\n        return () => {};\n      }\n\n      if (!element) {\n        return () => {};\n      }\n\n      // Set the state flag only if element is in viewport\n      const intersectionObserver = new IntersectionObserver(([entry]) => {\n        setIsInViewport(entry.isIntersecting);\n      });\n\n      // Run intersection observer as a macrotask, makes it wait for the next tick\n      // before start observing the element to make sure the observer will register the element\n      setTimeout(() => {\n        if (element) {\n          intersectionObserver.observe(element);\n        }\n      });\n\n      activeObserver.current = intersectionObserver;\n\n      return intersectionObserver;\n    },\n    [enabled],\n  );\n\n  const disconnect = useCallback(() => {\n    if (activeObserver.current) {\n      activeObserver.current.disconnect();\n      activeObserver.current = null;\n    }\n  }, []);\n\n  const setElementRef = useCallback(\n    (ref: Element | null) => {\n      // Attempt to disconnect the previous observer\n      disconnect();\n\n      // Start a new observer\n      startObserver(ref);\n    },\n    [disconnect, startObserver],\n  );\n\n  // Disconnect the observer when the component is unmounted\n  useEffect(() => disconnect, [disconnect]);\n\n  // If the feature flag is flipped, append deferred value to the result\n  if (shouldDeferLineChartRendering()) {\n    // We can safely disable the eslint rule here because flag evaluation is stable\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const [isInViewportDeferred] = useDebounce(isInViewport, deferTimeoutMs);\n    return { isInViewport, elementRef: setElementRef, isInViewportDeferred };\n  }\n\n  // When the flag is disabled, deferred result is the same as the regular one\n  return { isInViewport, elementRef: setElementRef, isInViewportDeferred: isInViewport };\n};\n","import type { PlotMouseEvent } from 'plotly.js';\nimport { useEffect, useRef } from 'react';\n\n/**\n * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n * so in order to achieve updated behavior we need to wrap each onHover callback with an\n * immutable callback that will call mutable implementation.\n */\nexport const useMutableChartHoverCallback = <T extends (event: Readonly<PlotMouseEvent>) => void>(callback: T) => {\n  const mutableRef = useRef<T>(callback);\n\n  useEffect(() => {\n    mutableRef.current = callback;\n  }, [callback]);\n\n  return (event: Readonly<PlotMouseEvent>) => {\n    mutableRef.current(event);\n  };\n};\n","import { isUndefined, noop } from 'lodash';\nimport {\n  type PropsWithChildren,\n  createContext,\n  createElement,\n  useContext,\n  useMemo,\n  useRef,\n  useEffect,\n  useState,\n  useCallback,\n} from 'react';\nimport { shouldEnableUnifiedChartDataTraceHighlight } from '../../../../common/utils/FeatureUtils';\n\n/**\n * Function used to highlight particular trace in the experiment runs chart,\n * for both hover and select scenarios.\n * Since implementation varies across chart types, the function is curryable where\n * two first-level parameters determine the target SVG selector paths to the trace within\n * target chart type.\n *\n * @param traceSelector selector path to the trace for a particular chart type\n * @param parentSelector selector path to the traces container for a particular chart type\n */\nconst highlightChartTracesFn =\n  (traceSelector: string, parentSelector: string) =>\n  /**\n   * @param parent a HTML element containing the chart\n   * @param hoverIndex index of a trace that should be hover-higlighted, set -1 to remove highlight\n   * @param selectIndex index of a trace that should be select-higlighted, set -1 to remove highlight\n   */\n  (parent: HTMLElement, hoverIndex: number, selectIndex: number, numberOfBands = 0) => {\n    const deselected = hoverIndex === -1 && selectIndex === -1;\n\n    parent.querySelector('.is-hover-highlight')?.classList.remove('is-hover-highlight');\n    if (hoverIndex > -1) {\n      parent.querySelectorAll(traceSelector)[hoverIndex]?.classList.add('is-hover-highlight');\n    }\n\n    parent.querySelector('.is-selection-highlight')?.classList.remove('is-selection-highlight');\n    if (selectIndex > -1) {\n      parent.querySelectorAll(traceSelector)[selectIndex]?.classList.add('is-selection-highlight');\n    }\n\n    if (numberOfBands > 0) {\n      const bandTraceIndex =\n        selectIndex > -1 ? selectIndex - numberOfBands : hoverIndex > -1 ? hoverIndex - numberOfBands : -1;\n      parent.querySelectorAll(traceSelector).forEach((e, index) => {\n        e.classList.toggle('is-band', index >= 0 && index < numberOfBands);\n        e.classList.toggle('is-band-highlighted', index === bandTraceIndex);\n      });\n    } else {\n      parent.querySelectorAll(traceSelector).forEach((e) => e.classList.remove('is-band'));\n    }\n\n    if (deselected) {\n      parent.querySelector(parentSelector)?.classList.remove('is-highlight');\n    } else {\n      parent.querySelector(parentSelector)?.classList.add('is-highlight');\n    }\n  };\n\n/**\n * Type-specific implementation of highlightChartTracesFn for bar charts\n */\nexport const highlightBarTraces = highlightChartTracesFn('svg .trace.bars g.point', '.trace.bars');\n\n/**\n * Type-specific implementation of highlightChartTracesFn for line charts\n */\nexport const highlightLineTraces = highlightChartTracesFn('svg .scatterlayer g.trace', '.scatterlayer');\n\n/**\n * Type-specific implementation of highlightChartTracesFn for scatter and contour charts\n */\nexport const highlightScatterTraces = highlightChartTracesFn('svg .scatterlayer path.point', '.trace.scatter');\n\n/**\n * This hook provides mechanisms necessary for highlighting SVG trace paths\n * in experiment runs charts.\n *\n * @param containerDiv HTML element containing the chart\n * @param selectedRunUuid currently selected run UUID (set to -1 if none)\n * @param runsData array containing run informations, should be the same order as provided to the chart\n * @param highlightFn a styling function that will be called when the trace should be (un)highlighted, please refer to `highlightCallbackFn()`\n */\nexport const useRenderRunsChartTraceHighlight = (\n  containerDiv: HTMLElement | null,\n  selectedRunUuid: string | null | undefined,\n  runsData: { uuid?: string }[],\n  highlightFn: ReturnType<typeof highlightChartTracesFn>,\n  numberOfBands = 0,\n) => {\n  // Save the last runs data to be available immediately on non-stateful callbacks\n  const lastRunsData = useRef(runsData);\n  lastRunsData.current = runsData;\n\n  const selectedTraceIndex = useMemo(() => {\n    if (!containerDiv || !selectedRunUuid) {\n      return -1;\n    }\n    return runsData.findIndex(({ uuid }) => uuid === selectedRunUuid);\n  }, [runsData, containerDiv, selectedRunUuid]);\n\n  const [hoveredPointIndex, setHoveredPointIndex] = useState(-1);\n  const { onHighlightChange } = useRunsChartTraceHighlight();\n\n  useEffect(() => {\n    // Disable this hook variant if new highlight model is enabled\n    if (shouldEnableUnifiedChartDataTraceHighlight()) {\n      return;\n    }\n    if (!containerDiv) {\n      return;\n    }\n    highlightFn(containerDiv, hoveredPointIndex, selectedTraceIndex, numberOfBands);\n  }, [highlightFn, containerDiv, selectedTraceIndex, hoveredPointIndex, numberOfBands]);\n\n  useEffect(() => {\n    // Use this hook variant only if new highlight model is enabled\n    if (!shouldEnableUnifiedChartDataTraceHighlight()) {\n      return;\n    }\n    if (!containerDiv) {\n      return;\n    }\n    // Here, we don't report stateful hovered run UUID since it's handled by the new highlight model\n    highlightFn(containerDiv, -1, selectedTraceIndex, numberOfBands);\n  }, [highlightFn, containerDiv, selectedTraceIndex, numberOfBands]);\n\n  // Save the last selected trace index to be available immediately on non-stateful callbacks\n  const lastSelectedTraceIndex = useRef(selectedTraceIndex);\n  lastSelectedTraceIndex.current = selectedTraceIndex;\n\n  const highlightChangeListener = useCallback(\n    (newExtern: string | null) => {\n      if (!containerDiv) {\n        return;\n      }\n\n      const externallyHighlightedRunIndex = lastRunsData.current.findIndex(({ uuid }) => uuid === newExtern);\n      highlightFn(containerDiv, externallyHighlightedRunIndex, lastSelectedTraceIndex.current, numberOfBands);\n    },\n    [highlightFn, containerDiv, numberOfBands],\n  );\n\n  // Listen to the highlight change event\n  useEffect(() => onHighlightChange(highlightChangeListener), [onHighlightChange, highlightChangeListener]);\n\n  return {\n    selectedTraceIndex,\n    hoveredPointIndex,\n    // With the unified chart data trace highlight, we don't need to do costly state updates anymore\n    setHoveredPointIndex: shouldEnableUnifiedChartDataTraceHighlight() ? noop : setHoveredPointIndex,\n  };\n};\n\nexport enum ChartsTraceHighlightSource {\n  NONE,\n  CHART,\n  TABLE,\n}\n\ninterface RunsChartsSetHighlightContextType {\n  highlightDataTrace: (\n    traceUuid: string | null,\n    options?: { source?: ChartsTraceHighlightSource; shouldBlock?: boolean },\n  ) => void;\n  onHighlightChange: (fn: (traceUuid: string | null, source?: ChartsTraceHighlightSource) => void) => () => void;\n}\n\nconst RunsChartsSetHighlightContext = createContext<RunsChartsSetHighlightContextType>({\n  highlightDataTrace: () => {},\n  onHighlightChange: () => () => {},\n});\n\nexport const RunsChartsSetHighlightContextProvider = ({ children }: PropsWithChildren<unknown>) => {\n  const highlightListenerFns = useRef<((traceUuid: string | null, source?: ChartsTraceHighlightSource) => void)[]>([]);\n  const block = useRef(false);\n\n  // Stable and memoized context value\n  const contextValue = useMemo<RunsChartsSetHighlightContextType>(() => {\n    // If new highlight model is disabled, disable entire feature by providint empty logic to the context\n    if (!shouldEnableUnifiedChartDataTraceHighlight()) {\n      return {\n        highlightDataTrace: () => {},\n        onHighlightChange: () => () => {},\n      };\n    }\n\n    const notifyListeners = (traceUuid: string | null, source?: ChartsTraceHighlightSource) => {\n      for (const fn of highlightListenerFns.current) {\n        fn(traceUuid, source);\n      }\n    };\n\n    const highlightDataTrace = (\n      traceUuid: string | null,\n      { shouldBlock, source }: { source?: ChartsTraceHighlightSource; shouldBlock?: boolean } = {},\n    ) => {\n      if (!isUndefined(shouldBlock)) {\n        block.current = shouldBlock;\n      } else if (block.current) {\n        return;\n      }\n      notifyListeners(traceUuid, source);\n    };\n\n    const onHighlightChange = (listener: (traceUuid: string | null, source?: ChartsTraceHighlightSource) => void) => {\n      highlightListenerFns.current.push(listener);\n      return () => {\n        highlightListenerFns.current = highlightListenerFns.current.filter((fn) => fn !== listener);\n      };\n    };\n\n    return {\n      highlightDataTrace,\n      onHighlightChange,\n    };\n  }, []);\n\n  return createElement(RunsChartsSetHighlightContext.Provider, { value: contextValue }, children);\n};\n\nexport const useRunsChartTraceHighlight = () => useContext(RunsChartsSetHighlightContext);\n","import { Interpolation, Theme } from '@emotion/react';\nimport React, { useCallback, useContext, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport type {\n  RunsCompareMultipleTracesTooltipData,\n  RunsMetricsSingleTraceTooltipData,\n} from '../components/RunsMetricsLinePlot';\nimport { RunsMetricsBarPlotHoverData } from '../components/RunsMetricsBarPlot';\nimport { shouldEnableDeepLearningUIPhase3 } from '../../../../common/utils/FeatureUtils';\nimport { ChartsTraceHighlightSource, useRunsChartTraceHighlight } from './useRunsChartTraceHighlight';\n\nexport interface RunsChartsTooltipBodyProps<TContext = any, TChartData = any, THoverData = any> {\n  runUuid: string;\n  hoverData: THoverData;\n  chartData: TChartData;\n  contextData: TContext;\n  closeContextMenu: () => void;\n  isHovering?: boolean;\n  mode: RunsChartsTooltipMode;\n}\n\nexport interface RunsChartsChartMouseEvent {\n  x: number;\n  y: number;\n  originalEvent?: MouseEvent;\n}\n\nexport enum RunsChartsTooltipMode {\n  Simple = 1,\n  MultipleTracesWithScanline = 2,\n}\n\nexport type RunsChartsTooltipBodyComponent<C = any, T = any> = React.ComponentType<RunsChartsTooltipBodyProps<C, T>>;\n\nconst RunsChartsTooltipContext = React.createContext<{\n  selectedRunUuid: string | null;\n  closeContextMenu: () => void;\n  resetTooltip: () => void;\n  destroyTooltip: () => void;\n  updateTooltip: (\n    runUuid: string,\n    mode: RunsChartsTooltipMode,\n    chartData?: any,\n    event?: RunsChartsChartMouseEvent,\n    additionalData?: any,\n  ) => void;\n} | null>(null);\n\nexport enum ContextMenuVisibility {\n  HIDDEN,\n  HOVER,\n  VISIBLE,\n}\n\nexport const containsMultipleRunsTooltipData = (\n  hoverData: RunsMetricsBarPlotHoverData | RunsMetricsSingleTraceTooltipData | RunsCompareMultipleTracesTooltipData,\n): hoverData is RunsCompareMultipleTracesTooltipData => hoverData && 'tooltipLegendItems' in hoverData;\n\n/**\n * Extract first ancestor HTML element in the hierarchy, even if the target is an SVG element.\n * Necessary for proper behavior of '.contains()'\n */\nconst extractHTMLAncestorElement = (element: Element | EventTarget | null) => {\n  if (element === null || !(element instanceof Element)) {\n    return null;\n  }\n  if (element instanceof HTMLElement) {\n    return element;\n  }\n\n  let currentElement: Element | null = element;\n  while (currentElement && !(currentElement instanceof HTMLElement)) {\n    currentElement = currentElement.parentElement;\n  }\n\n  return currentElement;\n};\n\n/**\n * Context and DOM container necessary for chart context menu to work.\n * Can wrap multiple charts.\n */\nexport const RunsChartsTooltipWrapper = <\n  // Type for the context data passed to the tooltip, e.g. list of all runs\n  TContext = any,\n  // Type for local hover data passed to the tooltip, e.g. configuration of particular chart\n  THover = any,\n>({\n  className,\n  children,\n  contextData,\n  component: Component,\n  hoverOnly = false,\n}: React.PropsWithChildren<{\n  className?: string;\n  contextData: TContext;\n  component: React.ComponentType<RunsChartsTooltipBodyProps<TContext, THover>>;\n  hoverOnly?: boolean;\n}>) => {\n  // A reference to the viewport-wide element containing the context menu\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  // A reference to the tooltip/context-menu element\n  const ctxMenuRef = useRef<HTMLDivElement>(null);\n\n  // Mutable value containing current mouse position\n  const currentPos = useRef<{ x: number; y: number }>({ x: 0, y: 0 });\n\n  const usingImprovedClickMechanism = shouldEnableDeepLearningUIPhase3();\n\n  // Mutable value containing current snapped mouse position, provided externally by the tooltip data providers\n  // Used instead of `currentPos` when the tooltip is in the \"multiple runs\" mode\n  const currentSnappedCoordinates = useRef<{ x: number; y: number }>({ x: 0, y: 0 });\n\n  const [mode, setMode] = useState<RunsChartsTooltipMode>(RunsChartsTooltipMode.Simple);\n\n  // Current visibility of the tooltip/context-menu\n  const [contextMenuShown, setContextMenuShown] = useState<ContextMenuVisibility>(ContextMenuVisibility.HIDDEN);\n\n  const [tooltipDisplayParams, setTooltipDisplayParams] = useState<any | null>(null);\n  const [hoveredRunUuid, setHoveredRunUuid] = useState<string>('');\n\n  // Apart from run uuid, It's also possible to set bonus axis data (helpful for line charts with data lineage)\n  const [additionalAxisData, setAdditionalAxisData] = useState<any>(null);\n\n  // Stores data about the run that has been clicked, but mouse has not been released.\n  const focusedRunData = useRef<{ x: number; y: number; runUuid: string } | null>(null);\n\n  // Mutable version of certain state values, used in processes outside the React event lifecycle\n  const mutableContextMenuShownRef = useRef<ContextMenuVisibility>(contextMenuShown);\n  const mutableHoveredRunUuid = useRef(hoveredRunUuid);\n  const mutableTooltipDisplayParams = useRef(tooltipDisplayParams);\n  const mutableAdditionalAxisData = useRef(additionalAxisData);\n\n  // Get the higlighting function from the context\n  const { highlightDataTrace } = useRunsChartTraceHighlight();\n\n  // This method applies the tooltip position basing on the mouse position\n  const applyPositioning = useCallback(\n    (isChangingVisibilityMode = false) => {\n      if (!ctxMenuRef.current || !containerRef.current) {\n        return;\n      }\n\n      // For the X coordinate, If the tooltip is in the \"multiple runs\" mode, use the snapped coordinates.\n      // Otherwise, use the current mouse position.\n      let targetX =\n        mode === RunsChartsTooltipMode.MultipleTracesWithScanline\n          ? currentSnappedCoordinates.current.x\n          : currentPos.current.x;\n\n      let targetY = currentPos.current.y;\n\n      const currentCtxMenu = ctxMenuRef.current;\n      const containerRect = containerRef.current.getBoundingClientRect();\n\n      if (mode === RunsChartsTooltipMode.MultipleTracesWithScanline) {\n        // In particular cases, the tooltip container can not take entire viewport size\n        // so we need to adjust the position of the tooltip\n        targetX -= containerRect.x;\n        targetY -= containerRect.y;\n      }\n\n      ctxMenuRef.current.style.left = '0px';\n      ctxMenuRef.current.style.top = '0px';\n      ctxMenuRef.current.style.transform = `translate3d(${targetX + 1}px, ${targetY + 1}px, 0)`;\n\n      // This function is used to reposition the tooltip if it's out of the viewport\n      const reposition = () => {\n        const menuRect = currentCtxMenu.getBoundingClientRect();\n\n        if (targetX + menuRect.width >= containerRect.width) {\n          targetX -= menuRect.width;\n        }\n\n        if (targetY + menuRect.height >= containerRect.height) {\n          targetY -= menuRect.height;\n        }\n\n        currentCtxMenu.style.transform = `translate3d(${targetX + 1}px, ${targetY + 1}px, 0)`;\n      };\n\n      // If the tooltip changes it's visibility mode during the process, defer repositioning to the next frame\n      // to make sure that the position is correct after possible change of the tooltip size.\n      // Otherwise, reposition immediately to save computation cycles.\n      if (isChangingVisibilityMode) {\n        requestAnimationFrame(reposition);\n      } else {\n        reposition();\n      }\n    },\n    [mode],\n  );\n\n  // Save mutable visibility each time a stateful one changes\n  useEffect(() => {\n    mutableContextMenuShownRef.current = contextMenuShown;\n  }, [contextMenuShown]);\n\n  // This function returns X and Y of the target element relative to the container\n  const getCoordinatesForTargetElement = useCallback((targetElement: HTMLElement, event: MouseEvent) => {\n    const targetRect = targetElement.getBoundingClientRect();\n    const containerRect = containerRef.current?.getBoundingClientRect() || { left: 0, top: 0 };\n    const x = event.offsetX + (targetRect.left - containerRect.left);\n    const y = event.offsetY + (targetRect.top - containerRect.top);\n    return { x, y };\n  }, []);\n\n  const mouseMove: React.MouseEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      // Apply only if the tooltip is in the hover mode\n      if (\n        mutableContextMenuShownRef.current === ContextMenuVisibility.HOVER &&\n        ctxMenuRef.current &&\n        containerRef.current\n      ) {\n        focusedRunData.current = null;\n        const targetElement = extractHTMLAncestorElement(event.target);\n        if (targetElement) {\n          currentPos.current = getCoordinatesForTargetElement(targetElement, event.nativeEvent);\n          applyPositioning();\n        }\n      }\n    },\n    [applyPositioning, getCoordinatesForTargetElement],\n  );\n\n  // This callback is being fired on every new run being hovered\n  const updateTooltip = useCallback(\n    (\n      runUuid: string,\n      mode: RunsChartsTooltipMode,\n      chartData?: any,\n      event?: RunsChartsChartMouseEvent,\n      additionalRunData?: any,\n    ) => {\n      mutableHoveredRunUuid.current = runUuid;\n      mutableTooltipDisplayParams.current = chartData;\n      mutableAdditionalAxisData.current = additionalRunData;\n\n      // If the tooltip is visible and hardwired to the position, don't change it\n      if (mutableContextMenuShownRef.current === ContextMenuVisibility.VISIBLE) {\n        return;\n      }\n\n      // Update the event-specific data in the state\n      setTooltipDisplayParams(chartData);\n\n      // If the mouse button has been clicked on a run but hover\n      // has been lost, do nothing\n      if (!runUuid && focusedRunData.current?.runUuid) {\n        return;\n      }\n\n      if (mode === RunsChartsTooltipMode.MultipleTracesWithScanline) {\n        currentSnappedCoordinates.current.x = event?.x || 0;\n      }\n\n      // Set the mode - single run or multiple runs\n      setMode(mode);\n\n      // Update the currently hovered run\n      setHoveredRunUuid((currentRunUuid) => {\n        if (additionalRunData) {\n          setAdditionalAxisData(additionalRunData);\n        }\n        // If the tooltip was hidden or it's shown but it's another run,\n        // make sure that the state is updated\n        if (\n          mutableContextMenuShownRef.current === ContextMenuVisibility.HIDDEN ||\n          (mutableContextMenuShownRef.current === ContextMenuVisibility.HOVER && runUuid !== currentRunUuid)\n        ) {\n          setContextMenuShown(ContextMenuVisibility.HOVER);\n          return runUuid;\n        }\n        return currentRunUuid;\n      });\n    },\n    [],\n  );\n\n  const mouseDownCapture: React.MouseEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      if (hoverOnly) {\n        return;\n      }\n      // Saves the current position and hovered run ID after lowering the mouse button,\n      // we use it afterwards to confirm that user has clicked on the same run and scrubbing/zooming\n      // didn't occur in the meanwhile\n      if (event.button === 0 && mutableHoveredRunUuid.current) {\n        focusedRunData.current = {\n          x: event.pageX,\n          y: event.pageY,\n          runUuid: mutableHoveredRunUuid.current,\n        };\n      }\n    },\n    [hoverOnly],\n  );\n\n  // Callback for the click event for the tooltip area, checks if context menu needs to be shown.\n  // We're not using `mouseup` because plotly.js hijacks the event by appending drag cover to the document on `mousedown`.\n  const tooltipAreaClicked: React.MouseEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      if (hoverOnly) {\n        return;\n      }\n\n      const clickedInTheSamePlace = () => {\n        if (!usingImprovedClickMechanism) {\n          return (\n            focusedRunData.current?.runUuid &&\n            event.pageX === focusedRunData.current.x &&\n            event.pageY === focusedRunData.current.y\n          );\n        }\n        const epsilonPixels = 5;\n\n        return (\n          focusedRunData.current?.runUuid &&\n          Math.abs(event.pageX - focusedRunData.current.x) < epsilonPixels &&\n          Math.abs(event.pageY - focusedRunData.current.y) < epsilonPixels\n        );\n      };\n\n      // We're interested in displaying the context menu only if\n      // mouse is in the same position as when lowering the button,\n      // this way we won't display it when zooming on the chart.\n      if (focusedRunData.current && clickedInTheSamePlace()) {\n        // If the context menu is already visible, we need to reposition it and provide\n        // the updated run UUID\n        if (mutableContextMenuShownRef.current === ContextMenuVisibility.VISIBLE) {\n          setHoveredRunUuid(focusedRunData.current.runUuid);\n          setAdditionalAxisData(mutableAdditionalAxisData.current);\n          const targetElement = extractHTMLAncestorElement(event.nativeEvent.target);\n          if (targetElement) {\n            currentPos.current = getCoordinatesForTargetElement(targetElement, event.nativeEvent);\n            applyPositioning(true);\n          }\n        } else {\n          // If the context menu was not visible before (it was a tooltip), just enable it.\n          setContextMenuShown(ContextMenuVisibility.VISIBLE);\n          applyPositioning(true);\n        }\n        event.stopPropagation();\n      }\n      // Since the mouse button is up, reset the currently focused run\n      focusedRunData.current = null;\n    },\n    [applyPositioning, hoverOnly, getCoordinatesForTargetElement, usingImprovedClickMechanism],\n  );\n\n  // Exposed function used to hide the context menu\n  const closeContextMenu = useCallback(() => setContextMenuShown(ContextMenuVisibility.HIDDEN), []);\n\n  // Set up main listeners in the useLayoutEffect hook\n  useLayoutEffect(() => {\n    if (!containerRef.current) {\n      return undefined;\n    }\n\n    // Find the DOM root - it can be either document or a shadow root\n    const domRoot = containerRef.current.getRootNode() as Document;\n\n    // This function is being called on every click in the document,\n    // it's used to dismiss the shown context menu\n    const rootClickListener = (e: MouseEvent) => {\n      // We're interested only in dismissing context menu mode, tooltip is fine\n      if (mutableContextMenuShownRef.current !== ContextMenuVisibility.VISIBLE) {\n        return;\n      }\n\n      const targetElement = extractHTMLAncestorElement(e.target);\n\n      if (!targetElement) {\n        return;\n      }\n\n      // Check if the click event occurred within the\n      // context menu\n      const contextMenuClicked =\n        targetElement instanceof HTMLElement &&\n        ctxMenuRef?.current instanceof HTMLElement &&\n        ctxMenuRef.current.contains(targetElement);\n\n      // Dismiss the context menu only if click didn't occur on\n      // the context menu content or on another run\n      if (!contextMenuClicked && !focusedRunData.current?.runUuid) {\n        setContextMenuShown(ContextMenuVisibility.HIDDEN);\n      }\n    };\n    domRoot.addEventListener('click', rootClickListener, { capture: true });\n\n    return () => {\n      domRoot.removeEventListener('click', rootClickListener, { capture: true });\n    };\n  }, [getCoordinatesForTargetElement, applyPositioning]);\n\n  // Callback used to reset the tooltip, fired when the mouse leaves the run\n  const resetTooltip = useCallback(() => {\n    mutableHoveredRunUuid.current = '';\n    if (focusedRunData.current?.runUuid || mutableContextMenuShownRef.current === ContextMenuVisibility.VISIBLE) {\n      return;\n    }\n    setHoveredRunUuid('');\n    setContextMenuShown(ContextMenuVisibility.HIDDEN);\n  }, []);\n\n  // Callback used to remove the tooltip,\n  const destroyTooltip = useCallback((force = false) => {\n    mutableHoveredRunUuid.current = '';\n    setHoveredRunUuid('');\n    setContextMenuShown(ContextMenuVisibility.HIDDEN);\n  }, []);\n\n  // Export the currently selected run ID. Set to \"null\" if there is nothing selected.\n  const selectedRunUuid = useMemo(() => {\n    if (contextMenuShown !== ContextMenuVisibility.VISIBLE) {\n      return null;\n    }\n    return hoveredRunUuid;\n  }, [contextMenuShown, hoveredRunUuid]);\n\n  // When the selected data trace changes, report the highlight event\n  useEffect(\n    () =>\n      highlightDataTrace(selectedRunUuid, {\n        source: ChartsTraceHighlightSource.CHART,\n        // Block the highlight event so it won't change as long as the tooltip is in selected mode\n        shouldBlock: Boolean(selectedRunUuid),\n      }),\n    [highlightDataTrace, selectedRunUuid],\n  );\n\n  const contextValue = useMemo(\n    () => ({ updateTooltip, resetTooltip, destroyTooltip, selectedRunUuid, closeContextMenu }),\n    [updateTooltip, resetTooltip, destroyTooltip, selectedRunUuid, closeContextMenu],\n  );\n\n  // We're displaying tooltip if:\n  // - it's not in the hidden mode\n  // - it's in the single run tooltip mode and hovered run is not empty\n  // - it's in the multiple runs tooltip mode\n  const displayTooltip =\n    contextMenuShown !== ContextMenuVisibility.HIDDEN &&\n    (mode === RunsChartsTooltipMode.MultipleTracesWithScanline || hoveredRunUuid !== '');\n\n  return (\n    <RunsChartsTooltipContext.Provider value={contextValue}>\n      {/* The element below wraps all the children (where charts are expected to be mounted)\n      and tracks mouse movement inside */}\n      <div\n        onMouseMove={mouseMove}\n        onMouseDownCapture={mouseDownCapture}\n        onClickCapture={tooltipAreaClicked}\n        css={{ height: '100%' }}\n      >\n        {children}\n      </div>\n      {/* The element below houses the tooltip/context menu */}\n      <div css={styles.contextMenuContainer} className={className} ref={containerRef}>\n        {displayTooltip && (\n          <div\n            ref={ctxMenuRef}\n            css={styles.contextMenuWrapper}\n            data-testid=\"tooltip-container\"\n            style={{\n              userSelect: contextMenuShown === ContextMenuVisibility.HOVER ? 'none' : 'unset',\n              pointerEvents: contextMenuShown === ContextMenuVisibility.HOVER ? 'none' : 'all',\n            }}\n          >\n            {/* A tooltip body component passed from the props */}\n            <Component\n              runUuid={hoveredRunUuid}\n              hoverData={additionalAxisData}\n              chartData={tooltipDisplayParams}\n              contextData={contextData}\n              isHovering={contextMenuShown === ContextMenuVisibility.HOVER}\n              closeContextMenu={closeContextMenu}\n              mode={mode}\n            />\n          </div>\n        )}\n      </div>\n    </RunsChartsTooltipContext.Provider>\n  );\n};\n\n/**\n * This hook is used to wire up tooltip to particular experiment runs chart.\n * Returns \"setTooltip\" and \"resetTooltip\" functions that should be called\n * upon chart's \"onHover\" and \"onUnhover\" events. \"setTooltip\" function consumes\n * the runUuid that was hovered on.\n */\nexport const useRunsChartsTooltip = <\n  // Type for local hover data passed to the tooltip, e.g. configuration of particular chart\n  TChart = any,\n  TAxisData = any,\n>(\n  chartData?: TChart,\n  mode = RunsChartsTooltipMode.Simple,\n) => {\n  const contextValue = useContext(RunsChartsTooltipContext);\n\n  if (!contextValue) {\n    throw new Error(\n      'You must invoke useRunsChartsTooltip() in a component being ancestor of <RunsChartsTooltipWrapper />!',\n    );\n  }\n\n  const { updateTooltip, resetTooltip, selectedRunUuid, closeContextMenu, destroyTooltip } = contextValue;\n  const { highlightDataTrace } = useRunsChartTraceHighlight();\n\n  const setTooltip = useCallback(\n    (runUuid = '', event?: RunsChartsChartMouseEvent, additionalAxisData?: TAxisData) => {\n      updateTooltip(runUuid, mode, chartData, event, additionalAxisData);\n      highlightDataTrace(runUuid, {\n        source: ChartsTraceHighlightSource.CHART,\n      });\n    },\n    [updateTooltip, chartData, mode, highlightDataTrace],\n  );\n\n  const resetTooltipWithHighlight = useCallback(() => {\n    resetTooltip();\n    highlightDataTrace(null);\n  }, [resetTooltip, highlightDataTrace]);\n\n  return { setTooltip, resetTooltip: resetTooltipWithHighlight, selectedRunUuid, closeContextMenu, destroyTooltip };\n};\n\nconst styles = {\n  contextMenuContainer: {\n    overflow: 'hidden',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    position: 'fixed',\n    pointerEvents: 'none',\n  } as Interpolation<Theme>,\n  contextMenuWrapper: (theme: Theme) => ({\n    zIndex: 1,\n    position: 'absolute' as const,\n    padding: theme.spacing.sm,\n    backgroundColor: theme.colors.backgroundPrimary,\n    border: `1px solid ${theme.colors.border}`,\n    left: -999,\n    top: -999,\n    borderRadius: theme.general.borderRadiusBase,\n    boxShadow: theme.general.shadowLow,\n  }),\n  overlayElement: (): Interpolation<Theme> => ({\n    '&::after': {\n      content: '\"\"',\n      position: 'absolute',\n      left: 0,\n      top: 0,\n      right: 0,\n      bottom: 0,\n      backgroundColor: 'transparent',\n    },\n  }),\n};\n","import React, { useCallback } from 'react';\nimport { ExperimentRunsChartsUIConfiguration } from '../../experiment-page/models/ExperimentPageUIState';\nimport { RunsChartsCardConfig } from '../runs-charts.types';\nimport { getUUID } from '../../../../common/utils/ActionUtils';\n\nexport type RunsChartsUIConfigurationSetter = (\n  state: ExperimentRunsChartsUIConfiguration,\n) => ExperimentRunsChartsUIConfiguration;\n\nconst RunsChartsUIConfigurationContext = React.createContext<(stateSetter: RunsChartsUIConfigurationSetter) => void>(\n  () => {},\n);\n\n/**\n * Creates a localized context to manage the UI state of the runs charts.\n * Accepts a function to update the state object, coming from simple state setter or a reducer.\n */\nexport const RunsChartsUIConfigurationContextProvider = ({\n  children,\n  updateChartsUIState,\n}: {\n  children: React.ReactNode;\n  updateChartsUIState: (stateSetter: RunsChartsUIConfigurationSetter) => void;\n}) => (\n  <RunsChartsUIConfigurationContext.Provider value={updateChartsUIState}>\n    {children}\n  </RunsChartsUIConfigurationContext.Provider>\n);\n\n/**\n * Returns a function to update the current overarching UI state of the runs charts.\n */\nexport const useUpdateRunsChartsUIConfiguration = () => React.useContext(RunsChartsUIConfigurationContext);\n\nexport const useReorderRunsChartsFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n\n  return useCallback(\n    (sourceChartUuid: string, targetChartUuid: string) => {\n      updateChartsUIState((current) => {\n        const newChartsOrder = current.compareRunCharts?.slice();\n        const newSectionsState = current.compareRunSections?.slice();\n        if (!newChartsOrder || !newSectionsState) {\n          return current;\n        }\n\n        const indexSource = newChartsOrder.findIndex((c) => c.uuid === sourceChartUuid);\n        const indexTarget = newChartsOrder.findIndex((c) => c.uuid === targetChartUuid);\n\n        // If one of the charts is not found, do nothing\n        if (indexSource < 0 || indexTarget < 0) {\n          return current;\n        }\n\n        const sourceChart = newChartsOrder[indexSource];\n        const targetChart = newChartsOrder[indexTarget];\n\n        const isSameMetricSection = targetChart.metricSectionId === sourceChart.metricSectionId;\n\n        // Update the sections to indicate that the charts have been reordered\n        const sourceSectionIdx = newSectionsState.findIndex((c) => c.uuid === sourceChart.metricSectionId);\n        const targetSectionIdx = newSectionsState.findIndex((c) => c.uuid === targetChart.metricSectionId);\n        newSectionsState.splice(sourceSectionIdx, 1, { ...newSectionsState[sourceSectionIdx], isReordered: true });\n        newSectionsState.splice(targetSectionIdx, 1, { ...newSectionsState[targetSectionIdx], isReordered: true });\n\n        // Set new chart metric group\n        const newSourceChart = { ...sourceChart };\n        newSourceChart.metricSectionId = targetChart.metricSectionId;\n\n        // Remove the source graph from array\n        newChartsOrder.splice(indexSource, 1);\n        if (!isSameMetricSection) {\n          // Insert the source graph into target\n          newChartsOrder.splice(\n            newChartsOrder.findIndex((c) => c.uuid === targetChartUuid),\n            0,\n            newSourceChart,\n          );\n        } else {\n          // The indexTarget is not neccessarily the target now, but it will work as the insert index\n          newChartsOrder.splice(indexTarget, 0, newSourceChart);\n        }\n\n        return {\n          ...current,\n          compareRunCharts: newChartsOrder,\n          compareRunSections: newSectionsState,\n        };\n      });\n    },\n    [updateChartsUIState],\n  );\n};\n\nexport const useConfirmChartCardConfigurationFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n  return (configuredCard: Partial<RunsChartsCardConfig>) => {\n    const serializedCard = RunsChartsCardConfig.serialize({\n      ...configuredCard,\n      uuid: getUUID(),\n    });\n\n    // Creating new chart\n    if (!configuredCard.uuid) {\n      updateChartsUIState((current) => ({\n        ...current,\n        // This condition ensures that chart collection will remain undefined if not set previously\n        compareRunCharts: current.compareRunCharts && [...current.compareRunCharts, serializedCard],\n      }));\n    } /* Editing existing chart */ else {\n      updateChartsUIState((current) => ({\n        ...current,\n        compareRunCharts: current.compareRunCharts?.map((existingChartCard) => {\n          if (existingChartCard.uuid === configuredCard.uuid) {\n            return serializedCard;\n          }\n          return existingChartCard;\n        }),\n      }));\n    }\n  };\n};\n\nexport const useInsertRunsChartsFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n  return (sourceChartUuid: string, targetSectionId: string) => {\n    updateChartsUIState((current) => {\n      const newChartsOrder = current.compareRunCharts?.slice();\n      const newSectionsState = current.compareRunSections?.slice();\n      if (!newChartsOrder || !newSectionsState) {\n        return current;\n      }\n\n      const indexSource = newChartsOrder.findIndex((c) => c.uuid === sourceChartUuid);\n      if (indexSource < 0) {\n        return current;\n      }\n      const sourceChart = newChartsOrder[indexSource];\n      // Set new chart metric group\n      const newSourceChart = { ...sourceChart };\n      newSourceChart.metricSectionId = targetSectionId;\n\n      // Update the sections to indicate that the charts have been reordered\n      const sourceSectionIdx = newSectionsState.findIndex((c) => c.uuid === sourceChart.metricSectionId);\n      const targetSectionIdx = newSectionsState.findIndex((c) => c.uuid === targetSectionId);\n      newSectionsState.splice(sourceSectionIdx, 1, { ...newSectionsState[sourceSectionIdx], isReordered: true });\n      newSectionsState.splice(targetSectionIdx, 1, { ...newSectionsState[targetSectionIdx], isReordered: true });\n\n      // Remove the source graph from array and append\n      newChartsOrder.splice(indexSource, 1);\n      newChartsOrder.push(newSourceChart);\n\n      return {\n        ...current,\n        compareRunCharts: newChartsOrder,\n        compareRunSections: newSectionsState,\n      };\n    });\n  };\n};\n\nexport const useRemoveRunsChartFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n\n  return useCallback(\n    (configToDelete: RunsChartsCardConfig) => {\n      updateChartsUIState((current) => ({\n        ...current,\n        compareRunCharts: configToDelete.isGenerated\n          ? current.compareRunCharts?.map((setup) =>\n              setup.uuid === configToDelete.uuid ? { ...setup, deleted: true } : setup,\n            )\n          : current.compareRunCharts?.filter((setup) => setup.uuid !== configToDelete.uuid),\n      }));\n    },\n    [updateChartsUIState],\n  );\n};\n","import { chunk, isEqual, keyBy } from 'lodash';\nimport { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { ReduxState, ThunkDispatch } from '../../../../redux-types';\nimport { createChartAxisRangeKey } from '../components/RunsCharts.common';\nimport { getSampledMetricHistoryBulkAction } from '../../../sdk/SampledMetricHistoryService';\nimport { SampledMetricsByRunUuidState } from '@mlflow/mlflow/src/experiment-tracking/types';\nimport { EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL } from '../../../utils/MetricsUtils';\nimport Utils from '../../../../common/utils/Utils';\n\ntype SampledMetricData = SampledMetricsByRunUuidState[string][string][string];\n\nexport type SampledMetricsByRun = {\n  runUuid: string;\n} & {\n  [metricKey: string]: SampledMetricData;\n};\n\nconst SAMPLED_METRIC_HISTORY_API_RUN_LIMIT = 100;\n/**\n *\n * Automatically fetches sampled metric history for runs, used in run runs charts.\n * After updating list of metrics or runs, optimizes the request and fetches\n * only the missing entries.\n */\nexport const useSampledMetricHistory = (params: {\n  runUuids: string[];\n  metricKeys: string[];\n  maxResults?: number;\n  range?: [number, number];\n  enabled?: boolean;\n  autoRefreshEnabled?: boolean;\n}) => {\n  const { metricKeys, runUuids, enabled, maxResults, range, autoRefreshEnabled } = params;\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  const { resultsByRunUuid, isLoading, isRefreshing } = useSelector(\n    (store: ReduxState) => {\n      const rangeKey = createChartAxisRangeKey(range);\n\n      let anyRunRefreshing = false;\n      let anyRunLoading = false;\n\n      const returnValues: SampledMetricsByRun[] = runUuids.map((runUuid) => {\n        const metricsByMetricKey = metricKeys.reduce(\n          (dataByMetricKey: { [key: string]: SampledMetricData }, metricKey: string) => {\n            const runMetricData = store.entities.sampledMetricsByRunUuid[runUuid]?.[metricKey]?.[rangeKey];\n\n            if (!runMetricData) {\n              return dataByMetricKey;\n            }\n\n            anyRunLoading = anyRunLoading || Boolean(runMetricData.loading);\n            anyRunRefreshing = anyRunRefreshing || Boolean(runMetricData.refreshing);\n\n            dataByMetricKey[metricKey] = runMetricData;\n            return dataByMetricKey;\n          },\n          {},\n        );\n\n        return {\n          runUuid,\n          ...metricsByMetricKey,\n        };\n      });\n\n      return {\n        isLoading: anyRunLoading,\n        isRefreshing: anyRunRefreshing,\n        resultsByRunUuid: keyBy(returnValues, 'runUuid'),\n      };\n    },\n    (left, right) =>\n      isEqual(left.resultsByRunUuid, right.resultsByRunUuid) &&\n      left.isLoading === right.isLoading &&\n      left.isRefreshing === right.isRefreshing,\n  );\n\n  const refreshFn = useCallback(() => {\n    metricKeys.forEach((metricKey) => {\n      chunk(runUuids, SAMPLED_METRIC_HISTORY_API_RUN_LIMIT).forEach((runUuidsChunk) => {\n        const action = getSampledMetricHistoryBulkAction(runUuidsChunk, metricKey, maxResults, range, 'all');\n        dispatch(action);\n      });\n    });\n  }, [dispatch, maxResults, runUuids, metricKeys, range]);\n\n  const refreshTimeoutRef = useRef<number | undefined>(undefined);\n  const autoRefreshEnabledRef = useRef(autoRefreshEnabled && params.enabled);\n  autoRefreshEnabledRef.current = autoRefreshEnabled && params.enabled;\n\n  // Serialize runUuids to a string to use as a dependency in the effect,\n  // directly used runUuids can cause unnecessary re-fetches\n  const runUuidsSerialized = useMemo(() => runUuids.join(','), [runUuids]);\n\n  // Regular single fetch effect with no auto-refresh capabilities. Used if auto-refresh is disabled.\n  useEffect(() => {\n    if (!enabled || autoRefreshEnabled) {\n      return;\n    }\n    metricKeys.forEach((metricKey) => {\n      chunk(runUuids, SAMPLED_METRIC_HISTORY_API_RUN_LIMIT).forEach((runUuidsChunk) => {\n        const action = getSampledMetricHistoryBulkAction(runUuidsChunk, metricKey, maxResults, range);\n        dispatch(action);\n      });\n    });\n  }, [dispatch, maxResults, runUuids, metricKeys, range, enabled, autoRefreshEnabled]);\n\n  // A fetch effect with auto-refresh capabilities. Used only if auto-refresh is enabled.\n  useEffect(() => {\n    let hookUnmounted = false;\n    if (!enabled || !autoRefreshEnabled) {\n      return;\n    }\n\n    // Base fetching function, used for both initial call and subsequent auto-refresh calls\n    const fetchMetricsFn = async (isAutoRefreshing = false) => {\n      const runUuids = runUuidsSerialized.split(',').filter((runUuid: string) => runUuid !== '');\n      await Promise.all(\n        metricKeys.map(async (metricKey) =>\n          Promise.all(\n            chunk(runUuids, SAMPLED_METRIC_HISTORY_API_RUN_LIMIT).map(async (runUuidsChunk) =>\n              dispatch(\n                getSampledMetricHistoryBulkAction(\n                  runUuidsChunk,\n                  metricKey,\n                  maxResults,\n                  range,\n                  isAutoRefreshing ? 'auto' : undefined,\n                ),\n              ),\n            ),\n          ),\n        ),\n      );\n    };\n\n    const scheduleRefresh = async () => {\n      // Initial check to confirm that auto-refresh is still enabled and the hook is still mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n      try {\n        await fetchMetricsFn(true);\n      } catch (e) {\n        // In case of error during auto-refresh, log the error but do break the auto-refresh loop\n        Utils.logErrorAndNotifyUser(e);\n      }\n      clearTimeout(refreshTimeoutRef.current);\n\n      // After loading the data, schedule the next refresh if the hook is still enabled and mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n\n      refreshTimeoutRef.current = window.setTimeout(scheduleRefresh, EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL);\n    };\n\n    fetchMetricsFn().then(scheduleRefresh);\n\n    return () => {\n      // Mark the hook as unmounted to prevent scheduling new auto-refreshes with current data\n      hookUnmounted = true;\n\n      // Clear the timeout\n      clearTimeout(refreshTimeoutRef.current);\n    };\n  }, [dispatch, maxResults, runUuidsSerialized, metricKeys, range, enabled, autoRefreshEnabled]);\n\n  return { isLoading, isRefreshing, resultsByRunUuid, refresh: refreshFn };\n};\n","import type { RunsChartAxisDef, RunsChartsRunData } from './components/RunsCharts.common';\nimport { RunsChartsLineChartXAxisType } from './components/RunsCharts.common';\nimport { getUUID } from '../../../common/utils/ActionUtils';\nimport { MetricEntitiesByName, ChartSectionConfig } from '../../types';\nimport {\n  MLFLOW_MODEL_METRIC_PREFIX,\n  MLFLOW_SYSTEM_METRIC_PREFIX,\n  MLFLOW_MODEL_METRIC_NAME,\n  MLFLOW_SYSTEM_METRIC_NAME,\n  DEFAULT_IMAGE_GRID_CHART_NAME,\n} from '../../constants';\nimport { isNil, uniq } from 'lodash';\nimport { customMetricBehaviorDefs } from '../experiment-page/utils/customMetricBehaviorUtils';\n\n/**\n * Enum for all recognized chart types used in runs charts\n */\nexport enum RunsChartType {\n  BAR = 'BAR',\n  LINE = 'LINE',\n  SCATTER = 'SCATTER',\n  CONTOUR = 'CONTOUR',\n  PARALLEL = 'PARALLEL',\n  DIFFERENCE = 'DIFFERENCE',\n  IMAGE = 'IMAGE',\n}\n\nconst MIN_NUMBER_OF_STEP_FOR_LINE_COMPARISON = 1;\n\n/**\n * Simple interface corresponding to `RunsChartsCardConfig`.\n * Its role is to distinguish between stateful class instance and a simple POJO,\n * it is meant to be contained in a serializable, persisted state.\n */\nexport type SerializedRunsChartsCardConfigCard = RunsChartsCardConfig;\n\n// A function to iterate across run/group data traces and determine if any metric has multiple epochs.\n// This helps to decide if we should seed the line chart or a bar chart.\nconst dataTraceMetricsContainMultipleEpochs = (dataTrace: RunsChartsRunData, metricKey: string): boolean =>\n  Boolean(dataTrace.metrics?.[metricKey]?.step >= MIN_NUMBER_OF_STEP_FOR_LINE_COMPARISON);\n\n/**\n * Main class used for represent a single configured chart card with its type, configuration options etc.\n * Meant to be extended by various chart type classes with `type` field being frozen to a single value.\n */\nexport abstract class RunsChartsCardConfig {\n  uuid?: string;\n  type: RunsChartType = RunsChartType.BAR;\n  runsCountToCompare?: number = 10;\n  metricSectionId?: string = '';\n  deleted = false;\n  isGenerated = false;\n\n  constructor(isGenerated: boolean, uuid?: string, metricSectionId?: string) {\n    this.isGenerated = isGenerated;\n    this.uuid = uuid;\n    this.metricSectionId = metricSectionId;\n  }\n\n  /**\n   * Serializes chart entry, i.e. strips all unnecessary fields (and/or methods) so\n   * it can be saved in persistable memory.\n   */\n  static serialize(entity: Partial<RunsChartsCardConfig>): SerializedRunsChartsCardConfigCard {\n    // TODO: strip unnecessary fields if any\n    return (Object.keys(entity) as (keyof SerializedRunsChartsCardConfigCard)[]).reduce(\n      (result, key) => ({ ...result, [key]: entity[key] }),\n      {} as SerializedRunsChartsCardConfigCard,\n    );\n  }\n\n  /**\n   * Creates empty chart (card) config basing on a type.\n   * TODO: consume visible run set and determine best configuration of metrics, params etc.\n   */\n  static getEmptyChartCardByType(type: RunsChartType, isGenerated: boolean, uuid?: string, metricSectionId?: string) {\n    if (type === RunsChartType.BAR) {\n      return new RunsChartsBarCardConfig(isGenerated, uuid, metricSectionId);\n    } else if (type === RunsChartType.SCATTER) {\n      return new RunsChartsScatterCardConfig(isGenerated, uuid, metricSectionId);\n    } else if (type === RunsChartType.PARALLEL) {\n      return new RunsChartsParallelCardConfig(isGenerated, uuid, metricSectionId);\n    } else if (type === RunsChartType.LINE) {\n      return new RunsChartsLineCardConfig(isGenerated, uuid, metricSectionId);\n    } else if (type === RunsChartType.DIFFERENCE) {\n      return new RunsChartsDifferenceCardConfig(isGenerated, uuid, metricSectionId);\n    } else if (type === RunsChartType.IMAGE) {\n      return new RunsChartsImageCardConfig(isGenerated, uuid, metricSectionId);\n    } else {\n      // Must be contour\n      return new RunsChartsContourCardConfig(isGenerated, uuid, metricSectionId);\n    }\n  }\n\n  static getBaseChartConfigs(primaryMetricKey: string, runsData: RunsChartsRunData[]) {\n    const resultChartSet: RunsChartsCardConfig[] = [];\n    const MAX_NUMBER_OF_METRICS_TO_RENDER = 30;\n\n    const allMetricKeys = uniq(runsData.flatMap((run) => Object.keys(run.metrics)));\n\n    const metricsToRender: Set<string> = new Set();\n    // Add primary_metric to render first\n    if (primaryMetricKey) {\n      metricsToRender.add(primaryMetricKey);\n    }\n\n    // Adding other metrics to render\n    for (const metricsKey of allMetricKeys) {\n      metricsToRender.add(metricsKey);\n    }\n\n    // Render only first N metrics\n    const renderFirstNMetrics: string[] = [...metricsToRender].slice(0, MAX_NUMBER_OF_METRICS_TO_RENDER);\n\n    renderFirstNMetrics.forEach((metricsKey) => {\n      // If the metric has multiple epochs, add a line chart. Otherwise, add a bar chart\n      const anyRunHasMultipleEpochs = runsData.some((dataTrace) =>\n        dataTraceMetricsContainMultipleEpochs(dataTrace, metricsKey),\n      );\n      const chartType = anyRunHasMultipleEpochs ? RunsChartType.LINE : RunsChartType.BAR;\n\n      // Add a bar metric chart only if at least one metric key is detected\n      resultChartSet.push({\n        ...RunsChartsCardConfig.getEmptyChartCardByType(chartType, true, getUUID()),\n        metricKey: metricsKey,\n      } as RunsChartsBarCardConfig);\n    });\n\n    // If no other charts exist, show empty parallel coordinates plot\n    if (resultChartSet.length === 0) {\n      resultChartSet.push(RunsChartsCardConfig.getEmptyChartCardByType(RunsChartType.PARALLEL, false, getUUID()));\n    }\n\n    return resultChartSet;\n  }\n\n  // Extract chart section from metric key\n  static extractChartSectionName = (metricKey: string, delimiter = '/') => {\n    const displayMetricName = customMetricBehaviorDefs[metricKey]?.displayName ?? metricKey;\n\n    const parts = displayMetricName.split(delimiter);\n    const section = parts.slice(0, -1).join(delimiter);\n    if (section === MLFLOW_MODEL_METRIC_PREFIX) {\n      return MLFLOW_MODEL_METRIC_NAME;\n    } else if (section + delimiter === MLFLOW_SYSTEM_METRIC_PREFIX) {\n      return MLFLOW_SYSTEM_METRIC_NAME;\n    }\n    return section;\n  };\n\n  static getBaseChartAndSectionConfigs({\n    primaryMetricKey,\n    runsData,\n    useParallelCoordinatesChart = false,\n    enabledSectionNames = [MLFLOW_MODEL_METRIC_NAME, MLFLOW_SYSTEM_METRIC_NAME],\n    filterMetricNames,\n  }: {\n    primaryMetricKey?: string;\n    useParallelCoordinatesChart?: boolean;\n    runsData: RunsChartsRunData[];\n    enabledSectionNames?: string[];\n    filterMetricNames?: (metricName: string) => boolean;\n  }) {\n    const resultChartSet: RunsChartsCardConfig[] = [];\n\n    const allMetricKeys = uniq(runsData.flatMap((run) => Object.keys(run.metrics))).filter((name) => {\n      if (!filterMetricNames) {\n        return true;\n      }\n      return filterMetricNames(name);\n    });\n\n    const metricsToRender: Set<string> = new Set();\n    // Add primary_metric to render first\n    if (primaryMetricKey) {\n      metricsToRender.add(primaryMetricKey);\n    }\n\n    const imagesToRender = uniq(runsData.flatMap((run) => Object.keys(run.images)));\n\n    // Adding other metrics to render\n    for (const metricsKey of allMetricKeys) {\n      metricsToRender.add(metricsKey);\n    }\n\n    const sectionName2Uuid: Record<string, string> = {};\n    enabledSectionNames.forEach((sectionName) => {\n      sectionName2Uuid[sectionName] = getUUID();\n    });\n\n    [...metricsToRender, ...imagesToRender].forEach((key) => {\n      if (!sectionName2Uuid[RunsChartsCardConfig.extractChartSectionName(key)]) {\n        sectionName2Uuid[RunsChartsCardConfig.extractChartSectionName(key)] = getUUID();\n      }\n    });\n\n    Array.from(metricsToRender)\n      .sort()\n      .forEach((metricsKey) => {\n        // If the metric has multiple epochs, add a line chart. Otherwise, add a bar chart\n        const anyRunHasMultipleEpochs = runsData.some((dataTrace) =>\n          dataTraceMetricsContainMultipleEpochs(dataTrace, metricsKey),\n        );\n        const chartType = anyRunHasMultipleEpochs ? RunsChartType.LINE : RunsChartType.BAR;\n\n        const sectionId = sectionName2Uuid[RunsChartsCardConfig.extractChartSectionName(metricsKey)];\n\n        // Add a bar metric chart only if at least one metric key is detected\n        resultChartSet.push({\n          ...RunsChartsCardConfig.getEmptyChartCardByType(chartType, true, getUUID(), sectionId),\n          metricKey: metricsKey,\n        } as RunsChartsBarCardConfig);\n      });\n\n    Array.from(imagesToRender)\n      .sort()\n      .forEach((imageKey) => {\n        const chartType = RunsChartType.IMAGE;\n        const sectionId = sectionName2Uuid[RunsChartsCardConfig.extractChartSectionName(imageKey)];\n\n        // Add an image chart\n        resultChartSet.push({\n          ...RunsChartsCardConfig.getEmptyChartCardByType(chartType, true, getUUID(), sectionId),\n          imageKeys: [imageKey],\n        } as RunsChartsImageCardConfig);\n      });\n\n    // If no other charts exist, show empty parallel coordinates plot\n    if (resultChartSet.length === 0 && useParallelCoordinatesChart) {\n      const sectionId = sectionName2Uuid[MLFLOW_MODEL_METRIC_NAME];\n      resultChartSet.push(\n        RunsChartsCardConfig.getEmptyChartCardByType(RunsChartType.PARALLEL, false, getUUID(), sectionId),\n      );\n    }\n    const rest = Object.keys(sectionName2Uuid)\n      .filter((sectionName) => sectionName !== MLFLOW_MODEL_METRIC_NAME && sectionName !== MLFLOW_SYSTEM_METRIC_NAME)\n      .sort();\n\n    const sortedSectionNames = [\n      ...rest,\n      ...[MLFLOW_MODEL_METRIC_NAME, MLFLOW_SYSTEM_METRIC_NAME].filter((name) => enabledSectionNames.includes(name)),\n    ];\n\n    // Create section configs\n    const resultSectionSet: ChartSectionConfig[] = sortedSectionNames.map((sectionName) => ({\n      uuid: sectionName2Uuid[sectionName],\n      name: sectionName,\n      display: true,\n      isReordered: false,\n      deleted: false,\n      isGenerated: true,\n    }));\n\n    return { resultChartSet, resultSectionSet };\n  }\n\n  static updateChartAndSectionConfigs({\n    compareRunCharts,\n    compareRunSections,\n    isAccordionReordered,\n    runsData,\n    filterMetricNames,\n  }: {\n    compareRunCharts: RunsChartsCardConfig[];\n    compareRunSections: ChartSectionConfig[];\n    runsData: RunsChartsRunData[];\n    isAccordionReordered: boolean;\n    filterMetricNames?: (metricName: string) => boolean;\n  }) {\n    // Make copies of the current charts and sections\n    const resultChartSet: RunsChartsCardConfig[] = compareRunCharts.slice();\n    let resultSectionSet: ChartSectionConfig[] = compareRunSections.slice();\n    // Flag for whether the section or chart set have been updated\n    let isResultUpdated = false;\n\n    const allMetricKeys = uniq(runsData.flatMap((run) => Object.keys(run.metrics))).filter((name) => {\n      if (!filterMetricNames) {\n        return true;\n      }\n      return filterMetricNames(name);\n    });\n\n    const imagesToRender = uniq(runsData.flatMap((run) => Object.keys(run.images)));\n\n    // Create set of metrics to render based on runsData\n    const metricsToRender: Set<string> = new Set();\n    // Adding other metrics to render\n    for (const metricsKey of allMetricKeys) {\n      metricsToRender.add(metricsKey);\n    }\n\n    // Create sectionName2Uuid mappings from existing sections\n    const sectionName2Uuid: Record<string, string> = {};\n    compareRunSections.forEach((section) => (sectionName2Uuid[section.name] = section.uuid));\n\n    imagesToRender.forEach((imageKey) => {\n      const doesImageKeyExist =\n        resultChartSet.findIndex((chart) => {\n          const chartImageKeys = (chart as RunsChartsImageCardConfig).imageKeys;\n          return chartImageKeys ? chartImageKeys.length === 1 && chartImageKeys.includes(imageKey) : false;\n        }) >= 0;\n\n      const chartType = RunsChartType.IMAGE;\n      if (!doesImageKeyExist) {\n        // result is updated when there is a new image key\n        isResultUpdated = true;\n\n        // Insert a new UUID if section doesn't exist\n        const sectionName = RunsChartsCardConfig.extractChartSectionName(imageKey);\n        if (!sectionName2Uuid[sectionName]) {\n          sectionName2Uuid[sectionName] = getUUID();\n        }\n\n        // Get section for imageKey and check if it has been reordered\n        const sectionId = sectionName2Uuid[sectionName];\n        // If section is undefined, it may be a new section, so its not reordered\n        const section = resultSectionSet.find((section) => section.uuid === sectionId);\n        const isSectionReordered = section ? section.isReordered : false;\n\n        const newChartConfig = {\n          ...RunsChartsCardConfig.getEmptyChartCardByType(chartType, true, getUUID(), sectionId),\n          imageKeys: [imageKey],\n        } as RunsChartsImageCardConfig;\n\n        if (isSectionReordered) {\n          // If the section has been reordered, then append to the end of the section\n          resultChartSet.push(newChartConfig);\n        } else {\n          // If section has not been reordered, then insert alphabetically\n          const insertIndex = resultChartSet.findIndex((chart) => {\n            const chartImageKeys = (chart as RunsChartsImageCardConfig).imageKeys;\n            return chartImageKeys ? chartImageKeys[0].localeCompare(imageKey) >= 0 : false;\n          });\n          resultChartSet.splice(insertIndex, 0, newChartConfig);\n        }\n      }\n    });\n\n    // Append new charts at the end instead of alphabetically\n    metricsToRender.forEach((metricKey) => {\n      // Check if metricKey exists in the current chart set\n      const doesMetricKeyExist =\n        resultChartSet.findIndex((chart) => {\n          const chartMetricKey = (chart as RunsChartsBarCardConfig).metricKey;\n          return chartMetricKey ? chartMetricKey === metricKey : false;\n        }) >= 0;\n\n      // Check if there is a generated chart with metricKey\n      const generatedChartIndex = resultChartSet.findIndex((chart) => {\n        const chartMetricKey = (chart as RunsChartsBarCardConfig).metricKey;\n        return chartMetricKey && chartMetricKey === metricKey && chart.isGenerated;\n      });\n\n      // If the metric has multiple epochs, add a line chart. Otherwise, add a bar chart\n      const anyRunHasMultipleEpochs = runsData.some((dataTrace) =>\n        dataTraceMetricsContainMultipleEpochs(dataTrace, metricKey),\n      );\n      const chartType = anyRunHasMultipleEpochs ? RunsChartType.LINE : RunsChartType.BAR;\n\n      // This is a new metric key, so add it to the chart set\n      if (!doesMetricKeyExist) {\n        // result is updated when there is a new metric key\n        isResultUpdated = true;\n\n        // Insert a new UUID if section doesn't exist\n        const sectionName = RunsChartsCardConfig.extractChartSectionName(metricKey);\n        if (!sectionName2Uuid[sectionName]) {\n          sectionName2Uuid[sectionName] = getUUID();\n        }\n\n        // Get section for metricKey and check if it has been reordered\n        const sectionId = sectionName2Uuid[sectionName];\n        // If section is undefined, it may be a new section, so its not reordered\n        const section = resultSectionSet.find((section) => section.uuid === sectionId);\n        const isSectionReordered = section ? section.isReordered : false;\n\n        const newChartConfig = {\n          ...RunsChartsCardConfig.getEmptyChartCardByType(chartType, true, getUUID(), sectionId),\n          metricKey: metricKey,\n        } as RunsChartsBarCardConfig;\n\n        if (isSectionReordered) {\n          // If the section has been reordered, then append to the end of the section\n          resultChartSet.push(newChartConfig);\n        } else {\n          // If section has not been reordered, then insert alphabetically\n          const insertIndex = resultChartSet.findIndex((chart) => {\n            const chartMetricKey = (chart as RunsChartsBarCardConfig).metricKey;\n            return chartMetricKey ? chartMetricKey.localeCompare(metricKey) >= 0 : false;\n          });\n          resultChartSet.splice(insertIndex, 0, newChartConfig);\n        }\n      } else if (\n        generatedChartIndex >= 0 &&\n        resultChartSet[generatedChartIndex].type === RunsChartType.BAR &&\n        chartType === RunsChartType.LINE\n      ) {\n        isResultUpdated = true;\n        // If the chart type has been updated to a line chart from a bar chart, then update the chart type\n        const prevChart = resultChartSet[generatedChartIndex];\n        resultChartSet[generatedChartIndex] = {\n          ...RunsChartsCardConfig.getEmptyChartCardByType(\n            chartType,\n            prevChart.isGenerated,\n            prevChart.uuid,\n            prevChart.metricSectionId,\n          ),\n          metricKey: metricKey,\n          deleted: prevChart.deleted,\n        } as RunsChartsLineCardConfig;\n      }\n    });\n\n    Object.keys(sectionName2Uuid).forEach((sectionName) => {\n      // Check if it is a new section\n      const doesSectionNameExist = resultSectionSet.findIndex((section) => section.name === sectionName) >= 0;\n      if (!doesSectionNameExist) {\n        resultSectionSet.push({\n          uuid: sectionName2Uuid[sectionName],\n          name: sectionName,\n          display: true,\n          isReordered: false,\n        });\n      }\n    });\n\n    if (!isAccordionReordered) {\n      // If sections are in order (not been reordered), then sort alphabetically\n      const rest = resultSectionSet.filter(\n        (section) => section.name !== MLFLOW_MODEL_METRIC_NAME && section.name !== MLFLOW_SYSTEM_METRIC_NAME,\n      );\n      rest.sort((a, b) => a.name.localeCompare(b.name));\n      resultSectionSet = [\n        ...rest,\n        compareRunSections[compareRunSections.length - 2],\n        compareRunSections[compareRunSections.length - 1],\n      ].filter((section) => !isNil(section));\n    }\n\n    return { resultChartSet, resultSectionSet, isResultUpdated };\n  }\n}\n\n// TODO: add configuration fields relevant to scatter chart\nexport class RunsChartsScatterCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType.SCATTER = RunsChartType.SCATTER;\n  xaxis: RunsChartAxisDef = { key: '', type: 'METRIC' };\n  yaxis: RunsChartAxisDef = { key: '', type: 'METRIC' };\n  runsCountToCompare = 100;\n}\n\nexport interface ChartRange {\n  xMin?: number;\n  xMax?: number;\n  yMin?: number;\n  yMax?: number;\n}\n\nexport enum RunsChartsLineChartYAxisType {\n  METRIC = 'metric',\n  EXPRESSION = 'expression',\n}\n\n// TODO: add configuration fields relevant to line chart\nexport class RunsChartsLineCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType.LINE = RunsChartType.LINE;\n\n  /**\n   * A metric key used for chart's X axis\n   */\n  metricKey = '';\n\n  /**\n   * New key to support multiple metrics\n   * NOTE: This key will not be present in older charts\n   */\n  selectedMetricKeys?: string[];\n\n  /**\n   * Smoothness\n   */\n  lineSmoothness = 0;\n\n  /**\n   * Scale type for X axis\n   */\n  xAxisScaleType: 'linear' | 'log' = 'linear';\n\n  /**\n   * Y axis mode\n   */\n  scaleType: 'linear' | 'log' = 'linear';\n\n  /**\n   * Range of Y axis, X axis.\n   */\n  range?: ChartRange = {\n    xMin: undefined,\n    xMax: undefined,\n    yMin: undefined,\n    yMax: undefined,\n  };\n\n  /**\n   * Choose X axis mode - numeric step, relative time in seconds or absolute time value\n   */\n  xAxisKey: RunsChartsLineChartXAxisType = RunsChartsLineChartXAxisType.STEP;\n\n  /**\n   * Name of the metric to use for the X axis. Used when xAxisKey is set to 'metric'\n   */\n  selectedXAxisMetricKey = '';\n\n  /**\n   * Display points on the line chart. Undefined means \"auto\" mode, i.e. display points only when\n   * there are fewer than 60 datapoints on the chart.\n   */\n  displayPoints?: boolean = undefined;\n\n  /**\n   * Show metrics directly or custom expressions on metrics\n   */\n  yAxisKey?: RunsChartsLineChartYAxisType = RunsChartsLineChartYAxisType.METRIC;\n\n  /**\n   * Custom expressions for Y axis\n   */\n  yAxisExpressions?: string[] = [];\n\n  /**\n   * Whether or not to ignore outliers. If true, the data will be clipped\n   * to the 5th and 95th percentiles.\n   */\n  ignoreOutliers?: boolean = false;\n}\n\n// TODO: add configuration fields relevant to bar chart\nexport class RunsChartsBarCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType.BAR = RunsChartType.BAR;\n\n  /**\n   * A metric key used for chart's X axis\n   */\n  metricKey = '';\n}\n\n// TODO: add configuration fields relevant to contour chart\nexport class RunsChartsContourCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType.CONTOUR = RunsChartType.CONTOUR;\n  xaxis: RunsChartAxisDef = { key: '', type: 'METRIC' };\n  yaxis: RunsChartAxisDef = { key: '', type: 'METRIC' };\n  zaxis: RunsChartAxisDef = { key: '', type: 'METRIC' };\n}\n\n// TODO: add configuration fields relevant to parallel coords chart\nexport class RunsChartsParallelCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType.PARALLEL = RunsChartType.PARALLEL;\n  selectedParams: string[] = [];\n  selectedMetrics: string[] = [];\n  showAllRuns?: boolean = false;\n}\n\nexport enum DifferenceCardConfigCompareGroup {\n  MODEL_METRICS = 'Model metrics',\n  SYSTEM_METRICS = 'System metrics',\n  PARAMETERS = 'Parameters',\n  ATTRIBUTES = 'Attributes',\n  TAGS = 'Tags',\n}\n\nexport const DISABLED_GROUP_WHEN_GROUPBY = [\n  DifferenceCardConfigCompareGroup.PARAMETERS,\n  DifferenceCardConfigCompareGroup.TAGS,\n  DifferenceCardConfigCompareGroup.ATTRIBUTES,\n];\n\nexport enum DifferenceCardAttributes {\n  USER = 'User',\n  SOURCE = 'Source',\n  VERSION = 'Version',\n  MODELS = 'Models',\n}\n\n// TODO: add configuration fields relevant to difference view chart\nexport class RunsChartsDifferenceCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType = RunsChartType.DIFFERENCE;\n  compareGroups: DifferenceCardConfigCompareGroup[] = [];\n  chartName = 'Runs difference view';\n  showChangeFromBaseline = true;\n  showDifferencesOnly = true;\n  baselineColumnUuid = '';\n}\n\nexport class RunsChartsImageCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType = RunsChartType.IMAGE;\n  // image keys to show\n  imageKeys: string[] = [];\n  step = 0;\n}\n","import { type Dictionary, compact, first, isUndefined, last, max, min, minBy, orderBy, values } from 'lodash';\nimport { MetricEntity, SampledMetricsByRunUuidState } from '../../../types';\nimport { SampledMetricsByRun } from '../hooks/useSampledMetricHistory';\n\n/**\n * This function consumes chart timestamp range and returns\n * corresponding step range for a given metric basing on a history.\n */\nexport const findChartStepsByTimestamp = (\n  // Currently fetched metric history\n  currentMetricHistory: {\n    [rangeKey: string]: {\n      loading?: boolean | undefined;\n      metricsHistory?: MetricEntity[] | undefined;\n    };\n  },\n  // Timestamp range - either textual (\"2022-10-23 10:00:00\") or numeric (milliseconds)\n  range: [string | number, string | number],\n  // If set to true, will return entire boundaries from history if timestamps are not found.\n  // Otherwise, will return undefined.\n  useDefaultIfNotFound = true,\n): [number, number] | undefined => {\n  // First, let's compile a history of all metric values from all ranges,\n  // then sort it by timestamp\n  const flatHistory = orderBy(\n    compact(\n      values(currentMetricHistory)\n        .map(({ metricsHistory }) => metricsHistory)\n        .flat(),\n    ),\n    'timestamp',\n  );\n\n  // If there's no sufficient entries, return nothing\n  if (flatHistory.length < 2) {\n    return undefined;\n  }\n\n  // We consume textual ranges produced by charts so we have\n  // to convert them to timestamps\n  const lowerBound = new Date(range[0]).valueOf();\n  const upperBound = new Date(range[1]).valueOf();\n\n  // First, try to find the lower entry using loop\n  let lowerEntry = useDefaultIfNotFound ? first(flatHistory) : undefined;\n\n  for (let index = 0; index < flatHistory.length; index++) {\n    const entry = flatHistory[index];\n    if (entry.timestamp > lowerBound) {\n      lowerEntry = flatHistory[index - 1] || entry;\n      break;\n    }\n  }\n\n  // Repeat for the upper entry\n  let upperEntry = useDefaultIfNotFound ? last(flatHistory) : undefined;\n\n  for (let index = flatHistory.length - 1; index >= 0; index--) {\n    const entry = flatHistory[index];\n    if (entry.timestamp < upperBound) {\n      upperEntry = flatHistory[index + 1] || entry;\n      break;\n    }\n  }\n\n  // If boundaries are not found, return nothing\n  if (isUndefined(lowerEntry) || isUndefined(upperEntry)) {\n    return undefined;\n  }\n\n  // Return found boundary entries\n  return [lowerEntry.step, upperEntry.step];\n};\n\n/**\n * Finds the chart steps by absolute timestamp for multiple runs.\n *\n * @param sampledMetrics - The sampled metrics by run UUID state.\n * @param runUuids - The array of run UUIDs.\n * @param metricKey - The metric key.\n * @param range - The range of timestamps.\n * @returns The lower and upper bounds of the chart steps, or undefined if not found.\n */\nexport const findChartStepsByTimestampForRuns = (\n  sampledMetrics: SampledMetricsByRunUuidState,\n  runUuids: string[],\n  metricKey: string,\n  range: [string | number, string | number],\n): [number, number] | undefined => {\n  const stepRangesPerRun = compact(\n    runUuids.map((runUuid) => {\n      const metricHistoryForRun = sampledMetrics[runUuid]?.[metricKey];\n      return metricHistoryForRun ? findChartStepsByTimestamp(metricHistoryForRun, range, false) : undefined;\n    }),\n  );\n  const lowerBound = min(stepRangesPerRun.map(([bound]) => bound));\n  const upperBound = max(stepRangesPerRun.map(([, bound]) => bound));\n\n  if (!isUndefined(lowerBound) && !isUndefined(upperBound)) {\n    return [lowerBound, upperBound];\n  }\n\n  return undefined;\n};\n\n/**\n * This function consumes chart relative time range and returns\n * corresponding step range for a given metric basing on a history.\n *\n * @param currentlyVisibleMetrics currentlyVisibleMetrics is a dictionary of currently rendered metric traces for run\n * @param runUuids a list of run UUIDs to process\n * @param relativeRange a relative time range in seconds\n * @returns a range of steps or undefined if no relevant are found\n */\nexport const findAbsoluteTimestampRangeForRelativeRange = (\n  currentlyVisibleMetrics: Dictionary<SampledMetricsByRun>,\n  runUuids: string[],\n  relativeRange: [number, number],\n  multiplier = 1000,\n): [number, number] | undefined => {\n  const stepRangesPerRun = compact(\n    runUuids.map((runUuid) => {\n      const runData = currentlyVisibleMetrics[runUuid];\n\n      if (!runData) {\n        return null;\n      }\n\n      // omit the \"runUuid\" key so we can conveniently access the metrics data\n      const { runUuid: _, ...runMetrics } = runData;\n\n      // concat all the metrics history for the run\n      const visibleMetricHistoryForRun = values(runMetrics).flatMap((metric) => metric.metricsHistory ?? []);\n\n      // Find the timestamp offset for the run. Should be equal to lowest timestamp value for each run.\n      const timestampOffset = minBy(visibleMetricHistoryForRun, 'timestamp')?.timestamp || 0;\n\n      // Convert relative time range to timestamp range. Relative range comes\n      // in seconds so we have to multiply it by 1000 to get milliseconds.\n      return [relativeRange[0] * multiplier + timestampOffset, relativeRange[1] * multiplier + timestampOffset] as [\n        number,\n        number,\n      ];\n    }),\n  );\n  const lowerBound = min(stepRangesPerRun.map(([bound]) => bound));\n  const upperBound = max(stepRangesPerRun.map(([, bound]) => bound));\n  if (!isUndefined(lowerBound) && !isUndefined(upperBound)) {\n    return [lowerBound, upperBound];\n  }\n\n  return undefined;\n};\n","import { useMemo } from 'react';\nimport type { RunGroupingAggregateFunction } from '../../experiment-page/utils/experimentPage.row-types';\nimport invariant from 'invariant';\nimport {\n  removeOutliersFromMetricHistory,\n  type RunsChartsRunData,\n} from '../../runs-charts/components/RunsCharts.common';\nimport {\n  createAggregatedMetricHistory,\n  createValueAggregatedMetricHistory,\n  type SyntheticMetricHistory,\n} from '../../experiment-page/utils/experimentPage.group-row-utils';\nimport { uniq, type Dictionary, compact, pick, isNil } from 'lodash';\nimport type { SampledMetricsByRun } from '../../runs-charts/hooks/useSampledMetricHistory';\nimport type { MetricHistoryByName } from '../../../types';\n\nexport interface UseGroupedChartRunDataParams {\n  ungroupedRunsData: RunsChartsRunData[];\n  enabled: boolean;\n  aggregateFunction?: RunGroupingAggregateFunction;\n  metricKeys: string[];\n  sampledDataResultsByRunUuid: Dictionary<SampledMetricsByRun>;\n  selectedXAxisMetricKey?: string;\n  ignoreOutliers: boolean;\n}\n\n/**\n * Returns a new array of RunsChartsRunData with aggregated metrics for grouped runs.\n * In order to make rendering of the confidence interval possible, the returned dataset contains\n * min, max and average values for each metric while respecting the metric history.\n */\nexport const useGroupedChartRunData = ({\n  ungroupedRunsData,\n  enabled,\n  aggregateFunction,\n  metricKeys,\n  sampledDataResultsByRunUuid,\n  selectedXAxisMetricKey,\n  ignoreOutliers,\n}: UseGroupedChartRunDataParams) => {\n  return useMemo(() => {\n    if (!enabled || !aggregateFunction) {\n      return ungroupedRunsData;\n    }\n\n    // Extract groups from the result set and calculate aggregated metrics\n    const perGroupData: RunsChartsRunData[] = ungroupedRunsData\n      .filter(({ groupParentInfo }) => groupParentInfo)\n      .map((group) => {\n        const aggregatedMetricsHistory: Record<string, SyntheticMetricHistory> = {};\n        metricKeys.forEach((metricKey) => {\n          invariant(group.groupParentInfo, 'groupParentInfo should be defined');\n\n          const aggregatedRunUuidsInGroup =\n            group.groupParentInfo.runUuidsForAggregation ?? group.groupParentInfo.runUuids;\n\n          let aggregatedMetricsHistoryForMetric;\n          if (!isNil(selectedXAxisMetricKey)) {\n            aggregatedMetricsHistoryForMetric = createValueAggregatedMetricHistory(\n              pick(sampledDataResultsByRunUuid, aggregatedRunUuidsInGroup),\n              metricKey,\n              selectedXAxisMetricKey,\n              ignoreOutliers,\n            );\n          } else {\n            const metricsHistoryInGroup = compact(\n              aggregatedRunUuidsInGroup.flatMap((runUuid) => {\n                const metricsHistory = sampledDataResultsByRunUuid[runUuid]?.[metricKey]?.metricsHistory;\n                if (ignoreOutliers) {\n                  return metricsHistory ? removeOutliersFromMetricHistory(metricsHistory) : undefined;\n                }\n                return metricsHistory;\n              }),\n            );\n\n            // Get all step numbers from all runs in the group\n            const steps = uniq(metricsHistoryInGroup.map((h) => h.step)).sort((a, b) => a - b);\n\n            aggregatedMetricsHistoryForMetric = createAggregatedMetricHistory(steps, metricKey, metricsHistoryInGroup);\n          }\n\n          aggregatedMetricsHistory[metricKey] = aggregatedMetricsHistoryForMetric;\n        });\n        const metricsHistory = metricKeys.reduce<MetricHistoryByName>((acc, key) => {\n          const history = aggregatedMetricsHistory[key][aggregateFunction];\n          if (history && history.length > 0) {\n            acc[key] = history;\n          }\n          return acc;\n        }, {});\n\n        return {\n          ...group,\n          metricsHistory,\n          aggregatedMetricsHistory,\n        };\n      });\n\n    const ungroupedRuns = ungroupedRunsData.filter(({ belongsToGroup }) => belongsToGroup === false);\n\n    return [...perGroupData, ...ungroupedRuns];\n  }, [\n    metricKeys,\n    sampledDataResultsByRunUuid,\n    ungroupedRunsData,\n    enabled,\n    aggregateFunction,\n    selectedXAxisMetricKey,\n    ignoreOutliers,\n  ]);\n};\n","import { type ModelTraceInfo } from '@databricks/web-shared/model-trace-explorer';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { MlflowService } from '../../../sdk/MlflowService';\nimport { EXPERIMENT_TRACES_SORTABLE_COLUMNS, getTraceInfoRunId } from '../TracesView.utils';\nimport { ViewType } from '../../../sdk/MlflowEnums';\nimport { first, uniq, values } from 'lodash';\nimport { RunEntity } from '../../../types';\n\n// A filter expression used to filter traces by run ID\nconst RUN_ID_FILTER_EXPRESSION = 'request_metadata.`mlflow.sourceRun`';\n\nconst createRunIdsFilterExpression = (runUuids: string[]) => {\n  const runIdsInQuotes = runUuids.map((runId: any) => `'${runId}'`);\n  return `run_id IN (${runIdsInQuotes.join(',')})`;\n};\n\n/**\n * Utility function that fetches run names for traces.\n */\nconst fetchRunNamesForTraces = async (experimentIds: string[], traces: ModelTraceInfo[]) => {\n  const traceIdToRunIdMap = traces.reduce<Record<string, string>>((acc, trace) => {\n    const traceId = trace.request_id;\n    const runId = getTraceInfoRunId(trace);\n    if (!traceId || !runId) {\n      return acc;\n    }\n    return { ...acc, [traceId]: runId };\n  }, {});\n\n  const runUuids = uniq(values(traceIdToRunIdMap));\n  if (runUuids.length < 1) {\n    return {};\n  }\n  const runResponse = (await MlflowService.searchRuns({\n    experiment_ids: experimentIds,\n    filter: createRunIdsFilterExpression(runUuids),\n    run_view_type: ViewType.ALL,\n  })) as { runs?: RunEntity[] };\n\n  const runs = runResponse.runs;\n\n  const runIdsToRunNames = (runs || []).reduce<Record<string, string>>((acc, run) => {\n    return { ...acc, [run.info.runUuid]: run.info.runName };\n  }, {});\n\n  const traceIdsToRunNames = traces.reduce<Record<string, string>>((acc, trace) => {\n    const traceId = trace.request_id;\n    if (!traceId) {\n      return acc;\n    }\n    const runId = traceIdToRunIdMap[traceId];\n\n    return { ...acc, [traceId]: runIdsToRunNames[runId] || runId };\n  }, {});\n\n  return traceIdsToRunNames;\n};\n\nexport interface ModelTraceInfoWithRunName extends ModelTraceInfo {\n  runName?: string;\n}\n\nexport const useExperimentTraces = (\n  experimentIds: string[],\n  sorting: {\n    id: string;\n    desc: boolean;\n  }[],\n  filter = '',\n  runUuid?: string,\n) => {\n  const [traces, setTraces] = useState<ModelTraceInfoWithRunName[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<Error | undefined>(undefined);\n\n  // Backend currently only supports ordering by timestamp\n  const orderByString = useMemo(() => {\n    const firstOrderByColumn = first(sorting);\n    if (firstOrderByColumn && EXPERIMENT_TRACES_SORTABLE_COLUMNS.includes(firstOrderByColumn.id)) {\n      return `${firstOrderByColumn.id} ${firstOrderByColumn.desc ? 'DESC' : 'ASC'}`;\n    }\n    return 'timestamp_ms DESC';\n  }, [sorting]);\n\n  const filterString = useMemo(() => {\n    if (!runUuid) {\n      return filter;\n    }\n\n    if (filter) {\n      return `${filter} AND ${RUN_ID_FILTER_EXPRESSION}='${runUuid}'`;\n    }\n\n    return `${RUN_ID_FILTER_EXPRESSION}='${runUuid}'`;\n  }, [filter, runUuid]);\n\n  const [pageTokens, setPageTokens] = useState<Record<string, string | undefined>>({ 0: undefined });\n  const [currentPage, setCurrentPage] = useState(0);\n  const currentPageToken = pageTokens[currentPage];\n\n  const fetchTraces = useCallback(\n    async ({\n      experimentIds,\n      currentPage = 0,\n      pageToken,\n      silent,\n      orderByString = '',\n      filterString = '',\n    }: {\n      experimentIds: string[];\n      currentPage?: number;\n      pageToken?: string;\n      filterString?: string;\n      orderByString?: string;\n      silent?: boolean;\n    }) => {\n      if (!silent) {\n        setLoading(true);\n      }\n      setError(undefined);\n\n      try {\n        const response = await MlflowService.getExperimentTraces(experimentIds, orderByString, pageToken, filterString);\n\n        if (!response.traces) {\n          setTraces([]);\n          return;\n        }\n\n        const runNamesForTraces = await fetchRunNamesForTraces(experimentIds, response.traces);\n        const tracesWithRunNames = response.traces.map((trace) => {\n          const traceId = trace.request_id;\n          if (!traceId) {\n            return { ...trace };\n          }\n          const runName = runNamesForTraces[traceId];\n          return { ...trace, runName };\n        });\n\n        setTraces(tracesWithRunNames);\n        setPageTokens((prevPages) => {\n          return { ...prevPages, [currentPage + 1]: response.next_page_token };\n        });\n      } catch (e: any) {\n        setError(e);\n      } finally {\n        setLoading(false);\n      }\n    },\n    [],\n  );\n\n  const hasNextPage = !loading && pageTokens[currentPage + 1] !== undefined;\n  const hasPreviousPage = !loading && (currentPage === 1 || pageTokens[currentPage - 1] !== undefined);\n\n  useEffect(() => {\n    fetchTraces({ experimentIds, filterString, orderByString });\n  }, [fetchTraces, filterString, experimentIds, orderByString]);\n\n  const reset = useCallback(() => {\n    setTraces([]);\n    setPageTokens({ 0: undefined });\n    setCurrentPage(0);\n    fetchTraces({ experimentIds });\n  }, [fetchTraces, experimentIds]);\n\n  const fetchNextPage = useCallback(() => {\n    setCurrentPage((prevPage) => prevPage + 1);\n    fetchTraces({\n      experimentIds,\n      currentPage: currentPage + 1,\n      pageToken: pageTokens[currentPage + 1],\n      filterString,\n      orderByString,\n    });\n  }, [experimentIds, currentPage, fetchTraces, pageTokens, filterString, orderByString]);\n\n  const fetchPrevPage = useCallback(() => {\n    setCurrentPage((prevPage) => prevPage - 1);\n    fetchTraces({\n      experimentIds,\n      currentPage: currentPage - 1,\n      pageToken: pageTokens[currentPage - 1],\n      filterString,\n      orderByString,\n    });\n  }, [experimentIds, currentPage, fetchTraces, pageTokens, filterString, orderByString]);\n\n  const refreshCurrentPage = useCallback(\n    (silent = false) => {\n      return fetchTraces({\n        experimentIds,\n        currentPage,\n        pageToken: currentPageToken,\n        silent,\n        filterString,\n        orderByString,\n      });\n    },\n    [experimentIds, currentPage, fetchTraces, currentPageToken, filterString, orderByString],\n  );\n\n  return {\n    traces,\n    loading,\n    error,\n    hasNextPage,\n    hasPreviousPage,\n    fetchNextPage,\n    fetchPrevPage,\n    refreshCurrentPage,\n    reset,\n  };\n};\n","import { Button, PencilIcon, SpeechBubblePlusIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { MLFLOW_INTERNAL_PREFIX } from '../../../common/utils/TagUtils';\nimport { KeyValueTag } from '../../../common/components/KeyValueTag';\n\nexport const TracesViewTableTagCell = ({\n  onAddEditTags,\n  tags,\n}: {\n  tags: { key: string; value: string }[];\n  onAddEditTags: () => void;\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const visibleTagList = tags?.filter(({ key }) => key && !key.startsWith(MLFLOW_INTERNAL_PREFIX)) || [];\n  const containsTags = visibleTagList.length > 0;\n  return (\n    <div\n      css={{\n        display: 'flex',\n        alignItems: 'flex-start',\n        flexWrap: 'wrap',\n        columnGap: theme.spacing.xs / 2,\n        rowGap: theme.spacing.xs / 2,\n      }}\n    >\n      {visibleTagList.map((tag) => (\n        <KeyValueTag\n          key={tag.key}\n          tag={tag}\n          css={{ marginRight: 0 }}\n          charLimit={20}\n          maxWidth={150}\n          enableFullViewModal\n        />\n      ))}{' '}\n      <Button\n        componentId=\"mlflow.experiment_page.traces_table.edit_tag\"\n        size=\"small\"\n        icon={!containsTags ? <SpeechBubblePlusIcon /> : <PencilIcon />}\n        onClick={onAddEditTags}\n      />\n    </div>\n  );\n};\n","import type { CellContext, ColumnDefTemplate } from '@tanstack/react-table';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { CheckCircleIcon, ClockIcon, XCircleIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { ExperimentViewTracesStatusLabels } from './TracesView.utils';\nimport { useIntl } from 'react-intl';\nimport type { Theme } from '@emotion/react';\n\nconst getIcon = (status: ModelTraceInfoWithRunName['status'], theme: Theme) => {\n  if (status === 'IN_PROGRESS') {\n    return <ClockIcon css={{ color: theme.colors.textValidationWarning }} />;\n  }\n\n  if (status === 'OK') {\n    return <CheckCircleIcon css={{ color: theme.colors.textValidationSuccess }} />;\n  }\n\n  if (status === 'ERROR') {\n    return <XCircleIcon css={{ color: theme.colors.textValidationDanger }} />;\n  }\n\n  return null;\n};\n\nexport const TracesViewTableStatusCell: ColumnDefTemplate<CellContext<ModelTraceInfoWithRunName, unknown>> = ({\n  row: { original },\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const intl = useIntl();\n\n  const labelDescriptor = ExperimentViewTracesStatusLabels[original.status || 'UNSET'];\n\n  return (\n    <div css={{ display: 'flex', gap: theme.spacing.xs, alignItems: 'center' }}>\n      {getIcon(original.status, theme)}\n      {labelDescriptor ? intl.formatMessage(labelDescriptor) : ''}\n    </div>\n  );\n};\n","import { Button, ChevronDownIcon, ChevronRightIcon, useDesignSystemTheme } from '@databricks/design-system';\nimport { isString } from 'lodash';\nimport { useCallback, useMemo, useState } from 'react';\nimport { MlflowService } from '../../sdk/MlflowService';\nimport Utils from '../../../common/utils/Utils';\nimport { ErrorWrapper } from '../../../common/utils/ErrorWrapper';\nimport type { CellContext, ColumnDefTemplate } from '@tanstack/react-table';\nimport type { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { getTraceInfoInputs, getTraceInfoOutputs, isTraceMetadataPossiblyTruncated } from './TracesView.utils';\n\nconst TracesViewTablePreviewCell = ({\n  value,\n  traceId,\n  previewFieldName,\n}: {\n  value: string;\n  traceId: string;\n  previewFieldName: 'request' | 'response';\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [fullData, setFullData] = useState<string | null>(null);\n\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const fetchFullData = useCallback(async () => {\n    setLoading(true);\n    try {\n      const response = await MlflowService.getExperimentTraceData<{\n        request?: any;\n        response?: any;\n      }>(traceId);\n\n      if (previewFieldName in response) {\n        const previewValue = response[previewFieldName];\n        const requestData = isString(previewValue) ? previewValue : JSON.stringify(previewValue);\n        setFullData(requestData);\n      }\n    } catch (e: any) {\n      const errorMessage = e instanceof ErrorWrapper ? e.getUserVisibleError() : e.message;\n      Utils.logErrorAndNotifyUser(`Error fetching response: ${errorMessage}`);\n    }\n    setLoading(false);\n  }, [previewFieldName, traceId]);\n\n  const expand = useCallback(async () => {\n    if (!fullData) {\n      await fetchFullData();\n    }\n    setIsExpanded(true);\n  }, [fullData, fetchFullData]);\n\n  const collapse = useCallback(() => {\n    setIsExpanded(false);\n  }, []);\n\n  const showExpander = isTraceMetadataPossiblyTruncated(value);\n\n  return (\n    <div css={{ display: 'flex', gap: theme.spacing.xs }}>\n      {showExpander && (\n        <Button\n          componentId=\"mlflow.experiment_page.traces_table.expand_cell_preview\"\n          size=\"small\"\n          icon={isExpanded ? <ChevronDownIcon /> : <ChevronRightIcon />}\n          onClick={isExpanded ? collapse : expand}\n          css={{ flexShrink: 0 }}\n          loading={loading}\n          type=\"primary\"\n        />\n      )}\n      <div\n        title={value}\n        css={{\n          overflow: 'hidden',\n          textOverflow: 'ellipsis',\n        }}\n      >\n        {isExpanded ? <ExpandedParamCell value={fullData ?? value} /> : value}\n      </div>\n    </div>\n  );\n};\n\nconst ExpandedParamCell = ({ value }: { value: string }) => {\n  const structuredJSONValue = useMemo(() => {\n    // Attempts to parse the value as JSON and returns a pretty printed version if successful.\n    // If JSON structure is not found, returns null.\n    try {\n      const objectData = JSON.parse(value);\n      return JSON.stringify(objectData, null, 2);\n    } catch (e) {\n      return null;\n    }\n  }, [value]);\n  return (\n    <div\n      css={{\n        whiteSpace: 'pre-wrap',\n        wordBreak: 'break-word',\n        fontFamily: structuredJSONValue ? 'monospace' : undefined,\n      }}\n    >\n      {structuredJSONValue || value}\n    </div>\n  );\n};\n\nexport const TracesViewTableRequestPreviewCell: ColumnDefTemplate<CellContext<ModelTraceInfoWithRunName, unknown>> = ({\n  row: { original },\n}) => (\n  <TracesViewTablePreviewCell\n    previewFieldName=\"request\"\n    traceId={original.request_id || ''}\n    value={getTraceInfoInputs(original) || ''}\n  />\n);\n\nexport const TracesViewTableResponsePreviewCell: ColumnDefTemplate<CellContext<ModelTraceInfoWithRunName, unknown>> = ({\n  row: { original },\n}) => (\n  <TracesViewTablePreviewCell\n    previewFieldName=\"response\"\n    traceId={original.request_id || ''}\n    value={getTraceInfoOutputs(original) || ''}\n  />\n);\n","import type { CellContext, ColumnDefTemplate } from '@tanstack/react-table';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { keyBy } from 'lodash';\nimport { SourceCellRenderer } from '../experiment-page/components/runs/cells/SourceCellRenderer';\n\nexport const TracesViewTableSourceCell: ColumnDefTemplate<CellContext<ModelTraceInfoWithRunName, unknown>> = ({\n  row: { original },\n}) => <SourceCellRenderer value={keyBy(original.tags, 'key')} />;\n","import { ColumnDef } from '@tanstack/react-table';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { Interpolation, Theme } from '@emotion/react';\n\nexport type TracesColumnDef = ColumnDef<ModelTraceInfoWithRunName> & {\n  meta?: {\n    styles?: Interpolation<Theme>;\n    multiline?: boolean;\n  };\n};\n\nexport const getHeaderSizeClassName = (id: string) => `--header-${id}-size`;\nexport const getColumnSizeClassName = (id: string) => `--col-${id}-size`;\n","import React from 'react';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { Row, flexRender } from '@tanstack/react-table';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { TracesColumnDef, getColumnSizeClassName } from './TracesViewTable.utils';\nimport { TRACE_TABLE_CHECKBOX_COLUMN_ID } from './TracesView.utils';\n\ntype TracesViewTableRowProps = {\n  row: Row<ModelTraceInfoWithRunName>;\n  // used only for memoization updates\n  selected: boolean;\n  columns: TracesColumnDef[];\n};\n\nexport const TracesViewTableRow = React.memo(\n  ({ row }: TracesViewTableRowProps) => {\n    const { theme } = useDesignSystemTheme();\n\n    return (\n      <div\n        role=\"row\"\n        key={row.id}\n        data-testid=\"endpoints-list-table-rows\"\n        css={{\n          minHeight: theme.general.buttonHeight,\n          display: 'flex',\n          flexDirection: 'row',\n          ':hover': {\n            backgroundColor: 'var(--table-row-hover)',\n          },\n        }}\n      >\n        {row.getAllCells().map((cell) => {\n          const multiline = (cell.column.columnDef as TracesColumnDef).meta?.multiline;\n          const isSelect = cell.column.id === TRACE_TABLE_CHECKBOX_COLUMN_ID;\n          const padding = isSelect ? theme.spacing.sm : `${theme.spacing.sm}px ${theme.spacing.xs}px`;\n\n          return (\n            <div\n              role=\"cell\"\n              css={[\n                {\n                  '--table-row-vertical-padding': `${theme.spacing.sm}px`,\n                  flex: `calc(var(${getColumnSizeClassName(cell.column.id)}) / 100)`,\n                  overflow: 'hidden',\n                  borderBottom: `1px solid var(--table-separator-color)`,\n                  whiteSpace: multiline ? 'pre-wrap' : 'nowrap',\n                  textOverflow: multiline ? 'ellipsis' : undefined,\n                  padding,\n                },\n                (cell.column.columnDef as TracesColumnDef).meta?.styles,\n              ]}\n              key={cell.id}\n            >\n              {flexRender(cell.column.columnDef.cell, cell.getContext())}\n            </div>\n          );\n        })}\n      </div>\n    );\n  },\n  (prev, next) => {\n    return prev.columns === next.columns && prev.selected === next.selected;\n  },\n);\n","import { CellContext, ColumnDefTemplate } from '@tanstack/react-table';\nimport React from 'react';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { LegacyTooltip } from '@databricks/design-system';\nimport Utils from '@mlflow/mlflow/src/common/utils/Utils';\n\nexport const TracesViewTableTimestampCell: ColumnDefTemplate<CellContext<ModelTraceInfoWithRunName, unknown>> =\n  React.memo(\n    ({ row: { original } }) => {\n      if (!original.timestamp_ms) {\n        return null;\n      }\n      return (\n        <LegacyTooltip\n          title={new Date(original.timestamp_ms).toLocaleString(navigator.language, {\n            timeZoneName: 'short',\n          })}\n          placement=\"right\"\n        >\n          <span>{Utils.timeSinceStr(original.timestamp_ms)}</span>\n        </LegacyTooltip>\n      );\n    },\n    () => true,\n  );\n","import React from 'react';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { Table } from '@tanstack/react-table';\nimport { Checkbox } from '@databricks/design-system';\n\ntype TracesViewTableCheckboxProps = {\n  table: Table<ModelTraceInfoWithRunName>;\n};\n\nexport const TracesViewTableHeaderCheckbox = ({ table }: TracesViewTableCheckboxProps) => {\n  const isChecked = table.getIsAllRowsSelected() || (table.getIsSomeRowsSelected() ? null : false);\n\n  return (\n    <Checkbox\n      data-testid=\"trace-table-header-checkbox\"\n      isChecked={isChecked}\n      wrapperStyle={{ padding: 0, margin: 0 }}\n      onChange={table.toggleAllRowsSelected}\n    />\n  );\n};\n","import React from 'react';\nimport { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { Row } from '@tanstack/react-table';\nimport { Checkbox } from '@databricks/design-system';\n\ntype TracesViewCellCheckboxProps = {\n  row: Row<ModelTraceInfoWithRunName>;\n};\n\nexport const TracesViewTableCellCheckbox = ({ row }: TracesViewCellCheckboxProps) => {\n  return (\n    <Checkbox\n      data-testid={`trace-table-cell-checkbox-${row.id}`}\n      disabled={!row.getCanSelect()}\n      isChecked={row.getIsSelected()}\n      wrapperStyle={{ padding: 0, margin: 0 }}\n      onChange={() => row.toggleSelected()}\n    />\n  );\n};\n","import {\n  CursorPagination,\n  DangerIcon,\n  Empty,\n  Table,\n  TableHeader,\n  TableRow,\n  TableSkeletonRows,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { SortingState, flexRender, getCoreRowModel, getSortedRowModel, useReactTable } from '@tanstack/react-table';\nimport React, { useMemo } from 'react';\nimport { isNil } from 'lodash';\nimport Utils from '../../../common/utils/Utils';\nimport { Link } from '../../../common/utils/RoutingUtils';\nimport { ErrorWrapper } from '../../../common/utils/ErrorWrapper';\nimport Routes from '../../routes';\nimport {\n  ExperimentViewTracesTableColumnLabels,\n  ExperimentViewTracesTableColumns,\n  TRACE_TABLE_CHECKBOX_COLUMN_ID,\n  TRACE_TAG_NAME_TRACE_NAME,\n  getTraceInfoRunId,\n  getTraceInfoTotalTokens,\n  getTraceTagValue,\n} from './TracesView.utils';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { type ModelTraceInfo } from '@databricks/web-shared/model-trace-explorer';\nimport { TracesViewTableTagCell } from './TracesViewTableTagCell';\nimport type { ModelTraceInfoWithRunName } from './hooks/useExperimentTraces';\nimport { TracesViewTableStatusCell } from './TracesViewTableStatusCell';\nimport { TracesViewTableRequestPreviewCell, TracesViewTableResponsePreviewCell } from './TracesViewTablePreviewCell';\nimport { TracesViewTableSourceCell } from './TracesViewTableSourceCell';\nimport { TracesColumnDef, getColumnSizeClassName, getHeaderSizeClassName } from './TracesViewTable.utils';\nimport { TracesViewTableRow } from './TracesViewTableRow';\nimport { TracesViewTableTimestampCell } from './TracesViewTableTimestampCell';\nimport { TracesViewTableHeaderCheckbox } from './TracesViewTableHeaderCheckbox';\nimport { TracesViewTableCellCheckbox } from './TracesViewTableCellCheckbox';\n\nexport interface TracesViewTableProps {\n  traces: ModelTraceInfoWithRunName[];\n  onTraceClicked?: (trace: ModelTraceInfo) => void;\n  onTraceTagsEdit?: (trace: ModelTraceInfo) => void;\n  onTagsUpdated?: () => void;\n  loading: boolean;\n  error?: Error;\n  usingFilters?: boolean;\n  hasNextPage: boolean;\n  hasPreviousPage: boolean;\n  onNextPage: () => void;\n  onPreviousPage: () => void;\n  onResetFilters: () => void;\n  sorting: SortingState;\n  setSorting: React.Dispatch<React.SetStateAction<SortingState>>;\n  rowSelection: { [id: string]: boolean };\n  setRowSelection: React.Dispatch<React.SetStateAction<{ [id: string]: boolean }>>;\n  hiddenColumns?: string[];\n  disableTokenColumn?: boolean;\n}\n\nexport const TracesViewTable = React.memo(\n  ({\n    traces,\n    loading,\n    error,\n    onTraceClicked,\n    onTraceTagsEdit,\n    hasNextPage,\n    hasPreviousPage,\n    onNextPage,\n    onPreviousPage,\n    usingFilters,\n    onResetFilters,\n    sorting,\n    setSorting,\n    rowSelection,\n    setRowSelection,\n    hiddenColumns = [],\n    disableTokenColumn,\n  }: TracesViewTableProps) => {\n    const intl = useIntl();\n\n    const columns = useMemo<TracesColumnDef[]>(() => {\n      const columns: TracesColumnDef[] = [\n        {\n          id: TRACE_TABLE_CHECKBOX_COLUMN_ID,\n          header: TracesViewTableHeaderCheckbox,\n          enableResizing: false,\n          enableSorting: false,\n          cell: TracesViewTableCellCheckbox,\n          meta: { styles: { minWidth: 32, maxWidth: 32 } },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.requestId]),\n          enableSorting: false,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.requestId,\n          cell({ row: { original } }) {\n            return (\n              <Typography.Link\n                ellipsis\n                css={{ maxWidth: '100%', textOverflow: 'ellipsis' }}\n                onClick={() => {\n                  onTraceClicked?.(original);\n                }}\n              >\n                {original.request_id}\n              </Typography.Link>\n            );\n          },\n          meta: { styles: { minWidth: 200 } },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.traceName]),\n          enableSorting: false,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.traceName,\n          cell({ row: { original } }) {\n            return (\n              <Typography.Link\n                ellipsis\n                css={{ maxWidth: '100%', textOverflow: 'ellipsis' }}\n                onClick={() => {\n                  onTraceClicked?.(original);\n                }}\n              >\n                {getTraceTagValue(original, TRACE_TAG_NAME_TRACE_NAME)}\n              </Typography.Link>\n            );\n          },\n          meta: { styles: { minWidth: 150 } },\n        },\n        {\n          header: intl.formatMessage(\n            ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.timestampMs],\n          ),\n          id: ExperimentViewTracesTableColumns.timestampMs,\n          accessorFn: (data) => data.timestamp_ms,\n          enableSorting: true,\n          enableResizing: false,\n          cell: TracesViewTableTimestampCell,\n          meta: { styles: { minWidth: 140, maxWidth: 140 } },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.status]),\n          id: ExperimentViewTracesTableColumns.status,\n          enableSorting: false,\n          enableResizing: false,\n          cell: TracesViewTableStatusCell,\n          meta: { styles: { minWidth: 110, maxWidth: 110 } },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.inputs]),\n          id: ExperimentViewTracesTableColumns.inputs,\n          enableSorting: false,\n          enableResizing: true,\n          cell: TracesViewTableRequestPreviewCell,\n          meta: { multiline: true },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.outputs]),\n          enableSorting: false,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.outputs,\n          cell: TracesViewTableResponsePreviewCell,\n          meta: { multiline: true },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.runName]),\n          enableSorting: false,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.runName,\n          cell({ row: { original } }) {\n            const runId = getTraceInfoRunId(original);\n            if (!runId || !original.experiment_id) {\n              return null;\n            }\n            const label = original.runName || runId;\n            return (\n              <Link\n                css={{\n                  maxWidth: '100%',\n                  textOverflow: 'ellipsis',\n                  display: 'inline-block',\n                  overflow: 'hidden',\n                }}\n                to={Routes.getRunPageRoute(original.experiment_id, runId)}\n              >\n                {label}\n              </Link>\n            );\n          },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.source]),\n          enableSorting: true,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.source,\n          cell: TracesViewTableSourceCell,\n          meta: { styles: { minWidth: 100 } },\n        },\n      ];\n\n      if (!disableTokenColumn) {\n        columns.push({\n          header: intl.formatMessage(\n            ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.totalTokens],\n          ),\n          enableSorting: false,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.totalTokens,\n          accessorFn: (data) => getTraceInfoTotalTokens(data),\n          meta: { styles: { minWidth: 80, maxWidth: 80 } },\n        });\n      }\n      columns.push(\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.latency]),\n          enableSorting: false,\n          enableResizing: false,\n          id: ExperimentViewTracesTableColumns.latency,\n          accessorFn: (data) => {\n            if (isNil(data.execution_time_ms) || !isFinite(data.execution_time_ms)) {\n              return null;\n            }\n            return Utils.formatDuration(data.execution_time_ms);\n          },\n          meta: { styles: { width: 120 } },\n        },\n        {\n          header: intl.formatMessage(ExperimentViewTracesTableColumnLabels[ExperimentViewTracesTableColumns.tags]),\n          enableSorting: false,\n          enableResizing: true,\n          id: ExperimentViewTracesTableColumns.tags,\n          cell({ row: { original } }) {\n            return (\n              <TracesViewTableTagCell tags={original.tags || []} onAddEditTags={() => onTraceTagsEdit?.(original)} />\n            );\n          },\n        },\n      );\n\n      return columns.filter((column) => column.id && !hiddenColumns.includes(column.id));\n    }, [intl, onTraceClicked, onTraceTagsEdit, disableTokenColumn, hiddenColumns]);\n\n    const table = useReactTable<ModelTraceInfoWithRunName>({\n      columns,\n      data: traces,\n      state: { sorting, rowSelection },\n      getCoreRowModel: getCoreRowModel(),\n      getRowId: (row, index) => row.request_id || index.toString(),\n      getSortedRowModel: getSortedRowModel(),\n      onSortingChange: setSorting,\n      onRowSelectionChange: setRowSelection,\n      enableColumnResizing: true,\n      enableRowSelection: true,\n      columnResizeMode: 'onChange',\n    });\n\n    const getEmptyState = () => {\n      if (error) {\n        const errorMessage = error instanceof ErrorWrapper ? error.getMessageField() : error.message;\n        return (\n          <Empty\n            image={<DangerIcon />}\n            description={errorMessage}\n            title={\n              <FormattedMessage\n                defaultMessage=\"Error\"\n                description=\"Experiment page > traces table > error state title\"\n              />\n            }\n          />\n        );\n      }\n      if (!loading && traces.length === 0 && usingFilters) {\n        return (\n          <Empty\n            description={\n              <FormattedMessage\n                defaultMessage=\"No traces found with the current filter query. <button>Reset filters</button> to see all traces.\"\n                description=\"Experiment page > traces table > no traces recorded\"\n                values={{\n                  button: (chunks: any) => <Typography.Link onClick={onResetFilters}>{chunks}</Typography.Link>,\n                }}\n              />\n            }\n            title={\n              <FormattedMessage\n                defaultMessage=\"No traces found\"\n                description=\"Experiment page > traces table > no traces recorded\"\n              />\n            }\n          />\n        );\n      }\n      if (!loading && traces.length === 0) {\n        return (\n          <Empty\n            description={null}\n            title={\n              <FormattedMessage\n                defaultMessage=\"No traces recorded\"\n                description=\"Experiment page > traces table > no traces recorded\"\n              />\n            }\n          />\n        );\n      }\n      return null;\n    };\n\n    // to improve performance, we pass the column sizes as inline styles to the table\n    const columnSizeInfo = table.getState().columnSizingInfo;\n    const columnSizeVars = React.useMemo(() => {\n      const headers = table.getFlatHeaders();\n      const colSizes: { [key: string]: number } = {};\n      headers.forEach((header) => {\n        colSizes[getHeaderSizeClassName(header.id)] = header.getSize();\n        colSizes[getColumnSizeClassName(header.column.id)] = header.column.getSize();\n      });\n      return colSizes;\n      // we need to recompute this whenever columns get resized or changed\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [columnSizeInfo, columns, table]);\n\n    return (\n      <Table\n        scrollable\n        empty={getEmptyState()}\n        style={columnSizeVars}\n        pagination={\n          <CursorPagination\n            hasNextPage={hasNextPage}\n            hasPreviousPage={hasPreviousPage}\n            onNextPage={onNextPage}\n            onPreviousPage={onPreviousPage}\n          />\n        }\n      >\n        <TableRow isHeader>\n          {table.getLeafHeaders().map((header) => {\n            return (\n              <TableHeader\n                key={header.id}\n                css={(header.column.columnDef as TracesColumnDef).meta?.styles}\n                sortable={header.column.getCanSort()}\n                sortDirection={header.column.getIsSorted() || 'none'}\n                onToggleSort={header.column.getToggleSortingHandler()}\n                resizable={header.column.getCanResize()}\n                resizeHandler={header.getResizeHandler()}\n                isResizing={header.column.getIsResizing()}\n                style={{\n                  flex: `calc(var(${getHeaderSizeClassName(header.id)}) / 100)`,\n                }}\n              >\n                {flexRender(header.column.columnDef.header, header.getContext())}\n              </TableHeader>\n            );\n          })}\n        </TableRow>\n        {loading && <TableSkeletonRows table={table} />}\n        {!loading &&\n          !error &&\n          table\n            .getRowModel()\n            .rows.map((row) => (\n              <TracesViewTableRow key={row.id} row={row} columns={columns} selected={rowSelection[row.id]} />\n            ))}\n      </Table>\n    );\n  },\n);\n","import { useCallback, useEffect, useState } from 'react';\nimport { MlflowService } from '../../../sdk/MlflowService';\nimport { ModelTraceStatus, type ModelTraceData } from '@databricks/web-shared/model-trace-explorer';\nimport Utils from '../../../../common/utils/Utils';\n\nexport const useExperimentTraceData = (traceId?: string, skip = false) => {\n  const [traceData, setTraceData] = useState<ModelTraceData | undefined>(undefined);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<Error | undefined>(undefined);\n\n  const fetchTraceData = useCallback(async (traceId: string) => {\n    setLoading(true);\n    try {\n      const response = await MlflowService.getExperimentTraceData(traceId);\n\n      if (Array.isArray(response.spans)) {\n        setTraceData(response);\n      } else {\n        // Not a showstopper, but we should log this error and notify the user.\n        Utils.logErrorAndNotifyUser('Invalid trace data response: ' + JSON.stringify(response?.toString()));\n      }\n    } catch (e: any) {\n      setError(e);\n    }\n    setLoading(false);\n  }, []);\n\n  useEffect(() => {\n    if (traceId && !skip) {\n      fetchTraceData(traceId);\n    }\n  }, [fetchTraceData, traceId, skip]);\n\n  return { traceData, loading, error };\n};\n","import React, { useEffect, useRef } from 'react';\n\nimport {\n  ModelTraceChildToParentFrameMessage,\n  ModelTraceParentToChildFrameMessage,\n} from '@databricks/web-shared/model-trace-explorer';\nimport type { ModelTrace, ModelTraceChildToParentFrameMessageType } from '@databricks/web-shared/model-trace-explorer';\nimport { TableSkeleton, TitleSkeleton } from '@databricks/design-system';\n\nexport const ModelTraceExplorerFrameRenderer = ({\n  modelTrace,\n  height = 700,\n  useLatestVersion = false,\n}: {\n  modelTrace: ModelTrace;\n  height?: number | string;\n  useLatestVersion?: boolean;\n}) => {\n  const iframeRef = useRef<HTMLIFrameElement>(null);\n  const [isLoading, setIsLoading] = React.useState(true);\n\n  useEffect(() => {\n    const handleMessage = (event: MessageEvent<ModelTraceChildToParentFrameMessageType>) => {\n      // only handle messages from the child iframe\n      const iframeWindow = iframeRef.current?.contentWindow;\n      if (!iframeWindow || event.source !== iframeWindow) {\n        return;\n      }\n\n      switch (event.data.type) {\n        case ModelTraceChildToParentFrameMessage.Ready: {\n          setIsLoading(false);\n          break;\n        }\n        default:\n          break;\n      }\n    };\n\n    window.addEventListener('message', handleMessage);\n    return () => {\n      window.removeEventListener('message', handleMessage);\n    };\n  }, [modelTrace]);\n\n  useEffect(() => {\n    const iframeWindow = iframeRef.current?.contentWindow;\n    if (!iframeWindow || isLoading) {\n      return;\n    }\n\n    iframeWindow.postMessage({\n      type: ModelTraceParentToChildFrameMessage.UpdateTrace,\n      traceData: modelTrace,\n    });\n  }, [modelTrace, isLoading]);\n\n  return (\n    <div css={{ height }}>\n      {isLoading && (\n        <div\n          css={{\n            position: 'absolute',\n            width: '100%',\n            height,\n          }}\n        >\n          <TitleSkeleton />\n          <TableSkeleton lines={5} />\n        </div>\n      )}\n      <iframe\n        title=\"Model Trace Explorer\"\n        src=\"static-files/lib/ml-model-trace-renderer/index.html\"\n        ref={iframeRef}\n        css={{\n          border: 'none',\n          width: '100%',\n          height,\n        }}\n      />\n    </div>\n  );\n};\n","export { ModelTraceExplorerFrameRenderer } from './ModelTraceExplorerFrameRenderer';\n\nexport enum ModelSpanType {\n  LLM = 'LLM',\n  CHAIN = 'CHAIN',\n  AGENT = 'AGENT',\n  TOOL = 'TOOL',\n  CHAT_MODEL = 'CHAT_MODEL',\n  RETRIEVER = 'RETRIEVER',\n  PARSER = 'PARSER',\n  EMBEDDING = 'EMBEDDING',\n  RERANKER = 'RERANKER',\n  UNKNOWN = 'UNKNOWN',\n}\n\nexport enum ModelIconType {\n  MODELS = 'models',\n  DOCUMENT = 'document',\n  CONNECT = 'connect',\n}\n\n/**\n * Represents a single model trace span.\n * Based on https://github.com/mlflow/mlflow/blob/tracing/mlflow/entities/span.py\n */\nexport type ModelTraceSpan = {\n  context: {\n    span_id: string;\n    trace_id: string;\n  };\n  name: string;\n  /* deprecated, renamed to `parent_id` */\n  parent_span_id?: string | null;\n  parent_id?: string | null;\n  /* deprecated, contained in attributes['mlflow.spanType'] */\n  span_type?: ModelSpanType | string;\n  /* deprecated, migrated to `status_code` and `status_message` */\n  status?: ModelTraceStatus;\n  status_code?: string;\n  status_message?: string | null;\n  start_time: number;\n  end_time: number;\n  /* deprecated, contained in attributes['mlflow.spanInputs'] */\n  inputs?: any;\n  /* deprecated, contained in attributes['mlflow.spanOutputs'] */\n  outputs?: any;\n  attributes?: Record<string, any>;\n  events?: ModelTraceEvent[];\n};\n\nexport type ModelTraceEvent = {\n  name: string;\n  timestamp?: number;\n  attributes?: Record<string, any>;\n};\n\nexport type ModelTraceData = {\n  spans: ModelTraceSpan[];\n};\n\n/**\n * Represents a single model trace object.\n * Based on https://github.com/mlflow/mlflow/blob/8e44d102e9568d09d9dc376136d13a5a5d1ab46f/mlflow/tracing/types/model.py#L11\n */\nexport type ModelTrace = {\n  /* deprecated, renamed to `data` */\n  trace_data?: ModelTraceData;\n  /* deprecated, renamed to `info` */\n  trace_info?: ModelTraceInfo;\n  data: ModelTraceData;\n  info: ModelTraceInfo;\n};\n\nexport type ModelTraceInfo = {\n  request_id?: string;\n  experiment_id?: string;\n  timestamp_ms?: number;\n  execution_time_ms?: number;\n  status?: ModelTraceStatus['description'];\n  attributes?: Record<string, any>;\n  request_metadata?: { key: string; value: string }[];\n  tags?: { key: string; value: string }[];\n};\n\nexport type ModelTraceStatusUnset = {\n  description: 'UNSET';\n  status_code: 0;\n};\n\nexport type ModelTraceStatusOk = {\n  description: 'OK';\n  status_code: 1;\n};\n\nexport type ModelTraceStatusError = {\n  description: 'ERROR';\n  status_code: 2;\n};\n\nexport type ModelTraceStatusInProgress = {\n  description: 'IN_PROGRESS';\n  status_code: 3;\n};\n\nexport enum ModelTraceSpanType {\n  LLM = 'LLM',\n  CHAIN = 'CHAIN',\n  AGENT = 'AGENT',\n  TOOL = 'TOOL',\n  CHAT_MODEL = 'CHAT_MODEL',\n  RETRIEVER = 'RETRIEVER',\n  PARSER = 'PARSER',\n  EMBEDDING = 'EMBEDDING',\n  RERANKER = 'RERANKER',\n  UNKNOWN = 'UNKNOWN',\n}\n\nexport type ModelTraceStatus =\n  | ModelTraceStatusUnset\n  | ModelTraceStatusOk\n  | ModelTraceStatusError\n  | ModelTraceStatusInProgress;\n\nexport enum ModelTraceChildToParentFrameMessage {\n  Ready = 'READY',\n}\n\ntype ModelTraceFrameReadyMessage = {\n  type: ModelTraceChildToParentFrameMessage.Ready;\n};\n\nexport enum ModelTraceParentToChildFrameMessage {\n  UpdateTrace = 'UPDATE_TRACE',\n}\n\ntype ModelTraceFrameUpdateTraceMessage = {\n  type: ModelTraceParentToChildFrameMessage.UpdateTrace;\n  traceData: ModelTrace;\n};\n\nexport type ModelTraceChildToParentFrameMessageType = ModelTraceFrameReadyMessage;\nexport type ModelTraceParentToChildFrameMessageType = ModelTraceFrameUpdateTraceMessage;\n","import { type ModelTraceInfo } from '@databricks/web-shared/model-trace-explorer';\nimport { useCallback, useEffect, useState } from 'react';\nimport { MlflowService } from '../../../sdk/MlflowService';\n\n/**\n * Fetches single trace info object for a given trace request ID.\n */\nexport const useExperimentTraceInfo = (requestId: string, enabled = true) => {\n  const [traceInfo, setTraceInfoData] = useState<ModelTraceInfo | undefined>(undefined);\n  const [loading, setLoading] = useState<boolean>(enabled);\n  const [error, setError] = useState<Error | undefined>(undefined);\n\n  const fetchTraceInfo = useCallback(async () => {\n    if (!enabled) {\n      return;\n    }\n    setError(undefined);\n\n    try {\n      const response = await MlflowService.getExperimentTraceInfo(requestId);\n\n      if (!response.trace_info) {\n        setTraceInfoData(undefined);\n        return;\n      }\n\n      setTraceInfoData(response.trace_info);\n    } catch (e: any) {\n      setError(e);\n    } finally {\n      setLoading(false);\n    }\n  }, [enabled, requestId]);\n\n  useEffect(() => {\n    fetchTraceInfo();\n  }, [fetchTraceInfo]);\n\n  return {\n    traceInfo,\n    loading,\n    error,\n  };\n};\n","import {\n  DangerIcon,\n  Drawer,\n  Empty,\n  Spacer,\n  TableSkeleton,\n  TitleSkeleton,\n  WarningIcon,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { getTraceDisplayName } from './TracesView.utils';\nimport { useExperimentTraceData } from './hooks/useExperimentTraceData';\nimport {\n  type ModelTrace,\n  ModelTraceInfo,\n  ModelTraceExplorerFrameRenderer,\n} from '@databricks/web-shared/model-trace-explorer';\nimport { useMemo } from 'react';\nimport { ErrorWrapper } from '../../../common/utils/ErrorWrapper';\nimport { FormattedMessage } from 'react-intl';\nimport { useExperimentTraceInfo } from './hooks/useExperimentTraceInfo';\n\nexport const TraceDataDrawer = ({\n  requestId,\n  traceInfo,\n  loadingTraceInfo,\n  onClose,\n}: {\n  requestId: string;\n  traceInfo?: ModelTraceInfo;\n  loadingTraceInfo?: boolean;\n  onClose: () => void;\n}) => {\n  const {\n    traceData,\n    loading: loadingTraceData,\n    error,\n  } = useExperimentTraceData(\n    requestId,\n    // skip fetching trace data if trace is in progress\n    traceInfo?.status === 'IN_PROGRESS',\n  );\n  const { theme } = useDesignSystemTheme();\n\n  // Usually, we rely on the parent component to provide trace info object (when clicked in a table row).\n  // But in some cases it's not available (e.g. when deep linking to a trace when the entity is not on the same page)\n  // and then we fetch it independently here.\n  const shouldFetchTraceInfo = !loadingTraceInfo && !traceInfo;\n\n  const { traceInfo: internalTraceInfo, loading: loadingInternalTracingInfo } = useExperimentTraceInfo(\n    requestId,\n    shouldFetchTraceInfo,\n  );\n\n  const traceInfoToUse = traceInfo || internalTraceInfo;\n\n  const title = useMemo(() => {\n    if (loadingTraceInfo || loadingInternalTracingInfo) {\n      return <TitleSkeleton />;\n    }\n    if (traceInfoToUse) {\n      return getTraceDisplayName(traceInfoToUse);\n    }\n    return requestId;\n  }, [traceInfoToUse, loadingTraceInfo, loadingInternalTracingInfo, requestId]);\n\n  // Construct the model trace object with the trace info and trace data\n  const combinedModelTrace = useMemo(\n    () =>\n      traceData\n        ? {\n            // We're assigning values redunantly due to a name change in the upstream interface,\n            // will be cleaned up shortly\n            trace_info: traceInfoToUse || {},\n            info: traceInfoToUse || {},\n            trace_data: traceData,\n            data: traceData,\n          }\n        : undefined,\n    [traceData, traceInfoToUse],\n  );\n\n  const containsSpans = (traceData?.spans || []).length > 0;\n\n  const renderContent = () => {\n    if (loadingTraceData || loadingTraceInfo || loadingInternalTracingInfo) {\n      return (\n        <>\n          <TitleSkeleton />\n          <TableSkeleton lines={5} />\n        </>\n      );\n    }\n    if (traceInfo?.status === 'IN_PROGRESS') {\n      return (\n        <>\n          <Spacer size=\"lg\" />\n          <Empty\n            image={<WarningIcon />}\n            description={\n              <FormattedMessage\n                defaultMessage=\"Trace data is not available for in-progress traces. Please wait for the trace to complete.\"\n                description=\"Experiment page > traces data drawer > in-progress description\"\n              />\n            }\n            title={\n              <FormattedMessage\n                defaultMessage=\"Trace data not available\"\n                description=\"Experiment page > traces data drawer > in-progress title\"\n              />\n            }\n          />\n        </>\n      );\n    }\n    if (error) {\n      return (\n        <>\n          <Spacer size=\"lg\" />\n          <Empty\n            image={<WarningIcon />}\n            description={\n              <FormattedMessage\n                defaultMessage=\"Trace data is not available for in-progress traces. Please wait for the trace to complete.\"\n                description=\"Experiment page > traces data drawer > in-progress description\"\n              />\n            }\n            title={\n              <FormattedMessage\n                defaultMessage=\"Trace data not available\"\n                description=\"Experiment page > traces data drawer > in-progress title\"\n              />\n            }\n          />\n        </>\n      );\n    }\n    if (!containsSpans) {\n      return (\n        <>\n          <Spacer size=\"lg\" />\n          <Empty\n            description={null}\n            title={\n              <FormattedMessage\n                defaultMessage=\"No trace data recorded\"\n                description=\"Experiment page > traces data drawer > no trace data recorded empty state\"\n              />\n            }\n          />\n        </>\n      );\n    }\n    if (combinedModelTrace) {\n      return (\n        <div\n          css={{\n            height: `calc(100% - ${theme.spacing.lg}px)`,\n            marginLeft: -theme.spacing.lg,\n            marginRight: -theme.spacing.lg,\n          }}\n          onWheel={(e) => e.stopPropagation()}\n        >\n          <ModelTraceExplorerFrameRenderer modelTrace={combinedModelTrace as ModelTrace} height=\"100%\" />\n        </div>\n      );\n    }\n    return null;\n  };\n\n  return (\n    <Drawer.Root\n      modal\n      open\n      onOpenChange={(open) => {\n        if (!open) {\n          onClose();\n        }\n      }}\n    >\n      <Drawer.Content width=\"85vw\" title={title} expandContentToFullHeight>\n        {renderContent()}\n      </Drawer.Content>\n    </Drawer.Root>\n  );\n};\n","import Utils from '@mlflow/mlflow/src/common/utils/Utils';\nimport { keys, pickBy } from 'lodash';\nimport React, { useState } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { MlflowService } from '../../sdk/MlflowService';\nimport { Modal, Typography } from '@databricks/design-system';\nimport { useParams } from '@mlflow/mlflow/src/common/utils/RoutingUtils';\n\nexport const TracesViewDeleteTraceModal = ({\n  experimentIds,\n  visible,\n  rowSelection,\n  setRowSelection,\n  handleClose,\n  refreshTraces,\n}: {\n  experimentIds: string[];\n  visible: boolean;\n  rowSelection: { [id: string]: boolean };\n  setRowSelection: (rowSelection: { [id: string]: boolean }) => void;\n  handleClose: () => void;\n  refreshTraces: () => void;\n}) => {\n  const intl = useIntl();\n  const [errorMessage, setErrorMessage] = useState<string>('');\n  const [isLoading, setIsLoading] = useState(false);\n  const tracesToDelete = keys(pickBy(rowSelection, (value) => value));\n\n  const submitDeleteTraces = async () => {\n    try {\n      // TODO: Add support for deleting traces from multiple experiments\n      // The trace data contains the experiment ID, so we simply need to\n      // pass the trace data instead of just the trace IDs.\n      await MlflowService.deleteTraces(experimentIds[0] ?? '', tracesToDelete);\n\n      // reset row selection and refresh traces\n      setRowSelection({});\n      refreshTraces();\n      handleClose();\n    } catch (e: any) {\n      setErrorMessage(\n        intl.formatMessage({\n          defaultMessage: 'An error occured while attempting to delete traces. Please refresh the page and try again.',\n          description: 'Experiment page > traces view controls > Delete traces modal > Error message',\n        }),\n      );\n    }\n    setIsLoading(false);\n  };\n\n  const handleOk = () => {\n    submitDeleteTraces();\n    setIsLoading(true);\n  };\n\n  return (\n    <Modal\n      title={\n        <FormattedMessage\n          defaultMessage=\"{count, plural, one {Delete Trace} other {Delete Traces}}\"\n          description=\"Experiment page > traces view controls > Delete traces modal > Title\"\n          values={{ count: tracesToDelete.length }}\n        />\n      }\n      visible={visible}\n      onCancel={handleClose}\n      okText={\n        <FormattedMessage\n          defaultMessage=\"Delete {count, plural, one { # trace } other { # traces }}\"\n          description=\"Experiment page > traces view controls > Delete traces modal > Delete button\"\n          values={{ count: tracesToDelete.length }}\n        />\n      }\n      onOk={handleOk}\n      okButtonProps={{ loading: isLoading, danger: true }}\n    >\n      {errorMessage && <Typography.Paragraph color=\"error\">{errorMessage}</Typography.Paragraph>}\n      <Typography.Paragraph>\n        <Typography.Text bold>\n          <FormattedMessage\n            defaultMessage=\"{count, plural, one { # trace } other { # traces }} will be deleted.\"\n            description=\"Experiment page > traces view controls > Delete traces modal > Confirmation message title\"\n            values={{\n              count: tracesToDelete.length,\n            }}\n          />\n        </Typography.Text>\n      </Typography.Paragraph>\n      <Typography.Paragraph>\n        <FormattedMessage\n          defaultMessage=\"Deleted traces cannot be restored. Are you sure you want to proceed?\"\n          description=\"Experiment page > traces view controls > Delete traces modal > Confirmation message\"\n        />\n      </Typography.Paragraph>\n    </Modal>\n  );\n};\n","import { Button, useDesignSystemTheme } from '@databricks/design-system';\nimport React, { useCallback, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { TracesViewDeleteTraceModal } from './TracesViewDeleteTraceModal';\n\nexport const TracesViewControlsActions = ({\n  experimentIds,\n  rowSelection,\n  setRowSelection,\n  refreshTraces,\n}: {\n  experimentIds: string[];\n  rowSelection: { [id: string]: boolean };\n  setRowSelection: (rowSelection: { [id: string]: boolean }) => void;\n  refreshTraces: () => void;\n}) => {\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const { theme } = useDesignSystemTheme();\n\n  const openModal = useCallback(() => {\n    setIsModalOpen(true);\n  }, [setIsModalOpen]);\n\n  const closeModal = useCallback(() => {\n    setIsModalOpen(false);\n  }, [setIsModalOpen]);\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        gap: theme.spacing.sm,\n      }}\n    >\n      <Button componentId=\"mlflow.experiment_page.traces_table.delete_traces\" onClick={openModal} danger>\n        <FormattedMessage\n          defaultMessage=\"Delete\"\n          description=\"Experiment page > traces view controls > Delete button\"\n        />\n      </Button>\n      <TracesViewDeleteTraceModal\n        experimentIds={experimentIds}\n        visible={isModalOpen}\n        rowSelection={rowSelection}\n        handleClose={closeModal}\n        refreshTraces={refreshTraces}\n        setRowSelection={setRowSelection}\n      />\n    </div>\n  );\n};\n","import {\n  Button,\n  ColumnsIcon,\n  DialogCombobox,\n  DialogComboboxContent,\n  DialogComboboxOptionList,\n  DialogComboboxOptionListCheckboxItem,\n  DialogComboboxOptionListSearch,\n  DialogComboboxTrigger,\n  InfoIcon,\n  Input,\n  Popover,\n  SearchIcon,\n  TableFilterLayout,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { useMemo, useState } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { ExperimentViewTracesTableColumnLabels } from './TracesView.utils';\nimport { entries } from 'lodash';\nimport { TracesViewControlsActions } from './TracesViewControlsActions';\n\nconst InputTooltip = () => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <Popover.Root modal={false}>\n      <Popover.Trigger asChild>\n        <Button\n          size=\"small\"\n          type=\"link\"\n          icon={\n            <InfoIcon\n              css={{\n                svg: { width: 16, height: 16, color: theme.colors.textSecondary },\n              }}\n            />\n          }\n          componentId=\"mlflow.experiment_page.traces_table.filter_tooltip\"\n        />\n      </Popover.Trigger>\n      <Popover.Content>\n        <Popover.Arrow />\n        <Typography.Paragraph>\n          <FormattedMessage\n            defaultMessage=\"Search traces using a simplified version of the SQL {whereBold} clause.\"\n            description=\"Tooltip string to explain how to search runs from the experiments table\"\n            values={{ whereBold: <b>WHERE</b> }}\n          />\n        </Typography.Paragraph>\n        <FormattedMessage defaultMessage=\"Examples:\" description=\"Text header for examples of mlflow search syntax\" />\n        <ul>\n          <li>\n            <code>tags.some_tag = \"abc\"</code>\n          </li>\n        </ul>\n      </Popover.Content>\n    </Popover.Root>\n  );\n};\n\nexport const TracesViewControls = ({\n  experimentIds,\n  filter,\n  onChangeFilter,\n  hiddenColumns = [],\n  disabledColumns = [],\n  toggleHiddenColumn,\n  rowSelection,\n  setRowSelection,\n  refreshTraces,\n}: {\n  experimentIds: string[];\n  filter: string;\n  onChangeFilter: (newFilter: string) => void;\n  hiddenColumns?: string[];\n  disabledColumns?: string[];\n  toggleHiddenColumn: (columnId: string) => void;\n  rowSelection: { [id: string]: boolean };\n  setRowSelection: (newSelection: { [id: string]: boolean }) => void;\n  refreshTraces: () => void;\n}) => {\n  const intl = useIntl();\n\n  // Internal filter value state, used to control the input value\n  const [filterValue, setFilterValue] = useState<string | undefined>(filter || undefined);\n\n  const allColumnsList = useMemo(() => {\n    return entries(ExperimentViewTracesTableColumnLabels)\n      .map(([key, label]) => ({\n        key,\n        label: intl.formatMessage(label),\n      }))\n      .filter(({ key }) => !disabledColumns.includes(key));\n  }, [intl, disabledColumns]);\n\n  const displayedFilterValue = filterValue ?? filter;\n\n  const showActionButtons = Object.values(rowSelection).filter(Boolean).length > 0;\n\n  return showActionButtons ? (\n    <TracesViewControlsActions\n      experimentIds={experimentIds}\n      rowSelection={rowSelection}\n      setRowSelection={setRowSelection}\n      refreshTraces={refreshTraces}\n    />\n  ) : (\n    <TableFilterLayout css={{ marginBottom: 0 }}>\n      <Input\n        placeholder={intl.formatMessage({\n          defaultMessage: 'Search traces',\n          description: 'Experiment page > traces view filters > filter string input placeholder',\n        })}\n        value={displayedFilterValue}\n        // Matches runs filter input width\n        css={{ width: 430 }}\n        onChange={(e) => setFilterValue(e.target.value)}\n        prefix={<SearchIcon />}\n        suffix={<InputTooltip />}\n        allowClear\n        onClear={() => {\n          onChangeFilter('');\n          setFilterValue(undefined);\n        }}\n        onKeyDown={(e) => {\n          if (e.key === 'Enter') {\n            onChangeFilter(displayedFilterValue);\n            setFilterValue(undefined);\n          }\n        }}\n      />\n      <DialogCombobox\n        label={\n          <div css={{ display: 'flex', alignItems: 'center', gap: 4 }}>\n            <ColumnsIcon />\n            <FormattedMessage\n              defaultMessage=\"Columns\"\n              description=\"Experiment page > traces table > column selector > title\"\n            />\n          </div>\n        }\n      >\n        <DialogComboboxTrigger\n          aria-label={intl.formatMessage({\n            defaultMessage: 'Columns',\n            description: 'Experiment page > traces table > column selector > title',\n          })}\n        />\n        <DialogComboboxContent>\n          <DialogComboboxOptionList>\n            <DialogComboboxOptionListSearch>\n              {allColumnsList.map(({ key, label }) => (\n                <DialogComboboxOptionListCheckboxItem\n                  key={key}\n                  value={key}\n                  checked={!hiddenColumns.includes(key)}\n                  onChange={() => toggleHiddenColumn(key)}\n                >\n                  {label}\n                </DialogComboboxOptionListCheckboxItem>\n              ))}\n            </DialogComboboxOptionListSearch>\n          </DialogComboboxOptionList>\n        </DialogComboboxContent>\n      </DialogCombobox>\n    </TableFilterLayout>\n  );\n};\n","import { useCallback, useEffect, useMemo, useState } from 'react';\nimport LocalStorageUtils from '../../../../common/utils/LocalStorageUtils';\nimport { isObject, sortBy } from 'lodash';\nimport { ExperimentViewTracesTableColumns } from '../TracesView.utils';\n\ntype LocalStorageStore = ReturnType<typeof LocalStorageUtils.getStoreForComponent>;\n\nexport interface ExperimentViewTracesUIState {\n  hiddenColumns?: string[];\n}\n\nconst defaultExperimentViewTracesUIState: ExperimentViewTracesUIState = {\n  hiddenColumns: [ExperimentViewTracesTableColumns.traceName, ExperimentViewTracesTableColumns.source],\n};\n\nconst loadExperimentViewTracesUIState = (localStore: LocalStorageStore): ExperimentViewTracesUIState => {\n  try {\n    const uiStateRaw = localStore.getItem('uiState');\n    const uiState = JSON.parse(uiStateRaw);\n    if (!isObject(uiState)) {\n      return defaultExperimentViewTracesUIState;\n    }\n    return uiState;\n  } catch (e) {\n    return defaultExperimentViewTracesUIState;\n  }\n};\n\nexport const useExperimentViewTracesUIState = (experimentIds: string[]) => {\n  const localStore = useMemo(() => {\n    const persistenceIdentifier = JSON.stringify(experimentIds.slice().sort());\n    return LocalStorageUtils.getStoreForComponent('ExperimentViewTraces', persistenceIdentifier);\n  }, [experimentIds]);\n\n  const [uiState, setUIState] = useState<ExperimentViewTracesUIState>(() =>\n    loadExperimentViewTracesUIState(localStore),\n  );\n\n  const toggleHiddenColumn = useCallback((columnId: string) => {\n    setUIState((prevUIState) => {\n      const hiddenColumns = prevUIState.hiddenColumns || [];\n      return {\n        hiddenColumns: hiddenColumns.includes(columnId)\n          ? hiddenColumns.filter((id) => id !== columnId)\n          : [...hiddenColumns, columnId],\n      };\n    });\n  }, []);\n\n  useEffect(() => {\n    localStore.setItem('uiState', JSON.stringify(uiState));\n  }, [localStore, uiState]);\n\n  return { uiState, toggleHiddenColumn };\n};\n","import { useCallback } from 'react';\nimport { useSearchParams } from '../../../../common/utils/RoutingUtils';\n\nconst QUERY_PARAM_KEY = 'selectedTraceId';\n\n/**\n * Query param-powered hook that returns the currently selected trace ID and a function to set the selected trace ID.\n * To be used in traces page components.\n */\nexport const useActiveExperimentTrace = () => {\n  // TODO(ML-40722): Create separate UI route for traces page and use route params instead of search params\n  const [searchParams, setSearchParams] = useSearchParams();\n\n  const selectedTraceId = searchParams.get(QUERY_PARAM_KEY) ?? undefined;\n\n  const setSelectedTraceId = useCallback(\n    (selectedTraceId: string | undefined) => {\n      setSearchParams((params) => {\n        if (selectedTraceId === undefined) {\n          params.delete(QUERY_PARAM_KEY);\n          return params;\n        }\n        params.set(QUERY_PARAM_KEY, selectedTraceId);\n        return params;\n      });\n    },\n    [setSearchParams],\n  );\n\n  return [selectedTraceId, setSelectedTraceId] as const;\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\n\nimport { useExperimentTraces } from './hooks/useExperimentTraces';\nimport { TracesViewTable } from './TracesViewTable';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { TraceDataDrawer } from './TraceDataDrawer';\nimport { useEditExperimentTraceTags } from './hooks/useEditExperimentTraceTags';\nimport { TracesViewControls } from './TracesViewControls';\nimport { SortingState } from '@tanstack/react-table';\nimport { compact, isFunction, isNil, uniq } from 'lodash';\nimport { useExperimentViewTracesUIState } from './hooks/useExperimentViewTracesUIState';\nimport { ExperimentViewTracesTableColumns, getTraceInfoTotalTokens } from './TracesView.utils';\nimport { useActiveExperimentTrace } from './hooks/useActiveExperimentTrace';\nimport { ModelTraceInfo } from '@databricks/web-shared/model-trace-explorer';\n\nexport const TRACE_AUTO_REFRESH_INTERVAL = 30000;\n\nconst defaultSorting: SortingState = [{ id: ExperimentViewTracesTableColumns.timestampMs, desc: true }];\n\nexport const TracesView = ({\n  experimentIds,\n  runUuid,\n  disabledColumns,\n}: {\n  experimentIds: string[];\n  runUuid?: string;\n  /**\n   * Columns that should be disabled in the table.\n   * Disabled columns are hidden and are not available to be toggled at all.\n   */\n  disabledColumns?: ExperimentViewTracesTableColumns[];\n}) => {\n  const timeoutRef = useRef<number | undefined>(undefined);\n  const [filter, setFilter] = useState<string>('');\n  const [sorting, setSorting] = useState<SortingState>(defaultSorting);\n  const [rowSelection, setRowSelection] = useState<{ [id: string]: boolean }>({});\n\n  const [selectedTraceId, setSelectedTraceId] = useActiveExperimentTrace();\n\n  const { traces, loading, error, hasNextPage, hasPreviousPage, fetchNextPage, fetchPrevPage, refreshCurrentPage } =\n    useExperimentTraces(experimentIds, sorting, filter, runUuid);\n\n  const onTraceClicked = useCallback(\n    ({ request_id }: ModelTraceInfo) => setSelectedTraceId(request_id),\n    [setSelectedTraceId],\n  );\n\n  // clear row selections when the page changes.\n  // the backend specifies a max of 100 deletions,\n  // plus it's confusing to have selections on a\n  // page that the user can't see\n  const onNextPage = useCallback(() => {\n    fetchNextPage();\n    setRowSelection({});\n  }, [fetchNextPage]);\n\n  const onPreviousPage = useCallback(() => {\n    fetchPrevPage();\n    setRowSelection({});\n  }, [fetchPrevPage]);\n\n  // auto-refresh traces\n  useEffect(() => {\n    // if the hook reruns, clear the current timeout, since we'll be scheduling another\n    window.clearTimeout(timeoutRef.current);\n\n    const scheduleRefresh = async () => {\n      // only refresh if the user is on the first page\n      // otherwise it might mess with browsing old traces\n      if (loading || hasPreviousPage) return;\n\n      await refreshCurrentPage(true);\n\n      window.clearTimeout(timeoutRef.current);\n      timeoutRef.current = window.setTimeout(scheduleRefresh, TRACE_AUTO_REFRESH_INTERVAL);\n    };\n\n    timeoutRef.current = window.setTimeout(scheduleRefresh, TRACE_AUTO_REFRESH_INTERVAL);\n    return () => window.clearTimeout(timeoutRef.current);\n  }, [refreshCurrentPage, loading, hasPreviousPage]);\n\n  const { theme } = useDesignSystemTheme();\n\n  // Try to find the trace info for the currently selected trace id\n  const selectedTraceInfo = useMemo(() => {\n    if (!selectedTraceId) return undefined;\n    return traces.find((trace) => trace.request_id === selectedTraceId);\n  }, [selectedTraceId, traces]);\n\n  const {\n    // hiddenColumns is a list of columns that are hidden by the user.\n    uiState,\n    toggleHiddenColumn,\n  } = useExperimentViewTracesUIState(experimentIds);\n\n  const existingTagKeys = useMemo(\n    () => uniq(compact(traces.flatMap((trace) => trace.tags?.map((tag) => tag.key)))),\n    [traces],\n  );\n\n  const { showEditTagsModalForTrace, EditTagsModal } = useEditExperimentTraceTags({\n    onSuccess: () => refreshCurrentPage(true),\n    existingTagKeys,\n  });\n\n  const usingFilters = filter !== '';\n\n  const anyTraceContainsTokenCount = traces.some((trace) => !isNil(getTraceInfoTotalTokens(trace)));\n\n  // Automatically disabled columns: hide the token count column if there's no trace that contains token count information.\n  const autoDisabledColumns = useMemo(\n    () => (!anyTraceContainsTokenCount ? [ExperimentViewTracesTableColumns.totalTokens] : []),\n    [anyTraceContainsTokenCount],\n  );\n\n  // Combine columns that are disabled by parent component and columns that are disabled automatically.\n  const allDisabledColumns = useMemo(\n    () => [...(disabledColumns ?? []), ...autoDisabledColumns],\n    [disabledColumns, autoDisabledColumns],\n  );\n\n  const allHiddenColumns = useMemo(\n    () => [...(uiState.hiddenColumns ?? []), ...allDisabledColumns],\n    [uiState, allDisabledColumns],\n  );\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        gap: theme.spacing.sm,\n        height: '100%',\n        overflow: 'hidden',\n      }}\n    >\n      <TracesViewControls\n        experimentIds={experimentIds}\n        filter={filter}\n        onChangeFilter={setFilter}\n        hiddenColumns={uiState.hiddenColumns ?? []}\n        disabledColumns={allDisabledColumns}\n        toggleHiddenColumn={toggleHiddenColumn}\n        rowSelection={rowSelection}\n        setRowSelection={setRowSelection}\n        refreshTraces={refreshCurrentPage}\n      />\n      <TracesViewTable\n        traces={traces}\n        loading={loading}\n        error={error}\n        onTraceClicked={onTraceClicked}\n        onTraceTagsEdit={showEditTagsModalForTrace}\n        hasNextPage={hasNextPage}\n        hasPreviousPage={hasPreviousPage}\n        onPreviousPage={onPreviousPage}\n        onNextPage={onNextPage}\n        onTagsUpdated={refreshCurrentPage}\n        usingFilters={usingFilters}\n        onResetFilters={() => setFilter('')}\n        hiddenColumns={allHiddenColumns}\n        disableTokenColumn={!anyTraceContainsTokenCount}\n        setSorting={(sortingSetter) => {\n          // If header is clicked enough times, tanstack table switches to \"no sort\" mode.\n          // In that case, we should just reverse the direction of the current sort instead.\n          if (isFunction(sortingSetter)) {\n            return setSorting((currentState) => {\n              const newState = sortingSetter(currentState);\n              const currentSortBy = currentState[0];\n              if ((!newState || newState.length === 0) && currentSortBy) {\n                return [{ id: currentSortBy.id, desc: !currentSortBy.desc }];\n              }\n              return newState;\n            });\n          }\n        }}\n        sorting={sorting}\n        rowSelection={rowSelection}\n        setRowSelection={setRowSelection}\n      />\n      {selectedTraceId && (\n        <TraceDataDrawer\n          traceInfo={selectedTraceInfo}\n          loadingTraceInfo={loading}\n          requestId={selectedTraceId}\n          onClose={() => setSelectedTraceId(undefined)}\n        />\n      )}\n      {EditTagsModal}\n    </div>\n  );\n};\n","import { type ModelTraceInfo } from '@databricks/web-shared/model-trace-explorer';\nimport { useEditKeyValueTagsModal } from '../../../../common/hooks/useEditKeyValueTagsModal';\nimport { MlflowService } from '../../../sdk/MlflowService';\nimport { KeyValueEntity } from '../../../types';\nimport { useCallback } from 'react';\nimport { MLFLOW_INTERNAL_PREFIX } from '../../../../common/utils/TagUtils';\n\ntype EditedModelTrace = {\n  traceRequestId: string;\n  tags: KeyValueEntity[];\n};\n\nexport const useEditExperimentTraceTags = ({\n  onSuccess,\n  existingTagKeys = [],\n}: {\n  onSuccess?: () => void;\n  existingTagKeys?: string[];\n}) => {\n  const { showEditTagsModal, EditTagsModal } = useEditKeyValueTagsModal<EditedModelTrace>({\n    saveTagsHandler: async (editedEntity, existingTags, newTags) => {\n      if (!editedEntity.traceRequestId) {\n        return;\n      }\n      const requestId = editedEntity.traceRequestId;\n      // First, determine new tags to be added\n      const addedOrModifiedTags = newTags.filter(\n        ({ key: newTagKey, value: newTagValue }) =>\n          !existingTags.some(\n            ({ key: existingTagKey, value: existingTagValue }) =>\n              existingTagKey === newTagKey && newTagValue === existingTagValue,\n          ),\n      );\n\n      // Next, determine those to be deleted\n      const deletedTags = existingTags.filter(\n        ({ key: existingTagKey }) => !newTags.some(({ key: newTagKey }) => existingTagKey === newTagKey),\n      );\n\n      // Fire all requests at once\n      const updateRequests = Promise.all([\n        ...addedOrModifiedTags.map(({ key, value }) => MlflowService.setExperimentTraceTag(requestId, key, value)),\n        ...deletedTags.map(({ key }) => MlflowService.deleteExperimentTraceTag(requestId, key)),\n      ]);\n\n      return updateRequests;\n    },\n    valueRequired: true,\n    allAvailableTags: existingTagKeys.filter((tagKey) => tagKey && !tagKey.startsWith(MLFLOW_INTERNAL_PREFIX)),\n    onSuccess: onSuccess,\n  });\n\n  const showEditTagsModalForTrace = useCallback(\n    (trace: ModelTraceInfo) => {\n      if (!trace.request_id) {\n        return;\n      }\n      const visibleTags = trace.tags?.filter(({ key }) => key && !key.startsWith(MLFLOW_INTERNAL_PREFIX)) || [];\n      showEditTagsModal({\n        traceRequestId: trace.request_id,\n        tags: visibleTags || [],\n      });\n    },\n    [showEditTagsModal],\n  );\n\n  return {\n    showEditTagsModalForTrace,\n    EditTagsModal,\n  };\n};\n","import { type ModelTraceInfo } from '@databricks/web-shared/model-trace-explorer';\nimport { type MessageDescriptor, defineMessage } from 'react-intl';\n\nconst TRACE_METADATA_FIELD_RUN_ID = 'mlflow.sourceRun';\nconst TRACE_METADATA_FIELD_TOTAL_TOKENS = 'total_tokens';\nconst TRACE_METADATA_FIELD_INPUTS = 'mlflow.traceInputs';\nconst TRACE_METADATA_FIELD_OUTPUTS = 'mlflow.traceOutputs';\nexport const TRACE_TAG_NAME_TRACE_NAME = 'mlflow.traceName';\n\n// Truncation limit for tracing metadata, taken from:\n// https://github.com/mlflow/mlflow/blob/2b457f2b46fc135a3fba77aefafe2319a899fc08/mlflow/tracing/constant.py#L23\nconst MAX_CHARS_IN_TRACE_INFO_METADATA_AND_TAGS = 250;\n\nconst getTraceMetadataField = (traceInfo: ModelTraceInfo, field: string) => {\n  return traceInfo.request_metadata?.find(({ key }) => key === field)?.value;\n};\n\nexport const isTraceMetadataPossiblyTruncated = (traceMetadata: string) => {\n  return traceMetadata.length >= MAX_CHARS_IN_TRACE_INFO_METADATA_AND_TAGS;\n};\n\nexport const getTraceInfoRunId = (traceInfo: ModelTraceInfo) =>\n  getTraceMetadataField(traceInfo, TRACE_METADATA_FIELD_RUN_ID);\n\nexport const getTraceInfoTotalTokens = (traceInfo: ModelTraceInfo) =>\n  getTraceMetadataField(traceInfo, TRACE_METADATA_FIELD_TOTAL_TOKENS);\n\nexport const getTraceInfoInputs = (traceInfo: ModelTraceInfo) =>\n  getTraceMetadataField(traceInfo, TRACE_METADATA_FIELD_INPUTS);\n\nexport const getTraceInfoOutputs = (traceInfo: ModelTraceInfo) =>\n  getTraceMetadataField(traceInfo, TRACE_METADATA_FIELD_OUTPUTS);\n\nexport const getTraceTagValue = (traceInfo: ModelTraceInfo, tagName: string) => {\n  return traceInfo.tags?.find(({ key }) => key === tagName)?.value;\n};\n\nexport const getTraceDisplayName = (traceInfo: ModelTraceInfo) => {\n  return getTraceTagValue(traceInfo, TRACE_TAG_NAME_TRACE_NAME) || traceInfo.request_id;\n};\n\nexport const EXPERIMENT_TRACES_SORTABLE_COLUMNS = ['timestamp_ms'];\n\n// defining a separate const for this column as\n// we don't users to be able to control its visibility\nexport const TRACE_TABLE_CHECKBOX_COLUMN_ID = 'select';\n\nexport enum ExperimentViewTracesTableColumns {\n  requestId = 'request_id',\n  traceName = 'traceName',\n  timestampMs = 'timestamp_ms',\n  inputs = 'inputs',\n  outputs = 'outputs',\n  runName = 'runName',\n  totalTokens = 'total_tokens',\n  source = 'source',\n  latency = 'latency',\n  tags = 'tags',\n  status = 'status',\n}\n\nexport const ExperimentViewTracesTableColumnLabels: Record<ExperimentViewTracesTableColumns, MessageDescriptor> = {\n  [ExperimentViewTracesTableColumns.requestId]: defineMessage({\n    defaultMessage: 'Request ID',\n    description: 'Experiment page > traces table > request id column header',\n  }),\n  [ExperimentViewTracesTableColumns.traceName]: defineMessage({\n    defaultMessage: 'Trace name',\n    description: 'Experiment page > traces table > trace name column header',\n  }),\n  [ExperimentViewTracesTableColumns.timestampMs]: defineMessage({\n    defaultMessage: 'Time created',\n    description: 'Experiment page > traces table > time created column header',\n  }),\n  [ExperimentViewTracesTableColumns.status]: defineMessage({\n    defaultMessage: 'Status',\n    description: 'Experiment page > traces table > status column header',\n  }),\n  [ExperimentViewTracesTableColumns.inputs]: defineMessage({\n    defaultMessage: 'Request',\n    description: 'Experiment page > traces table > input column header',\n  }),\n  [ExperimentViewTracesTableColumns.outputs]: defineMessage({\n    defaultMessage: 'Response',\n    description: 'Experiment page > traces table > output column header',\n  }),\n  [ExperimentViewTracesTableColumns.runName]: defineMessage({\n    defaultMessage: 'Run name',\n    description: 'Experiment page > traces table > run name column header',\n  }),\n  [ExperimentViewTracesTableColumns.totalTokens]: defineMessage({\n    defaultMessage: 'Tokens',\n    description: 'Experiment page > traces table > tokens column header',\n  }),\n  [ExperimentViewTracesTableColumns.source]: defineMessage({\n    defaultMessage: 'Source',\n    description: 'Experiment page > traces table > source column header',\n  }),\n  [ExperimentViewTracesTableColumns.latency]: defineMessage({\n    defaultMessage: 'Execution time',\n    description: 'Experiment page > traces table > latency column header',\n  }),\n  [ExperimentViewTracesTableColumns.tags]: defineMessage({\n    defaultMessage: 'Tags',\n    description: 'Experiment page > traces table > tags column header',\n  }),\n};\n\nexport const ExperimentViewTracesStatusLabels = {\n  UNSET: null,\n  IN_PROGRESS: defineMessage({\n    defaultMessage: 'In progress',\n    description: 'Experiment page > traces table > status label > in progress',\n  }),\n  OK: defineMessage({\n    defaultMessage: 'OK',\n    description: 'Experiment page > traces table > status label > ok',\n  }),\n  ERROR: defineMessage({\n    defaultMessage: 'Error',\n    description: 'Experiment page > traces table > status label > error',\n  }),\n};\n","import { DatasetSourceTypes, type DatasetSummary, type RunDatasetWithTags } from '../types';\n\nexport const datasetSummariesEqual = (summary1: DatasetSummary, summary2: DatasetSummary) =>\n  summary1.digest === summary2.digest && summary1.name === summary2.name && summary1.context === summary2.context;\n\nexport const getDatasetSourceUrl = (datasetWithTags: RunDatasetWithTags) => {\n  const { dataset } = datasetWithTags;\n  const sourceType = dataset.sourceType;\n  try {\n    if (sourceType === DatasetSourceTypes.HTTP) {\n      const { url } = JSON.parse(dataset.source);\n      return url;\n    }\n    if (sourceType === DatasetSourceTypes.S3) {\n      const { uri } = JSON.parse(dataset.source);\n      return uri;\n    }\n    if (sourceType === DatasetSourceTypes.HUGGING_FACE) {\n      const { path } = JSON.parse(dataset.source);\n      return `https://huggingface.co/datasets/${path}`;\n    }\n  } catch {\n    return null;\n  }\n  return null;\n};\n","import React, { useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Button, type ButtonProps, LegacyTooltip } from '@databricks/design-system';\n\ninterface CopyButtonProps extends Partial<ButtonProps> {\n  copyText: string;\n  showLabel?: React.ReactNode;\n}\n\nexport const CopyButton = ({ copyText, showLabel = true, ...buttonProps }: CopyButtonProps) => {\n  const [showTooltip, setShowTooltip] = useState(false);\n\n  const handleClick = () => {\n    navigator.clipboard.writeText(copyText);\n    setShowTooltip(true);\n    setTimeout(() => {\n      setShowTooltip(false);\n    }, 3000);\n  };\n\n  const handleMouseLeave = () => {\n    setShowTooltip(false);\n  };\n\n  return (\n    <LegacyTooltip\n      title={\n        <FormattedMessage defaultMessage=\"Copied\" description=\"Tooltip text shown when copy operation completes\" />\n      }\n      dangerouslySetAntdProps={{\n        visible: showTooltip,\n      }}\n    >\n      <Button\n        componentId=\"codegen_mlflow_app_src_shared_building_blocks_copybutton.tsx_35\"\n        type=\"primary\"\n        onClick={handleClick}\n        onMouseLeave={handleMouseLeave}\n        css={{ 'z-index': 1 }}\n        // Define children as a explicit prop so it can be easily overrideable\n        children={\n          showLabel ? <FormattedMessage defaultMessage=\"Copy\" description=\"Button text for copy button\" /> : undefined\n        }\n        {...buttonProps}\n      />\n    </LegacyTooltip>\n  );\n};\n","import {\n  ArrowLeftIcon,\n  ArrowRightIcon,\n  CloseIcon,\n  DesignSystemContext,\n  RedoIcon,\n  UndoIcon,\n  ZoomInIcon,\n  ZoomOutIcon,\n} from '@databricks/design-system';\nimport { useContext } from 'react';\nimport RcImage from 'rc-image';\nimport './Image.css';\n\nconst icons = {\n  rotateLeft: <UndoIcon />,\n  rotateRight: <RedoIcon />,\n  zoomIn: <ZoomInIcon />,\n  zoomOut: <ZoomOutIcon />,\n  close: <CloseIcon />,\n  left: <ArrowLeftIcon />,\n  right: <ArrowRightIcon />,\n};\n\nexport const ImagePreviewGroup = ({\n  children,\n  visible,\n  onVisibleChange,\n}: {\n  children: React.ReactNode;\n  visible: boolean;\n  onVisibleChange: (v: boolean) => void;\n}) => {\n  const { getPopupContainer } = useContext(DesignSystemContext);\n\n  return (\n    <RcImage.PreviewGroup\n      icons={icons}\n      preview={{\n        visible: visible,\n        getContainer: getPopupContainer,\n        onVisibleChange: (v) => onVisibleChange(v),\n      }}\n    >\n      {children}\n    </RcImage.PreviewGroup>\n  );\n};\n\nexport { RcImage as Image };\n","import React from 'react';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\n\nfunction useMatchesMediaQuery(queryList: MediaQueryList) {\n  return useSyncExternalStore(\n    React.useCallback(\n      (callback) => {\n        queryList.addEventListener('change', callback);\n        return () => {\n          queryList.removeEventListener('change', callback);\n        };\n      },\n      [queryList],\n    ),\n    () => queryList.matches,\n  );\n}\n\n/**\n * React hook that listens for changes to a [media query][media-query]. Uses\n * [`window.matchMedia()`][match-media] under-the-hood.\n *\n * [media-query]: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_media_queries/Using_media_queries\n * [match-media]: https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia\n *\n * @usage\n *\n * ```tsx\n * function FancyButton() {\n *   const prefersReducedMotion = useMediaQuery('(prefers-reduced-motion)');\n *   return prefersReducedMotion ? <Button /> : <DancingButton />;\n * }\n * ```\n *\n * > **Note**\n * > The vast majority of use-cases can (and should) use vanilla CSS media\n * > queries instead of this hook  which will cause a re-render when the match\n * > state changes. Usage of this hook should be reserved for use-cases where\n * > CSS cannot be used instead.\n * >\n * > ```tsx\n * > <Button css={{ 'not (prefers-reduced-motion)': { animation:  } }} />\n * > ```\n */\nexport function useMediaQuery(query: string) {\n  // Note: a new MediaQueryList is created with every _usage_ of this hook.\n  // It's probably cheap to create many instances of MediaQueryList, and\n  // garbage collection will still clean up as expected, but consider using a\n  // [weak cache](https://github.com/tc39/proposal-weakrefs#weak-caches) to\n  // reuse MediaQueryLists where possible if performance is impacted.\n  const queryList = React.useMemo(() => window.matchMedia(query), [query]);\n  return useMatchesMediaQuery(queryList);\n}\n","/**\n * Adapted from `duotone-dark`\n * Ref: https://github.com/react-syntax-highlighter/react-syntax-highlighter/blob/b2457268891948f7005ccf539a70c000f0695bde/src/styles/prism/duotone-dark.js\n */\n\nconst databricksDuotoneDarkTheme = {\n  'code[class*=\"language-\"]': {\n    fontFamily:\n      'Consolas, Menlo, Monaco, \"Andale Mono WT\", \"Andale Mono\", \"Lucida Console\", \"Lucida Sans Typewriter\", \"DejaVu Sans Mono\", \"Bitstream Vera Sans Mono\", \"Liberation Mono\", \"Nimbus Mono L\", \"Courier New\", Courier, monospace',\n    fontSize: '14px',\n    lineHeight: '1.375',\n    direction: 'ltr',\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n    background: '#2a2734',\n    color: '#5DFAFC', // D\n  },\n  'pre[class*=\"language-\"]': {\n    fontFamily:\n      'Consolas, Menlo, Monaco, \"Andale Mono WT\", \"Andale Mono\", \"Lucida Console\", \"Lucida Sans Typewriter\", \"DejaVu Sans Mono\", \"Bitstream Vera Sans Mono\", \"Liberation Mono\", \"Nimbus Mono L\", \"Courier New\", Courier, monospace',\n    fontSize: '14px',\n    lineHeight: '1.375',\n    direction: 'ltr',\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n    background: '#2a2734',\n    color: '#5DFAFC', // D\n    padding: '1em',\n    margin: '.5em 0',\n    overflow: 'auto',\n  },\n  'pre > code[class*=\"language-\"]': {\n    fontSize: '1em',\n  },\n  'pre[class*=\"language-\"]::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'pre[class*=\"language-\"] ::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"]::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"] ::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'pre[class*=\"language-\"]::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'pre[class*=\"language-\"] ::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"]::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"] ::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  ':not(pre) > code[class*=\"language-\"]': {\n    padding: '.1em',\n    borderRadius: '.3em',\n  },\n  comment: {\n    color: '#6c6783',\n  },\n  prolog: {\n    color: '#6c6783',\n  },\n  doctype: {\n    color: '#6c6783',\n  },\n  cdata: {\n    color: '#6c6783',\n  },\n  punctuation: {\n    color: '#6c6783',\n  },\n  namespace: {\n    Opacity: '.7',\n  },\n  tag: {\n    color: '#3AACE2', // D\n  },\n  operator: {\n    color: '#3AACE2', // D\n  },\n  number: {\n    color: '#3AACE2', // D\n  },\n  property: {\n    color: '#5DFAFC', // D\n  },\n  function: {\n    color: '#5DFAFC', // D\n  },\n  'tag-id': {\n    color: '#eeebff',\n  },\n  selector: {\n    color: '#eeebff',\n  },\n  'atrule-id': {\n    color: '#eeebff',\n  },\n  'code.language-javascript': {\n    color: '#c4b9fe',\n  },\n  'attr-name': {\n    color: '#c4b9fe',\n  },\n  'code.language-css': {\n    color: '#ffffff', // D\n  },\n  'code.language-scss': {\n    color: '#ffffff', // D\n  },\n  boolean: {\n    color: '#ffffff', // D\n  },\n  string: {\n    color: '#ffffff', // D\n  },\n  entity: {\n    color: '#ffffff', // D\n    cursor: 'help',\n  },\n  url: {\n    color: '#ffffff', // D\n  },\n  '.language-css .token.string': {\n    color: '#ffffff', // D\n  },\n  '.language-scss .token.string': {\n    color: '#ffffff', // D\n  },\n  '.style .token.string': {\n    color: '#ffffff', // D\n  },\n  'attr-value': {\n    color: '#ffffff', // D\n  },\n  keyword: {\n    color: '#ffffff', // D\n  },\n  control: {\n    color: '#ffffff', // D\n  },\n  directive: {\n    color: '#ffffff', // D\n  },\n  unit: {\n    color: '#ffffff', // D\n  },\n  statement: {\n    color: '#ffffff', // D\n  },\n  regex: {\n    color: '#ffffff', // D\n  },\n  atrule: {\n    color: '#ffffff', // D\n  },\n  placeholder: {\n    color: '#ffffff', // D\n  },\n  variable: {\n    color: '#ffffff', // D\n  },\n  deleted: {\n    textDecoration: 'line-through',\n  },\n  inserted: {\n    borderBottom: '1px dotted #eeebff',\n    textDecoration: 'none',\n  },\n  italic: {\n    fontStyle: 'italic',\n  },\n  important: {\n    fontWeight: 'bold',\n    color: '#c4b9fe',\n  },\n  bold: {\n    fontWeight: 'bold',\n  },\n  'pre > code.highlight': {\n    Outline: '.4em solid #8a75f5',\n    OutlineOffset: '.4em',\n  },\n  '.line-numbers.line-numbers .line-numbers-rows': {\n    borderRightColor: '#2c2937',\n  },\n  '.line-numbers .line-numbers-rows > span:before': {\n    color: '#3c3949',\n  },\n  '.line-highlight.line-highlight': {\n    background: 'linear-gradient(to right, rgba(224, 145, 66, 0.2) 70%, rgba(224, 145, 66, 0))',\n  },\n};\n\nexport default databricksDuotoneDarkTheme;\n","/**\n * Adapted from `material-light`\n * Ref: https://github.com/react-syntax-highlighter/react-syntax-highlighter/blob/b2457268891948f7005ccf539a70c000f0695bde/src/styles/prism/material-light.js#L1\n *\n * This theme overwrites colors to be similiar to the `@databricks/editor` theme.\n */\n\nconst databricksLightTheme = {\n  'code[class*=\"language-\"]': {\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    wordWrap: 'normal',\n    color: 'rgb(77, 77, 76)', // D\n    background: '#fafafa',\n    fontFamily: 'Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro, monospace',\n    fontSize: '12px', // D\n    lineHeight: '1.5em',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n  },\n  'pre[class*=\"language-\"]': {\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    wordWrap: 'normal',\n    color: 'rgb(77, 77, 76)', // D\n    background: '#fafafa',\n    fontFamily: 'Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro, monospace',\n    fontSize: '12px', // D\n    lineHeight: '1.5em',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n    overflow: 'auto',\n    position: 'relative',\n    margin: '0.5em 0',\n    padding: '1.25em 1em',\n  },\n  'code[class*=\"language-\"]::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"]::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'code[class*=\"language-\"] ::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"] ::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'code[class*=\"language-\"]::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"]::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'code[class*=\"language-\"] ::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"] ::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  ':not(pre) > code[class*=\"language-\"]': {\n    whiteSpace: 'normal',\n    borderRadius: '0.2em',\n    padding: '0.1em',\n  },\n  '.language-css > code': {\n    color: '#f5871f', // D\n  },\n  '.language-sass > code': {\n    color: '#f5871f', // D\n  },\n  '.language-scss > code': {\n    color: '#f5871f', // D\n  },\n  '[class*=\"language-\"] .namespace': {\n    Opacity: '0.7',\n  },\n  atrule: {\n    color: '#7c4dff',\n  },\n  'attr-name': {\n    color: '#39adb5',\n  },\n  'attr-value': {\n    color: '#f6a434',\n  },\n  attribute: {\n    color: '#f6a434',\n  },\n  boolean: {\n    color: '#7c4dff', // D\n  },\n  builtin: {\n    color: '#39adb5',\n  },\n  cdata: {\n    color: '#39adb5',\n  },\n  char: {\n    color: '#39adb5',\n  },\n  class: {\n    color: '#39adb5',\n  },\n  'class-name': {\n    color: '#6182b8',\n  },\n  comment: {\n    color: '#8e908c', // D\n  },\n  constant: {\n    color: '#7c4dff', // D\n  },\n  deleted: {\n    color: '#e53935',\n  },\n  doctype: {\n    color: '#aabfc9',\n  },\n  entity: {\n    color: '#e53935',\n  },\n  function: {\n    color: '#4271ae', // D\n  },\n  hexcode: {\n    color: '#f5871f', // D\n  },\n  id: {\n    color: '#7c4dff',\n    fontWeight: 'bold',\n  },\n  important: {\n    color: '#7c4dff',\n    fontWeight: 'bold',\n  },\n  inserted: {\n    color: '#39adb5',\n  },\n  keyword: {\n    color: '#8959a8', // D\n  },\n  number: {\n    color: '#f5871f', // D\n  },\n  operator: {\n    color: '#3e999f', // D\n  },\n  prolog: {\n    color: '#aabfc9',\n  },\n  property: {\n    color: '#39adb5',\n  },\n  'pseudo-class': {\n    color: '#f6a434',\n  },\n  'pseudo-element': {\n    color: '#f6a434',\n  },\n  punctuation: {\n    color: 'rgb(77, 77, 76)', // D\n  },\n  regex: {\n    color: '#6182b8',\n  },\n  selector: {\n    color: '#e53935',\n  },\n  string: {\n    color: '#3ba85f', // D\n  },\n  symbol: {\n    color: '#7c4dff',\n  },\n  tag: {\n    color: '#e53935',\n  },\n  unit: {\n    color: '#f5871f', // D\n  },\n  url: {\n    color: '#e53935',\n  },\n  variable: {\n    color: '#c72d4c', // D\n  },\n};\n\nexport default databricksLightTheme;\n","import { PrismLight as SyntaxHighlighter } from 'react-syntax-highlighter';\nimport python from 'react-syntax-highlighter/dist/cjs/languages/prism/python';\nimport json from 'react-syntax-highlighter/dist/cjs/languages/prism/json';\n\nSyntaxHighlighter.registerLanguage('python', python);\nSyntaxHighlighter.registerLanguage('json', json);\n\nimport duotoneDarkStyle from './theme/databricks-duotone-dark';\nimport lightStyle from './theme/databricks-light';\nimport { CSSProperties, ReactNode } from 'react';\nimport { pick } from 'lodash';\n\nexport type CodeSnippetTheme = 'duotoneDark' | 'light';\n\nexport const buttonBackgroundColorDark = 'rgba(140, 203, 255, 0)';\nexport const buttonColorDark = 'rgba(255, 255, 255, 0.84)';\nexport const buttonHoverColorDark = '#8ccbffcc';\nexport const buttonHoverBackgroundColorDark = 'rgba(140, 203, 255, 0.08)';\nexport const duboisAlertBackgroundColor = '#fff0f0';\nexport const snippetPadding = '24px';\n\nconst themesStyles: Record<CodeSnippetTheme, any> = {\n  light: lightStyle,\n  duotoneDark: duotoneDarkStyle,\n};\n\nexport type CodeSnippetLanguage = 'python' | 'json';\n\nexport interface CodeSnippetProps {\n  /**\n   * The code string\n   */\n  children: string;\n  /**\n   * The actions that are displayed on the right top corner of the component\n   *  see `./actions` for built-in actions\n   */\n  actions?: NonNullable<ReactNode> | NonNullable<ReactNode>[];\n  /**\n   * The theme, default theme is `light`\n   */\n  theme?: CodeSnippetTheme;\n  /**\n   * Language of the code (`children`)\n   */\n  language: CodeSnippetLanguage;\n  /**\n   * Custom styles (passed to the internal `<pre>`)\n   */\n  style?: CSSProperties;\n  /**\n   * Whether to show line numbers on the left or not\n   */\n  showLineNumbers?: boolean;\n  /**\n   * Custom styles for line numbers\n   */\n  lineNumberStyle?: CSSProperties;\n  /**\n   * Whether or not to wrap long lines\n   */\n  wrapLongLines?: boolean;\n}\n\n/**\n * `CodeSnippet` is used for highlighting code, use this instead of\n */\nexport function CodeSnippet({\n  theme = 'light',\n  language,\n  actions,\n  style,\n  children,\n  showLineNumbers,\n  lineNumberStyle,\n  wrapLongLines,\n}: CodeSnippetProps) {\n  const customStyle = {\n    border: 'none',\n    borderRadius: 0,\n    margin: 0,\n    padding: snippetPadding,\n    ...style,\n  };\n\n  return (\n    <>\n      <SyntaxHighlighter\n        showLineNumbers={showLineNumbers}\n        lineNumberStyle={lineNumberStyle}\n        language={language}\n        style={themesStyles[theme]}\n        customStyle={customStyle}\n        codeTagProps={{\n          style: pick(style, 'backgroundColor'),\n        }}\n        wrapLongLines={wrapLongLines}\n      >\n        {children}\n      </SyntaxHighlighter>\n    </>\n  );\n}\n"],"names":["_path","_rect","_rect2","_rect3","_rect4","_extends","Object","assign","bind","n","e","arguments","length","t","r","hasOwnProperty","call","apply","SvgChartBar","_ref","svgRef","title","titleId","props","width","height","viewBox","fill","xmlns","ref","id","d","stroke","strokeLinecap","x","y","ForwardRef","_path2","_path3","SvgChartContour","_rect5","_rect6","_rect7","_rect8","_rect9","_rect10","_rect11","_rect12","_rect13","_rect14","_rect15","_rect16","_rect17","_rect18","SvgChartDifference","_line","_line2","_line3","SvgChartImage","x1","y1","x2","y2","SvgChartLine","strokeWidth","strokeLinejoin","_path4","_path5","SvgChartParallel","_circle","_ellipse","_circle2","_circle3","_ellipse2","_ellipse3","SvgChartScatter","cx","cy","rx","ry","fillOpacity","_g","_defs","SvgRegisteredModelGreyOk","clipPath","style","maskType","maskUnits","mask","fillRule","clipRule","JsonPreview","json","wrapperStyle","overlayStyle","codeSnippetStyle","formattedJson","isJsonContent","useFormattedJson","_jsx","position","maxHeight","overflow","children","_jsxs","_Fragment","CodeSnippet","language","padding","overflowX","css","_css","bottom","right","left","background","React","parsed","JSON","parse","isJson","isObject","Date","stringify","_ref3","name","styles","FormattedJsonDisplay","_ref2","wrapLongLines","Paragraph","Typography","KeyValueTagFullViewModal","theme","useDesignSystemTheme","Modal","tagKey","visible","isKeyValueTagFullViewModalVisible","onCancel","setIsKeyValueTagFullViewModalVisible","backgroundColor","colors","backgroundPrimary","marginTop","spacing","sm","whiteSpace","wordBreak","tagValue","CopyButton","copyText","showLabel","icon","CopyIcon","TRUNCATE_ON_CHARS_LENGTH","getTruncatedStyles","undefined","textOverflow","textWrap","KeyValueTag","isClosable","onClose","tag","enableFullViewModal","charLimit","maxWidth","className","intl","useIntl","useState","shouldTruncateKey","shouldTruncateValue","key","value","fullLength","isKeyLonger","shorterLength","getKeyAndValueComplexTruncation","allowFullViewModal","fullViewModalLabel","formatMessage","defaultMessage","Tag","closable","LegacyTooltip","display","onClick","Text","bold","ToggleIconButton","pressed","onBlur","onFocus","onMouseEnter","onMouseLeave","componentId","analyticsEvents","type","remainingProps","eventContext","useDesignSystemEventComponentCallbacks","componentType","DesignSystemEventProviderComponentTypes","Button","DesignSystemEventProviderAnalyticsEventTypes","OnClick","event","cursor","general","heightSm","borderRadius","borders","borderRadiusMd","lineHeight","typography","lineHeightBase","border","alignItems","justifyContent","actionDefaultBackgroundPress","color","actionDefaultTextPress","textSecondary","actionDefaultBackgroundHover","actionDefaultTextHover","useDragAndDropElement","dragGroupKey","dragKey","onDrop","disabled","dropListener","useRef","current","isOver","draggedItem","dropTargetRef","useDrop","canDrop","accept","drop","monitor","sourceKey","didDrop","collect","shallow","getItem","isDragging","dragHandleRef","dragPreviewRef","useDrag","canDrag","item","groupKey","isDraggingOtherGroup","Boolean","_ref4","DragAndDropProvider","rootElementRef","manager","setManager","useLayoutEffect","rootElement","dragDropManager","createDragDropManager","HTML5Backend","getBackend","teardown","DndProvider","getDropdownMenu","allAvailableTags","menu","searchValue","toLowerCase","useMemo","sortedIndexOf","isValidTagKey","test","flattenOptions","data","actionTertiaryTextDefault","actionDisabledText","placement","PlusIcon","marginRight","groupOption","DropdownMenu","TagKeySelectDropdown","control","onKeyChangeCallback","isOpen","setIsOpen","selectRef","field","fieldState","useController","rules","required","message","LegacySelect","allowClear","dangerouslySetAntdProps","showSearch","dropdownRender","placeholder","defaultValue","open","onDropdownVisibleChange","filterOption","input","option","includes","onSelect","onChange","onClear","handleClear","validationState","error","map","Option","getTagsMap","tags","Map","useEditKeyValueTagsModal","onSuccess","saveTagsHandler","valueRequired","editedEntityRef","errorMessage","setErrorMessage","initialTags","setInitialTags","finalTags","setFinalTags","showModal","setShowModal","form","useForm","defaultValues","hideModal","showEditTagsModal","useCallback","editedEntity","reset","saveTags","async","setIsLoading","Array","from","values","then","catch","_e$getUserVisibleErro","ErrorWrapper","getUserVisibleError","formValues","watch","isLoading","hasNewValues","isEqual","sortBy","isDirty","showPopoverMessage","EditTagsModal","destroyOnClose","FormattedMessage","footer","RestoreAntDDefaultClsPrefix","dangerouslyUseFocusPseudoClass","UnsavedTagPopoverTrigger","onSaveTask","loading","onSubmit","handleSubmit","trim","newEntries","set","gap","md","minWidth","flex","FormUI","Label","htmlFor","_tag$value","get","setValue","RHFControlledComponents","Input","htmlType","Message","rowGap","xs","flexWrap","currentFinalTags","delete","handleTagDelete","_ref6","_ref5","fullTagDisplay","truncate","shownText","Popover","Root","Trigger","asChild","Content","align","Close","marginLeft","Arrow","useIsTabActive","isTabActive","setIsTabActive","document","visibilityState","useEffect","addEventListener","DEFAULT_MIN_COLUMNS","DEFAULT_MAX_COLUMNS","DEFAULT_MIN_COLUMN_WIDTH","DEFAULT_GAP","getGridColumnSetup","minColumns","maxColumns","minColumnWidth","additionalBreakpoints","gridTemplateColumns","reduce","acc","breakpointWidth","minColumnWidthForBreakpoint","LocalStorageUtils","getStoreForComponent","componentName","LocalStorageStore","join","getSessionScopedStoreForComponent","version","constructor","scope","storageObj","this","window","localStorage","sessionStorage","loadComponentState","storedVal","reactComponentStateKey","saveComponentState","stateRecord","targetValue","toJSON","setItem","withScopePrefix","ExperimentSourceTypeIcon","sourceType","SourceType","NOTEBOOK","NotebookIcon","LOCAL","HomeIcon","PROJECT","FolderBranchIcon","JOB","WorkflowsIcon","ErrorIcon","XCircleIcon","textValidationDanger","FinishedIcon","CheckCircleIcon","textValidationSuccess","RunStatusIcon","status","ClockIcon","HIGH_RESOLUTION_MEDIA_QUERY","RunColorPill","hidden","onChangeColor","colorValue","setColorValue","onChangeColorDebounced","debounce","flexShrink","marginBottom","opacity","visuallyHidden","target","list","COLORS_PALETTE_DATALIST_ID","ExperimentViewDatasetSchemaTable","schema","filter","filteredSchema","row","_","hasFilter","Table","scrollable","TableRow","isHeader","TableHeader","onWheel","stopPropagation","TableCell","idx","_ref7","_ref8","_ref9","_ref10","ExperimentViewDatasetSchema","datasetWithTags","dataset","setFilter","Header","grey600","TableFilterInput","containerProps","mlflow_colspec","TableIcon","fontSize","lg","ExperimentViewDatasetLink","runTags","DatasetSourceTypes","HTTP","HUGGING_FACE","url","getDatasetSourceUrl","NewWindowIcon","href","S3","EXTERNAL","ExperimentViewDatasetSourceType","typeLabel","Hint","ExperimentViewDatasetSourceURL","fontSizeSm","columnGap","Link","openInNewTab","uri","source","ExperimentViewDatasetDigest","digest","ExperimentViewDatasetDrawerImpl","_datasetWithTags$tags","selectedDatasetWithRun","setSelectedDatasetWithRun","runData","contextTag","find","MLFLOW_RUN_DATASET_CONTEXT_TAG","fullProfile","profile","getRunColor","useGetExperimentRunColor","experimentId","Drawer","onOpenChange","Title","level","to","Routes","getRunPageRoute","runUuid","runLink","runName","Spacer","size","borderTop","flexDirection","borderRight","paddingLeft","datasets","backgroundSecondary","paddingBottom","paddingTop","ExperimentViewDatasetWithContext","displayTextAsLink","ellipsis","textTransform","substring","Divider","ExperimentViewDatasetDrawer","_tags$find","SourceCellRenderer","_tags$Utils$sourceTyp","Utils","sourceTypeTag","sourceLink","renderSource","ExperimentPageUISetStateContext","state","ExperimentPageUIStateContextProvider","setUIState","Provider","useUpdateExperimentViewUIState","useExperimentIds","params","useParams","location","useLocation","normalizedLocationSearch","decodeURIComponent","search","compareExperimentIdsQueryParam","queryParams","qs","experimentIdsRaw","toString","logErrorAndNotifyUser","usePopulateImagesByRunUuid","runUuids","runUuidsIsActive","autoRefreshEnabled","enabled","dispatch","useDispatch","runUuidsSerialized","slice","NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE","split","forEach","listImagesApi","refreshTimeoutRef","autoRefreshEnabledRef","runUuidsIsActiveSerialized","hookUnmounted","fetchImagesFn","activeRunUuids","autoRefresh","index","scheduleRefresh","clearTimeout","setTimeout","EXPERIMENT_RUNS_IMAGE_AUTO_REFRESH_INTERVAL","customMetricBehaviorDefs","ConfirmModal","Component","super","isSubmitting","onRequestCloseHandler","handleSubmitWrapper","setState","finally","render","onOk","okText","confirmButtonText","confirmLoading","centered","helpText","DeleteRunModalImpl","deletePromises","selectedRunIds","runId","push","deleteRunApi","Promise","all","errorModalContent","openErrorModal","_this$props$onSuccess","_this$props","number","pluralize","mapDispatchToProps","connect","injectIntl","GenericInputModal","formRef","validateFields","resetAndClearModalForm","handleSubmitFailure","reject","resetFields","handleCancel","cancelText","displayForm","child","innerRef","NEW_NAME_FIELD","RenameFormComponent","inputToAutoFocus","autoFocusInputRef","focus","select","autoFocus","prevProps","componentDidUpdate","Form","layout","Item","initialValue","validator","label","RenameForm","RenameRunModalImpl","handleRenameRun","newRunName","updateRunRequestId","getUUID","updateRunApi","Error","RenameRunModalWithIntl","RenameRunModal","RunsChartsConfigureField","compact","RunsChartsMetricParamSelect","metricKeyList","paramKeyList","isEmpty","selectFull","OptGroup","metric","makeCanonicalSortKey","param","RunsChartsRunNumberSelect","options","shouldUseNewRunRowsVisibilityModel","countOption","optionValue","runsChartsRunCountDefaultOptions","RunsChartsConfigureBarChart","onStateChange","updateMetric","metricKey","updateVisibleRunCount","runsCountToCompare","emptyMetricsList","RunsChartsConfigureParallelChart","updateSelectedParams","selectedParams","updateSelectedMetrics","selectedMetrics","emptyParamsList","mode","renderMetricSelectorV2","selectedMetricKeys","RunsChartsYAxisMetricAndExpressionSelector","_state$yAxisExpressio","usingChartExpressions","shouldEnableChartExpressions","updateYAxisKey","yAxisKey","config","range","yMin","yMax","Radio","Group","RunsChartsLineChartYAxisType","METRIC","EXPRESSION","yAxisExpressions","expression","fontFamily","updateYAxisExpression","CloseIcon","splice","removeYAxisExpression","addNewYAxisExpression","renderXAxisMetricSelector","selectedXAxisMetricKey","updateSelectedXAxisMetricKey","RunsChartsLineChartXAxisType","preventDefault","safeLog","isUndefined","Math","log10","safePow","pow","RunsChartsConfigureLineChart","_state$range","_state$range2","_state$range3","_state$range4","_state$range5","_state$range6","_state$range7","_state$range8","shouldEnableMetricsOnXAxis","shouldEnableDeepLearningUIPhase3","usingManualRangeControls","shouldEnableManualRangeControls","localAxisRange","setLocalAxisRange","xMin","xAxisScaleType","xMax","scaleType","metricKeys","updateXAxisKey","xAxisKey","isInvalidLogValue","updateXAxisScaleType","isLogType","newXMin","newXMax","prev","updateYAxisType","newYMin","newYMax","updateIgnoreOutliers","ignoreOutliers","updateSmoothing","lineSmoothness","updateXAxisWhenConfirmed","inTransitionState","updateYAxisWhenConfirmed","a","b","invalidMessage","METRIC_AXIS_PREFIX","SimpleSelect","contentProps","matchTriggerWidth","textOverflowMode","startsWith","STEP","TIME","TIME_RELATIVE","SimpleSelectOption","Tooltip","content","side","QuestionMarkIcon","timeStepQuestionMarkIcon","SimpleSelectOptionGroup","Number","updateXAxisScaleMin","max","updateXAxisScaleMax","min","Switch","checked","activeLabel","inactiveLabel","disabledLabel","updateYAxisScaleMin","updateYAxisScaleMax","delayDuration","SegmentedControlGroup","displayPoints","SegmentedControlButton","InfoIcon","LineSmoothSlider","svg","RunsChartsConfigureLineChartPreview","entities","metricsByRunUuid","areStatesEqual","nextState","prevState","_cardConfig$ignoreOut","_cardConfig$range","_cardConfig$range2","_cardConfig$range3","_cardConfig$range4","previewData","cardConfig","groupBy","usingMultipleRunsHoverTooltip","isGrouped","some","groupParentInfo","aggregateFunction","runUuidsToFetch","flatMap","g","belongsToGroup","_r$runInfo$runUuid","_r$runInfo","runInfo","_g$runUuid","metricKeysToFetch","_cardConfig$selectedM","fallback","yAxisKeys","xAxisKeys","concat","resultsByRunUuid","useSampledMetricHistory","maxResults","sampledData","run","metricsHistory","_resultsByRunUuid$run","_resultsByRunUuid$run2","history","uuid","removeOutliersFromMetricHistory","sampledGroupData","useGroupedChartRunData","ungroupedRunsData","sampledDataResultsByRunUuid","chartData","setTooltip","resetTooltip","useRunsChartsTooltip","RunsChartsTooltipMode","MultipleTracesWithScanline","Simple","LegacySkeleton","checkValidRange","rangeMin","rangeMax","xRange","yRange","RunsMetricsLinePlot","runsData","useDefaultHoverBox","onHover","onUnhover","RunsChartsConfigureContourChart","updateAxis","canonicalKey","axis","isCanonicalSortKeyOfType","extractCanonicalSortKey","_state$xaxis","_state$yaxis","_state$zaxis","firstMetric","firstParam","xaxis","yaxis","zaxis","scatterPlotDefaultOptions","RunsChartsConfigureScatterChart","RunsChartsConfigureDifferenceChart","updateCompareGroups","compareGroup","compareGroups","group","updateChartName","chartName","updateShowChangeFromBaseline","showChangeFromBaseline","updateShowDifferencesOnly","showDifferencesOnly","Checkbox","DifferenceCardConfigCompareGroup","_state$compareGroups","groupedCondition","DISABLED_GROUP_WHEN_GROUPBY","isChecked","LegacyInfoTooltip","RunsChartsConfigureImageChart","imageKeyList","stepMarks","maxMark","minMark","useImageSliderStepMarks","selectedImageKeys","imageKeys","updateStep","step","handleUpdate","imageKey","_currentConfig$imageK","currentConfig","_currentConfig$imageK2","DialogCombobox","multiSelect","DialogComboboxTrigger","DialogComboboxContent","DialogComboboxOptionList","_state$imageKeys","DialogComboboxOptionListCheckboxItem","marks","keys","previewComponentsMap","RunsChartType","BAR","RunsMetricsBarPlot","displayRunNames","displayMetricKey","margin","barChartCardDefaultMargin","CONTOUR","RunsContourPlot","xAxis","yAxis","zAxis","LINE","PARALLEL","_cardConfig$selectedP","isConfigured","_cardConfig$selectedP2","paramKey","dataTrace","_dataTrace$params$par","isNaN","filteredData","processParallelCoordinateData","LazyParallelCoordinatesPlot","axesRotateThreshold","SCATTER","RunsScatterPlot","DIFFERENCE","setCardConfig","DifferenceViewPlot","IMAGE","ImageGridPlot","containerWidth","RunsChartsConfigureModal","chartRunData","supportedChartTypes","isChartTypeSupported","borderStyle","actionDefaultBorderDefault","currentFormState","setCurrentFormState","isEditing","updateChartType","emptyChartCard","RunsChartsCardConfig","getEmptyChartCardByType","reverse","Set","images","add","sort","disableSaveButton","_lineCardConfig$selec","okButtonProps","bodyStyle","overflowY","borderBottom","chartType","chartTypeOption","ChartBarIcon","ChartScatterIcon","ChartLineIcon","ChartParallelIcon","ChartContourIcon","shouldEnableDifferenceViewCharts","ChartDifferenceIcon","shouldEnableImageGridCharts","ChartImageIcon","RunsChartsTooltipWrapper","contextData","runs","component","RunsChartsTooltipBody","hoverOnly","PreviewComponent","renderPreviewChartType","iconSize","RunsChartsFullScreenModal","isMetricHistoryLoading","fullScreenChart","tooltipContextValue","tooltipComponent","getPrefixedClassName","subtitle","verticalSizing","RunsChartsCard","sectionIndex","fullScreen","onRemoveChart","onReorderCharts","onStartEditChart","setFullScreenChart","canMoveDown","canMoveUp","onMoveDown","onMoveUp","onReorderWith","RunsChartsNoDataFoundIndicator","updateUIState","hideEmptyCharts","paddingRight","Empty","description","link","chunks","image","NoIcon","createLineChartValuesBox","activeRun","hoverData","_hoverData$metricEnti","_hoverData$yValue","metricKeyFromConfig","metricEntity","metricValue","yValue","metrics","isNil","xValue","getTooltipXValue","_hoverData$xValue","_hoverData$xValue2","shouldEnableRelativeTimeDateAxis","ValuesBox","isHovering","createBarChartValuesBox","_customMetricBehavior","_customMetricBehavior2","customMetricBehaviorDef","displayName","displayValue","valueFormatter","createScatterChartValuesBox","_activeRun$metrics$xK","_activeRun$params$xKe","_activeRun$metrics$yK","_activeRun$params$yKe","xKey","yKey","createContourChartValuesBox","_activeRun$metrics$xK2","_activeRun$params$xKe2","_activeRun$metrics$yK2","_activeRun$params$yKe2","_activeRun$metrics$zK","_activeRun$params$zKe","zKey","zValue","createParallelChartValuesBox","paramsList","metricsList","closeContextMenu","onTogglePin","onHideRun","containsMultipleRunsTooltipData","RunsMultipleTracesTooltipBody","singleTraceHoverData","hoveredDataPoint","metricSuffix","contentWrapper","header","colorPill","actionsWrapper","pinnable","pinned","PinFillIcon","PinIcon","VisibleIcon","primary","PLOT_CONFIG","displaylogo","scrollZoom","modeBarButtonsToRemove","DEFAULT_COLOR_SCALE","markerSize","reverseScale","runsChartDefaultContourMargin","colorScale","onUpdate","selectedRunUuid","onSetDownloadHandler","layoutHeight","layoutWidth","setContainerDiv","containerDiv","isDynamicSizeSupported","useDynamicPlotSize","plotData","xValues","yValues","zValues","tooltipData","_xAxisData$xAxis$key","_yAxisData$yAxis$key","_zAxisData$zAxis$key","xAxisData","yAxisData","zAxisData","z","layers","customdata","text","hovertemplate","zAxisTitle","hoverinfo","hoverlabel","runsChartHoverlabel","textposition","marker","line","unshift","connectgaps","contours","coloring","colorscale","reversescale","colorbar","tickfont","family","plotlyThemedLayout","createThemedPlotlyLayout","setLayout","ticks","standoff","template","newLayout","setHoveredPointIndex","useRenderRunsChartTraceHighlight","highlightScatterTraces","hoverCallback","_scatterPoints$pointI","_customdata","points","scatterPoints","curveNumber","pointIndex","pointCustomDataRunUuid","unhoverCallback","mutableHoverCallback","useMutableChartHoverCallback","legendLabelData","getLegendDataFromRuns","dataToExport","trace","createChartImageDownloadHandler","chart","commonRunsChartStyles","chartWrapper","scatterChartHighlightStyles","LazyPlot","useResizeHandler","RunsMetricsLegendWrapper","labelData","doubleClick","showTips","runsChartDefaultMargin","barWidth","ids","names","_d$metrics$metricKey","normalizeChartValue","textValues","_d$metrics$metricKey3","_d$metrics$metricKey2","val","places","toFixed","getFixedPointValue","textfont","orientation","hovermode","tickformat","chartAxisTickFormat","showticklabels","fixedrange","highlightBarTraces","_points$0$data","_points$0$pointIndex","_points$","_points$2","layoutToExport","automargin","highlightStyles","transition","TraceLabel","dashStyle","TraceLabelColorIndicator","strokeDasharray","dashType","getDashArray","pathYOffset","STROKE_WIDTH","alignContent","labelDatum","heightBuffer","RunsMetricsLegend","PLOTLY_DRAGLAYER_SELECTOR","parseMicroseconds","plotlyAxisBoundary","_plotlyAxisBoundary$m","microsecondsString","isString","match","getDataTraceForRun","_runEntry$metricsHist","_yValues","_runEntry$runInfo","_yValues2","_runEntry$runInfo2","_runEntry$runInfo3","runEntry","lineShape","lineDash","displayOriginalLine","originalLine","sortedMetricsHistory","timestamp","ySteps","xValuesWithSteps","prepareXAxisDataForMetricType","stepOrder","xSteps","yValueHistory","orderBySteps","has","prepareMetricHistoryByAxisType","optimizedLineShape","containsDuplicateXValues","shouldDisplayMarkers","containsSingleValue","EMA","metricHistory","hovertext","createTooltipTemplate","dash","shape","createFadedTraceColor","dataPoints","stepIndexes","_stepIndexes$a$step","_stepIndexes$b$step","Infinity","axisType","minTimestamp","minBy","_ref16","EPOCH_RELATIVE_TIME","_ref17","_ref18","TIME_RELATIVE_HOURS","_ref19","HOUR_IN_MILLISECONDS","_ref20","_ref21","datapoint","_ref22","lockXAxisZoom","dynamicXAxisKey","maxDiff","maxTimestamp","maxBy","diff","LINE_CHART_RELATIVE_TIME_THRESHOLD","_runEntry$metricsHist2","lineDashStyles","shouldEnableChartsOriginalLinesWhenSmoothing","flat","bandsData","_ref23","_runEntry$runInfo4","aggregatedMetricsHistory","xMins","xMaxes","yMins","yMaxes","_ref11","_ref12","_ref13","minReversed","_ref14","_ref15","bandValues","fillcolor","getBandTraceForRun","plotDataWithBands","highlightLineTraces","xAxisPlotlyType","getXAxisPlotlyType","xAxisKeyLabel","getChartAxisLabelDescriptor","yAxisParams","autorange","xAxisParams","showlegend","updatedLayout","containsMultipleMetricKeys","_ref24","_hoveredPoint$curveNu","_hoveredPointData$met","hoveredPoint","hoveredPointData","themedPlotlyLayout","immediateLayout","getXAxisRange","getLineChartLegendData","scanlineElement","initHandler","updateHandler","updateHandlerMultipleRuns","onPointHover","hoverCallbackMultipleRuns","onPointUnhover","unhoverCallbackMultipleRuns","chartBoundaries","containerLeftPixels","plotWidthPixels","plotOffsetPixels","lowerBoundValue","valueRange","mainContainer","dragLayer","initialized","scanlineElementRef","currentHoveredDataPoint","visibleXValues","uniq","initializedFigure","setInitializedFigure","immediateHoverData","immediateLegendLabelData","immediateRunsData","immediatePlotData","immediateXValuesData","setupBoundaries","figure","_figure$layout$xaxis","_figure$layout$xaxis$","_figure$layout$xaxis2","_figure$layout$xaxis3","_lowerBoundary","_upperBoundary","lowerAxisValue","upperAxisValue","lowerBoundary","isNumber","getTime","upperBoundary","updateContainerPosition","containerRect","getBoundingClientRect","dragLayerRect","onUpdatePlotHandler","graphDiv","querySelector","onInitPlotHandler","pointerLeavePlotCallback","relatedTarget","Element","classList","contains","onPointHoverCallback","singleTraceData","traceUuid","onPointUnhoverCallback","getClosestXValue","pointerClientX","boundaries","resultX","currentStep","abs","tooltipDataUpdateHandler","throttle","closestXValue","clientX","legendEntry","_correspondingDataTra","_correspondingDataTra2","correspondingDataEntry","correspondingDataTrace","xIndex","indexOf","tooltipLegendItems","orderBy","leading","windowResizeHandler","hoverHandler","_immediateHoverData$c","_immediateHoverData$c2","closestXValueLeftInPixels","clientY","originalEvent","removeEventListener","top","borderLeft","pointerEvents","useRunsMultipleTracesTooltipData","legend","onInitialized","PlotlyLikeFormattedTime","FormattedDate","year","month","day","FormattedTime","hour","hourCycle","minute","second","fractionalSecondDigits","PlotlyLikeFormattedTimestamp","hoveredTraceUuid","displayedXValueLabel","textPlaceholder","fontWeight","_points$$customdata","RunsChartsChartsDragGroup","ChartRunsCountIndicator","memo","runsOrGroups","containsGroups","containsRuns","count","RunsChartCardWrapperRaw","onDelete","onEdit","tooltip","noop","previousChartUuid","nextChartUuid","additionalMenuContent","toggleFullScreenChart","toggles","supportedDownloadFormats","onClickDownload","isHidden","isRefreshing","gridTemplateRows","borderRadiusBase","element","DragIcon","String","Spinner","toggle","currentToggle","setToggle","toggleLabel","FullscreenIcon","modal","OverflowIcon","Separator","chartEntry","chartComponentWrapper","verticalAlign","RunsChartCardWrapper","l","pad","RunsChartsBarChartCard","_customMetricBehavior3","_customMetricBehavior4","reorderProps","slicedRuns","shouldEnableHidingChartsWithNoData","isEmptyDataset","elementRef","isInViewport","useIsInViewport","imageDownloadHandler","setImageDownloadHandler","useChartImageDownloadHandler","chartBody","barChartCardWrapper","GENERAL_AREA","format","runsToExport","downloadChartDataCsv","getV2ChartTitle","SUPPORTED_DOWNLOAD_FORMATS","RunsChartsLineChartCard","_config$ignoreOutlier","onDownloadFullMetricHistoryCsv","_config$selectedMetri","metricsInRuns","intersection","_r$runInfo2","_config$selectedMetri2","destroyTooltip","isInViewportDeferred","sampledMetricsByRunUuid","useSelector","pick","shallowEqual","yRangeLocal","setYRangeLocal","yRangeLegacy","setOffsetTimestamp","stepRange","xRangeLocal","setXRangeLocal","offsetTimestamp","findChartStepsByTimestampForRuns","lowerBound","floor","upperBound","ceil","useCompareRunChartSelectedRange","renderChartBody","renderSkeleton","lineChartCardWrapper","yAxisMin","yAxisMax","xAxisMin","xAxisMax","yAxisAutorange","newYRange","xAxisAutorange","newXRange","ungroupedRunUuids","groupedRunUuids","_groupParentInfo$runU","timestampRange","findAbsoluteTimestampRangeForRelativeRange","_groupParentInfo$runU2","_config$selectedMetri3","_config$selectedMetri4","savedChartTitle","downloadChartMetricHistoryCsv","_d$runInfo","_group$groupParentInf","RunsChartsScatterChartCard","scatterChartCardWrapper","paramsToExport","metricsToExport","RunsChartsContourChartCard","contourChartCardWrapper","SvgParallelChartPlaceholder","gradientUnits","stopColor","offset","NotConfiguredParallelCoordsPlaceholder","ParallelChartSvg","UnsupportedDataPlaceholder","textAlign","RunsChartsParallelChartCard","configuredChartRunData","showAllRuns","containsStringValues","_config$selectedParam","updateVisibleOnlySetting","_state$compareRunChar","newCompareRunCharts","compareRunCharts","existingChartConfig","parallelCoordsData","_config$selectedParam2","configured","containsUnsupportedValues","displaySubtitle","parallelChartCardWrapper","fullScreenEnabled","PARALLEL_CHARTS_AREA","CheckboxItem","ItemIndicator","NotConfiguredDifferenceChartPlaceholder","RunsChartsDifferenceChartCard","_config$compareGroups","confirmChartCardConfiguration","useConfirmChartCardConfigurationFn","showChangeFromBaselineToggle","showDifferencesOnlyToggle","setter","showTooltip","RunsChartsImageChartCard","containerRef","setContainerWidth","resizeObserver","ResizeObserver","entries","contentRect","observe","disconnect","tmpConfig","setTmpConfig","DEFAULT_IMAGE_GRID_CHART_NAME","stepMarkLength","shouldDisplayImageLimitIndicator","LOG_IMAGE_TAG_INDICATOR","conf","onAfterChange","RunsChartsCardRaw","chartElementKey","editProps","commonChartProps","differenceView","isDifferent","HEADING_COLUMN_ID","NoDifferenceDataPlaceholder","modelMetrics","systemMetrics","parameters","attributes","getDifferenceViewDataGroups","headingColumnId","getMetrics","filterCondition","runDataKeys","runDataAttribute","hasDifference","MLFLOW_SYSTEM_METRIC_PREFIX","getVisibleTagValues","DifferenceCardAttributes","USER","SOURCE","VERSION","MODELS","attribute","attributeData","user","getUser","getSourceName","getSourceVersion","models","getLoggedModelsFromTags","getData","MODEL_METRICS","SYSTEM_METRICS","PARAMETERS","ATTRIBUTES","TAGS","baselineColumn","nonBaselineColumns","baselineColumnUuid","getColumns","convertRunToColumnInfo","isBaseline","baselineAccessorFn","accessorFn","cell","getValue","difference","ArrowDownIcon","ArrowUpIcon","accessorKey","table","useReactTable","columns","enableColumnResizing","columnResizeMode","getCoreRowModel","updateBaselineColumnUuid","getRowModel","rows","getTotalSize","getHeaderGroups","headerGroup","headers","column","getSize","resizable","getCanResize","resizeHandler","getResizeHandler","flexRender","columnDef","getContext","getAllCells","multiline","IMAGE_GAP_SIZE","getImageSize","numImages","maxImagesPerRow","ImagePlot","imageUrl","compressedImageUrl","imageSize","maxImageSize","previewVisible","setPreviewVisible","GenericSkeleton","ImagePreviewGroup","onVisibleChange","Image","src","preview","ImagePlotWithHistory","metadataByStep","ImageIcon","getArtifactLocationUrl","filepath","compressed_filepath","EmptyImageGridPlot","ImageGridSingleKeyPlot","displayRuns","imageMetadata","imageMetadataByStep","metadata","lineHeightMd","ImageGridMultipleKeyPlot","grid","filteredPreviewData","ParallelCoordinatesPlot","MAX_NUMBER_STRINGS","allRuns","shift","stringRuns","numberRuns","seenVals","tempRuns","filterParallelCoordinateData","result","computeSelectedAttrs","attrs","runvalue","isArray","attr","Suspense","activeKey","onActiveKeyChange","disableCollapse","clsPrefix","classItem","classItemActive","classHeader","classContent","classContentBox","classArrow","transform","textPrimary","outlineColor","outlineStyle","Accordion","dangerouslyAppendEmotionCSS","expandIconPosition","RunsChartsAddChartMenu","onAddChart","addChartButton","IconWrapper","iconWrapper","RunsChartsSectionHeader","section","sectionChartsLength","addNewChartCard","onDeleteSection","onAddSection","editSection","onSetEditSection","onSetSectionName","onSectionReorder","isExpanded","hideExtraControls","tmpSectionName","setTmpSectionName","isDraggingHandle","setIsDraggingHandle","sectionNameRef","confirmButtonRef","sectionNameWidth","setSectionNameWidth","isDeleteSectionModalOpen","setIsDeleteSectionModalOpen","entry","isCurrentlyEdited","isCurrentlyHovered","setIsCurrentlyHovered","role","visibility","onMouseMove","inset","isDarkMode","blue800","blue100","blue400","EDITABLE_LABEL_PADDING_WIDTH","onMouseDown","onMouseUp","onDoubleClick","onKeyDown","onPressEnter","minHeight","PencilIcon","CheckIcon","rotate","addSectionAbove","addSectionBelow","deleteSection","DangerModal","deleteModalConfirm","deleteModalCancel","alignSelf","RunsCharts","sectionId","cardsConfig","onInsertCharts","parallelChartCards","differenceChartCards","imageChartCards","remainingChartCards","c","gridSetup","dropTargetGeneralRef","isOverGeneral","dropTargetParallelRef","isOverParallel","isChartsEmpty","chartCards","_chartCards","_chartCards2","_remainingChartCards","_remainingChartCards2","RunsChartsSection","sectionCharts","reorderCharts","insertCharts","startEditChart","removeChart","RunsChartsSectionAccordion","compareRunSections","useUpdateRunsChartsUIConfiguration","setEditSection","sectionConfig","onActivePanelChange","newCompareRunPanels","shouldDisplaySection","chartConfig","isGenerated","metricSectionId","deleted","newCompareRunSections","isAccordionReordered","addSection","above","findIndex","newSection","isReordered","appendSection","setSectionName","sectionReorder","sourceSectionId","targetSectionId","sourceSectionIdx","targetSectionIdx","sourceSection","noRunsSelected","sectionsToRender","chartsToRender","compareRunChartsFiltered","chartMatchesFilter","filterLowerCase","lineConfig","scatterConfig","contourConfig","sectionsWithCharts","isSearching","MetricChartsAccordion","Panel","block","experimentChartImageDefaultDownloadLayout","paper_bgcolor","plot_bgcolor","experimentChartImageDefaultDownloadSettings","experimentChartImageDefaultDownloadPlotConfig","downloadImage","filename","downloadHandlerRef","downloadHandler","setDownloadHandler","setDownloadHandlerCached","existingHandler","chartTitle","_downloadHandlerRef$c","meta","VIEWPORT_DEBOUNCE_MS","deferTimeoutMs","activeObserver","setIsInViewport","startObserver","IntersectionObserver","intersectionObserver","isIntersecting","setElementRef","shouldDeferLineChartRendering","useDebounce","callback","mutableRef","highlightChartTracesFn","traceSelector","parentSelector","parent","hoverIndex","selectIndex","_parent$querySelector","_parent$querySelector3","numberOfBands","deselected","_parent$querySelector2","_parent$querySelector4","_parent$querySelector5","_parent$querySelector6","remove","querySelectorAll","bandTraceIndex","highlightFn","lastRunsData","selectedTraceIndex","hoveredPointIndex","onHighlightChange","useRunsChartTraceHighlight","shouldEnableUnifiedChartDataTraceHighlight","lastSelectedTraceIndex","highlightChangeListener","newExtern","externallyHighlightedRunIndex","ChartsTraceHighlightSource","RunsChartsSetHighlightContext","createContext","highlightDataTrace","RunsChartsSetHighlightContextProvider","highlightListenerFns","contextValue","shouldBlock","notifyListeners","fn","listener","createElement","useContext","RunsChartsTooltipContext","ContextMenuVisibility","extractHTMLAncestorElement","HTMLElement","currentElement","parentElement","ctxMenuRef","currentPos","usingImprovedClickMechanism","currentSnappedCoordinates","setMode","contextMenuShown","setContextMenuShown","HIDDEN","tooltipDisplayParams","setTooltipDisplayParams","hoveredRunUuid","setHoveredRunUuid","additionalAxisData","setAdditionalAxisData","focusedRunData","mutableContextMenuShownRef","mutableHoveredRunUuid","mutableTooltipDisplayParams","mutableAdditionalAxisData","applyPositioning","isChangingVisibilityMode","targetX","targetY","currentCtxMenu","reposition","menuRect","requestAnimationFrame","getCoordinatesForTargetElement","targetElement","_containerRef$current","targetRect","offsetX","offsetY","mouseMove","HOVER","nativeEvent","updateTooltip","additionalRunData","_focusedRunData$curre","VISIBLE","currentRunUuid","mouseDownCapture","button","pageX","pageY","tooltipAreaClicked","clickedInTheSamePlace","_focusedRunData$curre3","_focusedRunData$curre2","domRoot","getRootNode","rootClickListener","_focusedRunData$curre4","capture","_focusedRunData$curre5","CHART","displayTooltip","onMouseDownCapture","onClickCapture","contextMenuContainer","contextMenuWrapper","userSelect","zIndex","boxShadow","shadowLow","overlayElement","RunsChartsUIConfigurationContext","RunsChartsUIConfigurationContextProvider","updateChartsUIState","useReorderRunsChartsFn","sourceChartUuid","targetChartUuid","_current$compareRunCh","_current$compareRunSe","newChartsOrder","newSectionsState","indexSource","indexTarget","sourceChart","targetChart","isSameMetricSection","newSourceChart","configuredCard","serializedCard","serialize","_current$compareRunCh2","existingChartCard","useInsertRunsChartsFn","_current$compareRunCh3","_current$compareRunSe2","useRemoveRunsChartFn","configToDelete","_current$compareRunCh4","_current$compareRunCh5","setup","store","rangeKey","createChartAxisRangeKey","anyRunRefreshing","anyRunLoading","returnValues","metricsByMetricKey","dataByMetricKey","_store$entities$sampl","_store$entities$sampl2","runMetricData","refreshing","keyBy","refreshFn","chunk","runUuidsChunk","action","getSampledMetricHistoryBulkAction","fetchMetricsFn","isAutoRefreshing","EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL","refresh","dataTraceMetricsContainMultipleEpochs","_dataTrace$metrics","_dataTrace$metrics$me","entity","RunsChartsBarCardConfig","RunsChartsScatterCardConfig","RunsChartsParallelCardConfig","RunsChartsLineCardConfig","RunsChartsDifferenceCardConfig","RunsChartsImageCardConfig","RunsChartsContourCardConfig","getBaseChartConfigs","primaryMetricKey","resultChartSet","allMetricKeys","metricsToRender","metricsKey","getBaseChartAndSectionConfigs","useParallelCoordinatesChart","enabledSectionNames","MLFLOW_MODEL_METRIC_NAME","MLFLOW_SYSTEM_METRIC_NAME","filterMetricNames","imagesToRender","sectionName2Uuid","sectionName","extractChartSectionName","resultSectionSet","updateChartAndSectionConfigs","isResultUpdated","doesImageKeyExist","chartImageKeys","isSectionReordered","newChartConfig","insertIndex","localeCompare","doesMetricKeyExist","chartMetricKey","generatedChartIndex","prevChart","rest","delimiter","MLFLOW_MODEL_METRIC_PREFIX","findChartStepsByTimestamp","currentMetricHistory","useDefaultIfNotFound","flatHistory","valueOf","lowerEntry","first","upperEntry","last","sampledMetrics","stepRangesPerRun","_sampledMetrics$runUu","metricHistoryForRun","bound","currentlyVisibleMetrics","relativeRange","multiplier","_minBy","runMetrics","visibleMetricHistoryForRun","_metric$metricsHistor","timestampOffset","invariant","aggregatedRunUuidsInGroup","runUuidsForAggregation","aggregatedMetricsHistoryForMetric","metricsHistoryInGroup","_sampledDataResultsBy","_sampledDataResultsBy2","steps","h","createAggregatedMetricHistory","createValueAggregatedMetricHistory","RUN_ID_FILTER_EXPRESSION","createRunIdsFilterExpression","useExperimentTraces","experimentIds","sorting","traces","setTraces","setLoading","setError","orderByString","firstOrderByColumn","EXPERIMENT_TRACES_SORTABLE_COLUMNS","desc","filterString","pageTokens","setPageTokens","currentPage","setCurrentPage","currentPageToken","fetchTraces","pageToken","silent","response","MlflowService","getExperimentTraces","runNamesForTraces","traceIdToRunIdMap","traceId","request_id","getTraceInfoRunId","runIdsToRunNames","searchRuns","experiment_ids","run_view_type","ViewType","ALL","info","fetchRunNamesForTraces","tracesWithRunNames","prevPages","next_page_token","hasNextPage","hasPreviousPage","fetchNextPage","prevPage","fetchPrevPage","refreshCurrentPage","TracesViewTableTagCell","onAddEditTags","visibleTagList","MLFLOW_INTERNAL_PREFIX","containsTags","SpeechBubblePlusIcon","getIcon","textValidationWarning","TracesViewTableStatusCell","original","labelDescriptor","ExperimentViewTracesStatusLabels","TracesViewTablePreviewCell","previewFieldName","setIsExpanded","fullData","setFullData","fetchFullData","getExperimentTraceData","previewValue","requestData","expand","collapse","showExpander","isTraceMetadataPossiblyTruncated","ChevronDownIcon","ChevronRightIcon","ExpandedParamCell","structuredJSONValue","objectData","TracesViewTableRequestPreviewCell","getTraceInfoInputs","TracesViewTableResponsePreviewCell","getTraceInfoOutputs","TracesViewTableSourceCell","getHeaderSizeClassName","getColumnSizeClassName","TracesViewTableRow","buttonHeight","_meta","_meta2","TRACE_TABLE_CHECKBOX_COLUMN_ID","next","selected","TracesViewTableTimestampCell","timestamp_ms","toLocaleString","navigator","timeZoneName","timeSinceStr","TracesViewTableHeaderCheckbox","getIsAllRowsSelected","getIsSomeRowsSelected","toggleAllRowsSelected","TracesViewTableCellCheckbox","getCanSelect","getIsSelected","toggleSelected","TracesViewTable","onTraceClicked","onTraceTagsEdit","onNextPage","onPreviousPage","usingFilters","onResetFilters","setSorting","rowSelection","setRowSelection","hiddenColumns","disableTokenColumn","enableResizing","enableSorting","ExperimentViewTracesTableColumnLabels","ExperimentViewTracesTableColumns","requestId","traceName","getTraceTagValue","TRACE_TAG_NAME_TRACE_NAME","timestampMs","inputs","outputs","experiment_id","totalTokens","getTraceInfoTotalTokens","latency","execution_time_ms","isFinite","formatDuration","getRowId","getSortedRowModel","onSortingChange","onRowSelectionChange","enableRowSelection","columnSizeInfo","getState","columnSizingInfo","columnSizeVars","getFlatHeaders","colSizes","empty","getEmptyState","getMessageField","DangerIcon","pagination","CursorPagination","getLeafHeaders","sortable","getCanSort","sortDirection","getIsSorted","onToggleSort","getToggleSortingHandler","isResizing","getIsResizing","TableSkeletonRows","ModelTraceExplorerFrameRenderer","modelTrace","useLatestVersion","iframeRef","handleMessage","_iframeRef$current","iframeWindow","contentWindow","ModelTraceChildToParentFrameMessage","Ready","_iframeRef$current2","postMessage","ModelTraceParentToChildFrameMessage","UpdateTrace","traceData","TitleSkeleton","TableSkeleton","lines","TraceDataDrawer","traceInfo","loadingTraceInfo","loadingTraceData","skip","setTraceData","fetchTraceData","spans","useExperimentTraceData","shouldFetchTraceInfo","internalTraceInfo","loadingInternalTracingInfo","setTraceInfoData","fetchTraceInfo","getExperimentTraceInfo","trace_info","useExperimentTraceInfo","traceInfoToUse","getTraceDisplayName","combinedModelTrace","trace_data","containsSpans","expandContentToFullHeight","WarningIcon","TracesViewDeleteTraceModal","handleClose","refreshTraces","tracesToDelete","pickBy","handleOk","_experimentIds$","deleteTraces","submitDeleteTraces","danger","TracesViewControlsActions","isModalOpen","setIsModalOpen","openModal","closeModal","InputTooltip","whereBold","TracesViewControls","onChangeFilter","disabledColumns","toggleHiddenColumn","filterValue","setFilterValue","allColumnsList","displayedFilterValue","TableFilterLayout","prefix","SearchIcon","suffix","ColumnsIcon","DialogComboboxOptionListSearch","defaultExperimentViewTracesUIState","useExperimentViewTracesUIState","localStore","persistenceIdentifier","uiState","uiStateRaw","loadExperimentViewTracesUIState","columnId","prevUIState","QUERY_PARAM_KEY","defaultSorting","TracesView","_uiState$hiddenColumn2","timeoutRef","selectedTraceId","setSelectedTraceId","useActiveExperimentTrace","_searchParams$get","searchParams","setSearchParams","useSearchParams","selectedTraceInfo","existingTagKeys","_trace$tags","showEditTagsModalForTrace","existingTags","newTags","traceRequestId","addedOrModifiedTags","newTagKey","newTagValue","existingTagKey","existingTagValue","deletedTags","updateRequests","setExperimentTraceTag","deleteExperimentTraceTag","visibleTags","useEditExperimentTraceTags","anyTraceContainsTokenCount","autoDisabledColumns","allDisabledColumns","allHiddenColumns","_uiState$hiddenColumn","onTagsUpdated","sortingSetter","isFunction","currentState","newState","currentSortBy","getTraceMetadataField","_traceInfo$request_me","_traceInfo$request_me2","request_metadata","traceMetadata","tagName","_traceInfo$tags","_traceInfo$tags$find","defineMessage","UNSET","IN_PROGRESS","OK","ERROR","datasetSummariesEqual","summary1","summary2","context","path","buttonProps","setShowTooltip","handleClick","clipboard","writeText","handleMouseLeave","icons","rotateLeft","UndoIcon","rotateRight","RedoIcon","zoomIn","ZoomInIcon","zoomOut","ZoomOutIcon","close","ArrowLeftIcon","ArrowRightIcon","getPopupContainer","DesignSystemContext","RcImage","PreviewGroup","getContainer","v","useMediaQuery","query","queryList","useSyncExternalStore","matches","useMatchesMediaQuery","matchMedia","direction","wordSpacing","MozTabSize","OTabSize","tabSize","WebkitHyphens","MozHyphens","msHyphens","hyphens","textShadow","comment","prolog","doctype","cdata","punctuation","namespace","Opacity","operator","property","function","selector","boolean","string","keyword","directive","unit","statement","regex","atrule","variable","textDecoration","inserted","italic","fontStyle","important","Outline","OutlineOffset","borderRightColor","wordWrap","builtin","char","class","constant","hexcode","symbol","SyntaxHighlighter","registerLanguage","python","snippetPadding","themesStyles","light","lightStyle","duotoneDark","duotoneDarkStyle","actions","showLineNumbers","lineNumberStyle","customStyle","codeTagProps"],"sourceRoot":""}